<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>!DOSバッチファイル</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../dos_batch.html?f1=dos_batch.files/dos_batch_tree.html&sub1=svgcats_index_p" + num +
     "&f2=dos_batch.files/dos_batch_02.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "dos_batch.files/dos_batch_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../dos_batch.html?f1=dos_batch.files/dos_batch_tree.html&sub1=svgcats_index_p" + num +
       "&f2=dos_batch.files/dos_batch_02.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 18 --> 
<PAGE>
<A id="svgcats_vml_p18" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '18' );">←</A>
<A href="#svgcats_vml_p19" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="dos_batch_01.html#svgcats_vml_p17" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="dos_batch_01.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:435px; height:183px;" fillcolor="white"/>
<DIV id="text18_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="cmd_api">
API</A></DIV>
<DIV id="text18_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:58px; margin-top:63px; line-height:15px; white-space:nowrap">
<A href="#_getch">
→ _getch, _getche</A></DIV>
<DIV id="text18_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:142px; margin-top:22px; line-height:12px; white-space:nowrap">
<A href="dos_batch_01.html#cmd">
[ 親: コマンドプロンプト ]</A></DIV>

<v:line from="0,0" to="435,0"/>
<v:line from="435,0" to="435,183"/>
<v:line from="435,183" to="0,183"/>
<v:line from="0,183" to="0,0"/>

</PAGE>
 
<!-- page 19 --> 
<PAGE>
<A id="svgcats_vml_p19" class="to_tree" style="margin-top:188px;" onClick="selectTreeElem( '19' );">←</A>
<A href="#svgcats_vml_p20" class="to_next_page" style="margin-top:188px;">▼</A>
<A href="#svgcats_vml_p18" class="to_prev_page" style="margin-top:188px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:199px; width:560px; height:645px;" fillcolor="white"/>
<DIV id="text19_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:216px; line-height:15px; white-space:nowrap">
<A name="_getch">
_getch</A></DIV>
<DIV id="text19_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:235px; line-height:15px; white-space:nowrap">
_getche</DIV>
<v:rect style="position:absolute; margin-left:35px; margin-top:265px; width:136px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text19_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:43px; margin-top:272px; line-height:13px; white-space:nowrap">
int&nbsp; _getch( void );</DIV>
<DIV id="text19_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:302px; line-height:15px; white-space:nowrap">
キーボードからの入力を１文字取得します。 入力があるまで待ちます。</DIV>
<DIV id="text19_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:230px; margin-top:218px; line-height:12px; white-space:nowrap">
<A href="#cmd_api">
[ 親: コマンドプロンプトAPI ]</A></DIV>
<DIV id="text19_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:144px; margin-top:216px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/vclib/html/_crt__getch.2c_._getche.asp" target="_blank">
MSDN(Web)</A></DIV>
<DIV id="text19_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:330px; line-height:15px; white-space:nowrap">
#include&nbsp; &lt;conio.h&gt;</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:421px; width:460px; height:400px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text19_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:427px; line-height:15px; white-space:nowrap">
/***********************************************************************<BR/>
&nbsp; &lt;&lt;&lt; [getYesNo] Yes か No をユーザに尋ねる &gt;&gt;&gt; <BR/>
【引数】<BR/>
&nbsp; ・int&nbsp; default;&nbsp; Enter のみ押したときの返り値<BR/>
&nbsp; ・int&nbsp; ctrl_c;&nbsp; &nbsp;Ctrl+C を押したときの返り値<BR/>
&nbsp; ・int&nbsp; 返り値;&nbsp; &nbsp;Yes=1, No=0<BR/>
************************************************************************/<BR/>
int&nbsp; getYesNo( int _default, int ctrl_c )<BR/>
{<BR/>
&nbsp; int&nbsp; b = -1;<BR/>
&nbsp; for (;;) {<BR/>
&nbsp; &nbsp; int&nbsp; c = _getch();<BR/>
&nbsp; &nbsp; if ( c == '\r' )&nbsp; { printf( "\n" );&nbsp; break; }<BR/>
&nbsp; &nbsp; if ( c == 0x03 )&nbsp; { printf( "^C\n" );&nbsp; b = -2;&nbsp; break; }&nbsp; /* Ctrl+C */<BR/>
&nbsp; &nbsp; if ( c == 0x08 )&nbsp; { printf( "\b \b" );&nbsp; b = -1;&nbsp; continue; }&nbsp; /* BS */<BR/>
&nbsp; &nbsp; if ( c != 'Y' &amp;&amp; c != 'y' &amp;&amp; c != 'N' &amp;&amp; c != 'n' )&nbsp; continue;<BR/>
&nbsp; &nbsp; if ( b != -1 )&nbsp; printf( "\b" );<BR/>
&nbsp; &nbsp; printf( "%c", c );<BR/>
&nbsp; &nbsp; b = ( c == 'Y' || c == 'y' );&nbsp; /* Y=1, N=0 */<BR/>
&nbsp; }<BR/>
&nbsp; if ( b == -1 )&nbsp; b = _default;&nbsp; /* デフォルト */<BR/>
&nbsp; else if ( b == -2 )&nbsp; b = ctrl_c;&nbsp; /* Ctrl+C */<BR/>
<BR/>
&nbsp; return&nbsp; b;<BR/>
}<BR/>
&nbsp;</DIV>
<DIV id="text19_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:396px; line-height:15px; white-space:nowrap">
サンプル：</DIV>

<v:line from="0,199" to="560,199"/>
<v:line from="560,199" to="560,844"/>
<v:line from="560,844" to="0,844"/>
<v:line from="0,844" to="0,199"/>

</PAGE>
 
<!-- page 20 --> 
<PAGE>
<A id="svgcats_vml_p20" class="to_tree" style="margin-top:849px;" onClick="selectTreeElem( '20' );">←</A>
<A href="#svgcats_vml_p21" class="to_next_page" style="margin-top:849px;">▼</A>
<A href="#svgcats_vml_p19" class="to_prev_page" style="margin-top:849px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:860px; width:503px; height:504px;" fillcolor="white"/>
<DIV id="text20_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:877px; line-height:15px; white-space:nowrap">
<A name="_getcwd">
_getcwd</A></DIV>
<DIV id="text20_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:1180px; line-height:15px; white-space:nowrap">
サンプルコード</DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:958px; width:268px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text20_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:965px; line-height:13px; white-space:nowrap">
char*&nbsp; _getcwd( char* cwd, int cwd_size );</DIV>
<DIV id="text20_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:1031px; line-height:15px; white-space:nowrap">
<A name="_getcwd_explain">
カレントフォルダを取得します。</A></DIV>
<DIV id="text20_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:53px; margin-top:1058px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text20_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:117px; margin-top:1058px; line-height:15px; white-space:nowrap">
cwd</DIV>
<DIV id="text20_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:117px; margin-top:1077px; line-height:15px; white-space:nowrap">
cwd_size</DIV>
<DIV id="text20_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:197px; margin-top:1058px; line-height:15px; white-space:nowrap">
（出力）カレントフォルダ</DIV>
<DIV id="text20_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:197px; margin-top:1077px; line-height:15px; white-space:nowrap">
メモリサイズ</DIV>
<DIV id="text20_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:145px; margin-top:877px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/sf98bd4y(VS.71).aspx" target="_blank">
MSDN(Web)</A></DIV>
<DIV id="text20_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:230px; margin-top:879px; line-height:12px; white-space:nowrap">
<A href="#cmd_api">
[ 親: コマンドプロンプトAPI ]</A></DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:989px; width:292px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text20_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:996px; line-height:13px; white-space:nowrap">
wchar_t*&nbsp; _wgetcwd( wchar_t* cwd, int cwd_m );</DIV>
<DIV id="text20_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:117px; margin-top:1096px; line-height:15px; white-space:nowrap">
cwd_m</DIV>
<DIV id="text20_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:197px; margin-top:1096px; line-height:15px; white-space:nowrap">
最大文字数+1</DIV>
<DIV id="text20_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:197px; margin-top:1115px; line-height:15px; white-space:nowrap">
cwd、エラー=NULL</DIV>
<DIV id="text20_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:117px; margin-top:1115px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text20_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:68px; margin-top:1298px; line-height:15px; white-space:nowrap">
→ GetCurrentDirectory</DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:927px; width:286px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text20_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:934px; line-height:13px; white-space:nowrap">
TCHAR*&nbsp; _tgetcwd( TCHAR* cwd, int cwd_size );</DIV>
<DIV id="text20_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:43px; margin-top:1149px; line-height:12px; white-space:nowrap">
キーワード：</DIV>
<DIV id="text20_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:106px; margin-top:1149px; line-height:12px; white-space:nowrap">
<A name="currentdir">
カレントディレクトリ、カレントフォルダ</A></DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:1199px; width:430px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text20_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:1205px; line-height:15px; white-space:nowrap">
#include&nbsp; &lt;direct.h&gt;<BR/>
TCHAR&nbsp; cwd[4096];<BR/>
<BR/>
IF ( _tgetcwd( cwd, _countof(cwd) ) == NULL ) {e=E_OTHERS; goto fin;}</DIV>
<DIV id="text20_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:1316px; line-height:15px; white-space:nowrap">
→ _tchdir</DIV>
<DIV id="text20_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:25px; margin-top:1298px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text20_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:893px; line-height:15px; white-space:nowrap">
_tgetcwd</DIV>

<v:line from="0,860" to="503,860"/>
<v:line from="503,860" to="503,1364"/>
<v:line from="503,1364" to="0,1364"/>
<v:line from="0,1364" to="0,860"/>

</PAGE>
 
<!-- page 21 --> 
<PAGE>
<A id="svgcats_vml_p21" class="to_tree" style="margin-top:1369px;" onClick="selectTreeElem( '21' );">←</A>
<A href="#svgcats_vml_p22" class="to_next_page" style="margin-top:1369px;">▼</A>
<A href="#svgcats_vml_p20" class="to_prev_page" style="margin-top:1369px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1380px; width:476px; height:339px;" fillcolor="white"/>
<DIV id="text21_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:22px; margin-top:1398px; line-height:15px; white-space:nowrap">
<A name="bat_test">
バッチファイルを使ったテストの自動化</A></DIV>
<DIV id="text21_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:1618px; line-height:15px; white-space:nowrap">
<A href="#test_start">
→ プログラムの起動</A></DIV>
<DIV id="text21_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:1638px; line-height:15px; white-space:nowrap">
<A href="#test_err">
→ プログラムの返り値のチェック （エラーレベル）</A></DIV>
<DIV id="text21_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:1671px; line-height:15px; white-space:nowrap">
<A href="#all_test">
→ 全テスト実行バッチ、バッチファイルのリターン値</A></DIV>
<DIV id="text21_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:1578px; line-height:15px; white-space:nowrap">
<A href="#folder_reset">
→ テスト用フォルダをリセット（削除＆コピー）</A></DIV>
<DIV id="text21_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:324px; margin-top:1578px; line-height:15px; white-space:nowrap">
clean,bat もあります</DIV>
<DIV id="text21_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:1441px; line-height:15px; white-space:nowrap">
<A href="#test_bat_tmp">
→ テストバッチのテンプレート</A></DIV>
<DIV id="text21_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:245px; margin-top:1441px; line-height:15px; white-space:nowrap">
通常はこれをコピーして使います</DIV>
<DIV id="text21_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:1598px; line-height:15px; white-space:nowrap">
→ コマンドライン・コンパイル</DIV>
<DIV id="text21_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:1464px; line-height:15px; white-space:nowrap">
<A href="#abs_path_chk">
→ 出力結果に絶対パスがあるとき</A></DIV>
<DIV id="text21_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:1487px; line-height:15px; white-space:nowrap">
<A href="#ver_pack">
→ バージョン別パッケージ</A></DIV>
<DIV id="text21_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:1510px; line-height:15px; white-space:nowrap">
<A href="#copy_sync">
→ コピーファイル同期</A></DIV>

<v:line from="0,1380" to="476,1380"/>
<v:line from="476,1380" to="476,1719"/>
<v:line from="476,1719" to="0,1719"/>
<v:line from="0,1719" to="0,1380"/>

</PAGE>
 
<!-- page 22 --> 
<PAGE>
<A id="svgcats_vml_p22" class="to_tree" style="margin-top:1724px;" onClick="selectTreeElem( '22' );">←</A>
<A href="#svgcats_vml_p23" class="to_next_page" style="margin-top:1724px;">▼</A>
<A href="#svgcats_vml_p21" class="to_prev_page" style="margin-top:1724px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1735px; width:479px; height:386px;" fillcolor="white"/>
<DIV id="text22_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1752px; line-height:15px; white-space:nowrap">
<A name="test_bat_tmp">
テストバッチのテンプレート</A></DIV>
<DIV id="text22_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:1955px; line-height:15px; white-space:nowrap">
<A href="#folder_reset">
→ テスト用フォルダをリセット（削除＆コピー）</A></DIV>
<DIV id="text22_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:1976px; line-height:15px; white-space:nowrap">
<A href="#test_start">
→ テストプログラムの起動</A></DIV>
<DIV id="text22_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:1997px; line-height:15px; white-space:nowrap">
<A href="#test_err">
→ プログラムの返り値のチェック</A></DIV>
<DIV id="text22_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1785px; line-height:15px; white-space:nowrap">
テンプレート：</DIV>
<DIV id="text22_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1931px; line-height:15px; white-space:nowrap">
含まれている内容：</DIV>
<DIV id="text22_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:1845px; line-height:15px; white-space:nowrap">
→ test_template.lzh</DIV>
<DIV id="text22_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:1869px; line-height:15px; white-space:nowrap">
→ test_template_snote.lzh</DIV>
<DIV id="text22_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:221px; margin-top:1845px; line-height:15px; white-space:nowrap">
一般用、テストのみ</DIV>
<DIV id="text22_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:221px; margin-top:1869px; line-height:15px; white-space:nowrap">
SnapNote 用、テストのみ</DIV>
<DIV id="text22_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:2054px; line-height:15px; white-space:nowrap">
→ コマンドライン・コンパイル</DIV>
<DIV id="text22_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2028px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text22_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:2073px; line-height:15px; white-space:nowrap">
<A href="dos_batch_04.html#currentfolder">
→ カレントフォルダを取得する</A></DIV>
<DIV id="text22_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:221px; margin-top:1893px; line-height:15px; white-space:nowrap">
一般用、全部（ビルド、テスト、リリース）</DIV>
<DIV id="text22_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:45px; margin-top:1893px; line-height:15px; white-space:nowrap">
<A href="#proj_templ">
→ プロジェクト・テンプレート</A></DIV>
<DIV id="text22_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:158px; margin-top:1821px; line-height:15px; white-space:nowrap">
標準出力をチェックする簡易自動テストバッチ</DIV>
<DIV id="text22_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:45px; margin-top:1821px; line-height:15px; white-space:nowrap">
<A href="#FCBat">
→ FCBat</A></DIV>

<v:line from="0,1735" to="479,1735"/>
<v:line from="479,1735" to="479,2121"/>
<v:line from="479,2121" to="0,2121"/>
<v:line from="0,2121" to="0,1735"/>

</PAGE>
 
<!-- page 23 --> 
<PAGE>
<A id="svgcats_vml_p23" class="to_tree" style="margin-top:2126px;" onClick="selectTreeElem( '23' );">←</A>
<A href="#svgcats_vml_p24" class="to_next_page" style="margin-top:2126px;">▼</A>
<A href="#svgcats_vml_p22" class="to_prev_page" style="margin-top:2126px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2137px; width:569px; height:2107px;" fillcolor="white"/>
<v:image src="23/image01.png"
   style="position:absolute; margin-left:45px; margin-top:2359px; width:18px; height:69px;"/>
<v:image src="23/image02.png"
   style="position:absolute; margin-left:47px; margin-top:2427px; width:14px; height:17px;"/>
<v:image src="23/image03.png"
   style="position:absolute; margin-left:47px; margin-top:2444px; width:14px; height:17px;"/>
<v:image src="23/image04.png"
   style="position:absolute; margin-left:53px; margin-top:2264px; width:33px; height:29px;"/>
<DIV id="text23_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2154px; line-height:15px; white-space:nowrap">
<A name="FCBat">
FCBat テストツール</A></DIV>
<DIV id="text23_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:70px; margin-top:2358px; line-height:17px; white-space:nowrap">
T_ALL_5_do_test.bat<BR/>
T_ALL_7_clean.bat<BR/>
T_Func.vbs<BR/>
T_Func_ans.txt<BR/>
T_Func_log.txt<BR/>
T_ALL_result.txt</DIV>
<DIV id="text23_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:193px; margin-top:2358px; line-height:17px; white-space:nowrap">
すべてのテストスクリプトを起動し、出力をチェックする<BR/>
すべてのテストの出力を削除する<BR/>
テスト・スクリプト（テスト・プログラム）の例<BR/>
正しい出力の例<BR/>
（テストを実行すると出力されるファイル） 出力の例<BR/>
（テストを実行すると出力されるファイル） 全体の結果</DIV>
<DIV id="text23_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:2716px; line-height:15px; white-space:nowrap">
<A name="FCBat_do">
すべてのテストを実施する</A></DIV>
<DIV id="text23_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:2740px; line-height:17px; white-space:nowrap">
T_ALL_5_do_test.bat をダブルクリックするとテストが始まります。<BR/>
すべてのテストスクリプトを起動して、出力をチェックします。<BR/>
すべての出力があっていたかどうかは、出力の最後の数行を確認してください。</DIV>
<v:rect style="position:absolute; margin-left:66px; margin-top:2829px; width:136px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text23_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:74px; margin-top:2835px; line-height:15px; white-space:nowrap">
Test log compare ...<BR/>
Pass.</DIV>
<DIV id="text23_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:60px; margin-top:2808px; line-height:15px; white-space:nowrap">
合っているとき</DIV>
<DIV id="text23_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:234px; margin-top:2808px; line-height:15px; white-space:nowrap">
誤っているときの例</DIV>
<v:rect style="position:absolute; margin-left:239px; margin-top:2829px; width:136px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text23_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:247px; margin-top:2835px; line-height:15px; white-space:nowrap">
Fail in T_Func.vbs<BR/>
Test log compare ...<BR/>
Fail.</DIV>
<DIV id="text23_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:3489px; line-height:15px; white-space:nowrap">
<A name="FCBat_debug">
１つのテストをデバッグする</A></DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:3614px; width:466px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text23_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:3620px; line-height:15px; white-space:nowrap">
set T=T_Sample<BR/>
echo ^&lt;^&lt;^&lt; [%T%] ^&gt;^&gt;^&gt;<BR/>
( cscript %2 //nologo %T%.vbs %3 2&gt;&amp;1 ) &gt; %T%_log.txt<BR/>
fc %T%_ans.txt %T%_log.txt<BR/>
if errorlevel 1&nbsp; echo Fail in %T%.vbs&gt;&gt; T_ALL_result.txt&amp;goto :last_of_test</DIV>
<DIV id="text23_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:3520px; line-height:17px; white-space:nowrap">
T_ALL.bat は、下記のようなスクリプト（ブロック）が集まったものです。<BR/>
１つのブロックが、１つのテストの実行に対応しています。<BR/>
環境変数 T がテストシンボルです。必要に応じて変えてください。<BR/>
（テストシンボル）＋.vbs を起動しています。<BR/>
（テストシンボル）＋_log.txt が出力内容を記録したファイルです。</DIV>
<DIV id="text23_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:41px; margin-top:3716px; line-height:17px; white-space:nowrap">
デバッグするときは、デバッグするテストに対応するブロックを先頭にコピーし、<BR/>
ブロックの前後に、下記のように記述します。</DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:3760px; width:88px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text23_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:3766px; line-height:15px; white-space:nowrap">
echo on<BR/>
<BR/>
（ブロック）<BR/>
<BR/>
pause</DIV>
<DIV id="text23_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:3880px; line-height:15px; white-space:nowrap">
<A name="FCBat_add">
テストを追加する</A></DIV>
<DIV id="text23_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:41px; margin-top:3907px; line-height:17px; white-space:nowrap">
上記のブロックをコピーして、環境変数の値を修正します。<BR/>
上記は、VBScript を起動していますが、別のプログラムを起動してもかまいません。</DIV>
<DIV id="text23_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2188px; line-height:17px; white-space:nowrap">
標準出力をチェックする自動テストバッチ。<BR/>
構造はシンプルですが、取り扱いが少し不便です。<BR/>
T_ALL_5_do_test.bat が、それぞれのテスト・プログラムを起動します。</DIV>
<DIV id="text23_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:2565px; line-height:15px; white-space:nowrap">
<A href="#FCBat_add">
→ テストを追加する</A></DIV>
<DIV id="text23_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:2546px; line-height:15px; white-space:nowrap">
<A href="#FCBat_debug">
→ １つのテストをデバッグする</A></DIV>
<DIV id="text23_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:2489px; line-height:15px; white-space:nowrap">
<A href="#FCBat_do">
→ すべてのテストを実施する</A></DIV>
<DIV id="text23_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:24px; margin-top:2332px; line-height:15px; white-space:nowrap">
ファイル構成</DIV>
<DIV id="text23_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:97px; margin-top:3325px; line-height:15px; white-space:nowrap">
<A href="dos_batch_05.html#fc">
→ fc</A></DIV>
<DIV id="text23_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:58px; margin-top:3325px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text23_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2623px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text23_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:63px; margin-top:2623px; line-height:15px; white-space:nowrap">
<A href="#abs_path_chk">
→ 出力結果に絶対パスがあるとき （T_ALL_4_setup.bat）</A></DIV>
<DIV id="text23_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:2893px; line-height:17px; white-space:nowrap">
複数のフォルダに、T_ALL_5_do_test.bat があるときは、ファイル名で検索して<BR/>
すべて手動で起動してください。</DIV>
<DIV id="text23_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:3977px; line-height:15px; white-space:nowrap">
<A name="fcbat_manual">
手動テストを一覧する</A></DIV>
<DIV id="text23_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:41px; margin-top:4004px; line-height:17px; white-space:nowrap">
自動テストの結果に手動テストを一覧することで、、テスターに残りのテストを通知<BR/>
します。 下記のように T_ALL_result.txt に出力すると、最後にまとめて表示されます。</DIV>
<v:rect style="position:absolute; margin-left:68px; margin-top:4072px; width:262px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text23_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:76px; margin-top:4079px; line-height:13px; white-space:nowrap">
echo [ManualTest] %T% &gt;&gt; T_ALL_result.txt</DIV>
<v:rect style="position:absolute; margin-left:68px; margin-top:4133px; width:136px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text23_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:76px; margin-top:4139px; line-height:15px; white-space:nowrap">
[ManualTest] T_Test1<BR/>
[ManualTest] T_Test2<BR/>
Test log compare ...<BR/>
Pass.</DIV>
<DIV id="text23_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:64px; margin-top:4050px; line-height:15px; white-space:nowrap">
バッチファイル</DIV>
<DIV id="text23_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:64px; margin-top:4113px; line-height:15px; white-space:nowrap">
表示例</DIV>
<DIV id="text23_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:2584px; line-height:15px; white-space:nowrap">
<A href="#fcbat_manual">
→ 手動テストを一覧する</A></DIV>
<DIV id="text23_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:63px; margin-top:2663px; line-height:15px; white-space:nowrap">
→ テストツール</DIV>
<DIV id="text23_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:2956px; line-height:15px; white-space:nowrap">
<A name="FCBat_FindFail">
Fail したテスト項目を特定する</A></DIV>
<DIV id="text23_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:2508px; line-height:15px; white-space:nowrap">
<A href="#FCBat_FindFail">
→ Fail したテスト項目を特定する</A></DIV>
<DIV id="text23_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:2985px; line-height:17px; white-space:nowrap">
テストに失敗すると、T_ALL_result.txt に、失敗したテスト項目が記録されます。<BR/>
T_ALL_result.txt は、T_ALL_5_do_test.bat が echo 出力したものなので、<BR/>
T_ALL_5_do_test.bat の内容を調べることで、問題があったコマンドラインを確認できます。</DIV>
<v:rect style="position:absolute; margin-left:146px; margin-top:3070px; width:136px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text23_42" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:154px; margin-top:3076px; line-height:15px; white-space:nowrap">
Fail in T_Func.vbs<BR/>
Test log compare ...<BR/>
Fail.</DIV>
<DIV id="text23_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:129px; margin-top:3051px; line-height:15px; white-space:nowrap">
Fail したときのT_ALL_result.txt の例：</DIV>
<DIV id="text23_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:63px; margin-top:2642px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_52.html#test_prompt">
→ テスト・プロンプト (Test.vbs)</A></DIV>
<DIV id="text23_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:3824px; line-height:15px; white-space:nowrap">
pause までたどり着いたら Pass です。</DIV>
<DIV id="text23_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:3766px; line-height:15px; white-space:nowrap">
バッチファイルの動きを表示します。</DIV>
<DIV id="text23_47" style="position:absolute; font-family: 'メイリオ'; font-size:10pt; color:#000000; margin-left:281px; margin-top:2269px; line-height:15px; white-space:nowrap">
(新規)</DIV>
<DIV id="text23_48" style="position:absolute; font-family: 'メイリオ'; font-size:10pt; color:#0000FF; margin-left:96px; margin-top:2269px; line-height:15px; white-space:nowrap">
<A name="FCBat" href="..\fcbat.zip" target="_blank">
FCBat テストツール(.zip)</A></DIV>
<DIV id="text23_49" style="position:absolute; font-family: 'メイリオ'; font-size:10pt; color:#0000FF; margin-left:329px; margin-top:2269px; line-height:15px; white-space:nowrap">
<A href="#FCBat">
(help)</A></DIV>
<DIV id="text23_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:3163px; line-height:15px; white-space:nowrap">
<A name="fcbat_check">
出力ファイルをチェックする</A></DIV>
<DIV id="text23_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:2527px; line-height:15px; white-space:nowrap">
<A href="#fcbat_check">
→ 出力ファイルをチェックする</A></DIV>
<v:rect style="position:absolute; margin-left:50px; margin-top:3217px; width:466px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text23_52" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:58px; margin-top:3223px; line-height:15px; white-space:nowrap">
set T=T_TestSet<BR/>
echo ((( [%T%] )))<BR/>
del "Test_logs.txt"<BR/>
( %CL% %T%.vbs /set_input:2. 2&gt;&amp;1 ) &gt; %T%_log.txt<BR/>
fc "%T%_log.txt" "%T%_ans.txt"<BR/>
if errorlevel 1&nbsp; echo Fail in %T%.vbs&gt;&gt; T_ALL_result.txt&amp;goto :last_of_test</DIV>
<v:rect style="position:absolute; margin-left:50px; margin-top:3384px; width:466px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text23_53" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:58px; margin-top:3390px; line-height:15px; white-space:nowrap">
findstr /C:"+ 1) T_TestSet" "%T%_log.txt"<BR/>
if errorlevel 1&nbsp; echo Fail in %T%.vbs&gt;&gt; T_ALL_result.txt&amp;goto :last_of_test</DIV>
<DIV id="text23_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:3195px; line-height:15px; white-space:nowrap">
出力内容をすべて比較する。</DIV>
<DIV id="text23_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:3364px; line-height:15px; white-space:nowrap">
出力内容の一部を比較する。</DIV>
<DIV id="text23_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:97px; margin-top:3433px; line-height:15px; white-space:nowrap">
<A href="dos_batch_05.html#findstr">
→ findstr</A></DIV>
<DIV id="text23_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:58px; margin-top:3433px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text23_58" style="position:absolute; font-family: 'メイリオ'; font-size:10pt; color:#000000; margin-left:96px; margin-top:2294px; line-height:15px; white-space:nowrap">
FCVbs テストツール フォルダ</DIV>

<v:line from="0,2137" to="569,2137"/>
<v:line from="569,2137" to="569,4244"/>
<v:line from="569,4244" to="0,4244"/>
<v:line from="0,4244" to="0,2137"/>

</PAGE>
 
<!-- page 24 --> 
<PAGE>
<A id="svgcats_vml_p24" class="to_tree" style="margin-top:4249px;" onClick="selectTreeElem( '24' );">←</A>
<A href="#svgcats_vml_p25" class="to_next_page" style="margin-top:4249px;">▼</A>
<A href="#svgcats_vml_p23" class="to_prev_page" style="margin-top:4249px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4260px; width:582px; height:879px;" fillcolor="white"/>
<DIV id="text24_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4277px; line-height:15px; white-space:nowrap">
<A name="abs_path_chk">
出力結果に絶対パスがあるとき</A></DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:4356px; width:232px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text24_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:4362px; line-height:15px; white-space:nowrap">
エラー in C:\folderA\folderB\out.txt</DIV>
<DIV id="text24_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:28px; margin-top:4310px; line-height:15px; white-space:nowrap">
C:\folderA がソースをインストールした任意のフォルダで、次のような出力結果が正しいとき、</DIV>
<DIV id="text24_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:4336px; line-height:15px; white-space:nowrap">
out_ans.txt</DIV>
<DIV id="text24_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:28px; margin-top:4469px; line-height:15px; white-space:nowrap">
そこで、out_ans.txt をバッチファイルで作成することで、インストールした状態が変わっても<BR/>
自動的に判定することができるようになります。</DIV>
<DIV id="text24_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:28px; margin-top:4412px; line-height:15px; white-space:nowrap">
C:\folderA の部分は、インストールした状態によって変わってしまいます。<BR/>
つまり、単純なファイルの比較で、出力結果が正しいかどうかを自動的に判定することが<BR/>
できません。</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:4537px; width:280px; height:175px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text24_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:4543px; line-height:15px; white-space:nowrap">
pushd ..\..<BR/>
set base=%cd%<BR/>
popd<BR/>
<BR/>
set out=out_ans.txt<BR/>
if exist %out% del %out%<BR/>
echo エラー in %base%\folderB\out.txt&gt;&gt;%out%<BR/>
echo.&gt;&gt;%out%<BR/>
<BR/>
set out=<BR/>
set base=</DIV>
<DIV id="text24_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:4517px; line-height:15px; white-space:nowrap">
T_ALL_4_setup.bat</DIV>
<DIV id="text24_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:350px; margin-top:4632px; line-height:15px; white-space:nowrap">
←ここを修正する</DIV>
<DIV id="text24_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:350px; margin-top:4557px; line-height:15px; white-space:nowrap">
←ここで絶対パスを得る</DIV>
<DIV id="text24_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:14px; margin-top:4908px; line-height:15px; white-space:nowrap">
絶対パスをすべて大文字にするとき</DIV>
<DIV id="text24_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:28px; margin-top:4937px; line-height:15px; white-space:nowrap">
ツールによっては出力結果を勝手に大文字だけにするものがある。<BR/>
これに対処するには、次のようにして、大文字だけが入った base_i 環境変数を使う。</DIV>
<v:rect style="position:absolute; margin-left:53px; margin-top:4999px; width:454px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text24_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:61px; margin-top:5005px; line-height:15px; white-space:nowrap">
cscript //nologo set_base_i.vbs &gt; _set.bat &amp; call _set.bat &amp; del _set.bat<BR/>
echo %base_i%\FILE.TXT</DIV>
<DIV id="text24_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:51px; margin-top:4977px; line-height:15px; white-space:nowrap">
T_ALL_4_setup.bat</DIV>
<v:rect style="position:absolute; margin-left:53px; margin-top:5069px; width:370px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text24_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:61px; margin-top:5075px; line-height:15px; white-space:nowrap">
Set&nbsp; g_sh = WScript.CreateObject("WScript.Shell")<BR/>
WScript.Echo&nbsp; "Set base_i="+ UCase( g_sh.CurrentDirectory )</DIV>
<DIV id="text24_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:51px; margin-top:5050px; line-height:15px; white-space:nowrap">
set_base_i.vbs</DIV>
<DIV id="text24_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:4733px; line-height:15px; white-space:nowrap">
Test.vbs</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:4752px; width:424px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text24_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:4758px; line-height:15px; white-space:nowrap">
Sub&nbsp; test_setup( tests )<BR/>
&nbsp; Dim&nbsp; base : base = g_sh.GetAbstructPathName( "..\.." )<BR/>
&nbsp; Dim&nbsp; f : Set f = g_fs.CreateTextFile( "out_ans.txt", True, False )<BR/>
&nbsp; f.WriteLine&nbsp; "エラー in " + base + "\folderB\out.txt"<BR/>
&nbsp; f.WriteLine&nbsp; ""<BR/>
&nbsp; Pass<BR/>
End Sub</DIV>
<DIV id="text24_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:56px; margin-top:4633px; line-height:15px; white-space:nowrap">
echo エラー in %base%\folderB\out.txt<BR/>
echo.</DIV>
<DIV id="text24_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:104px; margin-top:4604px; line-height:13px; white-space:nowrap">
out_ans.txt</DIV>
<DIV id="text24_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:92px; margin-top:4544px; line-height:13px; white-space:nowrap">
..\..</DIV>
<DIV id="text24_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:302px; margin-top:4789px; line-height:13px; white-space:nowrap">
out_ans.txt</DIV>
<DIV id="text24_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:146px; margin-top:4804px; line-height:13px; white-space:nowrap">
"エラー in " + base + "\folderB\out.txt"</DIV>
<DIV id="text24_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:344px; margin-top:4774px; line-height:13px; white-space:nowrap">
..\..</DIV>

<v:line from="0,4260" to="582,4260"/>
<v:line from="582,4260" to="582,5139"/>
<v:line from="582,5139" to="0,5139"/>
<v:line from="0,5139" to="0,4260"/>

</PAGE>
 
<!-- page 25 --> 
<PAGE>
<A id="svgcats_vml_p25" class="to_tree" style="margin-top:5144px;" onClick="selectTreeElem( '25' );">←</A>
<A href="#svgcats_vml_p26" class="to_next_page" style="margin-top:5144px;">▼</A>
<A href="#svgcats_vml_p24" class="to_prev_page" style="margin-top:5144px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5155px; width:579px; height:782px;" fillcolor="white"/>
<v:image src="25/image01.png"
   style="position:absolute; margin-left:50px; margin-top:5540px; width:18px; height:15px;"/>
<v:image src="25/image02.png"
   style="position:absolute; margin-left:95px; margin-top:5703px; width:18px; height:15px;"/>
<v:image src="25/image03.png"
   style="position:absolute; margin-left:95px; margin-top:5721px; width:18px; height:15px;"/>
<v:image src="25/image04.png"
   style="position:absolute; margin-left:71px; margin-top:5562px; width:18px; height:15px;"/>
<v:image src="25/image05.png"
   style="position:absolute; margin-left:94px; margin-top:5601px; width:18px; height:15px;"/>
<v:image src="25/image06.png"
   style="position:absolute; margin-left:94px; margin-top:5619px; width:18px; height:15px;"/>
<v:image src="25/image07.png"
   style="position:absolute; margin-left:94px; margin-top:5638px; width:17px; height:15px;"/>
<v:image src="25/image08.png"
   style="position:absolute; margin-left:94px; margin-top:5657px; width:17px; height:15px;"/>
<v:image src="25/image09.png"
   style="position:absolute; margin-left:71px; margin-top:5683px; width:18px; height:15px;"/>
<v:image src="25/image10.png"
   style="position:absolute; margin-left:94px; margin-top:5583px; width:18px; height:15px;"/>
<DIV id="text25_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5172px; line-height:15px; white-space:nowrap">
<A name="ver_pack">
バージョン別パッケージ (ver_pack)</A></DIV>
<DIV id="text25_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:5213px; line-height:15px; white-space:nowrap">
内部用と公開用、外部依存モジュールあり/なし、ソースパッケージとバイナリパッケージ、<BR/>
のようにファイルの構成が大きく異なるときは、１つのフルパッケージから、それぞれの<BR/>
パッケージを自動的に作成できるようにするとよいでしょう。</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:5331px; width:316px; height:145px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text25_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:5337px; line-height:15px; white-space:nowrap">
REM --- package name ---<BR/>
set p=ModuleA<BR/>
call :rmdir&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %p%<BR/>
<BR/>
REM --- copy folder ---<BR/>
call :copy&nbsp; &nbsp;..\Modules_src\ModuleA&nbsp; &nbsp; %p%\ModuleA<BR/>
&nbsp;if %r%==1 goto :eof<BR/>
call :copy&nbsp; &nbsp;..\Modules_src\ModuleB&nbsp; &nbsp; %p%\ModuleB<BR/>
&nbsp;if %r%==1 goto :eof</DIV>
<DIV id="text25_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:73px; margin-top:5540px; line-height:15px; white-space:nowrap">
modules_src</DIV>
<DIV id="text25_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:116px; margin-top:5703px; line-height:15px; white-space:nowrap">
ModuleA</DIV>
<DIV id="text25_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:116px; margin-top:5721px; line-height:15px; white-space:nowrap">
ModuleB</DIV>
<DIV id="text25_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:92px; margin-top:5562px; line-height:15px; white-space:nowrap">
_pack</DIV>
<DIV id="text25_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:116px; margin-top:5602px; line-height:15px; white-space:nowrap">
ModuleA_src</DIV>
<DIV id="text25_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:116px; margin-top:5620px; line-height:15px; white-space:nowrap">
Modules_src</DIV>
<DIV id="text25_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:27px; margin-top:5513px; line-height:15px; white-space:nowrap">
サンプル・パッケージの構成例</DIV>
<DIV id="text25_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:116px; margin-top:5638px; line-height:15px; white-space:nowrap">
ModuleA_make.bat</DIV>
<DIV id="text25_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:116px; margin-top:5657px; line-height:15px; white-space:nowrap">
Modules_make.bat</DIV>
<DIV id="text25_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:5540px; line-height:15px; white-space:nowrap">
フルパッケージ</DIV>
<DIV id="text25_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:247px; margin-top:5602px; line-height:15px; white-space:nowrap">
ModuleA のみのパッケージ</DIV>
<DIV id="text25_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:247px; margin-top:5620px; line-height:15px; white-space:nowrap">
ModuleA と ModuleB を組み合わせたパッケージ</DIV>
<DIV id="text25_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:247px; margin-top:5638px; line-height:15px; white-space:nowrap">
ModuleA_src フォルダを作成するバッチファイル</DIV>
<DIV id="text25_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:247px; margin-top:5656px; line-height:15px; white-space:nowrap">
Modules_src フォルダを作成するバッチファイル</DIV>
<DIV id="text25_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5784px; line-height:15px; white-space:nowrap">
<A name="pack_min">
最小限のパッケージに必要なもの</A></DIV>
<DIV id="text25_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:5845px; line-height:15px; white-space:nowrap">
・ライブラリのソース、またはバイナリ<BR/>
・ライブラリを使うアプリのサンプル</DIV>
<DIV id="text25_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:408px; margin-top:5602px; line-height:15px; white-space:nowrap">
<A href="#pack_min">
→ 最小限のパッケージ</A></DIV>
<DIV id="text25_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:5817px; line-height:15px; white-space:nowrap">
コンパイルエラーとリンクエラーをチェックするために、最低限下記のものが必要です。</DIV>
<DIV id="text25_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:5889px; line-height:15px; white-space:nowrap">
この構成で、動作確認を行います。</DIV>
<DIV id="text25_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:5278px; line-height:15px; white-space:nowrap">
rmdir, copy サブルーチンを使ったサンプル：</DIV>
<DIV id="text25_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:5311px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<DIV id="text25_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:291px; margin-top:5278px; line-height:15px; white-space:nowrap">
→ ver_pack.lzh</DIV>
<DIV id="text25_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:94px; margin-top:5683px; line-height:15px; white-space:nowrap">
Modules_src</DIV>
<DIV id="text25_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:201px; margin-top:5683px; line-height:15px; white-space:nowrap">
マスターファイル（コピー元）</DIV>
<DIV id="text25_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:116px; margin-top:5584px; line-height:15px; white-space:nowrap">
ModuleA_patch</DIV>
<DIV id="text25_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:247px; margin-top:5584px; line-height:15px; white-space:nowrap">
ModuleA をコピーした後に上書き修正するファイル</DIV>

<v:line from="0,5155" to="579,5155"/>
<v:line from="579,5155" to="579,5937"/>
<v:line from="579,5937" to="0,5937"/>
<v:line from="0,5937" to="0,5155"/>

</PAGE>
 
<!-- page 26 --> 
<PAGE>
<A id="svgcats_vml_p26" class="to_tree" style="margin-top:5942px;" onClick="selectTreeElem( '26' );">←</A>
<A href="#svgcats_vml_p27" class="to_next_page" style="margin-top:5942px;">▼</A>
<A href="#svgcats_vml_p25" class="to_prev_page" style="margin-top:5942px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5953px; width:558px; height:678px;" fillcolor="white"/>
<DIV id="text26_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5970px; line-height:15px; white-space:nowrap">
<A name="copy_sync">
コピーファイル同期</A></DIV>
<v:rect style="position:absolute; margin-left:32px; margin-top:6096px; width:328px; height:400px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text26_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:40px; margin-top:6102px; line-height:15px; white-space:nowrap">
@echo off<BR/>
if "%~1"=="" cmd /K %0 /wnd %1 %2 %3 %4<BR/>
shift<BR/>
<BR/>
pushd ..<BR/>
REM&nbsp; base folder is vbslib_new<BR/>
echo base folder is %cd%<BR/>
echo OK?<BR/>
pause<BR/>
&nbsp; &nbsp; &nbsp; <BR/>
set src_name=vbs_inc.vbs<BR/>
set src=TestByFCBat\vbs_inc\vbslib\%src_name%<BR/>
for /R %%i in (%src_name%) do (<BR/>
&nbsp; if exist "%%i" if not "%cd%\%src%"=="%%i" (<BR/>
&nbsp; &nbsp; fc /A "%src%" "%%i"<BR/>
&nbsp; &nbsp; if errorlevel 1 explorer /select, "%%i"&amp;goto fin<BR/>
&nbsp; )<BR/>
)<BR/>
<BR/>
:fin<BR/>
echo.<BR/>
echo done in %cd%<BR/>
echo.<BR/>
popd<BR/>
set src_name=<BR/>
set src=</DIV>
<DIV id="text26_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:24px; margin-top:6075px; line-height:15px; white-space:nowrap">
比較＆選択</DIV>
<v:rect style="position:absolute; margin-left:32px; margin-top:6559px; width:172px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text26_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:40px; margin-top:6565px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; echo %%i<BR/>
&nbsp; &nbsp; xcopy /D "%src%" "%%i"</DIV>
<DIV id="text26_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:24px; margin-top:6518px; line-height:15px; white-space:nowrap">
コピー</DIV>
<DIV id="text26_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:6539px; line-height:15px; white-space:nowrap">
fc の行を変えます</DIV>
<DIV id="text26_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:378px; margin-top:6250px; line-height:15px; white-space:nowrap">
src_name と src を、<BR/>
マスターファイルの<BR/>
パスにします</DIV>
<DIV id="text26_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6003px; line-height:15px; white-space:nowrap">
複数のフォルダにある同じ名前のファイルの内容を同じにします。<BR/>
<BR/>
内容が異なると、マスターではない方のファイルを自動的に選択します。</DIV>

<v:line from="0,5953" to="558,5953"/>
<v:line from="558,5953" to="558,6631"/>
<v:line from="558,6631" to="0,6631"/>
<v:line from="0,6631" to="0,5953"/>

</PAGE>
 
<!-- page 27 --> 
<PAGE>
<A id="svgcats_vml_p27" class="to_tree" style="margin-top:6636px;" onClick="selectTreeElem( '27' );">←</A>
<A href="#svgcats_vml_p28" class="to_next_page" style="margin-top:6636px;">▼</A>
<A href="#svgcats_vml_p26" class="to_prev_page" style="margin-top:6636px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6647px; width:582px; height:1302px;" fillcolor="white"/>
<v:image src="27/image01.png"
   style="position:absolute; margin-left:107px; margin-top:7471px; width:18px; height:14px;"/>
<v:image src="27/image02.png"
   style="position:absolute; margin-left:108px; margin-top:7381px; width:18px; height:14px;"/>
<v:image src="27/image03.png"
   style="position:absolute; margin-left:36px; margin-top:7277px; width:18px; height:15px;"/>
<v:image src="27/image04.png"
   style="position:absolute; margin-left:57px; margin-top:7298px; width:18px; height:15px;"/>
<v:image src="27/image05.png"
   style="position:absolute; margin-left:57px; margin-top:7338px; width:18px; height:15px;"/>
<v:image src="27/image06.png"
   style="position:absolute; margin-left:78px; margin-top:7359px; width:18px; height:15px;"/>
<v:image src="27/image07.png"
   style="position:absolute; margin-left:78px; margin-top:7452px; width:18px; height:15px;"/>
<v:image src="27/image08.png"
   style="position:absolute; margin-left:108px; margin-top:7398px; width:18px; height:14px;"/>
<v:image src="27/image09.png"
   style="position:absolute; margin-left:108px; margin-top:7415px; width:18px; height:14px;"/>
<v:image src="27/image10.png"
   style="position:absolute; margin-left:108px; margin-top:7432px; width:18px; height:14px;"/>
<v:image src="27/image11.png"
   style="position:absolute; margin-left:82px; margin-top:7318px; width:18px; height:14px;"/>
<v:image src="27/image12.png"
   style="position:absolute; margin-left:49px; margin-top:7531px; width:18px; height:14px;"/>
<v:image src="27/image13.png"
   style="position:absolute; margin-left:75px; margin-top:7551px; width:18px; height:14px;"/>
<v:image src="27/image14.png"
   style="position:absolute; margin-left:75px; margin-top:7567px; width:18px; height:14px;"/>
<v:image src="27/image15.png"
   style="position:absolute; margin-left:104px; margin-top:7584px; width:18px; height:14px;"/>
<v:image src="27/image16.png"
   style="position:absolute; margin-left:137px; margin-top:7603px; width:18px; height:14px;"/>
<DIV id="text27_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6664px; line-height:15px; white-space:nowrap">
<A name="proj_templ">
プロジェクト・テンプレート (auto.bat)</A></DIV>
<DIV id="text27_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:132px; margin-top:7468px; line-height:15px; white-space:nowrap">
do.bat</DIV>
<DIV id="text27_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:60px; margin-top:7277px; line-height:15px; white-space:nowrap">
project_template</DIV>
<DIV id="text27_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:7298px; line-height:15px; white-space:nowrap">
src</DIV>
<DIV id="text27_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:7338px; line-height:15px; white-space:nowrap">
test</DIV>
<DIV id="text27_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:99px; margin-top:7359px; line-height:15px; white-space:nowrap">
alltest</DIV>
<DIV id="text27_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:99px; margin-top:7452px; line-height:15px; white-space:nowrap">
test1</DIV>
<DIV id="text27_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:132px; margin-top:7381px; line-height:15px; white-space:nowrap">
alltest.bat</DIV>
<DIV id="text27_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:132px; margin-top:7398px; line-height:15px; white-space:nowrap">
call_do.bat</DIV>
<DIV id="text27_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:132px; margin-top:7415px; line-height:15px; white-space:nowrap">
do_each.bat</DIV>
<DIV id="text27_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:132px; margin-top:7432px; line-height:15px; white-space:nowrap">
setting.bat</DIV>
<DIV id="text27_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7381px; line-height:15px; white-space:nowrap">
(a) メイン・バッチ</DIV>
<DIV id="text27_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7398px; line-height:15px; white-space:nowrap">
(d) 内部用（コール・バッチ）</DIV>
<DIV id="text27_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7415px; line-height:15px; white-space:nowrap">
(c) フォルダ一覧 （要修正）</DIV>
<DIV id="text27_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7432px; line-height:15px; white-space:nowrap">
(b) 環境変数設定 （要修正）</DIV>
<DIV id="text27_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:107px; margin-top:7315px; line-height:15px; white-space:nowrap">
do.bat</DIV>
<DIV id="text27_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7468px; line-height:15px; white-space:nowrap">
(e) クリーン、ビルド、テストなどを実行 （要修正）</DIV>
<DIV id="text27_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7315px; line-height:15px; white-space:nowrap">
(e) クリーン、ビルド、テストなどを実行 （要修正）</DIV>
<DIV id="text27_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7246px; line-height:15px; white-space:nowrap">
<A name="projtmp_files">
ファイル構成</A></DIV>
<DIV id="text27_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7502px; line-height:15px; white-space:nowrap">
<A name="projtmp_calltree">
コールツリー</A></DIV>
<DIV id="text27_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:73px; margin-top:7531px; line-height:15px; white-space:nowrap">
alltest.bat</DIV>
<DIV id="text27_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:99px; margin-top:7551px; line-height:15px; white-space:nowrap">
setting.bat</DIV>
<DIV id="text27_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:99px; margin-top:7567px; line-height:15px; white-space:nowrap">
do_each.bat</DIV>
<DIV id="text27_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:128px; margin-top:7584px; line-height:15px; white-space:nowrap">
call_do.bat</DIV>
<DIV id="text27_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:7600px; line-height:15px; white-space:nowrap">
do.bat</DIV>
<DIV id="text27_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7531px; line-height:15px; white-space:nowrap">
(a) メイン・バッチ</DIV>
<DIV id="text27_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7551px; line-height:15px; white-space:nowrap">
(b) 環境変数設定 （要修正）</DIV>
<DIV id="text27_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7567px; line-height:15px; white-space:nowrap">
(c) フォルダ一覧 （要修正）</DIV>
<DIV id="text27_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7584px; line-height:15px; white-space:nowrap">
(d) 内部用（コール・バッチ）</DIV>
<DIV id="text27_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:7600px; line-height:15px; white-space:nowrap">
(e) クリーン、ビルド、テストなどを実行 （要修正）</DIV>
<DIV id="text27_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6818px; line-height:15px; white-space:nowrap">
<A name="projtmp_use">
使い方</A></DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:6882px; width:46px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text27_48" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:6889px; line-height:13px; white-space:nowrap">
&gt;auto</DIV>
<DIV id="text27_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:172px; margin-top:6887px; line-height:15px; white-space:nowrap">
全フォルダのクリーン→リビルド→テストを実行します。</DIV>
<DIV id="text27_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:6954px; line-height:15px; white-space:nowrap">
バッチファイルを起動するときは、カレントディレクトリに起動するバッチファイルが<BR/>
ある状態で行ってください。</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:7169px; width:34px; height:17px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text27_51" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:7172px; line-height:13px; white-space:nowrap">
all</DIV>
<DIV id="text27_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:134px; margin-top:7046px; line-height:15px; white-space:nowrap">
デフォルトの実行を表示して確認してから実行します。</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:6913px; width:70px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text27_53" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:6920px; line-height:13px; white-space:nowrap">
&gt;do build</DIV>
<DIV id="text27_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:172px; margin-top:6918px; line-height:15px; white-space:nowrap">
１つのフォルダのリビルドを行います。</DIV>
<DIV id="text27_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:7010px; line-height:15px; white-space:nowrap">
auto.bat と do.bat のパラメータに指定できるのは、次のとおりです。</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:7045px; width:52px; height:17px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text27_56" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:7048px; line-height:13px; white-space:nowrap">
(なし)</DIV>
<DIV id="text27_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:134px; margin-top:7172px; line-height:15px; white-space:nowrap">
全フォルダのクリーン→ビルド→テスト→クリーンを実行します。</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:7076px; width:46px; height:17px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text27_58" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:7079px; line-height:13px; white-space:nowrap">
build</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:7107px; width:40px; height:17px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text27_59" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:7110px; line-height:13px; white-space:nowrap">
test</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:7138px; width:46px; height:17px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text27_60" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:7141px; line-height:13px; white-space:nowrap">
clean</DIV>
<DIV id="text27_61" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:134px; margin-top:7077px; line-height:15px; white-space:nowrap">
リビルドを実行します。</DIV>
<DIV id="text27_62" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:134px; margin-top:7108px; line-height:15px; white-space:nowrap">
テストを実行します。</DIV>
<DIV id="text27_63" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:134px; margin-top:7139px; line-height:15px; white-space:nowrap">
クリーンを実行します。</DIV>
<DIV id="text27_64" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:6852px; line-height:15px; white-space:nowrap">
全フォルダ(alltest.bat)、または１つのフォルダ(do.bat)に対して、ビルドやテストなどを行います。</DIV>
<DIV id="text27_65" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:55px; margin-top:6768px; line-height:15px; white-space:nowrap">
<A href="#projtmp_use">
→ 使い方</A></DIV>
<DIV id="text27_66" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:6742px; line-height:15px; white-space:nowrap">
テンプレート</DIV>
<DIV id="text27_67" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:144px; margin-top:6768px; line-height:15px; white-space:nowrap">
<A href="#projtmp_files">
→ ファイル構成</A></DIV>
<DIV id="text27_68" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:265px; margin-top:6768px; line-height:15px; white-space:nowrap">
<A href="#projtmp_calltree">
→ コールツリー</A></DIV>
<DIV id="text27_69" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:23px; margin-top:7654px; line-height:15px; white-space:nowrap">
<A name="projtmp_do">
処理内容テンプレート</A></DIV>
<DIV id="text27_70" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:385px; margin-top:6768px; line-height:15px; white-space:nowrap">
<A href="#projtmp_do">
→ 処理内容テンプレート</A></DIV>
<v:rect style="position:absolute; margin-left:59px; margin-top:7770px; width:466px; height:145px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text27_71" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:67px; margin-top:7776px; line-height:15px; white-space:nowrap">
if exist Build.dat&nbsp; del Build.dat<BR/>
if exist Build.wrn&nbsp; del Build.wrn<BR/>
if exist Build.err&nbsp; del Build.err<BR/>
if exist Build.log&nbsp; del Build.log<BR/>
<BR/>
set rmdir_path=obj<BR/>
if exist %rmdir_path%&nbsp; rmdir /S /Q %rmdir_path%<BR/>
if exist %rmdir_path%&nbsp; echo cannot delete %rmdir_path% &amp; set r=1&amp; goto :eof<BR/>
set rmdir_path=</DIV>
<DIV id="text27_72" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:7693px; line-height:15px; white-space:nowrap">
→ clean</DIV>
<DIV id="text27_73" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:7748px; line-height:15px; white-space:nowrap">
PB delete</DIV>
<DIV id="text27_74" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:7717px; line-height:15px; white-space:nowrap">
→ コマンドライン・コンパイル(VS2005)</DIV>
<DIV id="text27_75" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:155px; margin-top:6742px; line-height:15px; white-space:nowrap">
→ batchlib.lzh</DIV>
<DIV id="text27_76" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:265px; margin-top:6742px; line-height:15px; white-space:nowrap">
→ vbslib.lzh</DIV>
<DIV id="text27_77" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:37px; margin-top:6701px; line-height:15px; white-space:nowrap">
vbslib 製テスト・プロンプトをお使いください。</DIV>

<v:line from="0,6647" to="582,6647"/>
<v:line from="582,6647" to="582,7949"/>
<v:line from="582,7949" to="0,7949"/>
<v:line from="0,7949" to="0,6647"/>

</PAGE>
 
<!-- page 28 --> 
<PAGE>
<A id="svgcats_vml_p28" class="to_tree" style="margin-top:7954px;" onClick="selectTreeElem( '28' );">←</A>
<A href="#svgcats_vml_p29" class="to_next_page" style="margin-top:7954px;">▼</A>
<A href="#svgcats_vml_p27" class="to_prev_page" style="margin-top:7954px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7965px; width:577px; height:419px;" fillcolor="white"/>
<DIV id="text28_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7982px; line-height:15px; white-space:nowrap">
<A name="folder_reset">
テスト用フォルダをリセット（削除＆コピー）</A></DIV>
<v:rect style="position:absolute; margin-left:55px; margin-top:8162px; width:238px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text28_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:63px; margin-top:8168px; line-height:15px; white-space:nowrap">
echo ----- reset test folder -----<BR/>
if exist test_do&nbsp; rmdir /S /Q test_do<BR/>
mkdir test_do<BR/>
xcopy /E /Y original test_do<BR/>
echo cd .. &amp; a.bat &gt; a.bat</DIV>
<v:shape style="position:absolute; margin-left:56px; margin-top:8061px; width:109px; height:16px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt">
<v:path v="m 36,0 l 1035,0, 963,999, -36,999 x e"/>
</v:shape>
<DIV id="text28_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:8062px; line-height:15px; white-space:nowrap">
original フォルダ</DIV>
<DIV id="text28_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:8139px; line-height:15px; white-space:nowrap">
テストを実行するバッチファイルの一部</DIV>
<DIV id="text28_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:196px; margin-top:8062px; line-height:15px; white-space:nowrap">
リセット状態のファイル構成が入ったフォルダ</DIV>
<v:shape style="position:absolute; margin-left:56px; margin-top:8088px; width:110px; height:16px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt">
<v:path v="m 36,0 l 1035,0, 963,999, -36,999 x e"/>
</v:shape>
<DIV id="text28_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:8089px; line-height:15px; white-space:nowrap">
test_do フォルダ</DIV>
<DIV id="text28_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:196px; margin-top:8089px; line-height:15px; white-space:nowrap">
リセットするテスト実施用フォルダ</DIV>
<DIV id="text28_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:8023px; line-height:15px; white-space:nowrap">
test_do フォルダを一度削除し、originai フォルダの内容と一致させます（リセットします）。</DIV>
<v:line style="position:absolute;" from="40,8076" to="40,8093" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="40,8093" to="44,8082" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="40,8093" to="36,8082" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text28_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:337px; margin-top:7984px; line-height:12px; white-space:nowrap">
<A href="#bat_test">
[ 親: バッチファイルを使ったテストの自動化 ]</A></DIV>
<DIV id="text28_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:8305px; line-height:15px; white-space:nowrap">
clean.bat</DIV>
<v:rect style="position:absolute; margin-left:55px; margin-top:8327px; width:388px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text28_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:63px; margin-top:8334px; line-height:13px; white-space:nowrap">
for /D /R %%i in (test_do) do if exist "%%i" rmdir /S /Q "%%i"</DIV>
<DIV id="text28_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:151px; margin-top:8305px; line-height:15px; white-space:nowrap">
テスト終了後に、すべての test_do フォルダを削除します</DIV>

<v:line from="0,7965" to="577,7965"/>
<v:line from="577,7965" to="577,8384"/>
<v:line from="577,8384" to="0,8384"/>
<v:line from="0,8384" to="0,7965"/>

</PAGE>
 
<!-- page 29 --> 
<PAGE>
<A id="svgcats_vml_p29" class="to_tree" style="margin-top:8389px;" onClick="selectTreeElem( '29' );">←</A>
<A href="#svgcats_vml_p30" class="to_next_page" style="margin-top:8389px;">▼</A>
<A href="#svgcats_vml_p28" class="to_prev_page" style="margin-top:8389px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8400px; width:728px; height:504px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:74px; margin-top:8612px; width:622px; height:205px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text29_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:82px; margin-top:8618px; line-height:15px; white-space:nowrap">
echo off<BR/>
echo ----- setup tools -----<BR/>
call ..\common\setting.bat<BR/>
if (%test_prog%)==() echo not set %%test_prog%% &amp; set r=1 &amp; if (%no_pause%)==() pause &amp; goto :eof<BR/>
if not exist %test_prog% echo not found %test_prog% &amp; set r=1 &amp; if (%no_pause%)==() pause &amp; goto :eof<BR/>
<BR/>
set&nbsp; case=test1<BR/>
echo ----- %case% -----<BR/>
%test_prog% %case%&nbsp; &gt; %case%_out.txt<BR/>
%feq% %case%_out.txt %case%_ans.txt<BR/>
if errorlevel 1&nbsp; echo NG &amp; set r=1 &amp; if (%no_pause%)==() pause &amp; goto :eof<BR/>
<BR/>
set r=0 &amp; echo Pass. if (%no_pause%)==() pause</DIV>
<v:rect style="position:absolute; margin-left:74px; margin-top:8532px; width:232px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text29_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:82px; margin-top:8538px; line-height:15px; white-space:nowrap">
REM ----- common setting ----- <BR/>
set test_prog="..\..\Debug\prog.exe"</DIV>
<DIV id="text29_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:32px; margin-top:8421px; line-height:15px; white-space:nowrap">
<A name="test_start">
テストプログラムの起動</A></DIV>
<DIV id="text29_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:51px; margin-top:8452px; line-height:15px; white-space:nowrap">
プログラムのパスは、デバッグ版とリリース版、また、Program Files に入っていたりして、<BR/>
変わることがよくあります。 そこで、各テストバッチファイルから、テストグループ共通の<BR/>
setting.bat を呼び出すようにします。</DIV>
<DIV id="text29_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:8511px; line-height:15px; white-space:nowrap">
setting.bat</DIV>
<DIV id="text29_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:8591px; line-height:15px; white-space:nowrap">
<A name="test_bat_samp">
a.bat （一般的なテストバッチのサンプル）</A></DIV>
<DIV id="text29_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:254px; margin-top:8422px; line-height:12px; white-space:nowrap">
<A href="#bat_test">
[ 親: バッチファイルを使ったテストの自動化 ]</A></DIV>
<DIV id="text29_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:76px; margin-top:8831px; line-height:15px; white-space:nowrap">
clean.bat</DIV>
<v:rect style="position:absolute; margin-left:74px; margin-top:8849px; width:88px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text29_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:82px; margin-top:8856px; line-height:13px; white-space:nowrap">
del out1.txt</DIV>

<v:line from="0,8400" to="728,8400"/>
<v:line from="728,8400" to="728,8904"/>
<v:line from="728,8904" to="0,8904"/>
<v:line from="0,8904" to="0,8400"/>

</PAGE>
 
<!-- page 30 --> 
<PAGE>
<A id="svgcats_vml_p30" class="to_tree" style="margin-top:8909px;" onClick="selectTreeElem( '30' );">←</A>
<A href="#svgcats_vml_p31" class="to_next_page" style="margin-top:8909px;">▼</A>
<A href="#svgcats_vml_p29" class="to_prev_page" style="margin-top:8909px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8920px; width:533px; height:275px;" fillcolor="white"/>
<DIV id="text30_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8937px; line-height:15px; white-space:nowrap">
<A name="notepad">
notepad</A></DIV>
<DIV id="text30_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8977px; line-height:15px; white-space:nowrap">
notepad.exe は、結果の表示に使うことができます。</DIV>
<v:rect style="position:absolute; margin-left:43px; margin-top:9055px; width:310px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text30_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:51px; margin-top:9061px; line-height:15px; white-space:nowrap">
if "%notepad%"=="" start "" notepad log.txt<BR/>
if not "%notepad%"=="" start "" %notepad% log.txt</DIV>
<DIV id="text30_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:9010px; line-height:15px; white-space:nowrap">
下記のバッチファイルは、notepad 環境変数が設定してあったら、別のプログラムで<BR/>
log.txt を表示します。</DIV>
<DIV id="text30_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:26px; margin-top:9116px; line-height:15px; white-space:nowrap">
me 設定</DIV>
<v:rect style="position:absolute; margin-left:43px; margin-top:9138px; width:280px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text30_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:51px; margin-top:9145px; line-height:13px; white-space:nowrap">
set notepad="C:\Program Files\sted\sted.exe"</DIV>

<v:line from="0,8920" to="533,8920"/>
<v:line from="533,8920" to="533,9195"/>
<v:line from="533,9195" to="0,9195"/>
<v:line from="0,9195" to="0,8920"/>

</PAGE>
 
<!-- page 31 --> 
<PAGE>
<A id="svgcats_vml_p31" class="to_tree" style="margin-top:9200px;" onClick="selectTreeElem( '31' );">←</A>
<A href="#svgcats_vml_p32" class="to_next_page" style="margin-top:9200px;">▼</A>
<A href="#svgcats_vml_p30" class="to_prev_page" style="margin-top:9200px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9211px; width:558px; height:321px;" fillcolor="white"/>
<DIV id="text31_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9230px; line-height:15px; white-space:nowrap">
<A name="all_test">
全テスト実行バッチ</A></DIV>
<DIV id="text31_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:9328px; line-height:15px; white-space:nowrap">
all_test.bat</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:9349px; width:280px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text31_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:9355px; line-height:15px; white-space:nowrap">
echo off<BR/>
<BR/>
pushd test1<BR/>
call test1.bat<BR/>
popd<BR/>
if not %r%==0&nbsp; echo NG &amp; set r=1 &amp; goto :eof<BR/>
<BR/>
set r=0 &amp; echo Pass.<BR/>
:eof2<BR/>
if "%1"==""&nbsp; pause</DIV>
<DIV id="text31_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9267px; line-height:15px; white-space:nowrap">
各テストのバッチファイルを呼び出し、テスト結果が入った環境変数をチェックします。<BR/>
最後に表示される Pass か NG で全テストの結果を判定をします。 <BR/>
set errorlevel しても if errorlevel で判定できません。</DIV>
<DIV id="text31_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:267px; margin-top:9235px; line-height:12px; white-space:nowrap">
<A href="#bat_test">
[ 親: バッチファイルを使ったテストの自動化 ]</A></DIV>

<v:line from="0,9211" to="558,9211"/>
<v:line from="558,9211" to="558,9532"/>
<v:line from="558,9532" to="0,9532"/>
<v:line from="0,9532" to="0,9211"/>

</PAGE>
 
<!-- page 32 --> 
<PAGE>
<A id="svgcats_vml_p32" class="to_tree" style="margin-top:9537px;" onClick="selectTreeElem( '32' );">←</A>
<A href="dos_batch_03.html#svgcats_vml_p33" class="to_next_page" style="margin-top:9537px;">▼</A>
<A href="#svgcats_vml_p31" class="to_prev_page" style="margin-top:9537px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9548px; width:596px; height:1078px;" fillcolor="white"/>
<DIV id="text32_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:10188px; line-height:15px; white-space:nowrap">
.exe 形式の main 関数の返り値は、エラーレベルに格納されます。</DIV>
<v:rect style="position:absolute; margin-left:64px; margin-top:10255px; width:292px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text32_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:72px; margin-top:10262px; line-height:13px; white-space:nowrap">
if errorlevel 1&nbsp; echo NG &amp; set r=1 &amp; goto :eof</DIV>
<DIV id="text32_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:395px; margin-top:10260px; line-height:15px; white-space:nowrap">
1以上ならNG</DIV>
<DIV id="text32_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:22px; margin-top:9561px; line-height:15px; white-space:nowrap">
<A name="test_err">
エラー処理、プログラムの返り値のチェック （</A></DIV>
<v:rect style="position:absolute; margin-left:64px; margin-top:10285px; width:316px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text32_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:72px; margin-top:10292px; line-height:13px; white-space:nowrap">
if not errorlevel 1&nbsp; echo NG &amp; set r=1 &amp; goto :eof</DIV>
<DIV id="text32_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:395px; margin-top:10290px; line-height:15px; white-space:nowrap">
0 なら NG</DIV>
<DIV id="text32_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:10207px; line-height:15px; white-space:nowrap">
echo %errorlevel% でエラーレベルの値が分かります。</DIV>
<DIV id="text32_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:363px; margin-top:9561px; line-height:15px; white-space:nowrap">
errorlevel</DIV>
<DIV id="text32_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:425px; margin-top:9561px; line-height:15px; white-space:nowrap">
）</DIV>
<DIV id="text32_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:351px; margin-top:9561px; line-height:15px; white-space:nowrap">
、</DIV>
<DIV id="text32_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:275px; margin-top:9561px; line-height:15px; white-space:nowrap">
エラーレベル</DIV>
<DIV id="text32_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:10317px; line-height:15px; white-space:nowrap">
環境変数 r に代入していますが、これは、後述する全テスト実行バッチのためです。</DIV>
<v:rect style="position:absolute; margin-left:64px; margin-top:10380px; width:136px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text32_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:72px; margin-top:10386px; line-height:15px; white-space:nowrap">
set r=0 &amp; echo Pass.<BR/>
:eof2<BR/>
if "%1"==""&nbsp; pause</DIV>
<DIV id="text32_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:10357px; line-height:15px; white-space:nowrap">
NG が無く、バッチファイルの最後まで来たら、次のように Pass したことを明示します。</DIV>
<DIV id="text32_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:327px; margin-top:9576px; line-height:12px; white-space:nowrap">
<A href="#bat_test">
[ 親: バッチファイルを使ったテストの自動化 ]</A></DIV>
<DIV id="text32_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:10448px; line-height:15px; white-space:nowrap">
<A href="#test_bat_samp">
→ 一般的なテストバッチのサンプル</A></DIV>
<DIV id="text32_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:10448px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text32_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10095px; line-height:15px; white-space:nowrap">
<A name="errorlevel_statement">
errorlevel 構文を使う</A></DIV>
<DIV id="text32_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:9765px; line-height:15px; white-space:nowrap">
errorlevel 変数を使う</DIV>
<v:rect style="position:absolute; margin-left:40px; margin-top:9793px; width:388px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text32_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:48px; margin-top:9799px; line-height:15px; white-space:nowrap">
cscript sample.vbs<BR/>
if not "%errorlevel%"=="21" ( echo ERROR &amp; pause &amp; exit /b 1 )</DIV>
<DIV id="text32_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:196px; margin-top:9765px; line-height:15px; white-space:nowrap">
Windows2000以降？</DIV>
<v:rect style="position:absolute; margin-left:63px; margin-top:9984px; width:418px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text32_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:71px; margin-top:9990px; line-height:15px; white-space:nowrap">
cmd /v:on /c "prog1 &amp; echo exit /b !ERRORLEVEL! &gt; _tmp.bat" | prog2<BR/>
call _tmp.bat<BR/>
echo %ERRORLEVEL%</DIV>
<DIV id="text32_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:53px; margin-top:9967px; line-height:15px; white-space:nowrap">
パイプの前段のエラーレベルを知りたいとき</DIV>
<DIV id="text32_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:278px; margin-top:10042px; line-height:15px; white-space:nowrap">
<A href="http://d.hatena.ne.jp/otn/comment?date=20050214" target="_blank">
→ それはそれ。これはこれ。 (Web)</A></DIV>
<DIV id="text32_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10578px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text32_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:10578px; line-height:15px; white-space:nowrap">
→ 終了コード （Linux）</DIV>
<DIV id="text32_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10502px; line-height:15px; white-space:nowrap">
エラーレベルを設定する</DIV>
<DIV id="text32_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:10528px; line-height:15px; white-space:nowrap">
バッチ・ファイルから返すエラーレベルは設定できません。</DIV>
<DIV id="text32_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:63px; margin-top:9841px; line-height:15px; white-space:nowrap">
exit /b 1 で呼び出し元へ戻ります。 1 は %errorlevel% に設定する値です。<BR/>
exit&nbsp; 1 ですぐにバッチファイルを終了します。 1 は %errorlevel% に設定する値です。</DIV>
<DIV id="text32_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:63px; margin-top:9871px; line-height:15px; white-space:nowrap">
exit に引数を指定しなければ、%errorlevel% の値は変わりません。</DIV>
<DIV id="text32_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:65px; margin-top:9598px; line-height:15px; white-space:nowrap">
<A href="dos_batch_03.html#Error">
→ Error</A></DIV>
<DIV id="text32_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:128px; margin-top:9598px; line-height:15px; white-space:nowrap">
<A href="dos_batch_03.html#ClearError">
→ ClearError</A></DIV>
<DIV id="text32_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9642px; line-height:15px; white-space:nowrap">
<A name="ThroughError">
エラーをそのまま返す</A></DIV>
<v:rect style="position:absolute; margin-left:63px; margin-top:9672px; width:202px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text32_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:71px; margin-top:9678px; line-height:15px; white-space:nowrap">
call :T_Example<BR/>
&nbsp; &nbsp; if errorlevel 1 ( exit /b )</DIV>
<DIV id="text32_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:9722px; line-height:15px; white-space:nowrap">
呼び出し先でエラーが発生したら、すぐにそのエラーを呼び出し元に返します。</DIV>
<DIV id="text32_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9598px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text32_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#C05A00; margin-left:53px; margin-top:9912px; line-height:15px; white-space:nowrap">
if や for の ( ) の中で errorlevel 変数を参照しないでください。</DIV>
<DIV id="text32_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:375px; margin-top:9927px; line-height:15px; white-space:nowrap">
<A href="#errorlevel_statement">
errorlevel 構文を使ってください。</A></DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:10129px; width:202px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text32_39" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:10135px; line-height:15px; white-space:nowrap">
call :T_Example<BR/>
&nbsp; &nbsp; if errorlevel 1 ( exit /b )</DIV>
<DIV id="text32_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:53px; margin-top:9927px; line-height:15px; white-space:nowrap">
( ) の前の errorlevel 変数の値が参照されてしまいます。</DIV>
<DIV id="text32_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:10226px; line-height:15px; white-space:nowrap">
if や for の ( ) の中でも、直前の呼び出しによって設定された errorlevel をチェックします。</DIV>

<v:line from="0,9548" to="596,9548"/>
<v:line from="596,9548" to="596,10626"/>
<v:line from="596,10626" to="0,10626"/>
<v:line from="0,10626" to="0,9548"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10626px;">
<A id="svgcats_vml_p32" class="to_tree" onClick="selectTreeElem( '32' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10626px;">
<A id="page_group_bottom" href="dos_batch_03.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
