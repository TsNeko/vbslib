<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>!DOSバッチファイル</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../dos_batch.html?f1=dos_batch.files/dos_batch_tree.html&sub1=svgcats_index_p" + num +
     "&f2=dos_batch.files/dos_batch_03.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "dos_batch.files/dos_batch_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../dos_batch.html?f1=dos_batch.files/dos_batch_tree.html&sub1=svgcats_index_p" + num +
       "&f2=dos_batch.files/dos_batch_03.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 33 --> 
<PAGE>
<A id="svgcats_vml_p33" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '33' );">←</A>
<A href="#svgcats_vml_p34" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="dos_batch_02.html#svgcats_vml_p32" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="dos_batch_02.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:617px; height:808px;" fillcolor="white"/>
<DIV id="text33_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="bat_debug">
バッチファイルのデバッグ</A></DIV>
<v:rect style="position:absolute; margin-left:61px; margin-top:723px; width:268px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text33_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:69px; margin-top:730px; line-height:13px; white-space:nowrap">
echo /* [DEBUGGING] */&nbsp; &nbsp;a&nbsp; &nbsp;&amp; pause &amp; cls</DIV>
<DIV id="text33_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:24px; margin-top:693px; line-height:15px; white-space:nowrap">
実行中に止める</DIV>
<DIV id="text33_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:24px; margin-top:152px; line-height:15px; white-space:nowrap">
全体の動きを見る</DIV>
<DIV id="text33_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:49px; margin-top:182px; line-height:15px; white-space:nowrap">
・echo on にして、注目したい箇所に、特有のコメント、または、ファイルへリダイレクトする <BR/>
　echo を入れます。</DIV>
<v:rect style="position:absolute; margin-left:61px; margin-top:225px; width:166px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text33_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:69px; margin-top:232px; line-height:13px; white-space:nowrap">
REM&nbsp; /* [DEBUGGING] */&nbsp; a</DIV>
<DIV id="text33_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:49px; margin-top:282px; line-height:15px; white-space:nowrap">
・注目したい箇所に、変数に関するコメントを入れます</DIV>
<DIV id="text33_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:347px; line-height:15px; white-space:nowrap">
・echo on にするか、バッチファイル内で set echo_on=1 に対応させて、<BR/>
　実行ログをファイルに出力しながら、実行するバッチファイルを作成して実行します。</DIV>
<v:rect style="position:absolute; margin-left:61px; margin-top:305px; width:190px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text33_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:69px; margin-top:312px; line-height:13px; white-space:nowrap">
REM&nbsp; /* [DEBUGGING] */&nbsp; r=%r%</DIV>
<v:rect style="position:absolute; margin-left:61px; margin-top:413px; width:310px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text33_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:69px; margin-top:419px; line-height:15px; white-space:nowrap">
echo on<BR/>
set echo_on=1<BR/>
( call auto.bat 2&gt;&amp;1 ) &gt; log.txt<BR/>
if "%notepad%"=="" start "" notepad log.txt<BR/>
if not "%notepad%"=="" start "" %notepad% log.txt<BR/>
set echo_on=</DIV>
<DIV id="text33_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:393px; line-height:15px; white-space:nowrap">
x.bat</DIV>
<DIV id="text33_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:111px; margin-top:450px; line-height:13px; white-space:nowrap">
auto.bat</DIV>
<DIV id="text33_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:69px; margin-top:518px; line-height:15px; white-space:nowrap">
2&gt;&amp;1 で、標準エラー出力も log.txt に出力しています。</DIV>
<v:rect style="position:absolute; margin-left:61px; margin-top:617px; width:46px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text33_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:69px; margin-top:624px; line-height:13px; white-space:nowrap">
&gt;call</DIV>
<DIV id="text33_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:53px; margin-top:573px; line-height:15px; white-space:nowrap">
実行ログで、どのバッチファイルを実行しているかどうかは、call 文を検索すれば<BR/>
分かります。</DIV>
<v:rect style="position:absolute; margin-left:61px; margin-top:752px; width:418px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text33_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:69px; margin-top:759px; line-height:13px; white-space:nowrap">
if not (%rr%)==(0) echo %cd%^&gt;&amp;echo /* [DEBUGGING] */&nbsp; &nbsp;%msg%&amp;pause</DIV>
<DIV id="text33_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:111px; margin-top:393px; line-height:15px; white-space:nowrap">
→ x.lzh</DIV>
<DIV id="text33_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:69px; margin-top:539px; line-height:15px; white-space:nowrap">
<A href="dos_batch_02.html#notepad">
→ notepad</A></DIV>
<DIV id="text33_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:181px; margin-top:393px; line-height:15px; white-space:nowrap">
→ x_me.lzh</DIV>
<DIV id="text33_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:237px; margin-top:230px; line-height:15px; white-space:nowrap">
または、</DIV>
<v:rect style="position:absolute; margin-left:293px; margin-top:225px; width:292px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text33_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:301px; margin-top:231px; line-height:15px; white-space:nowrap">
del&nbsp; "C:\batlog.txt"<BR/>
echo&nbsp; /* [DEBUGGING] */&nbsp; a&nbsp; &gt;&gt; "C:\batlog.txt"</DIV>
<v:rect style="position:absolute; margin-left:61px; margin-top:83px; width:418px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text33_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:69px; margin-top:89px; line-height:15px; white-space:nowrap">
set /A g_count = %g_count% + 1<BR/>
echo g_count=%g_count% &amp; if "%g_count%" == "1"&nbsp; ( pause &amp; echo on )</DIV>
<DIV id="text33_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:24px; margin-top:60px; line-height:15px; white-space:nowrap">
指定した回数が通過したら、コマンドを表示しながら実行する。</DIV>

<v:line from="0,0" to="617,0"/>
<v:line from="617,0" to="617,808"/>
<v:line from="617,808" to="0,808"/>
<v:line from="0,808" to="0,0"/>

</PAGE>
 
<!-- page 34 --> 
<PAGE>
<A id="svgcats_vml_p34" class="to_tree" style="margin-top:813px;" onClick="selectTreeElem( '34' );">←</A>
<A href="#svgcats_vml_p35" class="to_next_page" style="margin-top:813px;">▼</A>
<A href="#svgcats_vml_p33" class="to_prev_page" style="margin-top:813px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:824px; width:636px; height:666px;" fillcolor="white"/>
<v:image src="34/image01.jpg"
   style="position:absolute; margin-left:20px; margin-top:917px; width:450px; height:338px;"/>
<DIV id="text34_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:841px; line-height:15px; white-space:nowrap">
<A name="VisualBat">
VisualBat - バッチファイルのデバッガー</A></DIV>
<DIV id="text34_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:143px; margin-top:885px; line-height:15px; white-space:nowrap">
→ VisualBat_1.0.0.zip</DIV>
<v:rect style="position:absolute; margin-left:30px; margin-top:879px; width:90px; height:26px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text34_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:40px; margin-top:885px; line-height:15px; white-space:nowrap">
ダウンロード</DIV>
<DIV id="text34_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:1420px; line-height:15px; white-space:nowrap">
<A href="http://cx20.hatenablog.com/entry/2014/02/05/002139" target="_blank">
→ バッチファイル向け統合開発環境「VisualBat」を試してみる - CX's Hatena Blog (Web)</A></DIV>
<DIV id="text34_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:1442px; line-height:15px; white-space:nowrap">
<A href="http://www.forest.impress.co.jp/docs/review/20140204_633694.html" target="_blank">
→ 編集やデバッグが簡単になるバッチファイル向け統合開発環境「VisualBat」 - 窓の杜 (Web)</A></DIV>
<DIV id="text34_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:25px; margin-top:1276px; line-height:15px; white-space:nowrap">
次のことができます。<BR/>
・ブレーク ポイントの設定<BR/>
・ステップ実行<BR/>
・全変数のウォッチ</DIV>
<DIV id="text34_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1420px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text34_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:25px; margin-top:1359px; line-height:15px; white-space:nowrap">
次のことはできません。<BR/>
・コールスタックの参照</DIV>

<v:line from="0,824" to="636,824"/>
<v:line from="636,824" to="636,1490"/>
<v:line from="636,1490" to="0,1490"/>
<v:line from="0,1490" to="0,824"/>

</PAGE>
 
<!-- page 35 --> 
<PAGE>
<A id="svgcats_vml_p35" class="to_tree" style="margin-top:1495px;" onClick="selectTreeElem( '35' );">←</A>
<A href="#svgcats_vml_p36" class="to_next_page" style="margin-top:1495px;">▼</A>
<A href="#svgcats_vml_p34" class="to_prev_page" style="margin-top:1495px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1506px; width:524px; height:819px;" fillcolor="white"/>
<DIV id="text35_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1523px; line-height:15px; white-space:nowrap">
<A name="batlib">
batlib</A></DIV>
<DIV id="text35_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1586px; line-height:15px; white-space:nowrap">
→ batlib フォルダー</DIV>
<DIV id="text35_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1555px; line-height:15px; white-space:nowrap">
Sage Plaisir 21 が提供する（予定の）バッチ ファイルのライブラリ。</DIV>
<DIV id="text35_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1628px; line-height:15px; white-space:nowrap">
<A name="batlib_main">
メイン関数</A></DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:1653px; width:448px; height:640px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text35_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:1659px; line-height:15px; white-space:nowrap">
@echo off<BR/>
rem ********************************************************************<BR/>
rem * File: batlib.bat<BR/>
rem ********************************************************************<BR/>
<BR/>
call :Main<BR/>
if errorlevel 1 ( echo ^&lt;%error_message%/^&gt; &amp; pause &amp; exit /b )<BR/>
exit<BR/>
<BR/>
<BR/>
rem ********************************************************************<BR/>
rem * Function: Main<BR/>
rem *&nbsp; &nbsp; Calls test functions.<BR/>
rem *<BR/>
rem * Return Value:<BR/>
rem *&nbsp; &nbsp; %errorlevel% - 0=Pass<BR/>
rem ********************************************************************<BR/>
:Main<BR/>
&nbsp; &nbsp; call :T_Example&nbsp; "Example.txt"<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; if errorlevel 1 ( exit /b )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; rem&nbsp; ★ call の直後は必ず errorlevel をチェックすること<BR/>
<BR/>
&nbsp; &nbsp; echo Pass.<BR/>
&nbsp; &nbsp; pause<BR/>
goto :eof<BR/>
<BR/>
<BR/>
rem ********************************************************************<BR/>
rem * Function: T_Example<BR/>
rem *&nbsp; &nbsp; A test function.<BR/>
rem *<BR/>
rem * Arguments:<BR/>
rem *&nbsp; &nbsp; "%~1" - Full path of input.<BR/>
rem *<BR/>
rem * Return Value:<BR/>
rem *&nbsp; &nbsp; %return_value% - 1=Same, 0=NotSame<BR/>
rem ********************************************************************<BR/>
:T_Example<BR/>
&nbsp; &nbsp; set input_path=%~1<BR/>
<BR/>
&nbsp; &nbsp; set return_value=0<BR/>
goto :eof</DIV>
<DIV id="text35_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:202px; margin-top:1750px; line-height:13px; white-space:nowrap">
<A href="#error_message">
%error_message%</A></DIV>
<DIV id="text35_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:118px; margin-top:1945px; line-height:13px; white-space:nowrap">
<A href="dos_batch_02.html#test_err">
errorlevel</A></DIV>

<v:line from="0,1506" to="524,1506"/>
<v:line from="524,1506" to="524,2325"/>
<v:line from="524,2325" to="0,2325"/>
<v:line from="0,2325" to="0,1506"/>

</PAGE>
 
<!-- page 36 --> 
<PAGE>
<A id="svgcats_vml_p36" class="to_tree" style="margin-top:2330px;" onClick="selectTreeElem( '36' );">←</A>
<A href="#svgcats_vml_p37" class="to_next_page" style="margin-top:2330px;">▼</A>
<A href="#svgcats_vml_p35" class="to_prev_page" style="margin-top:2330px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2341px; width:560px; height:653px;" fillcolor="white"/>
<DIV id="text36_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2358px; line-height:15px; white-space:nowrap">
<A name="Error">
Error</A></DIV>
<DIV id="text36_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:246px; margin-top:2358px; line-height:15px; white-space:nowrap">
<A href="#batlib">
&lt;&lt; batlib</A></DIV>
<DIV id="text36_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2839px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text36_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:2839px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:2388px; width:178px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text36_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:2395px; line-height:13px; white-space:nowrap">
call :Error "%~1" &amp; exit /b</DIV>
<DIV id="text36_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2425px; line-height:15px; white-space:nowrap">
エラーを発生させます。</DIV>
<DIV id="text36_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2451px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text36_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2451px; line-height:15px; white-space:nowrap">
%~1</DIV>
<DIV id="text36_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:2451px; line-height:15px; white-space:nowrap">
%errorlevel% に設定する値</DIV>
<DIV id="text36_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2491px; line-height:15px; white-space:nowrap">
%errorlevel%</DIV>
<DIV id="text36_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:2491px; line-height:15px; white-space:nowrap">
%~1、ただし整数のみ</DIV>
<DIV id="text36_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2471px; line-height:15px; white-space:nowrap">
%~2</DIV>
<DIV id="text36_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:2471px; line-height:15px; white-space:nowrap">
%error_message% の一部に設定するエラーメッセージ</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:2748px; width:304px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text36_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:2755px; line-height:13px; white-space:nowrap">
if not exist "a.txt" ( call :Error 1 &amp; exit /b )</DIV>
<DIV id="text36_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2723px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:2785px; width:376px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text36_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:2792px; line-height:13px; white-space:nowrap">
if not exist "a.txt" ( call :Error 1 "not found" &amp; exit /b )</DIV>
<DIV id="text36_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2723px; line-height:15px; white-space:nowrap">
エラーを発生させます。</DIV>
<DIV id="text36_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:2587px; line-height:15px; white-space:nowrap">
Error 関数を呼び出すと、%error_message% に次のようなエラーメッセージが入ります。</DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:2607px; width:250px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text36_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:2614px; line-height:13px; white-space:nowrap">
ERROR&nbsp; errorlevel="1"&nbsp; error_message=""</DIV>
<DIV id="text36_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:49px; margin-top:2650px; line-height:15px; white-space:nowrap">
%error_message% を XML 形式にしなかった理由は、変数を参照したときに<BR/>
リダイレクトされてしまうからです。<BR/>
%~2 引数に、&lt; や &gt; や " を含めることはできません。</DIV>
<DIV id="text36_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:2869px; line-height:15px; white-space:nowrap">
<A href="dos_batch_02.html#ThroughError">
→ エラーをそのまま返す</A></DIV>
<DIV id="text36_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2869px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text36_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:2897px; line-height:15px; white-space:nowrap">
<A href="#ClearError">
→ ClearError</A></DIV>
<DIV id="text36_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:112px; margin-top:2916px; line-height:15px; white-space:nowrap">
エラーをクリアします。 <BR/>
エラーメッセージを表示して、続きを実行します。<BR/>
エラーが発生したことをテストします。</DIV>
<DIV id="text36_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2558px; line-height:15px; white-space:nowrap">
<A name="error_message">
%error_message% 変数</A></DIV>

<v:line from="0,2341" to="560,2341"/>
<v:line from="560,2341" to="560,2994"/>
<v:line from="560,2994" to="0,2994"/>
<v:line from="0,2994" to="0,2341"/>

</PAGE>
 
<!-- page 37 --> 
<PAGE>
<A id="svgcats_vml_p37" class="to_tree" style="margin-top:2999px;" onClick="selectTreeElem( '37' );">←</A>
<A href="#svgcats_vml_p38" class="to_next_page" style="margin-top:2999px;">▼</A>
<A href="#svgcats_vml_p36" class="to_prev_page" style="margin-top:2999px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3010px; width:595px; height:583px;" fillcolor="white"/>
<DIV id="text37_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3027px; line-height:15px; white-space:nowrap">
<A name="ClearError">
ClearError</A></DIV>
<DIV id="text37_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:246px; margin-top:3027px; line-height:15px; white-space:nowrap">
<A href="#batlib">
&lt;&lt; batlib</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:3057px; width:112px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text37_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:3064px; line-height:13px; white-space:nowrap">
call :ClearError</DIV>
<DIV id="text37_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3094px; line-height:15px; white-space:nowrap">
エラーをクリアします。</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:3339px; width:322px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text37_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:3345px; line-height:15px; white-space:nowrap">
call :T_Example<BR/>
&nbsp; &nbsp; echo.<BR/>
&nbsp; &nbsp; echo Next is Error Test<BR/>
<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; ...<BR/>
<BR/>
&nbsp; &nbsp; if not errorlevel 1 ( call :Error 1 &amp; exit /b )<BR/>
&nbsp; &nbsp; call :ClearError</DIV>
<DIV id="text37_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3313px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text37_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:102px; margin-top:3313px; line-height:15px; white-space:nowrap">
エラーが発生したことをチェックします。 パスしたらエラーをクリアします。</DIV>
<DIV id="text37_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3495px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text37_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:3495px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text37_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3122px; line-height:15px; white-space:nowrap">
%errorlevel% と %error_message% をクリアします。</DIV>
<DIV id="text37_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:3526px; line-height:15px; white-space:nowrap">
<A href="dos_batch_02.html#ThroughError">
→ エラーをそのまま返す</A></DIV>
<DIV id="text37_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3526px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text37_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:3545px; line-height:15px; white-space:nowrap">
<A href="#Error">
→ Error</A></DIV>
<DIV id="text37_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:102px; margin-top:3173px; line-height:15px; white-space:nowrap">
エラーが発生したら、エラーメッセージを表示して、続きを実行します。</DIV>
<DIV id="text37_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3173px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:3199px; width:424px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text37_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:3205px; line-height:15px; white-space:nowrap">
call :T_Example<BR/>
&nbsp; &nbsp; if errorlevel 1 ( echo ^&lt;%error_message%/^&gt; &amp; call :ClearError )</DIV>
<DIV id="text37_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#C05A00; margin-left:52px; margin-top:3251px; line-height:15px; white-space:nowrap">
if や for の ( ) の中で errorlevel 変数を参照しないでください。</DIV>
<DIV id="text37_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:374px; margin-top:3266px; line-height:15px; white-space:nowrap">
<A href="dos_batch_02.html#errorlevel_statement">
errorlevel 構文を使ってください。</A></DIV>
<DIV id="text37_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:3266px; line-height:15px; white-space:nowrap">
( ) の前の errorlevel 変数の値が参照されてしまいます。</DIV>

<v:line from="0,3010" to="595,3010"/>
<v:line from="595,3010" to="595,3593"/>
<v:line from="595,3593" to="0,3593"/>
<v:line from="0,3593" to="0,3010"/>

</PAGE>
 
<!-- page 38 --> 
<PAGE>
<A id="svgcats_vml_p38" class="to_tree" style="margin-top:3598px;" onClick="selectTreeElem( '38' );">←</A>
<A href="#svgcats_vml_p39" class="to_next_page" style="margin-top:3598px;">▼</A>
<A href="#svgcats_vml_p37" class="to_prev_page" style="margin-top:3598px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3609px; width:543px; height:338px;" fillcolor="white"/>
<DIV id="text38_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3626px; line-height:15px; white-space:nowrap">
<A name="GetStepPath">
GetStepPath</A></DIV>
<DIV id="text38_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:246px; margin-top:3626px; line-height:15px; white-space:nowrap">
<A href="#batlib">
&lt;&lt; batlib</A></DIV>
<DIV id="text38_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3899px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text38_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3854px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text38_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:3854px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text38_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:3899px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text38_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:178px; margin-top:3899px; line-height:15px; white-space:nowrap">
T_GetStepPath</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:3656px; width:202px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text38_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:3663px; line-height:13px; white-space:nowrap">
call :GetStepPath&nbsp; "%~1"&nbsp; "%~2"</DIV>
<DIV id="text38_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3693px; line-height:15px; white-space:nowrap">
フル パスを相対パスに変換します。</DIV>
<DIV id="text38_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3719px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text38_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:3719px; line-height:15px; white-space:nowrap">
%~1</DIV>
<DIV id="text38_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:3738px; line-height:15px; white-space:nowrap">
%~2</DIV>
<DIV id="text38_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:3719px; line-height:15px; white-space:nowrap">
入力するフル パス</DIV>
<DIV id="text38_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:3738px; line-height:15px; white-space:nowrap">
相対パスの基準となるフル パス</DIV>
<DIV id="text38_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:3757px; line-height:15px; white-space:nowrap">
%return_value%</DIV>
<DIV id="text38_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:3757px; line-height:15px; white-space:nowrap">
相対パス</DIV>
<DIV id="text38_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3792px; line-height:15px; white-space:nowrap">
親フォルダー（ピリオド２つ）が相対パスに含まれるような値を引数に指定したときは、<BR/>
エラーになります。</DIV>
<DIV id="text38_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:158px; margin-top:3871px; line-height:15px; white-space:nowrap">
のコードも必要です。</DIV>
<DIV id="text38_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:117px; margin-top:3871px; line-height:15px; white-space:nowrap">
<A href="#Error">
Error</A></DIV>

<v:line from="0,3609" to="543,3609"/>
<v:line from="543,3609" to="543,3947"/>
<v:line from="543,3947" to="0,3947"/>
<v:line from="0,3947" to="0,3609"/>

</PAGE>
 
<!-- page 39 --> 
<PAGE>
<A id="svgcats_vml_p39" class="to_tree" style="margin-top:3952px;" onClick="selectTreeElem( '39' );">←</A>
<A href="#svgcats_vml_p40" class="to_next_page" style="margin-top:3952px;">▼</A>
<A href="#svgcats_vml_p38" class="to_prev_page" style="margin-top:3952px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3963px; width:487px; height:470px;" fillcolor="white"/>
<DIV id="text39_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3980px; line-height:15px; white-space:nowrap">
<A name="GetFileName">
GetFileName</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:4010px; width:160px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text39_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:4017px; line-height:13px; white-space:nowrap">
call :GetFileName&nbsp; "%~1"</DIV>
<DIV id="text39_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4047px; line-height:15px; white-space:nowrap">
パスからファイル名を返します。</DIV>
<DIV id="text39_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4073px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text39_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4073px; line-height:15px; white-space:nowrap">
%~1</DIV>
<DIV id="text39_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:4073px; line-height:15px; white-space:nowrap">
入力するパス。相対パス、または、フル パス</DIV>
<DIV id="text39_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:4092px; line-height:15px; white-space:nowrap">
ファイル名、または、フォルダー名</DIV>
<DIV id="text39_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4092px; line-height:15px; white-space:nowrap">
%return_value%</DIV>
<DIV id="text39_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4134px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text39_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4192px; line-height:13px; white-space:nowrap">
C:\Folder\Example.txt</DIV>
<DIV id="text39_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:81px; margin-top:4160px; line-height:15px; white-space:nowrap">
%~1</DIV>
<DIV id="text39_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:240px; margin-top:4160px; line-height:15px; white-space:nowrap">
%return_value%</DIV>
<v:line style="position:absolute;" from="62,4183" to="353,4183" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text39_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:240px; margin-top:4192px; line-height:13px; white-space:nowrap">
Example.txt</DIV>
<DIV id="text39_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4209px; line-height:13px; white-space:nowrap">
C:\Folder</DIV>
<DIV id="text39_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:240px; margin-top:4209px; line-height:13px; white-space:nowrap">
Folder</DIV>
<DIV id="text39_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4226px; line-height:13px; white-space:nowrap">
C:</DIV>
<DIV id="text39_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:240px; margin-top:4226px; line-height:13px; white-space:nowrap">
なし（エラー）</DIV>
<DIV id="text39_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4243px; line-height:13px; white-space:nowrap">
なし</DIV>
<DIV id="text39_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:240px; margin-top:4243px; line-height:13px; white-space:nowrap">
なし（エラー）</DIV>
<DIV id="text39_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4386px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text39_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4336px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text39_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:4336px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text39_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:4386px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text39_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:178px; margin-top:4386px; line-height:15px; white-space:nowrap">
T_GetFileName</DIV>
<DIV id="text39_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4260px; line-height:13px; white-space:nowrap">
Folder\Example</DIV>
<DIV id="text39_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4277px; line-height:13px; white-space:nowrap">
Folder</DIV>
<DIV id="text39_28" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:240px; margin-top:4260px; line-height:13px; white-space:nowrap">
Example</DIV>
<DIV id="text39_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:240px; margin-top:4277px; line-height:13px; white-space:nowrap">
Folder</DIV>
<DIV id="text39_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4315px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text39_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:84px; margin-top:4315px; line-height:15px; white-space:nowrap">
<A href="#bat_path">
→ ファイル名、パス</A></DIV>
<DIV id="text39_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:4356px; line-height:15px; white-space:nowrap">
のコードも必要です。</DIV>
<DIV id="text39_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:116px; margin-top:4356px; line-height:15px; white-space:nowrap">
<A href="#Error">
Error</A></DIV>

<v:line from="0,3963" to="487,3963"/>
<v:line from="487,3963" to="487,4433"/>
<v:line from="487,4433" to="0,4433"/>
<v:line from="0,4433" to="0,3963"/>

</PAGE>
 
<!-- page 40 --> 
<PAGE>
<A id="svgcats_vml_p40" class="to_tree" style="margin-top:4438px;" onClick="selectTreeElem( '40' );">←</A>
<A href="#svgcats_vml_p41" class="to_next_page" style="margin-top:4438px;">▼</A>
<A href="#svgcats_vml_p39" class="to_prev_page" style="margin-top:4438px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4449px; width:556px; height:454px;" fillcolor="white"/>
<DIV id="text40_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4466px; line-height:15px; white-space:nowrap">
<A name="GetParentPath">
GetParentPath</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:4496px; width:172px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text40_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:4503px; line-height:13px; white-space:nowrap">
call :GetParentPath&nbsp; "%~1"</DIV>
<DIV id="text40_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4533px; line-height:15px; white-space:nowrap">
親フォルダーのパスを返します。</DIV>
<DIV id="text40_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4559px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text40_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4559px; line-height:15px; white-space:nowrap">
%~1</DIV>
<DIV id="text40_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:4559px; line-height:15px; white-space:nowrap">
入力するパス。相対パス、または、フル パス</DIV>
<DIV id="text40_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:4578px; line-height:15px; white-space:nowrap">
%~1 の親フォルダーのフル パス</DIV>
<DIV id="text40_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4578px; line-height:15px; white-space:nowrap">
%return_value%</DIV>
<DIV id="text40_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4620px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text40_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4678px; line-height:13px; white-space:nowrap">
C:\Folder\Example</DIV>
<DIV id="text40_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:81px; margin-top:4646px; line-height:15px; white-space:nowrap">
%~1</DIV>
<DIV id="text40_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:216px; margin-top:4646px; line-height:15px; white-space:nowrap">
%return_value%</DIV>
<v:line style="position:absolute;" from="62,4669" to="322,4669" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text40_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:216px; margin-top:4678px; line-height:13px; white-space:nowrap">
C:\Folder</DIV>
<DIV id="text40_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4695px; line-height:13px; white-space:nowrap">
C:\Folder</DIV>
<DIV id="text40_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:216px; margin-top:4695px; line-height:13px; white-space:nowrap">
C:</DIV>
<DIV id="text40_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4712px; line-height:13px; white-space:nowrap">
C:</DIV>
<DIV id="text40_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:216px; margin-top:4712px; line-height:13px; white-space:nowrap">
なし（エラー）</DIV>
<DIV id="text40_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4729px; line-height:13px; white-space:nowrap">
なし</DIV>
<DIV id="text40_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:216px; margin-top:4729px; line-height:13px; white-space:nowrap">
なし（エラー）</DIV>
<DIV id="text40_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4855px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text40_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4808px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text40_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:4808px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text40_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:4855px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text40_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:178px; margin-top:4855px; line-height:15px; white-space:nowrap">
T_GetParentPath</DIV>
<DIV id="text40_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:81px; margin-top:4746px; line-height:13px; white-space:nowrap">
Folder</DIV>
<DIV id="text40_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:216px; margin-top:4746px; line-height:13px; white-space:nowrap">
C:\Current\Folder （カレントが C:\Current の場合）</DIV>
<DIV id="text40_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4787px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text40_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:84px; margin-top:4787px; line-height:15px; white-space:nowrap">
<A href="#bat_path">
→ ファイル名、パス</A></DIV>
<DIV id="text40_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:4830px; line-height:15px; white-space:nowrap">
のコードも必要です。</DIV>
<DIV id="text40_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:116px; margin-top:4830px; line-height:15px; white-space:nowrap">
<A href="#Error">
Error</A></DIV>

<v:line from="0,4449" to="556,4449"/>
<v:line from="556,4449" to="556,4903"/>
<v:line from="556,4903" to="0,4903"/>
<v:line from="0,4903" to="0,4449"/>

</PAGE>
 
<!-- page 41 --> 
<PAGE>
<A id="svgcats_vml_p41" class="to_tree" style="margin-top:4908px;" onClick="selectTreeElem( '41' );">←</A>
<A href="#svgcats_vml_p42" class="to_next_page" style="margin-top:4908px;">▼</A>
<A href="#svgcats_vml_p40" class="to_prev_page" style="margin-top:4908px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4919px; width:551px; height:580px;" fillcolor="white"/>
<DIV id="text41_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4936px; line-height:15px; white-space:nowrap">
<A name="SearchParent">
SearchParent</A></DIV>
<DIV id="text41_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:114px; margin-top:5423px; line-height:15px; white-space:nowrap">
<A href="#GetParentPath">
GetParentPath,</A></DIV>
<DIV id="text41_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:253px; margin-top:5423px; line-height:15px; white-space:nowrap">
のコードも必要です。</DIV>
<DIV id="text41_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:212px; margin-top:5423px; line-height:15px; white-space:nowrap">
<A href="#Error">
Error</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:4966px; width:166px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text41_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:4973px; line-height:13px; white-space:nowrap">
call :SearchParent&nbsp; "%~1"</DIV>
<DIV id="text41_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5003px; line-height:15px; white-space:nowrap">
StepPath&nbsp; に指定したファイルまたはフォルダを、親フォルダに向かって探します。</DIV>
<DIV id="text41_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5029px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text41_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:5029px; line-height:15px; white-space:nowrap">
%~1</DIV>
<DIV id="text41_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:5029px; line-height:15px; white-space:nowrap">
ファイル名、または相対パス</DIV>
<DIV id="text41_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:5048px; line-height:15px; white-space:nowrap">
見つかったファイルまたはフォルダのフル・パス</DIV>
<DIV id="text41_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:5048px; line-height:15px; white-space:nowrap">
%return_value%</DIV>
<DIV id="text41_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5090px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text41_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:85px; margin-top:5284px; line-height:13px; white-space:nowrap">
B2</DIV>
<DIV id="text41_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:85px; margin-top:5252px; line-height:15px; white-space:nowrap">
%~1</DIV>
<DIV id="text41_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:220px; margin-top:5252px; line-height:15px; white-space:nowrap">
%return_value%</DIV>
<v:line style="position:absolute;" from="64,5275" to="326,5275" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text41_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:220px; margin-top:5284px; line-height:13px; white-space:nowrap">
C:\A\B\B2</DIV>
<DIV id="text41_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5451px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text41_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5404px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text41_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:5404px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text41_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:5451px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text41_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:178px; margin-top:5451px; line-height:15px; white-space:nowrap">
T_SearchParent</DIV>
<DIV id="text41_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:5120px; line-height:15px; white-space:nowrap">
カレント フォルダーが、C:\A\B\C で、下記のフォルダーまたはファイルがあるとき、</DIV>
<DIV id="text41_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:220px; margin-top:5303px; line-height:13px; white-space:nowrap">
C:\A\A2</DIV>
<DIV id="text41_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:85px; margin-top:5303px; line-height:13px; white-space:nowrap">
A2</DIV>
<DIV id="text41_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:85px; margin-top:5322px; line-height:13px; white-space:nowrap">
C2</DIV>
<DIV id="text41_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:220px; margin-top:5322px; line-height:13px; white-space:nowrap">
C:\A\B\C\C2</DIV>
<DIV id="text41_28" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:220px; margin-top:5341px; line-height:13px; white-space:nowrap">
C:\A\B\B2</DIV>
<DIV id="text41_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:85px; margin-top:5341px; line-height:13px; white-space:nowrap">
B\B2</DIV>
<DIV id="text41_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:5224px; line-height:15px; white-space:nowrap">
引数と返り値の関係は、以下のようになります。</DIV>
<DIV id="text41_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:85px; margin-top:5142px; line-height:15px; white-space:nowrap">
C:\A\A2<BR/>
C:\A\B\B2<BR/>
C:\A\B\C\C2<BR/>
C:\A\B\C</DIV>
<DIV id="text41_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:85px; margin-top:5360px; line-height:13px; white-space:nowrap">
NotFound</DIV>
<DIV id="text41_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:220px; margin-top:5360px; line-height:13px; white-space:nowrap">
なし（エラー）</DIV>

<v:line from="0,4919" to="551,4919"/>
<v:line from="551,4919" to="551,5499"/>
<v:line from="551,5499" to="0,5499"/>
<v:line from="0,5499" to="0,4919"/>

</PAGE>
 
<!-- page 42 --> 
<PAGE>
<A id="svgcats_vml_p42" class="to_tree" style="margin-top:5504px;" onClick="selectTreeElem( '42' );">←</A>
<A href="#svgcats_vml_p43" class="to_next_page" style="margin-top:5504px;">▼</A>
<A href="#svgcats_vml_p41" class="to_prev_page" style="margin-top:5504px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5515px; width:554px; height:207px;" fillcolor="white"/>
<DIV id="text42_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5532px; line-height:15px; white-space:nowrap">
IsSameFolder</DIV>
<v:roundrect style="position:absolute; margin-left:128px; margin-top:5529px; width:56px; height:20px;" arcsize="0.500000" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text42_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:136px; margin-top:5532px; line-height:15px; white-space:nowrap">
未対応</DIV>
<DIV id="text42_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5671px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text42_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5650px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text42_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:5650px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text42_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:5671px; line-height:15px; white-space:nowrap">
→ batlib.bat</DIV>
<DIV id="text42_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:178px; margin-top:5671px; line-height:15px; white-space:nowrap">
T_IsSameFolder</DIV>
<DIV id="text42_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5589px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text42_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:60px; margin-top:5589px; line-height:15px; white-space:nowrap">
<A href="http://qanda.rakuten.ne.jp/qa5142827.html" target="_blank">
→ バッチにてフォルダ内ファイルの差分抽出 - 楽天 みんなで解決！Ｑ＆Ａ (Web)</A></DIV>
<DIV id="text42_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:84px; margin-top:5606px; line-height:15px; white-space:nowrap">
サブ フォルダーは比較しない</DIV>

<v:line from="0,5515" to="554,5515"/>
<v:line from="554,5515" to="554,5722"/>
<v:line from="554,5722" to="0,5722"/>
<v:line from="0,5722" to="0,5515"/>

</PAGE>
 
<!-- page 43 --> 
<PAGE>
<A id="svgcats_vml_p43" class="to_tree" style="margin-top:5727px;" onClick="selectTreeElem( '43' );">←</A>
<A href="#svgcats_vml_p44" class="to_next_page" style="margin-top:5727px;">▼</A>
<A href="#svgcats_vml_p42" class="to_prev_page" style="margin-top:5727px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5738px; width:600px; height:583px;" fillcolor="white"/>
<DIV id="text43_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5755px; line-height:15px; white-space:nowrap">
<A name="check">
パラメータ、プログラムのチェック</A></DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:5934px; width:508px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text43_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:5940px; line-height:15px; white-space:nowrap">
set prog="%ProgramFiles%\prog\prog.exe"<BR/>
if not exist %prog%&nbsp; echo %prog% が見つかりません &amp; echo exit. &amp; pause &amp; goto :eof<BR/>
<BR/>
%prog% %1</DIV>
<DIV id="text43_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:5891px; line-height:15px; white-space:nowrap">
プログラムを呼び出すときは、次のようにバッチファイルの先頭で、プログラムの存在をチェック<BR/>
するようにしてください。</DIV>
<DIV id="text43_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5797px; line-height:15px; white-space:nowrap">
バッチファイルにパラメータが必要なときは、次のようにチェックします。<BR/>
%1 ではなく %~1 にしているのは、"" が付いていたらカットするためです。</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:5840px; width:496px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text43_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:5847px; line-height:13px; white-space:nowrap">
if "%~1"=="" echo&nbsp; 使い方: %bat_name%&nbsp; (folder) &amp; echo exit. &amp; pause &amp; goto :eof</DIV>
<DIV id="text43_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:6034px; line-height:15px; white-space:nowrap">
パラメータに指定したパスを、プログラムに渡すときは、"%1" ではなく "%~1" を記述してください。</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:6066px; width:88px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text43_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:6073px; line-height:13px; white-space:nowrap">
%prog% "%~1"</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:6240px; width:28px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text43_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:6247px; line-height:13px; white-space:nowrap">
%*</DIV>
<DIV id="text43_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:6220px; line-height:15px; white-space:nowrap">
すべてのパラメータ</DIV>
<DIV id="text43_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:6117px; line-height:15px; white-space:nowrap">
バッチファイルがある場所から相対パスで実行ファイルを指定するときは、"" で囲んだ相対パス<BR/>
の先頭に、%~d0%~p0 を記述してください。</DIV>
<DIV id="text43_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:267px; margin-top:6132px; line-height:15px; white-space:nowrap">
<A href="#bat_path">
→ ファイル名、パスの変数の活用</A></DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:6165px; width:196px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text43_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:6172px; line-height:13px; white-space:nowrap">
"%~d0%~p0..\Sample.exe"&nbsp; "%~1"</DIV>
<DIV id="text43_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:6274px; line-height:15px; white-space:nowrap">
shift を実行しても、パラメーターは減りません。</DIV>

<v:line from="0,5738" to="600,5738"/>
<v:line from="600,5738" to="600,6321"/>
<v:line from="600,6321" to="0,6321"/>
<v:line from="0,6321" to="0,5738"/>

</PAGE>
 
<!-- page 44 --> 
<PAGE>
<A id="svgcats_vml_p44" class="to_tree" style="margin-top:6326px;" onClick="selectTreeElem( '44' );">←</A>
<A href="#svgcats_vml_p45" class="to_next_page" style="margin-top:6326px;">▼</A>
<A href="#svgcats_vml_p43" class="to_prev_page" style="margin-top:6326px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6337px; width:516px; height:549px;" fillcolor="white"/>
<DIV id="text44_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6354px; line-height:15px; white-space:nowrap">
<A name="set_ex">
変数の活用</A></DIV>
<DIV id="text44_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6742px; line-height:15px; white-space:nowrap">
<A name="stdio">
標準出力</A></DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:6768px; width:142px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text44_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:6774px; line-height:15px; white-space:nowrap">
&gt;echo set a=1 &gt; s.bat<BR/>
&gt;call s.bat<BR/>
&gt;del s.bat<BR/>
&gt;echo %a%<BR/>
1</DIV>
<DIV id="text44_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:206px; margin-top:6774px; line-height:15px; white-space:nowrap">
… 任意のプログラムの標準出力のつもり<BR/>
… call 先で設定した環境変数が使える</DIV>
<DIV id="text44_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:6618px; line-height:15px; white-space:nowrap">
<A href="#part_str">
→ 部分文字列</A></DIV>
<DIV id="text44_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:181px; margin-top:6639px; line-height:15px; white-space:nowrap">
<A href="#date">
→ 日付 (timedate)</A></DIV>
<DIV id="text44_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:304px; margin-top:6639px; line-height:15px; white-space:nowrap">
<A href="#stdio">
→ 標準出力</A></DIV>
<DIV id="text44_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:393px; margin-top:6639px; line-height:15px; white-space:nowrap">
<A href="#math">
→ 計算</A></DIV>
<DIV id="text44_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:6702px; line-height:15px; white-space:nowrap">
<A href="#set_help">
→ set /?</A></DIV>
<DIV id="text44_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:6660px; line-height:15px; white-space:nowrap">
<A href="#set_proc">
→ プロセス間の環境変数の引継ぎ</A></DIV>
<DIV id="text44_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:262px; margin-top:6660px; line-height:15px; white-space:nowrap">
<A href="dos_batch_01.html#cmd_lateenv">
→ 遅延環境変数</A></DIV>
<DIV id="text44_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:393px; margin-top:6660px; line-height:15px; white-space:nowrap">
<A href="dos_batch_05.html#if">
→ 比較 (if)</A></DIV>
<DIV id="text44_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:6681px; line-height:15px; white-space:nowrap">
<A href="dos_batch_04.html#set_p">
→ set /p ：ユーザーに任意の文字列を入力させる</A></DIV>
<DIV id="text44_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:139px; margin-top:6617px; line-height:15px; white-space:nowrap">
<A href="#replace">
→ 置き換え、置換</A></DIV>
<DIV id="text44_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:6639px; line-height:15px; white-space:nowrap">
<A href="#bat_path">
→ ファイル名、パス</A></DIV>
<v:rect style="position:absolute; margin-left:31px; margin-top:6386px; width:94px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text44_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:39px; margin-top:6393px; line-height:13px; white-space:nowrap">
set VAR=value</DIV>
<v:rect style="position:absolute; margin-left:31px; margin-top:6459px; width:46px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text44_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:39px; margin-top:6466px; line-height:13px; white-space:nowrap">
%VAR%</DIV>
<v:rect style="position:absolute; margin-left:74px; margin-top:6496px; width:100px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text44_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:82px; margin-top:6503px; line-height:13px; white-space:nowrap">
set VAR2=%VAR%</DIV>
<v:rect style="position:absolute; margin-left:74px; margin-top:6527px; width:124px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text44_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:82px; margin-top:6534px; line-height:13px; white-space:nowrap">
call :Sub&nbsp; "%VAR%"</DIV>
<v:rect style="position:absolute; margin-left:74px; margin-top:6558px; width:142px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text44_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:82px; margin-top:6565px; line-height:13px; white-space:nowrap">
if "%VAR%" == "" (&nbsp; )</DIV>
<DIV id="text44_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:232px; margin-top:6501px; line-height:15px; white-space:nowrap">
… 代入する値は、" " で囲まないこと</DIV>
<DIV id="text44_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:232px; margin-top:6532px; line-height:15px; white-space:nowrap">
… call やコマンドの引数は、" " で囲めます</DIV>
<DIV id="text44_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:232px; margin-top:6563px; line-height:15px; white-space:nowrap">
… if の条件式の中は、" " で囲めます</DIV>
<DIV id="text44_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:137px; margin-top:6391px; line-height:15px; white-space:nowrap">
… 変数に値を代入します</DIV>
<DIV id="text44_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:137px; margin-top:6464px; line-height:15px; white-space:nowrap">
… 変数の値を参照します</DIV>
<DIV id="text44_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#C05A00; margin-left:61px; margin-top:6420px; line-height:15px; white-space:nowrap">
= の後に空白を入れると、値の先頭が空白になります。</DIV>

<v:line from="0,6337" to="516,6337"/>
<v:line from="516,6337" to="516,6886"/>
<v:line from="516,6886" to="0,6886"/>
<v:line from="0,6886" to="0,6337"/>

</PAGE>
 
<!-- page 45 --> 
<PAGE>
<A id="svgcats_vml_p45" class="to_tree" style="margin-top:6891px;" onClick="selectTreeElem( '45' );">←</A>
<A href="#svgcats_vml_p46" class="to_next_page" style="margin-top:6891px;">▼</A>
<A href="#svgcats_vml_p44" class="to_prev_page" style="margin-top:6891px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6902px; width:534px; height:286px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:27px; margin-top:6956px; width:142px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text45_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:6962px; line-height:15px; white-space:nowrap">
&gt;set STR=ABCDEFGHIJKL<BR/>
&gt;echo %STR:~2,5%<BR/>
CDEFG</DIV>
<DIV id="text45_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:20px; margin-top:6921px; line-height:15px; white-space:nowrap">
<A name="part_str">
部分文字列</A></DIV>
<DIV id="text45_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:186px; margin-top:6976px; line-height:15px; white-space:nowrap">
… 3文字目から 5文字取り出す（2文字目からではない）</DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:7023px; width:106px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text45_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:7030px; line-height:13px; white-space:nowrap">
echo %STR:~0,3%</DIV>
<DIV id="text45_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:149px; margin-top:7028px; line-height:15px; white-space:nowrap">
… 左から 3文字取り出す</DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:7054px; width:100px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text45_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:7061px; line-height:13px; white-space:nowrap">
echo %STR:~-3%</DIV>
<DIV id="text45_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:149px; margin-top:7059px; line-height:15px; white-space:nowrap">
… 右から 3文字取り出す</DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:7085px; width:94px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text45_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:7092px; line-height:13px; white-space:nowrap">
echo %STR:~4%</DIV>
<DIV id="text45_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:149px; margin-top:7090px; line-height:15px; white-space:nowrap">
… 左から 3文字目以降を取り出す</DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:7116px; width:208px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text45_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:7122px; line-height:15px; white-space:nowrap">
echo %STR:~0,-1%<BR/>
&nbsp; &nbsp; rem // Cut a last character.</DIV>
<DIV id="text45_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:241px; margin-top:7121px; line-height:15px; white-space:nowrap">
… 右から 1文字削除する</DIV>
<DIV id="text45_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:89px; margin-top:7030px; line-height:13px; white-space:nowrap">
:~0,3</DIV>
<DIV id="text45_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:95px; margin-top:6978px; line-height:13px; white-space:nowrap">
:~2,5</DIV>
<DIV id="text45_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:89px; margin-top:7061px; line-height:13px; white-space:nowrap">
:~-3</DIV>
<DIV id="text45_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:89px; margin-top:7092px; line-height:13px; white-space:nowrap">
:~4</DIV>
<DIV id="text45_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:89px; margin-top:7123px; line-height:13px; white-space:nowrap">
:~0,-1</DIV>

<v:line from="0,6902" to="534,6902"/>
<v:line from="534,6902" to="534,7188"/>
<v:line from="534,7188" to="0,7188"/>
<v:line from="0,7188" to="0,6902"/>

</PAGE>
 
<!-- page 46 --> 
<PAGE>
<A id="svgcats_vml_p46" class="to_tree" style="margin-top:7193px;" onClick="selectTreeElem( '46' );">←</A>
<A href="#svgcats_vml_p47" class="to_next_page" style="margin-top:7193px;">▼</A>
<A href="#svgcats_vml_p45" class="to_prev_page" style="margin-top:7193px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7204px; width:445px; height:405px;" fillcolor="white"/>
<DIV id="text46_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7221px; line-height:15px; white-space:nowrap">
<A name="replace">
置き換え、置換</A></DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:7352px; width:208px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text46_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:7358px; line-height:15px; white-space:nowrap">
@echo off<BR/>
set file_name=C:\Folder\File.txt<BR/>
echo %file_name:\=/%<BR/>
pause</DIV>
<v:rect style="position:absolute; margin-left:28px; margin-top:7259px; width:292px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text46_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:36px; margin-top:7266px; line-height:13px; white-space:nowrap">
%（変数名）:（置き換える前）=（置き換えた後）%</DIV>
<DIV id="text46_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7309px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:7471px; width:124px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text46_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:7478px; line-height:13px; white-space:nowrap">
C:/Folder/File.txt</DIV>
<DIV id="text46_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:7333px; line-height:15px; white-space:nowrap">
バッチファイル：</DIV>
<DIV id="text46_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:7451px; line-height:15px; white-space:nowrap">
結果：</DIV>
<DIV id="text46_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:69px; margin-top:7561px; line-height:15px; white-space:nowrap">
<A href="http://doudemoexe.com/Batch/0001.jsp" target="_blank">
→ batプログラミング基本事項まとめ - どーでもえぐぜ (Web)</A></DIV>
<DIV id="text46_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7561px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text46_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:7527px; line-height:15px; white-space:nowrap">
引数は置き換えできません。</DIV>

<v:line from="0,7204" to="445,7204"/>
<v:line from="445,7204" to="445,7609"/>
<v:line from="445,7609" to="0,7609"/>
<v:line from="0,7609" to="0,7204"/>

</PAGE>
 
<!-- page 47 --> 
<PAGE>
<A id="svgcats_vml_p47" class="to_tree" style="margin-top:7614px;" onClick="selectTreeElem( '47' );">←</A>
<A href="#svgcats_vml_p48" class="to_next_page" style="margin-top:7614px;">▼</A>
<A href="#svgcats_vml_p46" class="to_prev_page" style="margin-top:7614px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7625px; width:514px; height:382px;" fillcolor="white"/>
<DIV id="text47_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7642px; line-height:15px; white-space:nowrap">
<A name="bat_path">
ファイル名、パス</A></DIV>
<v:rect style="position:absolute; margin-left:28px; margin-top:7676px; width:454px; height:205px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text47_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:36px; margin-top:7682px; line-height:15px; white-space:nowrap">
%1="C:\Users\user1\Desktop\新しいテキスト ドキュメント.txt"<BR/>
%~1=C:\Users\user1\Desktop\新しいテキスト ドキュメント.txt<BR/>
%~d1=C:<BR/>
%~p1=\Users\user1\Desktop\<BR/>
%~n1=新しいテキスト ドキュメント<BR/>
%~x1=.txt<BR/>
%~nx1=新しいテキスト ドキュメント.txt<BR/>
<BR/>
%~f1=C:\Users\user1\Desktop\新しいテキスト ドキュメント.txt ... full name<BR/>
%~s1=C:\Users\user1\Desktop\新しい~1.TXT ... short name<BR/>
%~t1=2012/07/05 20:33 ... time stamp<BR/>
%~z1=895 ... file size<BR/>
%~a1=--a------ ... attribute</DIV>
<DIV id="text47_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:7889px; line-height:15px; white-space:nowrap">
%0 〜 %9 については、上記の記述が使えます。</DIV>
<DIV id="text47_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:7927px; line-height:15px; white-space:nowrap">
任意の環境変数については、下記のように</DIV>
<DIV id="text47_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:281px; margin-top:7927px; line-height:15px; white-space:nowrap">
<A href="dos_batch_04.html#call">
call の引数</A></DIV>
<DIV id="text47_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:351px; margin-top:7927px; line-height:15px; white-space:nowrap">
を活用してください。</DIV>
<DIV id="text47_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:7960px; line-height:15px; white-space:nowrap">
<A href="#GetFileName">
→ GetFileName</A></DIV>
<DIV id="text47_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:151px; margin-top:7960px; line-height:15px; white-space:nowrap">
<A href="#GetParentPath">
→ GetParentPath</A></DIV>
<DIV id="text47_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:278px; margin-top:7960px; line-height:15px; white-space:nowrap">
<A href="#SearchParent">
→ SearchParent</A></DIV>
<DIV id="text47_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:7907px; line-height:15px; white-space:nowrap">
たとえば、%~d0%~p0 は、バッチファイルがあるフォルダー\ になります。</DIV>

<v:line from="0,7625" to="514,7625"/>
<v:line from="514,7625" to="514,8007"/>
<v:line from="514,8007" to="0,8007"/>
<v:line from="0,8007" to="0,7625"/>

</PAGE>
 
<!-- page 48 --> 
<PAGE>
<A id="svgcats_vml_p48" class="to_tree" style="margin-top:8012px;" onClick="selectTreeElem( '48' );">←</A>
<A href="#svgcats_vml_p49" class="to_next_page" style="margin-top:8012px;">▼</A>
<A href="#svgcats_vml_p47" class="to_prev_page" style="margin-top:8012px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8023px; width:557px; height:1070px;" fillcolor="white"/>
<DIV id="text48_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:20px; margin-top:8040px; line-height:15px; white-space:nowrap">
<A name="date">
日付 (%date%, %time%, timedate)</A></DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:8082px; width:88px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text48_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:8088px; line-height:15px; white-space:nowrap">
&gt;echo %date%<BR/>
2007/07/18</DIV>
<v:rect style="position:absolute; margin-left:133px; margin-top:8082px; width:88px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text48_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:141px; margin-top:8088px; line-height:15px; white-space:nowrap">
&gt;echo %time%<BR/>
13:43:11.81</DIV>
<DIV id="text48_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:8132px; line-height:15px; white-space:nowrap">
ただし、地域やバージョン依存になるため、お勧めできない。</DIV>
<DIV id="text48_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8891px; line-height:15px; white-space:nowrap">
→ timedate.lzh</DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:8996px; width:412px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text48_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:9002px; line-height:15px; white-space:nowrap">
"%batchlib_dir%\timedate.exe" &gt; _t.bat &amp; call _t.bat &amp; del _t.bat <BR/>
echo %now%</DIV>
<DIV id="text48_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:9045px; line-height:15px; white-space:nowrap">
例） 070101_2359</DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:8935px; width:130px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text48_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:8942px; line-height:13px; white-space:nowrap">
set now=070101_2359</DIV>
<DIV id="text48_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8914px; line-height:15px; white-space:nowrap">
標準出力に、次の内容を出力します。</DIV>
<DIV id="text48_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:8976px; line-height:15px; white-space:nowrap">
次のように使うことができます。</DIV>
<DIV id="text48_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:8489px; line-height:15px; white-space:nowrap">
<A name="timedate2_exe">
timedate2.exe</A></DIV>
<DIV id="text48_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:8861px; line-height:15px; white-space:nowrap">
<A name="timedate_exe">
timedate.exe</A></DIV>
<DIV id="text48_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:22px; margin-top:8545px; line-height:15px; white-space:nowrap">
次のように使うことができます。<BR/>
call などを使っているのは、子プロセスから親プロセスへ環境変数を引き継げない<BR/>
ためです。</DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:8604px; width:466px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text48_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:8610px; line-height:15px; white-space:nowrap">
REM&nbsp; 現在の時刻（ローカルタイム）<BR/>
"%batchlib_dir%\timedate2.exe" now_var=now &gt;_t.bat&amp; call _t.bat&amp; del _t.bat<BR/>
echo %now_var%</DIV>
<v:roundrect style="position:absolute; margin-left:190px; margin-top:8486px; width:56px; height:20px;" arcsize="0.500000" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text48_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:198px; margin-top:8489px; line-height:15px; white-space:nowrap">
未対応</DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:8666px; width:496px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text48_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:8672px; line-height:15px; white-space:nowrap">
REM&nbsp; タイムスタンプ・更新日時<BR/>
timedate2.exe t_var=update "C:\folder\file.txt" &gt;_t.bat&amp; call _t.bat&amp; del _t.bat<BR/>
echo %t_var%</DIV>
<DIV id="text48_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:22px; margin-top:8740px; line-height:15px; white-space:nowrap">
書式：</DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:8763px; width:352px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text48_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:8770px; line-height:13px; white-space:nowrap">
timedate2.exe [(環境変数名)=(コマンド)] [(ファイルパス)]</DIV>
<DIV id="text48_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:8158px; line-height:15px; white-space:nowrap">
<A href="#timedate2_exe">
→ timedate2.exe</A></DIV>
<DIV id="text48_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:151px; margin-top:8158px; line-height:15px; white-space:nowrap">
<A href="#timedate_exe">
→ timedate.exe</A></DIV>
<DIV id="text48_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:22px; margin-top:8521px; line-height:15px; white-space:nowrap">
現在の時刻やタイムスタンプを、環境変数に設定します。</DIV>
<DIV id="text48_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:8178px; line-height:15px; white-space:nowrap">
<A href="http://www.atmarkit.co.jp/fwin2k/win2ktips/419batchdate/batchdate.html" target="_blank">
→ バッチ・ファイル中で日付をファイル名に使用する − ＠IT (Web)</A></DIV>
<DIV id="text48_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:176px; margin-top:8250px; line-height:15px; white-space:nowrap">
<A href="#bat_path">
→ ファイル名、パス</A></DIV>
<DIV id="text48_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:8250px; line-height:15px; white-space:nowrap">
タイムスタンプは、%~t1</DIV>
<DIV id="text48_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:408px; margin-top:8266px; line-height:15px; white-space:nowrap">
<A href="#replace">
→ 置き換え</A></DIV>
<DIV id="text48_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:8266px; line-height:15px; white-space:nowrap">
ただし、/ （スラッシュ）や : （コロン）はフォルダー名に使えないので、</DIV>
<DIV id="text48_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:8227px; line-height:15px; white-space:nowrap">
%~t1</DIV>
<DIV id="text48_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:8282px; line-height:15px; white-space:nowrap">
地域やバージョン依存になるため、お勧めできないが、単に識別するためなら使える。</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:8329px; width:202px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text48_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:8335px; line-height:15px; white-space:nowrap">
:GetTimeStampFolderName<BR/>
&nbsp; &nbsp; set a_string=%~t1<BR/>
&nbsp; &nbsp; set a_string=%a_string:/=-%<BR/>
&nbsp; &nbsp; set a_string=%a_string::=;%<BR/>
&nbsp; &nbsp; set return_value=%a_string%<BR/>
goto :eof</DIV>
<DIV id="text48_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:8302px; line-height:15px; white-space:nowrap">
→ PowerShell - タイムスタンプを取得する (LastWriteTime)</DIV>

<v:line from="0,8023" to="557,8023"/>
<v:line from="557,8023" to="557,9093"/>
<v:line from="557,9093" to="0,9093"/>
<v:line from="0,9093" to="0,8023"/>

</PAGE>
 
<!-- page 49 --> 
<PAGE>
<A id="svgcats_vml_p49" class="to_tree" style="margin-top:9098px;" onClick="selectTreeElem( '49' );">←</A>
<A href="#svgcats_vml_p50" class="to_next_page" style="margin-top:9098px;">▼</A>
<A href="#svgcats_vml_p48" class="to_prev_page" style="margin-top:9098px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9109px; width:267px; height:171px;" fillcolor="white"/>
<DIV id="text49_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9126px; line-height:15px; white-space:nowrap">
<A name="math">
計算</A></DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:9178px; width:136px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text49_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:9184px; line-height:15px; white-space:nowrap">
set a=1<BR/>
set b=2<BR/>
set /A c = %a% + %b%<BR/>
echo %c%</DIV>
<DIV id="text49_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:9157px; line-height:15px; white-space:nowrap">
数値計算は、set /A でできます。</DIV>

<v:line from="0,9109" to="267,9109"/>
<v:line from="267,9109" to="267,9280"/>
<v:line from="267,9280" to="0,9280"/>
<v:line from="0,9280" to="0,9109"/>

</PAGE>
 
<!-- page 50 --> 
<PAGE>
<A id="svgcats_vml_p50" class="to_tree" style="margin-top:9285px;" onClick="selectTreeElem( '50' );">←</A>
<A href="#svgcats_vml_p51" class="to_next_page" style="margin-top:9285px;">▼</A>
<A href="#svgcats_vml_p49" class="to_prev_page" style="margin-top:9285px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9296px; width:518px; height:305px;" fillcolor="white"/>
<DIV id="text50_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:25px; margin-top:9318px; line-height:15px; white-space:nowrap">
<A name="set_proc">
プロセス間の環境変数の引継ぎ</A></DIV>
<DIV id="text50_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:25px; margin-top:9357px; line-height:15px; white-space:nowrap">
子プロセスから親プロセスへ環境変数を引き継げません。<BR/>
<BR/>
.exe ファイルを起動すると、新しくプロセスを作成し、起動をトリガしたプロセスの<BR/>
環境変数のコピーを、新しいプロセスの環境変数にします。<BR/>
<BR/>
PCの環境変数を変更しても、各プロセスに反映されません。<BR/>
<BR/>
バッチファイルに環境変数でデータを返すときは、call で呼び出すバッチファイルを<BR/>
作成します。</DIV>
<DIV id="text50_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:107px; margin-top:9477px; line-height:15px; white-space:nowrap">
<A href="dos_batch_04.html#call">
→ call &amp; 引数</A></DIV>
<DIV id="text50_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:25px; margin-top:9509px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_49.html#RunCmd">
RunBat (vbslib)</A></DIV>
<DIV id="text50_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:118px; margin-top:9509px; line-height:15px; white-space:nowrap">
でバッチファイルを実行する場合、環境変数を設定するバッチ</DIV>
<DIV id="text50_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:25px; margin-top:9523px; line-height:15px; white-space:nowrap">
ファイルを call する代わりに、バッチファイルの内容を、RunBat のパラメーターに<BR/>
ReadFile (vbslib) で埋め込むと、バッチファイルによって設定する環境変数を引き<BR/>
継ぐことができます。</DIV>

<v:line from="0,9296" to="518,9296"/>
<v:line from="518,9296" to="518,9601"/>
<v:line from="518,9601" to="0,9601"/>
<v:line from="0,9601" to="0,9296"/>

</PAGE>
 
<!-- page 51 --> 
<PAGE>
<A id="svgcats_vml_p51" class="to_tree" style="margin-top:9606px;" onClick="selectTreeElem( '51' );">←</A>
<A href="dos_batch_04.html#svgcats_vml_p52" class="to_next_page" style="margin-top:9606px;">▼</A>
<A href="#svgcats_vml_p50" class="to_prev_page" style="margin-top:9606px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9617px; width:549px; height:2465px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:39px; margin-top:9670px; width:478px; height:2380px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text51_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:9676px; line-height:15px; white-space:nowrap">
cmd.exe 環境変数を表示、設定、または削除します。<BR/>
<BR/>
SET [変数名=[文字列]]<BR/>
<BR/>
&nbsp; 変数名&nbsp; &nbsp;環境変数名を指定します。<BR/>
&nbsp; 文字列&nbsp; &nbsp;変数に割り当てる文字列を指定します。<BR/>
<BR/>
現在の環境変数を表示するには、パラメータを指定せずに SET と入力してください。<BR/>
<BR/>
コマンド拡張機能を有効にすると、SET は、次のように変更されます:<BR/>
<BR/>
等号や値を指定せずに、変数名だけを指定して SET コマンドを実行すると、<BR/>
SET コマンドに指定された名前に接頭辞が一致するすべての変数の値が<BR/>
表示されます。たとえば、<BR/>
<BR/>
&nbsp; &nbsp; SET P<BR/>
<BR/>
と入力すると、文字 'P' で始まるすべての変数が表示されます。<BR/>
<BR/>
変数名が現在の環境に見つからない場合は、SET コマンドは、ERRORLEVEL を<BR/>
1 に設定します。<BR/>
<BR/>
SET コマンドでは、変数の名前に等符号を使用することはできません。<BR/>
<BR/>
SET コマンドには、2 つの新しいスイッチが追加されています:<BR/>
<BR/>
&nbsp; &nbsp; SET /A 式<BR/>
&nbsp; &nbsp; SET /P 変数=[プロンプト文字列]<BR/>
<BR/>
/A スイッチは、等号の右側の文字列が、評価すべき数式であることを<BR/>
指定します。式の評価はごく単純で、次の操作がサポートされます。<BR/>
操作は、優先順位の高い順に示されています:<BR/>
<BR/>
&nbsp; &nbsp; ()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - グループ化<BR/>
&nbsp; &nbsp; ! ~ -&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- 単項演算子<BR/>
&nbsp; &nbsp; * / %&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- 算術演算子<BR/>
&nbsp; &nbsp; + -&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- 算術演算子<BR/>
&nbsp; &nbsp; &lt;&lt; &gt;&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- 論理シフト<BR/>
&nbsp; &nbsp; &amp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- ビット演算子 AND<BR/>
&nbsp; &nbsp; ^&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- ビット演算子排他的 OR<BR/>
&nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- ビット演算子 OR<BR/>
&nbsp; &nbsp; = *= /= %= += -=&nbsp; &nbsp;- 代入<BR/>
&nbsp; &nbsp; &nbsp; &amp;= ^= |= &lt;&lt;= &gt;&gt;=<BR/>
&nbsp; &nbsp; ,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- 式の区切り記号<BR/>
<BR/>
論理演算子またはモジュール演算子を使う場合は、式文字列を引用符で<BR/>
囲む必要があります。式内の数値以外の文字列は環境変数文字列として<BR/>
処理され、使用される前に数値に変換されます。指定された環境変数名が<BR/>
現在の環境で定義されていない場合は、値として 0 が使用されます。<BR/>
これにより、いくつもの % 記号を入力して値を取得しないでも、環境<BR/>
変数の値を算術演算に使うことができます。<BR/>
コマンド スクリプト外でコマンド ラインから SET /A を実行すると、式の<BR/>
最終的な値が表示されます。割り当て演算子を使うには、割り当て演算子<BR/>
の左側に環境変数名が必要です。数値は 10 進数ですが、接頭辞として 0x<BR/>
を付けると 16 進数、0 を付けると 8 進数になります。従って、0x12 は 18、<BR/>
あるいは 022 と同じです。8 進表記を使う場合は、注意してください。08 や<BR/>
09 は、8 と 9 が有効な 8 進数ではないため、有効な数値ではありません。<BR/>
<BR/>
<BR/>
/P はユーザーによって入力された入力行を変数の値として設定できるようにします。<BR/>
入力行を読み取る前に、指定されたプロンプト文字列を表示します。プロンプト文<BR/>
字列は空でもかまいません。<BR/>
<BR/>
環境変数の置換は、次のように拡張されます:<BR/>
<BR/>
&nbsp; &nbsp; %PATH:文字列1=文字列2%<BR/>
<BR/>
は、PATH 環境変数を展開し、その結果に含まれるすべての "文字列1" を<BR/>
"文字列2" に置き換えます。"文字列2" に空の文字列を指定すると、展開<BR/>
された出力からすべての "文字列1" を削除することができます。"文字列1"<BR/>
をアスタリスクで始め、展開された出力の先頭から、文字列1 の残りの部分<BR/>
が最初に現れるまでのすべてを一致させることもできます。<BR/>
<BR/>
また、展開の副文字列を指定することもできます。<BR/>
<BR/>
&nbsp; &nbsp; %PATH:~10,5%<BR/>
<BR/>
は、PATH 環境変数を展開し、展開結果の 11 番目 (オフセット 10) の文字<BR/>
から始まる 5 文字だけを使います。長さが指定されなかった場合は、変数の<BR/>
値の残りの長さを既定値とします。オフセットまたは長さのどちらかが負の値<BR/>
の場合、環境変数の値の長さに指定されたオフセットまたは長さを足してその<BR/>
数を使います。<BR/>
<BR/>
&nbsp; &nbsp; %PATH:~-10%<BR/>
<BR/>
は、パス変数の最後の10 文字が展開されます。<BR/>
<BR/>
&nbsp; &nbsp; %PATH:~0,-2%<BR/>
<BR/>
は最後の 2 文字以外のすべてが展開されます。<BR/>
<BR/>
最後に、遅延環境変数の展開が追加されました。このサポートは常に既定で<BR/>
無効になっていますが、CMD.EXE の /V: のコマンド ライン スイッチを使<BR/>
って有効または無効にできます。CMD /? を参照してください。<BR/>
<BR/>
遅延環境変数の展開は、実行時ではなく、テキスト行を読み取るときに展開<BR/>
されるという現在の制限を避けるために役立ちます。<BR/>
次の例は即時変数展開の問題を説明しています。<BR/>
<BR/>
&nbsp; &nbsp; set VAR=before<BR/>
&nbsp; &nbsp; if "%VAR%" == "before" (<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; set VAR=after;<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; if "%VAR%" == "after" @echo If you see this, it worked<BR/>
&nbsp; &nbsp; )<BR/>
<BR/>
この例は、論理的には IF 文が別の IF 文の本体に含まれる複合文なので、<BR/>
両方の IF 文の %VAR% が、最初の IF 文を読み取ったときに展開されます。<BR/>
このため、メッセージは決して表示されません。複合文の中の IF では "before"<BR/>
と "after" が比較され、決して等しくはなりません。同様に次の例も期待し<BR/>
たようには動作しません。<BR/>
<BR/>
&nbsp; &nbsp; set LIST=<BR/>
&nbsp; &nbsp; for %i in (*) do set LIST=%LIST% %i<BR/>
&nbsp; &nbsp; echo %LIST%<BR/>
<BR/>
この例では、現在のディレクトリのファイルの一覧は作成されず、代わりに最後<BR/>
に見つけられたファイルが LIST 変数に設定されます。これは %LIST% が FOR 文<BR/>
が読み取られるとき、一度だけ展開され、そのときは LIST 変数は、空だからです。<BR/>
つまり、実際に実行されている FOR ループは<BR/>
<BR/>
&nbsp; &nbsp; for %i in (*) do set LIST= %i<BR/>
<BR/>
で、LIST に最後にみつけられたファイルを設定し続けているだけです。<BR/>
<BR/>
遅延環境変数の展開では、実行時に環境変数を展開するために異なった文字<BR/>
(感嘆符)を使うことができます。遅延環境変数の展開が有効な場合、上記の<BR/>
例は次のように書くと意図したように動作します。<BR/>
<BR/>
&nbsp; &nbsp; set VAR=before<BR/>
&nbsp; &nbsp; if "%VAR%" == "before" (<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; set VAR=after<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; if "!VAR!" == "after" @echo If you see this, it worked<BR/>
&nbsp; &nbsp; )<BR/>
<BR/>
&nbsp; &nbsp; set LIST=<BR/>
&nbsp; &nbsp; for %i in (*) do set LIST=!LIST! %i<BR/>
&nbsp; &nbsp; echo %LIST%<BR/>
<BR/>
コマンド拡張機能が有効な場合、SET によって表示される変数の一覧には<BR/>
現れないいくつかの動的な環境変数があります。これらの変数の値は、変数の<BR/>
値が展開されるときに動的に計算されます。ユーザーがこれらの名前の変数を<BR/>
明示的に定義する場合、その定義は下記の動的な定義を無効にします。<BR/>
<BR/>
%CD% - 現在のディレクトリ文字列に展開します。<BR/>
<BR/>
%DATE% - DATE コマンドと同じフォーマットで現在の日付に展開します。<BR/>
<BR/>
%TIME% - TIME コマンドと同じフォーマットで現在の時刻に展開します。<BR/>
<BR/>
%RANDOM% - 0 から 32767 の間の任意の 10 進数に展開します<BR/>
<BR/>
%ERRORLEVEL% - 現在の ERRORLEVEL の値に展開します。<BR/>
<BR/>
%CMDEXTVERSION% - 現在のコマンド プロセッサ拡張機能のバージョン番号に<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;展開します。<BR/>
<BR/>
%CMDCMDLINE% - コマンド プロセッサを起動したオリジナル コマンドライン<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;に展開します。</DIV>
<DIV id="text51_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:23px; margin-top:9642px; line-height:15px; white-space:nowrap">
<A name="set_help">
set /?</A></DIV>

<v:line from="0,9617" to="549,9617"/>
<v:line from="549,9617" to="549,12082"/>
<v:line from="549,12082" to="0,12082"/>
<v:line from="0,12082" to="0,9617"/>

<DIV style="position:absolute; margin-left:0px; margin-top:12082px;">
<A id="svgcats_vml_p51" class="to_tree" onClick="selectTreeElem( '51' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:12082px;">
<A id="page_group_bottom" href="dos_batch_04.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
