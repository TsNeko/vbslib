<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>VBSメモ</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbs_memo.html?f1=vbs_memo.files/vbs_memo_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbs_memo.files/vbs_memo_04.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbs_memo.files/vbs_memo_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbs_memo.html?f1=vbs_memo.files/vbs_memo_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbs_memo.files/vbs_memo_04.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 50 --> 
<PAGE>
<A id="svgcats_vml_p50" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '50' );">←</A>
<A href="#svgcats_vml_p51" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbs_memo_03.html#svgcats_vml_p49" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbs_memo_03.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:532px; height:488px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:46px; margin-top:247px; width:451px; height:156px;" fillcolor="#DFDFDF" strokecolor="#000000" strokeweight="1pt"/>
<v:rect style="position:absolute; margin-left:48px; margin-top:48px; width:291px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text50_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:54px; line-height:15px; white-space:nowrap">
Set sh = WScript.CreateObject("WScript.Shell")<BR/>
sh.Run "sub.vbs param1",1,True<BR/>
Set sh = Nothing</DIV>
<DIV id="text50_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="start_wsh2">
別のスクリプトを呼び出す</A></DIV>
<v:line style="position:absolute;" from="244,81" to="291,90" strokecolor="#008040" strokeweight="2pt"/>
<v:oval style="position:absolute; margin-left:240px; margin-top:77px; width:7px; height:7px;" fillcolor="#008040" strokecolor="#008040" strokeweight="2pt"/>
<v:rect style="position:absolute; margin-left:283px; margin-top:82px; width:207px; height:17px;" fillcolor="#FFFFFF" strokecolor="#FFFFFF" strokeweight="1pt"/>
<DIV id="text50_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:287px; margin-top:84px; line-height:15px; white-space:nowrap">
終わるまで待つ（省略するとFALSE）</DIV>
<v:line style="position:absolute;" from="203,66" to="267,23" strokecolor="#008040" strokeweight="2pt"/>
<v:oval style="position:absolute; margin-left:199px; margin-top:62px; width:7px; height:7px;" fillcolor="#008040" strokecolor="#008040" strokeweight="2pt"/>
<v:rect style="position:absolute; margin-left:219px; margin-top:15px; width:167px; height:17px;" fillcolor="#FFFFFF" strokecolor="#FFFFFF" strokeweight="1pt"/>
<DIV id="text50_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:223px; margin-top:17px; line-height:15px; white-space:nowrap">
通常のウィンドウ（省略可能）</DIV>
<DIV id="text50_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:197px; line-height:14px; white-space:nowrap">
呼び出し先が異なるフォルダにあるとき、カレントフォルダは、<BR/>
呼び出し元のフォルダのままになっているので、呼び出し先で、<BR/>
次のようにしてカレントフォルダを移動するとよいでしょう。</DIV>
<DIV id="text50_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:61px; margin-top:256px; line-height:14px; white-space:nowrap">
Set fs = CreateObject("Scripting.FileSystemObject")<BR/>
Set sh = WScript.CreateObject("WScript.Shell")<BR/>
oldDir = sh.CurrentDirectory<BR/>
sh.CurrentDirectory = fs.GetParentFolderName( Wscript.ScriptFullName )</DIV>
<DIV id="text50_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:61px; margin-top:349px; line-height:14px; white-space:nowrap">
sh.CurrentDirectory = oldDir<BR/>
Set sh = Nothing<BR/>
Set fs = Nothing</DIV>
<DIV id="text50_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:61px; margin-top:323px; line-height:15px; white-space:nowrap">
（主な処理をここに書く）</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:431px; width:142px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text50_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:438px; line-height:13px; white-space:nowrap">
WScript.Sleep( 1000 )</DIV>
<v:rect style="position:absolute; margin-left:219px; margin-top:431px; width:88px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text50_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:227px; margin-top:438px; line-height:13px; white-space:nowrap">
WScript.Quit</DIV>
<DIV id="text50_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:165px; line-height:15px; white-space:nowrap">
（cscript.exe では、別のコマンドプロンプト・ウィンドウが表示されてしまいます。）</DIV>
<DIV id="text50_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:63px; margin-top:109px; line-height:15px; white-space:nowrap">
または</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:131px; width:400px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text50_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:138px; line-height:13px; white-space:nowrap">
WScript.CreateObject("WScript.Shell").Run "sub.vbs param1",,True</DIV>

<v:line from="0,0" to="532,0"/>
<v:line from="532,0" to="532,488"/>
<v:line from="532,488" to="0,488"/>
<v:line from="0,488" to="0,0"/>

</PAGE>
 
<!-- page 51 --> 
<PAGE>
<A id="svgcats_vml_p51" class="to_tree" style="margin-top:493px;" onClick="selectTreeElem( '51' );">←</A>
<A href="#svgcats_vml_p52" class="to_next_page" style="margin-top:493px;">▼</A>
<A href="#svgcats_vml_p50" class="to_prev_page" style="margin-top:493px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:504px; width:731px; height:330px;" fillcolor="white"/>
<DIV id="text51_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:521px; line-height:15px; white-space:nowrap">
<A name="run_with_opt">
別のスクリプトを、オプション付きで起動する</A></DIV>
<v:rect style="position:absolute; margin-left:31px; margin-top:583px; width:538px; height:220px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text51_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:39px; margin-top:589px; line-height:15px; white-space:nowrap">
RunWithOption&nbsp; "main.vbs", "/opt1"<BR/>
<BR/>
Sub&nbsp; RunWithOption( FName, Opt )<BR/>
&nbsp; Dim g_fs : Set&nbsp; g_fs = CreateObject( "Scripting.FileSystemObject" )<BR/>
&nbsp; Dim&nbsp; cmdline : cmdline = "cmd /K cscript.exe //nologo """+g_fs.GetParentFolderName( _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WScript.ScriptFullName)+"\" + FName + """ " + Opt<BR/>
&nbsp; For i=0 To WScript.Arguments.Count - 1<BR/>
&nbsp; &nbsp; If InStr( WScript.Arguments(i), " " ) = 0 Then _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmdline=cmdline+" "+WScript.Arguments(i) _<BR/>
&nbsp; &nbsp; Else&nbsp; cmdline=cmdline+" """+WScript.Arguments(i)+""""<BR/>
&nbsp; Next<BR/>
&nbsp; CreateObject("WScript.Shell").Run&nbsp; cmdline<BR/>
&nbsp; WScript.Quit&nbsp; 0<BR/>
End Sub</DIV>
<DIV id="text51_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:26px; margin-top:562px; line-height:15px; white-space:nowrap">
main_opt1.vbs</DIV>
<DIV id="text51_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:135px; margin-top:590px; line-height:13px; white-space:nowrap">
main.vbs</DIV>
<DIV id="text51_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:207px; margin-top:590px; line-height:13px; white-space:nowrap">
/opt1</DIV>

<v:line from="0,504" to="731,504"/>
<v:line from="731,504" to="731,834"/>
<v:line from="731,834" to="0,834"/>
<v:line from="0,834" to="0,504"/>

</PAGE>
 
<!-- page 52 --> 
<PAGE>
<A id="svgcats_vml_p52" class="to_tree" style="margin-top:839px;" onClick="selectTreeElem( '52' );">←</A>
<A href="#svgcats_vml_p53" class="to_next_page" style="margin-top:839px;">▼</A>
<A href="#svgcats_vml_p51" class="to_prev_page" style="margin-top:839px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:850px; width:593px; height:819px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:37px; margin-top:1292px; width:346px; height:89px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text52_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:1297px; line-height:16px; white-space:nowrap">
Option Explicit <BR/>
Set g_fs = CreateObject( "Scripting.FileSystemObject" )<BR/>
Set f = g_fs.OpenTextFile( "vbslib.vbs" )<BR/>
Execute f.ReadAll()<BR/>
f = Empty</DIV>
<DIV id="text52_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:19px; margin-top:1182px; line-height:15px; white-space:nowrap">
<A name="include">
別のスクリプトをインクルードする（Execute, ExecuteGlobal）</A></DIV>
<DIV id="text52_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:496px; margin-top:1550px; line-height:15px; white-space:nowrap">
(cache)</DIV>
<DIV id="text52_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:83px; margin-top:1550px; line-height:15px; white-space:nowrap">
<A href="http://www012.upp.so-net.ne.jp/scotchegg/VBScript/Execute.htm" target="_blank">
→ Deep Decryption - VBScript Tips - Execute とExecuteGlobal (Web)</A></DIV>
<DIV id="text52_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:83px; margin-top:1531px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/default.asp?url=/library/ja/script56/html/vsstmExecuteGlobal.asp" target="_blank">
→ ExecuteGlobal ステートメント (Web)</A></DIV>
<DIV id="text52_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:38px; margin-top:1397px; line-height:15px; white-space:nowrap">
インクルードしようとするスクリプトにエラーが発生すると、メインでエラーが発生したよう<BR/>
にエラーが出てしまいます。 エラーメッセージの行番号は 0 固定となります。</DIV>
<DIV id="text52_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:22px; margin-top:868px; line-height:15px; white-space:nowrap">
<A name="inc_wsf">
別のスクリプトをインクルードする（WSFファイル）</A></DIV>
<v:rect style="position:absolute; margin-left:36px; margin-top:911px; width:274px; height:105px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text52_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:44px; margin-top:916px; line-height:16px; white-space:nowrap">
&lt;job&gt;<BR/>
&lt;script language="vbscript" src="lib.vbs"/&gt;<BR/>
&lt;script language="vbscript"&gt;<BR/>
SubA<BR/>
&lt;/script&gt;<BR/>
&lt;/job&gt;</DIV>
<v:rect style="position:absolute; margin-left:331px; margin-top:911px; width:142px; height:57px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text52_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:339px; margin-top:916px; line-height:16px; white-space:nowrap">
Sub SubA<BR/>
&nbsp; WScript.Echo "SubA"<BR/>
End Sub</DIV>
<DIV id="text52_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:894px; line-height:15px; white-space:nowrap">
main.wsf</DIV>
<DIV id="text52_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:331px; margin-top:893px; line-height:15px; white-space:nowrap">
lib.vbs</DIV>
<DIV id="text52_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:1033px; line-height:15px; white-space:nowrap">
main.wsf を実行すると、lib.vbs の SubA を呼び出します。</DIV>
<DIV id="text52_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:44px; margin-top:1054px; line-height:15px; white-space:nowrap">
lib.vbs でエラーが発生すると、main.wsf でエラーが発生したようにエラーが出てしまいます。<BR/>
エラーメッセージの行番号は、lib.vbs の行番号を表していることがあります。</DIV>
<DIV id="text52_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:1092px; line-height:15px; white-space:nowrap">
スクリプト内から、インクルードするファイルを指定することはできません。<BR/>
（XML部分に静的に書く必要があります）</DIV>
<DIV id="text52_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:1216px; line-height:15px; white-space:nowrap">
プロシージャの中で Execute すると、グローバル変数ではなくなります。<BR/>
関数は定義されます。 すでに定義されている関数は上書きされます。<BR/>
クラスも定義されます。 すでに定義されているクラスがあるとエラーになります。<BR/>
（クラスは、インスタンスに影響するため上書きできません）</DIV>
<DIV id="text52_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:44px; margin-top:1130px; line-height:15px; white-space:nowrap">
Execute や、script src タグで WSF ファイルをインクルードすることはできません。</DIV>
<DIV id="text52_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:83px; margin-top:1583px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_48.html#include">
→ include (vbslib)</A></DIV>
<DIV id="text52_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:1445px; line-height:15px; white-space:nowrap">
Execute で定義した関数は、関数の直下から呼び出すときしか使えません。<BR/>
他の関数から呼び出すときに使えるようにしたいときは、ExecuteGlobal で定義してください。</DIV>
<DIV id="text52_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:1493px; line-height:15px; white-space:nowrap">
JScript では、</DIV>
<DIV id="text52_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:315px; margin-top:1493px; line-height:15px; white-space:nowrap">
(cache)</DIV>
<DIV id="text52_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:114px; margin-top:1493px; line-height:15px; white-space:nowrap">
<A href="http://www.vector.co.jp/soft/win95/prog/se405682.html" target="_blank">
→ Vector：ExecuteGlobal.JS (Web)</A></DIV>
<DIV id="text52_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:29px; margin-top:1583px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text52_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:29px; margin-top:1531px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text52_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:83px; margin-top:1602px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_21.html#CalculateVariables">
→ CalculateVariables (vbslib)</A></DIV>
<DIV id="text52_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:83px; margin-top:1621px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_09.html#Eval">
→ Eval</A></DIV>

<v:line from="0,850" to="593,850"/>
<v:line from="593,850" to="593,1669"/>
<v:line from="593,1669" to="0,1669"/>
<v:line from="0,1669" to="0,850"/>

</PAGE>
 
<!-- page 53 --> 
<PAGE>
<A id="svgcats_vml_p53" class="to_tree" style="margin-top:1674px;" onClick="selectTreeElem( '53' );">←</A>
<A href="#svgcats_vml_p54" class="to_next_page" style="margin-top:1674px;">▼</A>
<A href="#svgcats_vml_p52" class="to_prev_page" style="margin-top:1674px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1685px; width:659px; height:698px;" fillcolor="white"/>
<DIV id="text53_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1702px; line-height:15px; white-space:nowrap">
<A name="WSC">
別のスクリプトをインクルードする（WSCファイル）</A></DIV>
<DIV id="text53_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1737px; line-height:15px; white-space:nowrap">
Windows Script Component(*.wsc) ファイルに記述されたスクリプトは、COM オブジェクトになれます。<BR/>
COM オブジェクトなので、VBScript や JScript などから呼び出すことができます。<BR/>
WSC ファイルには、VBScript と JScript を混在させることができます。<BR/>
WSC ファイルによるCOM オブジェクトのホストは、Scrobj.dll です。</DIV>
<DIV id="text53_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:70px; margin-top:2316px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/cc392140.aspx" target="_blank">
→ スクリプト コンポーネント チュートリアル - MSDN (Web)</A></DIV>
<DIV id="text53_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:70px; margin-top:2336px; line-height:15px; white-space:nowrap">
<A href="http://www.atmarkit.co.jp/fwin2k/win2ktips/475scriptlet/scriptlet.html" target="_blank">
→ ＠IT：Windows TIPS -- Tips：よく利用するジョブをスクリプトレットでコンポーネント化する (Web)</A></DIV>
<DIV id="text53_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2316px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text53_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:2249px; line-height:15px; white-space:nowrap">
*.wsc ファイルの中では、WScript オブジェクトは、あらかじめ用意されていません。<BR/>
グローバル変数 g_Name は、GetObject で取得した複数のオブジェクトのそれぞれに、異なる変数領域<BR/>
を持ちます。</DIV>
<v:rect style="position:absolute; margin-left:35px; margin-top:1868px; width:460px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text53_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:43px; margin-top:1874px; line-height:15px; white-space:nowrap">
Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
Set obj = GetObject( "Script:"+ g_fs.GetAbsolutePathName( "ClassA.wsc" ) )<BR/>
obj.MethodByJS&nbsp; &nbsp;WScript, "ABC"<BR/>
WScript.Echo&nbsp; obj.Name</DIV>
<DIV id="text53_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1847px; line-height:15px; white-space:nowrap">
*.wsc を使うサンプル：</DIV>
<v:rect style="position:absolute; margin-left:35px; margin-top:1978px; width:592px; height:265px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text53_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:43px; margin-top:1984px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0"?&gt;<BR/>
&lt;?component error="true" debug="false"?&gt;<BR/>
&lt;component&gt;<BR/>
&lt;public&gt;<BR/>
&nbsp; &lt;method name="MethodByJS"&gt;&lt;PARAMETER name="Param1"/&gt;&lt;PARAMETER name="Param2"/&gt;&lt;/method&gt;<BR/>
&nbsp; &lt;property name="Name" internalName="g_Name"/&gt;<BR/>
&nbsp; &lt;property name="Prop2"&gt;&lt;get internalName="GetProp2"/&gt;&lt;put internalName="PutProp2"/&gt;&lt;/property&gt;<BR/>
&nbsp; &lt;event name="namechanged"/&gt;<BR/>
&lt;/public&gt;<BR/>
&lt;script language="JScript"&gt;&lt;![CDATA[<BR/>
var&nbsp; g_Name = "ABC";<BR/>
function&nbsp; MethodByJS( Param1, Param2 )<BR/>
{<BR/>
&nbsp; Param1.Echo( "MethodByVBS&nbsp; "+ Param2 );<BR/>
}<BR/>
]]&gt;&lt;/script&gt;<BR/>
&lt;/component&gt;</DIV>
<DIV id="text53_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1956px; line-height:15px; white-space:nowrap">
*.wsc ファイルのサンプル：</DIV>
<DIV id="text53_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:339px; margin-top:1702px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/cc428163.aspx" target="_blank">
(Web)</A></DIV>
<DIV id="text53_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:175px; margin-top:1847px; line-height:15px; white-space:nowrap">
→ wsc_sample.zip</DIV>
<DIV id="text53_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1810px; line-height:15px; white-space:nowrap">
WSC ファイルの中をデバッグするときは、?component debug を true にしてください。</DIV>

<v:line from="0,1685" to="659,1685"/>
<v:line from="659,1685" to="659,2383"/>
<v:line from="659,2383" to="0,2383"/>
<v:line from="0,2383" to="0,1685"/>

</PAGE>
 
<!-- page 54 --> 
<PAGE>
<A id="svgcats_vml_p54" class="to_tree" style="margin-top:2388px;" onClick="selectTreeElem( '54' );">←</A>
<A href="#svgcats_vml_p55" class="to_next_page" style="margin-top:2388px;">▼</A>
<A href="#svgcats_vml_p53" class="to_prev_page" style="margin-top:2388px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2399px; width:430px; height:242px;" fillcolor="white"/>
<DIV id="text54_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:20px; margin-top:2420px; line-height:15px; white-space:nowrap">
<A name="envi">
環境変数を取得する</A></DIV>
<v:rect style="position:absolute; margin-left:34px; margin-top:2457px; width:364px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text54_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:42px; margin-top:2463px; line-height:15px; white-space:nowrap">
Set g_sh = CreateObject( "WScript.Shell" )<BR/>
root = g_sh.ExpandEnvironmentStrings( "%windir%\System" ) </DIV>
<DIV id="text54_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:2520px; line-height:15px; white-space:nowrap">
windir が定義されていないときは、%windir% のままになります</DIV>
<DIV id="text54_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:81px; margin-top:2557px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_47.html#env">
→ env (vbslib)</A></DIV>
<DIV id="text54_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:81px; margin-top:2575px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_02.html#Environment_Shell">
→ Environment (Shell)</A></DIV>
<DIV id="text54_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:34px; margin-top:2557px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text54_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:81px; margin-top:2593px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_02.html#Shell_ExpandEnvironmentStrings">
→ ExpandEnvironmentStrings (Shell)</A></DIV>

<v:line from="0,2399" to="430,2399"/>
<v:line from="430,2399" to="430,2641"/>
<v:line from="430,2641" to="0,2641"/>
<v:line from="0,2641" to="0,2399"/>

</PAGE>
 
<!-- page 55 --> 
<PAGE>
<A id="svgcats_vml_p55" class="to_tree" style="margin-top:2646px;" onClick="selectTreeElem( '55' );">←</A>
<A href="#svgcats_vml_p56" class="to_next_page" style="margin-top:2646px;">▼</A>
<A href="#svgcats_vml_p54" class="to_prev_page" style="margin-top:2646px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2657px; width:633px; height:462px;" fillcolor="white"/>
<v:image src="55/image01.png"
   style="position:absolute; margin-left:4px; margin-top:2661px; width:47px; height:47px;"/>
<DIV id="text55_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:60px; margin-top:2677px; line-height:15px; white-space:nowrap">
<A name="task">
タスク （Windows でのスケジュール実行）</A></DIV>
<DIV id="text55_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:2988px; line-height:15px; white-space:nowrap">
<A href="#new_sched_xp">
→ 新しくスケジュールを作成する (Windows XP)</A></DIV>
<DIV id="text55_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:2762px; line-height:15px; white-space:nowrap">
Windows は、定期的に任意のバッチ処理を実行するようにスケジュールすることができます。</DIV>
<DIV id="text55_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:2801px; line-height:15px; white-space:nowrap">
指定の日時に一度だけ行ったり、定期的に何度も行ったりできます。<BR/>
スリープやログオフしていても開始可能です。<BR/>
実行するユーザがログオンしていないと、ウィンドウは表示されません。（ユーザの切り替えで<BR/>
裏で動いているときは表示されます）<BR/>
特定の処理が終わってから、次の処理をすぐに実行するときは、バッチファイルなどで制御します。</DIV>
<DIV id="text55_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:2801px; line-height:15px; white-space:nowrap">
・<BR/>
・<BR/>
・<BR/>
<BR/>
・</DIV>
<DIV id="text55_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:27px; margin-top:2927px; line-height:15px; white-space:nowrap">
バッチファイルなどから実行できることを確認してから、タスクを作成してください。</DIV>
<DIV id="text55_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:2944px; line-height:15px; white-space:nowrap">
処理を行うプログラムが、バッチファイルなどから処理を開始できるようになっている必要があります。<BR/>
別のユーザがログオン中でも正しく動作するには、プログラムの終了まで、実行する必要があります。</DIV>
<DIV id="text55_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:17px; margin-top:2733px; line-height:15px; white-space:nowrap">
できること</DIV>
<DIV id="text55_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:17px; margin-top:2900px; line-height:15px; white-space:nowrap">
設定方法</DIV>
<DIV id="text55_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:3009px; line-height:15px; white-space:nowrap">
<A href="#new_sched_vista">
→ 新しくスケジュールを作成する (Windows Vista/7)</A></DIV>
<DIV id="text55_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:17px; margin-top:3047px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text55_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:3071px; line-height:15px; white-space:nowrap">
→ TaskScheduler フォルダー (vbslib)</DIV>

<v:line from="0,2657" to="633,2657"/>
<v:line from="633,2657" to="633,3119"/>
<v:line from="633,3119" to="0,3119"/>
<v:line from="0,3119" to="0,2657"/>

</PAGE>
 
<!-- page 56 --> 
<PAGE>
<A id="svgcats_vml_p56" class="to_tree" style="margin-top:3124px;" onClick="selectTreeElem( '56' );">←</A>
<A href="#svgcats_vml_p57" class="to_next_page" style="margin-top:3124px;">▼</A>
<A href="#svgcats_vml_p55" class="to_prev_page" style="margin-top:3124px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3135px; width:534px; height:1703px;" fillcolor="white"/>
<v:image src="56/image01.png"
   style="position:absolute; margin-left:42px; margin-top:3404px; width:179px; height:89px;"/>
<v:image src="56/image02.png"
   style="position:absolute; margin-left:35px; margin-top:3544px; width:330px; height:163px;"/>
<v:image src="56/image03.png"
   style="position:absolute; margin-left:36px; margin-top:3757px; width:320px; height:191px;"/>
<v:image src="56/image04.png"
   style="position:absolute; margin-left:28px; margin-top:4481px; width:434px; height:319px;"/>
<v:image src="56/image05.png"
   style="position:absolute; margin-left:89px; margin-top:4164px; width:47px; height:17px;"/>
<v:image src="56/image06.png"
   style="position:absolute; margin-left:36px; margin-top:4024px; width:316px; height:88px;"/>
<v:image src="56/image07.png"
   style="position:absolute; margin-left:37px; margin-top:4399px; width:192px; height:17px;"/>
<v:oval style="position:absolute; margin-left:31px; margin-top:4392px; width:35px; height:31px;" fillcolor="#FFFFFF" strokecolor="#FF0000" strokeweight="2pt">
<v:fill opacity="0.00"/>
</v:oval>
<v:oval style="position:absolute; margin-left:39px; margin-top:4760px; width:35px; height:31px;" fillcolor="#FFFFFF" strokecolor="#FF0000" strokeweight="2pt">
<v:fill opacity="0.00"/>
</v:oval>
<DIV id="text56_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3152px; line-height:15px; white-space:nowrap">
<A name="new_sched_xp">
新しくスケジュールを作成する (Windows XP)</A></DIV>
<DIV id="text56_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:3375px; line-height:15px; white-space:nowrap">
[ コントロール パネル | タスク ］ で [ タスクの追加 ] をダブルクリックします。</DIV>
<DIV id="text56_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:28px; margin-top:3518px; line-height:15px; white-space:nowrap">
[ 参照 ] で、処理内容を示す、バッチファイルやスクリプトファイルなどを指定します。</DIV>
<DIV id="text56_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:147px; margin-top:3837px; line-height:15px; white-space:nowrap">
毎日、平日、n日間隔</DIV>
<DIV id="text56_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:22px; margin-top:3732px; line-height:15px; white-space:nowrap">
期間の単位を指定します。 （この次で、時刻や曜日などを指定します）</DIV>
<DIV id="text56_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:147px; margin-top:3855px; line-height:15px; white-space:nowrap">
曜日指定、n週間隔</DIV>
<DIV id="text56_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:147px; margin-top:3873px; line-height:15px; white-space:nowrap">
毎月n日、第n m曜日</DIV>
<DIV id="text56_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:25px; margin-top:4143px; line-height:15px; white-space:nowrap">
時計がついたアイコンが、タスクに追加されます。</DIV>
<DIV id="text56_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:25px; margin-top:4263px; line-height:15px; white-space:nowrap">
アイコンを右クリックし [ プロパティ ] で、さらに詳細を設定できます。</DIV>
<DIV id="text56_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:20px; margin-top:3971px; line-height:15px; white-space:nowrap">
プログラムを実行するユーザを指定します。<BR/>
特定のユーザでしか処理ができないということでなければ、<BR/>
普段使っているユーザで構いません。</DIV>
<DIV id="text56_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:3195px; line-height:15px; white-space:nowrap">
処理を実行するバッチファイルやスクリプトファイルをあらかじめ作っておきます。<BR/>
指定した時間になると、ダブルクリックしたときと同じ動きをします。</DIV>
<DIV id="text56_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:3252px; line-height:15px; white-space:nowrap">
新規タスク・ウィザードは、次の設定を行います。</DIV>
<DIV id="text56_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:83px; margin-top:3281px; line-height:15px; white-space:nowrap">
処理を実行するバッチファイルなど<BR/>
実行する間隔（1回だけも可能）<BR/>
開始時刻<BR/>
実行するユーザ（通常は、普段使っているユーザでよい）</DIV>
<DIV id="text56_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:70px; margin-top:3281px; line-height:15px; white-space:nowrap">
・<BR/>
・<BR/>
・<BR/>
・</DIV>
<DIV id="text56_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:25px; margin-top:4323px; line-height:15px; white-space:nowrap">
スリープ状態やバッテリー状態でも実行するときは、「電源の管理」の設定が必要です。</DIV>
<DIV id="text56_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:63px; margin-top:4200px; line-height:15px; white-space:nowrap">
一覧には、ユーザ本人が作成したタスクしか表示されませんが、<BR/>
ログオフ状態のユーザが作成したタスクも実行されます。</DIV>
<DIV id="text56_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:374px; margin-top:4057px; line-height:15px; white-space:nowrap">
自分でも<BR/>
パスワードの<BR/>
入力が必要です</DIV>
<DIV id="text56_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:25px; margin-top:4298px; line-height:15px; white-space:nowrap">
パラメータの指定は、ウィザードでは行えません。[ プロパティ ] で設定してください。</DIV>
<DIV id="text56_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:25px; margin-top:4371px; line-height:15px; white-space:nowrap">
[ タスク ] タブ</DIV>
<DIV id="text56_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:25px; margin-top:4454px; line-height:15px; white-space:nowrap">
[ 設定 ] タブ</DIV>

<v:line from="0,3135" to="534,3135"/>
<v:line from="534,3135" to="534,4838"/>
<v:line from="534,4838" to="0,4838"/>
<v:line from="0,4838" to="0,3135"/>

</PAGE>
 
<!-- page 57 --> 
<PAGE>
<A id="svgcats_vml_p57" class="to_tree" style="margin-top:4843px;" onClick="selectTreeElem( '57' );">←</A>
<A href="#svgcats_vml_p58" class="to_next_page" style="margin-top:4843px;">▼</A>
<A href="#svgcats_vml_p56" class="to_prev_page" style="margin-top:4843px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4854px; width:648px; height:1072px;" fillcolor="white"/>
<v:image src="57/image01.jpg"
   style="position:absolute; margin-left:127px; margin-top:5044px; width:373px; height:215px;"/>
<DIV id="text57_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4871px; line-height:15px; white-space:nowrap">
<A name="new_sched_vista">
新しくスケジュールを作成する (Windows Vista/7)</A></DIV>
<DIV id="text57_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:41px; margin-top:5379px; line-height:15px; white-space:nowrap">
Windows7 のタスクが起動する条件（時刻など）になったとき、PC がスリープ状態なら、<BR/>
スリープから復帰した直後にタスクが起動します。</DIV>
<DIV id="text57_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:41px; margin-top:5427px; line-height:15px; white-space:nowrap">
タスクの [ 条件 | タスクを実行するためにスリープを解除する] にチェック入れてあれば、<BR/>
30秒前に Sleep 状態から復帰して、タスクが実行できます。</DIV>
<DIV id="text57_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:41px; margin-top:5578px; line-height:15px; white-space:nowrap">
『半スリープ状態への入り方』<BR/>
スリープ状態のときに、StationTV（地デジ・アプリ） の録画時間の 5分前になると、半スリープ状態に<BR/>
なります。 予約録画中にスリープに入っても、半スリープ状態になります。<BR/>
半スリープ状態では、画面は省電力モードになりますが、CPU などは通常通り動きます。<BR/>
このため、地デジの録画ができます。<BR/>
StationTV [ 共通設定 | 予約録画終了後処理 ] を [ 待機モード ] にすると、録画が終了したら、<BR/>
画面が表示された状態での半スリープ状態になります。<BR/>
<BR/>
『半スリープ状態の特徴』<BR/>
CPU などは通常通り動きます。<BR/>
音声出力は、ミュート（無音）になります。<BR/>
SetSuspendState を呼び出しても、スリープに入りません。<BR/>
shutdown コマンドによる PowerOff はできます。<BR/>
<BR/>
『半スリープ状態からの復帰』<BR/>
半スリープ状態から通常状態に復帰するには、マウスを動かすなどの操作をします。<BR/>
自動的に復帰させようと、SetCursorPos Win32 API を使ってカーソルを動かしても、復帰しません。<BR/>
自動的に半スリープ状態から復帰するには、スクリーンセーバーを起動します。 Windows の設定で、<BR/>
スクリーンセーバーの起動時間を設定してください。 ただし、WSH で任意のプロセスを起動すると、<BR/>
スクリーンセーバーが起動するまでの時間を測っているタイマーがリセットされるので注意してください。<BR/>
また、scr ファイルを直接起動した場合は、半スリープ状態から復帰しません。 </DIV>
<DIV id="text57_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5548px; line-height:15px; white-space:nowrap">
<A name="half_sleep">
半スリープ状態（Windows7）</A></DIV>
<DIV id="text57_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5348px; line-height:15px; white-space:nowrap">
タスクが起動する条件になったときに、PC がスリープ状態のとき</DIV>
<DIV id="text57_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:41px; margin-top:5475px; line-height:15px; white-space:nowrap">
半スリープ状態では、半スリープ状態のまま、タスクが起動できます。<BR/>
ただし、Sleep 状態から通常状態に復帰しません。</DIV>
<DIV id="text57_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:4914px; line-height:15px; white-space:nowrap">
処理を実行するバッチファイルやスクリプトファイルをあらかじめ作っておきます。<BR/>
指定した時間になると、ダブルクリックしたときと同じ動きをします。</DIV>
<DIV id="text57_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:4959px; line-height:15px; white-space:nowrap">
スタート・メニューから、「タスク・スケジューラ」 を検索して起動します。<BR/>
右のペインから、「タスクの作成」 を押します。<BR/>
[ トリガー ] に開始時刻やイベントを入力します。<BR/>
[ 操作 ] に、実行するコマンドを入力します。</DIV>
<v:line style="position:absolute;" from="311,5106" to="369,5024" strokecolor="#008000" strokeweight="2pt"/>
<v:oval style="position:absolute; margin-left:307px; margin-top:5102px; width:7px; height:7px;" fillcolor="#008000" strokecolor="#008000" strokeweight="2pt"/>
<A>
<v:roundrect style="position:absolute; margin-left:317px; margin-top:5007px; width:265px; height:26px;" arcsize="0.384615" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text57_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:333px; margin-top:5013px; line-height:15px; white-space:nowrap">
<A name="label-1">
タスクの一覧 （ダブルクリックで編集開始）</A></DIV>
<v:line style="position:absolute;" from="145,5109" to="72,5059" strokecolor="#008000" strokeweight="2pt"/>
<v:oval style="position:absolute; margin-left:141px; margin-top:5105px; width:7px; height:7px;" fillcolor="#008000" strokecolor="#008000" strokeweight="2pt"/>
<A>
<v:roundrect style="position:absolute; margin-left:23px; margin-top:5040px; width:93px; height:41px;" arcsize="0.243902" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text57_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5046px; line-height:15px; white-space:nowrap">
<A name="label-2">
はじめに<BR/>
ここをクリック</A></DIV>
<v:line style="position:absolute;" from="266,5196" to="312,5288" strokecolor="#008000" strokeweight="2pt"/>
<v:oval style="position:absolute; margin-left:262px; margin-top:5192px; width:7px; height:7px;" fillcolor="#008000" strokecolor="#008000" strokeweight="2pt"/>
<A>
<v:roundrect style="position:absolute; margin-left:250px; margin-top:5276px; width:272px; height:26px;" arcsize="0.384615" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text57_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:266px; margin-top:5282px; line-height:15px; white-space:nowrap">
<A name="label-3">
選択中のタスクの内容（編集はできません）</A></DIV>
<v:line style="position:absolute;" from="443,5128" to="520,5094" strokecolor="#008000" strokeweight="2pt"/>
<v:oval style="position:absolute; margin-left:439px; margin-top:5124px; width:7px; height:7px;" fillcolor="#008000" strokecolor="#008000" strokeweight="2pt"/>
<A>
<v:roundrect style="position:absolute; margin-left:510px; margin-top:5077px; width:72px; height:26px;" arcsize="0.384615" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text57_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:520px; margin-top:5083px; line-height:15px; white-space:nowrap">
<A name="label-4">
新規作成</A></DIV>
<DIV id="text57_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:245px; margin-top:5551px; line-height:12px; white-space:nowrap">
<A name="label-4">
半スリープ状態は、Windowsの用語ではありません</A></DIV>

<v:line from="0,4854" to="648,4854"/>
<v:line from="648,4854" to="648,5926"/>
<v:line from="648,5926" to="0,5926"/>
<v:line from="0,5926" to="0,4854"/>

</PAGE>
 
<!-- page 58 --> 
<PAGE>
<A id="svgcats_vml_p58" class="to_tree" style="margin-top:5931px;" onClick="selectTreeElem( '58' );">←</A>
<A href="#svgcats_vml_p59" class="to_next_page" style="margin-top:5931px;">▼</A>
<A href="#svgcats_vml_p57" class="to_prev_page" style="margin-top:5931px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5942px; width:572px; height:746px;" fillcolor="white"/>
<DIV id="text58_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:23px; margin-top:5959px; line-height:15px; white-space:nowrap">
<A name="stdinout">
標準入出力、リダイレクト、エラーレベル</A></DIV>
<A href="http://www.atmarkit.co.jp/fwin2k/operation/wsh05/wsh05_01.html" target="_blank">
<v:rect style="position:absolute; margin-left:323px; margin-top:5957px; width:217px; height:18px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text58_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:329px; margin-top:5959px; line-height:15px; white-space:nowrap">
<A href="http://www.atmarkit.co.jp/fwin2k/operation/wsh05/wsh05_01.html" target="_blank">
＠IT：WshShellオブジェクトの詳細（1）</A></DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:6294px; width:196px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text58_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:6301px; line-height:13px; white-space:nowrap">
ex.StdIn, ex.StdOut, ex.StdErr</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:6113px; width:466px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text58_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:6119px; line-height:15px; white-space:nowrap">
Set g_sh = WScript.CreateObject( "WScript.Shell" )<BR/>
Set ex = g_sh.Exec( "ipconfig.exe" )&nbsp; ' ipconfig を実行 *******<BR/>
Do While ex.Status = 0 : WScript.Sleep 100 : Loop<BR/>
Do Until ex.StdOut.AtEndOfStream : WScript.Echo ex.StdOut.ReadLine() : Loop<BR/>
Do Until ex.StdErr.AtEndOfStream : WScript.Echo ex.StdErr.ReadLine() : Loop<BR/>
ex.ExitCode<BR/>
ex = Empty</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:6414px; width:460px; height:205px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text58_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:6420px; line-height:15px; white-space:nowrap">
Dim&nbsp; ex, f<BR/>
Set g_sh = WScript.CreateObject( "WScript.Shell" )<BR/>
Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
<BR/>
Set ex = g_sh.Exec( "ipconfig" )<BR/>
Do While ex.Status = 0 : WScript.Sleep 100 : Loop<BR/>
<BR/>
Set f = g_fs.OpenTextFile( "C:\result.txt", 8, True, False )&nbsp; '// 8=append<BR/>
Do Until ex.StdOut.AtEndOfStream : f.WriteLine ex.StdOut.ReadLine() : Loop<BR/>
Do Until ex.StdErr.AtEndOfStream : f.WriteLine ex.StdErr.ReadLine() : Loop<BR/>
<BR/>
ex = Empty<BR/>
f = Empty</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:6250px; width:220px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text58_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:6256px; line-height:15px; white-space:nowrap">
ex.Status&nbsp; &nbsp;' 0=実行中, 1=終了<BR/>
ex.ExitCode ' 終了コード（返り値）</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:6340px; width:262px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text58_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:6347px; line-height:13px; white-space:nowrap">
WScript.StdErr.Write "pass" &amp; vbCR &amp; vbLF</DIV>
<DIV id="text58_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:387px; margin-top:6087px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/script56/html/wslrfExecMethod.asp" target="_blank">
→ Exec メソッド (Web)</A></DIV>
<DIV id="text58_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:39px; margin-top:6392px; line-height:15px; white-space:nowrap">
ファイルに追記出力する</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:6001px; width:394px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text58_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:6007px; line-height:15px; white-space:nowrap">
Set g_sh = WScript.CreateObject( "WScript.Shell" )<BR/>
Set ex = g_sh.Exec( "ipconfig.exe" )&nbsp; ' ipconfig を実行 *******<BR/>
Do While ex.Status = 0 : WScript.Sleep 100 : Loop<BR/>
text = ex.StdOut.ReadAll()<BR/>
ex = Empty</DIV>

<v:line from="0,5942" to="572,5942"/>
<v:line from="572,5942" to="572,6688"/>
<v:line from="572,6688" to="0,6688"/>
<v:line from="0,6688" to="0,5942"/>

</PAGE>
 
<!-- page 59 --> 
<PAGE>
<A id="svgcats_vml_p59" class="to_tree" style="margin-top:6693px;" onClick="selectTreeElem( '59' );">←</A>
<A href="#svgcats_vml_p60" class="to_next_page" style="margin-top:6693px;">▼</A>
<A href="#svgcats_vml_p58" class="to_prev_page" style="margin-top:6693px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6704px; width:619px; height:414px;" fillcolor="white"/>
<DIV id="text59_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6721px; line-height:15px; white-space:nowrap">
<A name="fie">
ファイル操作</A></DIV>
<DIV id="text59_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:35px; margin-top:6815px; line-height:15px; white-space:nowrap">
<A href="#FileSystemObject_CopyFile">
→ ファイルをコピーする</A></DIV>
<DIV id="text59_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:201px; margin-top:6815px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#folder_copy">
→ フォルダをコピーする</A></DIV>
<DIV id="text59_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:369px; margin-top:6815px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#copy_new">
→ 新しいファイルのみコピーする</A></DIV>
<DIV id="text59_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:35px; margin-top:6921px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#file_exist">
→ ファイルの存在</A></DIV>
<DIV id="text59_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:35px; margin-top:6947px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#file_list">
→ ファイル一覧</A></DIV>
<DIV id="text59_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:155px; margin-top:6947px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#folder_list">
→ サブフォルダ一覧 （１段下のみ）</A></DIV>
<DIV id="text59_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:376px; margin-top:6947px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#files_list">
→ サブフォルダ一覧 （再帰、ネスト）</A></DIV>
<DIV id="text59_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:183px; margin-top:6869px; line-height:15px; white-space:nowrap">
<A href="#ren">
→ ファイル名を変える</A></DIV>
<DIV id="text59_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; font-weight: bold; margin-left:35px; margin-top:6973px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#fileaxs">
→ ファイル内アクセス（テキスト）</A></DIV>
<DIV id="text59_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:35px; margin-top:7045px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#CreateFolder">
→ CreateFolder</A></DIV>
<DIV id="text59_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:155px; margin-top:7045px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#DeleteFolderR">
→ DeleteFolderR</A></DIV>
<DIV id="text59_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:253px; margin-top:6973px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#txt_join">
→ テキストファイルを結合する</A></DIV>
<DIV id="text59_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; font-weight: bold; margin-left:35px; margin-top:6869px; line-height:15px; white-space:nowrap">
<A href="#fname">
→ ファイル名、パス</A></DIV>
<DIV id="text59_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; font-weight: bold; margin-left:35px; margin-top:6766px; line-height:15px; white-space:nowrap">
<A href="#FileSystemObject">
→ FileSystemObject</A></DIV>
<DIV id="text59_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; font-weight: bold; margin-left:201px; margin-top:6766px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#file_obj">
→ File オブジェクト</A></DIV>
<DIV id="text59_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:35px; margin-top:6895px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#file_obj">
→ ファイルの属性や更新日時</A></DIV>
<DIV id="text59_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:35px; margin-top:7012px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_02.html#WScript_Shell_CurrentDirectory">
→ カレント・ディレクトリ</A></DIV>
<DIV id="text59_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:175px; margin-top:6921px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#open_not_exist">
→ 存在しないファイルを開く</A></DIV>
<DIV id="text59_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:201px; margin-top:7012px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_02.html#WScript_Shell_SpecialFolders">
→ 特殊フォルダ</A></DIV>
<DIV id="text59_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:435px; margin-top:6973px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#skiplines">
→ 指定した行へ移動する</A></DIV>
<DIV id="text59_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:35px; margin-top:7070px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_03.html#drop_vbs">
→ VBSファイルにドラッグ＆ドロップ</A></DIV>
<DIV id="text59_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:35px; margin-top:6835px; line-height:15px; white-space:nowrap">
<A name="create_shcut" href="vbs_memo_02.html#CreateShortcut_Shell">
→ ショートカットを作成する</A></DIV>

<v:line from="0,6704" to="619,6704"/>
<v:line from="619,6704" to="619,7118"/>
<v:line from="619,7118" to="0,7118"/>
<v:line from="0,7118" to="0,6704"/>

</PAGE>
 
<!-- page 60 --> 
<PAGE>
<A id="svgcats_vml_p60" class="to_tree" style="margin-top:7123px;" onClick="selectTreeElem( '60' );">←</A>
<A href="#svgcats_vml_p61" class="to_next_page" style="margin-top:7123px;">▼</A>
<A href="#svgcats_vml_p59" class="to_prev_page" style="margin-top:7123px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7134px; width:552px; height:2025px;" fillcolor="white"/>
<DIV id="text60_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7151px; line-height:15px; white-space:nowrap">
<A name="fname">
ファイル名、パス</A></DIV>
<DIV id="text60_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8850px; line-height:15px; white-space:nowrap">
<A name="ren">
ファイルの名前を変える</A></DIV>
<v:rect style="position:absolute; margin-left:51px; margin-top:8907px; width:394px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text60_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:59px; margin-top:8913px; line-height:15px; white-space:nowrap">
Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
Set f = g_fs.GetFile( "c:\a.txt" )<BR/>
f.Name = "b.ini"</DIV>
<v:rect style="position:absolute; margin-left:51px; margin-top:8336px; width:466px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text60_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:59px; margin-top:8342px; line-height:15px; white-space:nowrap">
Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
s = g_fs.GetParentFolderName( "c:\sub1\sub2\file.txt" )&nbsp; ' s="c:\sub1\sub2"<BR/>
s = g_fs.GetFileName( "c:\sub1\file.txt" )&nbsp; ' s="file.txt"<BR/>
s = g_fs.GetDriveName( "c:\sub1\file.txt" )&nbsp; ' s="c:"<BR/>
s = g_fs.GetBaseName( "c:\sub1\file.txt" )&nbsp; ' s="file"<BR/>
s = g_fs.GetExtensionName( "c:\sub1\file.txt" )&nbsp; ' s="txt"<BR/>
s = g_fs.BuildPath( "c:\sub1", "file.txt" )&nbsp; ' s="c:\sub1\file.txt"</DIV>
<DIV id="text60_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8261px; line-height:15px; white-space:nowrap">
<A name="file_path">
ファイルパス文字列の操作関数</A></DIV>
<DIV id="text60_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:71px; margin-top:8966px; line-height:15px; white-space:nowrap">
C:\a.txt をb.ini に変えています。</DIV>
<DIV id="text60_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8480px; line-height:15px; white-space:nowrap">
<A name="getabspath">
フル・パスにする、GetAbsolutePathName</A></DIV>
<DIV id="text60_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:8506px; line-height:15px; white-space:nowrap">
カレントフォルダを基準に、相対パスをフル・パスにします。</DIV>
<DIV id="text60_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:8288px; line-height:15px; white-space:nowrap">
実際にファイルが存在しなくても正しく操作されます。</DIV>
<DIV id="text60_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8776px; line-height:15px; white-space:nowrap">
<A name="exp_wild">
ワイルドカードを展開する</A></DIV>
<DIV id="text60_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:59px; margin-top:8803px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_35.html#ExpandWildcard">
→ ExpandWildcard (VBSLib)</A></DIV>
<v:rect style="position:absolute; margin-left:51px; margin-top:8535px; width:310px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text60_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:59px; margin-top:8542px; line-height:13px; white-space:nowrap">
フル・パス = g_fs.GetAbsolutePathName( 相対パス )</DIV>
<DIV id="text60_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:113px; margin-top:8373px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_GetFileName">
GetFileName</A></DIV>
<DIV id="text60_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:113px; margin-top:8358px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_GetParentFolderName">
GetParentFolderName</A></DIV>
<DIV id="text60_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:76px; margin-top:8570px; line-height:15px; white-space:nowrap">
g_fs.GetAbsolutePathName( フル・パス + "\.." ) とすると、親フォルダの<BR/>
フル・パスになります。<BR/>
g_fs.GetAbsolutePathName( "C:\folder\..\a.txt" ) は、"C:\folder\..\a.txt"<BR/>
のままです。<BR/>
g_fs.GetAbsolutePathName( "C:\folder\*" ) は、"C:\folder\." になります。</DIV>
<DIV id="text60_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8677px; line-height:15px; white-space:nowrap">
<A name="chgext">
拡張子を変えたパスを取得する</A></DIV>
<DIV id="text60_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:8881px; line-height:15px; white-space:nowrap">
存在するファイルの名前を変えます。</DIV>
<DIV id="text60_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; font-weight: bold; margin-left:46px; margin-top:7292px; line-height:15px; white-space:nowrap">
<A href="#file_path">
→ ファイルパス文字列の操作関数</A></DIV>
<DIV id="text60_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:46px; margin-top:7330px; line-height:15px; white-space:nowrap">
<A href="#chgext">
→ 拡張子を変えたパスを取得する</A></DIV>
<DIV id="text60_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:46px; margin-top:7311px; line-height:15px; white-space:nowrap">
<A href="#getabspath">
→ フルパスにする</A></DIV>
<DIV id="text60_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:46px; margin-top:7349px; line-height:15px; white-space:nowrap">
<A href="#exp_wild">
→ ワイルドカードを展開する</A></DIV>
<DIV id="text60_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:46px; margin-top:7368px; line-height:15px; white-space:nowrap">
<A href="#ren">
→ ファイルの名前を変える</A></DIV>
<v:rect style="position:absolute; margin-left:51px; margin-top:8705px; width:448px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text60_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:59px; margin-top:8712px; line-height:13px; white-space:nowrap">
s = g_fs.GetParentFolderName( s ) + "\" + g_fs.GetBaseName( s ) + ".csv"</DIV>
<v:rect style="position:absolute; margin-left:51px; margin-top:9048px; width:394px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text60_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:59px; margin-top:9054px; line-height:15px; white-space:nowrap">
Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
Set f = g_fs.GetFolder( "c:\folderA" )<BR/>
f.Name = "folder1"</DIV>
<DIV id="text60_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:71px; margin-top:9111px; line-height:15px; white-space:nowrap">
C:\folderA をfolder1 に変えています。</DIV>
<DIV id="text60_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:51px; margin-top:9025px; line-height:15px; white-space:nowrap">
存在するフォルダの名前を変えます。</DIV>
<DIV id="text60_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:71px; margin-top:8986px; line-height:15px; white-space:nowrap">
変えようとする名前のファイルが既にあるときは、エラーになります。</DIV>
<DIV id="text60_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7744px; line-height:15px; white-space:nowrap">
<A name="path_syntax">
パスの記述方法、相対パス、フル・パス、カレントフォルダー</A></DIV>
<DIV id="text60_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:46px; margin-top:7273px; line-height:15px; white-space:nowrap">
<A href="#path_syntax">
→ パスの記述方法、相対パス、フル・パス、カレントフォルダー</A></DIV>
<v:rect style="position:absolute; margin-left:51px; margin-top:7773px; width:226px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text60_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:59px; margin-top:7780px; line-height:13px; white-space:nowrap">
C:\Users\user1\Documents\sample.txt</DIV>
<DIV id="text60_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7182px; line-height:15px; white-space:nowrap">
ファイルやフォルダの場所を示すアドレスのことを特に、「パス」と言います。</DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:7210px; width:226px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text60_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:7217px; line-height:13px; white-space:nowrap">
C:\Users\user1\Documents\sample.txt</DIV>
<DIV id="text60_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:46px; margin-top:7215px; line-height:15px; white-space:nowrap">
例：</DIV>
<DIV id="text60_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:7812px; line-height:15px; white-space:nowrap">
上記は、Windows 7 における、「ドキュメント」フォルダにある sample.txt ファイルの<BR/>
フル・パスです。 C:\ から始まるものを<BR/>
フォルダ（エクスプローラー）の「アドレス」に書かれています。<BR/>
\ または / は、Windows におけるフォルダーの区切りを示します。</DIV>
<DIV id="text60_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:7885px; line-height:15px; white-space:nowrap">
C: は、コンピューターの C ドライブを表しており、通常、PC に入っている<BR/>
ハードディスクになります。 USB メモリを挿すと、E ドライブなどができます。</DIV>
<DIV id="text60_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:7930px; line-height:15px; white-space:nowrap">
一般にスクリプトには、<BR/>
相対パスは、</DIV>
<DIV id="text60_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:8018px; line-height:15px; white-space:nowrap">
カレントフォルダー</DIV>
<DIV id="text60_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:199px; margin-top:8018px; line-height:15px; white-space:nowrap">
相対パス</DIV>
<DIV id="text60_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:316px; margin-top:8018px; line-height:15px; white-space:nowrap">
フル・パス</DIV>
<v:line style="position:absolute;" from="46,8039" to="492,8039" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text60_41" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:66px; margin-top:8049px; line-height:13px; white-space:nowrap">
C:\Folder1</DIV>
<DIV id="text60_42" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:316px; margin-top:8049px; line-height:13px; white-space:nowrap">
C:\Folder1\File1.txt</DIV>
<DIV id="text60_43" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:199px; margin-top:8049px; line-height:13px; white-space:nowrap">
File1.txt</DIV>
<DIV id="text60_44" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:66px; margin-top:8065px; line-height:13px; white-space:nowrap">
C:\Folder1</DIV>
<DIV id="text60_45" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:199px; margin-top:8065px; line-height:13px; white-space:nowrap">
sub\File1.txt</DIV>
<DIV id="text60_46" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:316px; margin-top:8065px; line-height:13px; white-space:nowrap">
C:\Folder1\sub\File1.txt</DIV>
<DIV id="text60_47" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:316px; margin-top:8081px; line-height:13px; white-space:nowrap">
C:\Folder1\File1.txt</DIV>
<DIV id="text60_48" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:199px; margin-top:8081px; line-height:13px; white-space:nowrap">
.\File1.txt</DIV>
<DIV id="text60_49" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:66px; margin-top:8081px; line-height:13px; white-space:nowrap">
C:\Folder1</DIV>
<DIV id="text60_50" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:199px; margin-top:8097px; line-height:13px; white-space:nowrap">
..\File1.txt</DIV>
<DIV id="text60_51" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:316px; margin-top:8097px; line-height:13px; white-space:nowrap">
C:\File1.txt</DIV>
<DIV id="text60_52" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:66px; margin-top:8097px; line-height:13px; white-space:nowrap">
C:\Folder1</DIV>
<DIV id="text60_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:8193px; line-height:15px; white-space:nowrap">
環境変数を含むパスは、</DIV>
<DIV id="text60_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:193px; margin-top:8193px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_02.html#Shell_ExpandEnvironmentStrings">
WScript.Shell.ExpandEnvironmentStrings</A></DIV>
<DIV id="text60_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:423px; margin-top:8193px; line-height:15px; white-space:nowrap">
または、</DIV>
<DIV id="text60_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:8210px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_47.html#env">
env (vbslib)</A></DIV>
<DIV id="text60_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:119px; margin-top:8210px; line-height:15px; white-space:nowrap">
で展開できます。</DIV>
<DIV id="text60_58" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:316px; margin-top:8113px; line-height:13px; white-space:nowrap">
C:\File1.txt</DIV>
<DIV id="text60_59" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:199px; margin-top:8113px; line-height:13px; white-space:nowrap">
..\..\File1.txt</DIV>
<DIV id="text60_60" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:66px; margin-top:8113px; line-height:13px; white-space:nowrap">
C:\Folder1\sub</DIV>
<DIV id="text60_61" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:7959px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_02.html#WScript_Shell_CurrentDirectory">
Shell::CurrentDirectory</A></DIV>
<DIV id="text60_62" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:184px; margin-top:7959px; line-height:15px; white-space:nowrap">
や</DIV>
<DIV id="text60_63" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:7976px; line-height:15px; white-space:nowrap">
は、通常、起動したスクリプト・ファイル（.vbs）があるフォルダーになります。</DIV>
<DIV id="text60_64" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:52px; margin-top:8316px; line-height:12px; white-space:nowrap">
キーワード：</DIV>
<DIV id="text60_65" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:115px; margin-top:8316px; line-height:12px; white-space:nowrap">
<A name="GetBaseName">
GetBaseName, GetExtensionName</A></DIV>
<DIV id="text60_66" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:46px; margin-top:7449px; line-height:15px; white-space:nowrap">
インターネットにあるファイルの場所を示すアドレスは、URL または URI と言います。</DIV>
<DIV id="text60_67" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7420px; line-height:15px; white-space:nowrap">
<A name="net_path">
インターネットやLANのアドレス</A></DIV>
<DIV id="text60_68" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:46px; margin-top:7254px; line-height:15px; white-space:nowrap">
<A href="#net_path">
→ インターネットやLANのアドレス</A></DIV>
<DIV id="text60_69" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:331px; margin-top:7827px; line-height:15px; white-space:nowrap">
と言います。</DIV>
<DIV id="text60_70" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:265px; margin-top:7827px; line-height:15px; white-space:nowrap">
フル・パス</DIV>
<DIV id="text60_71" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:235px; margin-top:7930px; line-height:15px; white-space:nowrap">
か、環境変数を含んだパスを記述します。</DIV>
<DIV id="text60_72" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:179px; margin-top:7930px; line-height:15px; white-space:nowrap">
相対パス</DIV>
<DIV id="text60_73" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:235px; margin-top:7945px; line-height:15px; white-space:nowrap">
を基準としたパスです。 カレントフォルダーは、</DIV>
<DIV id="text60_74" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:127px; margin-top:7945px; line-height:15px; white-space:nowrap">
カレント・フォルダー</DIV>
<DIV id="text60_75" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:228px; margin-top:7960px; line-height:15px; white-space:nowrap">
で、設定や参照ができますが、スクリプト起動直後</DIV>
<DIV id="text60_76" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:203px; margin-top:7960px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_23.html#cd">
cd</A></DIV>
<DIV id="text60_77" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:8146px; line-height:15px; white-space:nowrap">
相対パスに記述する . （ピリオド）は、カレントフォルダー、 .. （ピリオド２つ）は、<BR/>
親フォルダーを表します。</DIV>
<DIV id="text60_78" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:46px; margin-top:7511px; line-height:15px; white-space:nowrap">
URL は、ファイル操作などの関数に指定することはできません。</DIV>
<DIV id="text60_79" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:46px; margin-top:7631px; line-height:15px; white-space:nowrap">
LAN （家庭内、社内ネットワーク）にあるファイル（\\ で始まるアドレス、UNC）は、<BR/>
copy 関数などに指定できます。 ただし、カレント・フォルダー（後述）に指定する<BR/>
ことはできません。</DIV>
<DIV id="text60_80" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:46px; margin-top:7528px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_58.html#DownloadByHttp">
DownloadByHttp (vbslib)</A></DIV>
<DIV id="text60_81" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:7528px; line-height:15px; white-space:nowrap">
などを使ってダウンロードしてください。</DIV>
<DIV id="text60_82" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:70px; margin-top:7477px; line-height:15px; white-space:nowrap">
例：</DIV>
<v:rect style="position:absolute; margin-left:100px; margin-top:7472px; width:250px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text60_83" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:108px; margin-top:7479px; line-height:13px; white-space:nowrap">
http://www.sage-p.com/vbslib/vbslib.htm</DIV>
<DIV id="text60_84" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:46px; margin-top:7555px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text60_85" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:86px; margin-top:7555px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_58.html#GetPercentURL">
→ GetPercentURL</A></DIV>
<DIV id="text60_86" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7608px; line-height:15px; white-space:nowrap">
<A name="UNC">
UNC</A></DIV>
<DIV id="text60_87" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:90px; margin-top:7684px; line-height:15px; white-space:nowrap">
→ UNC：Universal Naming Convention</DIV>
<DIV id="text60_88" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:46px; margin-top:7684px; line-height:15px; white-space:nowrap">
参考</DIV>

<v:line from="0,7134" to="552,7134"/>
<v:line from="552,7134" to="552,9159"/>
<v:line from="552,9159" to="0,9159"/>
<v:line from="0,9159" to="0,7134"/>

</PAGE>
 
<!-- page 61 --> 
<PAGE>
<A id="svgcats_vml_p61" class="to_tree" style="margin-top:9164px;" onClick="selectTreeElem( '61' );">←</A>
<A href="#svgcats_vml_p62" class="to_next_page" style="margin-top:9164px;">▼</A>
<A href="#svgcats_vml_p60" class="to_prev_page" style="margin-top:9164px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9175px; width:421px; height:452px;" fillcolor="white"/>
<DIV id="text61_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9192px; line-height:15px; white-space:nowrap">
<A name="FileSystemObject">
FileSystemObject</A></DIV>
<DIV id="text61_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:9352px; line-height:15px; white-space:nowrap">
<A href="#FileSystemObject_CopyFile">
CopyFile</A></DIV>
<DIV id="text61_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:9352px; line-height:15px; white-space:nowrap">
ファイルをコピーします</DIV>
<DIV id="text61_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:9436px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_MoveFile">
MoveFile</A></DIV>
<DIV id="text61_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:9436px; line-height:15px; white-space:nowrap">
ファイルを移動します</DIV>
<DIV id="text61_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:9457px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_MoveFolder">
MoveFolder</A></DIV>
<DIV id="text61_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:9457px; line-height:15px; white-space:nowrap">
フォルダを移動します</DIV>
<DIV id="text61_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:234px; margin-top:9194px; line-height:12px; white-space:nowrap">
<A href="#fie">
[ 親: ファイル操作 ]</A></DIV>
<DIV id="text61_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:9415px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_FolderExists">
FolderExists</A></DIV>
<DIV id="text61_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:9415px; line-height:15px; white-space:nowrap">
フォルダが存在するかどうかを返します</DIV>
<DIV id="text61_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:193px; margin-top:9192px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/script56/html/FSOoriFileSystemObject.asp" target="_blank">
(Web)</A></DIV>
<DIV id="text61_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:9520px; line-height:15px; white-space:nowrap">
ファイルを削除します</DIV>
<DIV id="text61_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:9373px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_CopyFolder">
CopyFolder</A></DIV>
<DIV id="text61_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:9373px; line-height:15px; white-space:nowrap">
フォルダをコピーします</DIV>
<DIV id="text61_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:9394px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_FileExists">
FileExists</A></DIV>
<DIV id="text61_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:9394px; line-height:15px; white-space:nowrap">
ファイルが存在するかどうかを返します</DIV>
<DIV id="text61_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:9520px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_DeleteFile">
DeleteFile</A></DIV>
<v:rect style="position:absolute; margin-left:35px; margin-top:9283px; width:334px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text61_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:43px; margin-top:9290px; line-height:13px; white-space:nowrap">
Set g_fs = CreateObject("Scripting.FileSystemObject")</DIV>
<DIV id="text61_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9260px; line-height:15px; white-space:nowrap">
オブジェクトの取得</DIV>
<DIV id="text61_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9329px; line-height:15px; white-space:nowrap">
メンバ</DIV>
<DIV id="text61_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:9499px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_GetFile">
GetFile</A></DIV>
<DIV id="text61_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:162px; margin-top:9499px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#file_obj">
→ File オブジェクト</A></DIV>
<DIV id="text61_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:9478px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_CreateFolder">
CreateFolder</A></DIV>
<DIV id="text61_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:9478px; line-height:15px; white-space:nowrap">
フォルダを作成します。</DIV>
<DIV id="text61_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:9580px; line-height:15px; white-space:nowrap">
<A href="#fname">
→ ファイル名、パス</A></DIV>
<DIV id="text61_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:9224px; line-height:15px; white-space:nowrap">
WSH だけでなく VBA でも使えます。</DIV>
<DIV id="text61_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:9558px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#TextStream">
→ TextStream （テキストファイル）</A></DIV>
<DIV id="text61_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9558px; line-height:15px; white-space:nowrap">
関連</DIV>

<v:line from="0,9175" to="421,9175"/>
<v:line from="421,9175" to="421,9627"/>
<v:line from="421,9627" to="0,9627"/>
<v:line from="0,9627" to="0,9175"/>

</PAGE>
 
<!-- page 62 --> 
<PAGE>
<A id="svgcats_vml_p62" class="to_tree" style="margin-top:9632px;" onClick="selectTreeElem( '62' );">←</A>
<A href="vbs_memo_05.html#svgcats_vml_p63" class="to_next_page" style="margin-top:9632px;">▼</A>
<A href="#svgcats_vml_p61" class="to_prev_page" style="margin-top:9632px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9643px; width:597px; height:443px;" fillcolor="white"/>
<DIV id="text62_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9660px; line-height:15px; white-space:nowrap">
<A name="FileSystemObject_CopyFile">
FileSystemObject::CopyFile</A></DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:9917px; width:365px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text62_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:9923px; line-height:15px; white-space:nowrap">
Set fs = CreateObject("Scripting.FileSystemObject")<BR/>
fs.CopyFile&nbsp; "ipLibCom.h", "..\..\..\inc\ipLibCom.h", True<BR/>
Set fs = Nothing</DIV>
<v:line style="position:absolute;" from="397,9956" to="456,9973" strokecolor="#008040" strokeweight="2pt"/>
<v:oval style="position:absolute; margin-left:393px; margin-top:9952px; width:7px; height:7px;" fillcolor="#008040" strokecolor="#008040" strokeweight="2pt"/>
<v:rect style="position:absolute; margin-left:420px; margin-top:9962px; width:71px; height:17px;" fillcolor="#FFFFFF" strokecolor="#FFFFFF" strokeweight="1pt"/>
<DIV id="text62_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:424px; margin-top:9964px; line-height:15px; white-space:nowrap">
強制上書き</DIV>
<v:line style="position:absolute;" from="279,9955" to="377,10005" strokecolor="#008040" strokeweight="2pt"/>
<v:oval style="position:absolute; margin-left:275px; margin-top:9951px; width:7px; height:7px;" fillcolor="#008040" strokecolor="#008040" strokeweight="2pt"/>
<v:rect style="position:absolute; margin-left:287px; margin-top:9995px; width:179px; height:17px;" fillcolor="#FFFFFF" strokecolor="#FFFFFF" strokeweight="1pt"/>
<DIV id="text62_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:291px; margin-top:9997px; line-height:15px; white-space:nowrap">
新しくできるファイル名も含める</DIV>
<DIV id="text62_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:9729px; line-height:15px; white-space:nowrap">
src から dst にファイルをコピーします。</DIV>
<DIV id="text62_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:288px; margin-top:9660px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/script56/html/jsmthCopyFile.asp?frame=true" target="_blank">
MSDN(Web)</A></DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:9694px; width:526px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text62_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:9701px; line-height:13px; white-space:nowrap">
Sub&nbsp; FileSystemObject::CopyFile( src as string, dst as string [, overwrite as Bool] )</DIV>
<DIV id="text62_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:9755px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text62_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:118px; margin-top:9755px; line-height:15px; white-space:nowrap">
src</DIV>
<DIV id="text62_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:195px; margin-top:9755px; line-height:15px; white-space:nowrap">
コピーするファイルのパス（コピー元、ワイルドカード可）</DIV>
<DIV id="text62_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:118px; margin-top:9772px; line-height:15px; white-space:nowrap">
dst</DIV>
<DIV id="text62_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:195px; margin-top:9772px; line-height:15px; white-space:nowrap">
コピー先のファイルのパス</DIV>
<DIV id="text62_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:9897px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text62_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:118px; margin-top:9789px; line-height:15px; white-space:nowrap">
overwrite</DIV>
<DIV id="text62_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:195px; margin-top:9789px; line-height:15px; white-space:nowrap">
上書きするかどうか。 デフォルト True (*1)</DIV>
<DIV id="text62_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:384px; margin-top:9662px; line-height:12px; white-space:nowrap">
<A href="#FileSystemObject">
[ 親: FileSystemObject ]</A></DIV>
<DIV id="text62_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:83px; margin-top:9830px; line-height:15px; white-space:nowrap">
False のとき、上書きしようとするとエラーになります。</DIV>
<DIV id="text62_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:9830px; line-height:15px; white-space:nowrap">
(*1)</DIV>
<DIV id="text62_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:83px; margin-top:9855px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_06.html#copy_arg">
→ ファイルコピーの引数</A></DIV>
<DIV id="text62_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:9855px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text62_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:10016px; line-height:15px; white-space:nowrap">
エラー</DIV>
<DIV id="text62_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:10038px; line-height:15px; white-space:nowrap">
src に指定したファイルが無いとき、エラー 76</DIV>

<v:line from="0,9643" to="597,9643"/>
<v:line from="597,9643" to="597,10086"/>
<v:line from="597,10086" to="0,10086"/>
<v:line from="0,10086" to="0,9643"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10086px;">
<A id="svgcats_vml_p62" class="to_tree" onClick="selectTreeElem( '62' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10086px;">
<A id="page_group_bottom" href="vbs_memo_05.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
