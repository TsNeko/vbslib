<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>VBSメモ</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbs_memo.html?f1=vbs_memo.files/vbs_memo_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbs_memo.files/vbs_memo_06.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbs_memo.files/vbs_memo_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbs_memo.html?f1=vbs_memo.files/vbs_memo_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbs_memo.files/vbs_memo_06.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 90 --> 
<PAGE>
<A id="svgcats_vml_p90" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '90' );">←</A>
<A href="#svgcats_vml_p91" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbs_memo_05.html#svgcats_vml_p89" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbs_memo_05.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:524px; height:525px;" fillcolor="white"/>
<DIV id="text90_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="TextStream_SkipLine">
SkipLine (TextStream)</A></DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:46px; width:178px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text90_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:53px; line-height:13px; white-space:nowrap">
Sub&nbsp; TextStream::SkipLine()</DIV>
<DIV id="text90_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:81px; line-height:15px; white-space:nowrap">
テキストストリームを１行スキップします。</DIV>
<DIV id="text90_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:186px; margin-top:17px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/cc428058.aspx" target="_blank">
(Web)</A></DIV>
<DIV id="text90_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:129px; line-height:15px; white-space:nowrap">
<A name="skiplines">
指定した行へ移動するサンプル：</A></DIV>
<v:rect style="position:absolute; margin-left:35px; margin-top:151px; width:406px; height:325px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text90_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:43px; margin-top:157px; line-height:15px; white-space:nowrap">
&nbsp; path = "a.txt"<BR/>
&nbsp; Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
&nbsp; Set f = g_fs.OpenTextFile( path )<BR/>
<BR/>
&nbsp; Do Until f.AtEndOfStream<BR/>
&nbsp; &nbsp; line = f.ReadLine()<BR/>
&nbsp; &nbsp; If line = "point" Then<BR/>
&nbsp; &nbsp; &nbsp; i_line = f.Line - 1&nbsp; '// 行番号を取得。(*1)<BR/>
&nbsp; &nbsp; &nbsp; Exit Do<BR/>
&nbsp; &nbsp; End If<BR/>
&nbsp; Loop<BR/>
<BR/>
&nbsp; WScript.Echo&nbsp; "i_line = " &amp; i_line <BR/>
<BR/>
&nbsp; Set f = g_fs.OpenTextFile( path )<BR/>
&nbsp; For i=1 To&nbsp; i_line - 1 : f.SkipLine : Next&nbsp; '// 行へジャンプ<BR/>
<BR/>
&nbsp; WScript.Echo&nbsp; f.ReadLine()&nbsp; '// "point" が書いてある行<BR/>
<BR/>
&nbsp; f = Empty<BR/>
&nbsp; g_fs = Empty</DIV>
<DIV id="text90_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:486px; line-height:15px; white-space:nowrap">
(*1) ReadLine した後なので、line の行番号は f.Line 行目ではなく f.Line-1 行目</DIV>

<v:line from="0,0" to="524,0"/>
<v:line from="524,0" to="524,525"/>
<v:line from="524,525" to="0,525"/>
<v:line from="0,525" to="0,0"/>

</PAGE>
 
<!-- page 91 --> 
<PAGE>
<A id="svgcats_vml_p91" class="to_tree" style="margin-top:530px;" onClick="selectTreeElem( '91' );">←</A>
<A href="#svgcats_vml_p92" class="to_next_page" style="margin-top:530px;">▼</A>
<A href="#svgcats_vml_p90" class="to_prev_page" style="margin-top:530px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:541px; width:378px; height:249px;" fillcolor="white"/>
<DIV id="text91_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:558px; line-height:15px; white-space:nowrap">
<A name="TextStream_Line">
Line (TextStream)</A></DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:587px; width:274px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text91_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:594px; line-height:13px; white-space:nowrap">
Property Get&nbsp; TextStream::Line() as integer</DIV>
<DIV id="text91_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:622px; line-height:15px; white-space:nowrap">
テキストストリームの現在の行番号。（１〜）<BR/>
次にアクセスする行番号。</DIV>
<DIV id="text91_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:175px; margin-top:558px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/cc428134.aspx" target="_blank">
(Web)</A></DIV>
<DIV id="text91_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:677px; line-height:15px; white-space:nowrap">
１行目をリード/ライトしたら、Line = 2 になります。</DIV>
<DIV id="text91_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:701px; line-height:15px; white-space:nowrap">
ファイルの最後の行をリードしたときは、＋１されません。</DIV>
<DIV id="text91_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:742px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text91_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:69px; margin-top:742px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_30.html#GetLineCount">
→ GetLineCount</A></DIV>

<v:line from="0,541" to="378,541"/>
<v:line from="378,541" to="378,790"/>
<v:line from="378,790" to="0,790"/>
<v:line from="0,790" to="0,541"/>

</PAGE>
 
<!-- page 92 --> 
<PAGE>
<A id="svgcats_vml_p92" class="to_tree" style="margin-top:795px;" onClick="selectTreeElem( '92' );">←</A>
<A href="#svgcats_vml_p93" class="to_next_page" style="margin-top:795px;">▼</A>
<A href="#svgcats_vml_p91" class="to_prev_page" style="margin-top:795px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:806px; width:532px; height:628px;" fillcolor="white"/>
<DIV id="text92_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:823px; line-height:15px; white-space:nowrap">
<A name="TextStream_AtEndOfStream">
AtEndOfStream (TextStream)</A></DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:852px; width:268px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text92_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:859px; line-height:13px; white-space:nowrap">
Dim&nbsp; TextStream::AtEndOfStream&nbsp; as boolean</DIV>
<DIV id="text92_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:892px; line-height:15px; white-space:nowrap">
ストリームの最後なら True</DIV>
<DIV id="text92_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:256px; margin-top:823px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/cc428128.aspx" target="_blank">
(Web)</A></DIV>
<DIV id="text92_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:1310px; line-height:15px; white-space:nowrap">
Shell:Exec で起動したプログラムから出力される標準出力ストリームに<BR/>
バッファリングされた文字がないときは、False を返します。<BR/>
<BR/>
標準入力ストリームにバッファリングされた文字がないときは、待ち状態に<BR/>
入ります。改行文字がバッファリングされ、改行文字の前に文字が入力されて<BR/>
いなかったら True、文字が入力されていたら False を返します。</DIV>
<DIV id="text92_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:930px; line-height:15px; white-space:nowrap">
ファイルの最後が改行文字のとき、その改行文字をリードしたら、AtEndOfStream<BR/>
= True になります。</DIV>
<v:rect style="position:absolute; margin-left:71px; margin-top:1216px; width:88px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text92_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:79px; margin-top:1223px; line-height:13px; white-space:nowrap">
end (Return)</DIV>
<v:rect style="position:absolute; margin-left:197px; margin-top:1216px; width:154px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text92_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:205px; margin-top:1222px; line-height:15px; white-space:nowrap">
f.AtEndOfStream = False<BR/>
ReadLine = "end"<BR/>
f.AtEndOfStream = True</DIV>
<DIV id="text92_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:61px; margin-top:1198px; line-height:15px; white-space:nowrap">
ファイル</DIV>
<DIV id="text92_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:191px; margin-top:1198px; line-height:15px; white-space:nowrap">
メソッドの結果</DIV>
<DIV id="text92_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:1128px; line-height:15px; white-space:nowrap">
リードした内容が入っている変数が無効かどうかではなく、最後の行かどうかです。<BR/>
変数 = Null にしておけば、空行である "" と一致しません。<BR/>
変数 = Empty にしておけば、空行である "" と一致します。</DIV>
<v:rect style="position:absolute; margin-left:50px; margin-top:1017px; width:184px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text92_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:58px; margin-top:1023px; line-height:15px; white-space:nowrap">
Do Until&nbsp; file.AtEndOfStream<BR/>
&nbsp; &nbsp; line = file.ReadLine()<BR/>
Loop</DIV>
<DIV id="text92_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:991px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text92_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1103px; line-height:15px; white-space:nowrap">
補足</DIV>

<v:line from="0,806" to="532,806"/>
<v:line from="532,806" to="532,1434"/>
<v:line from="532,1434" to="0,1434"/>
<v:line from="0,1434" to="0,806"/>

</PAGE>
 
<!-- page 93 --> 
<PAGE>
<A id="svgcats_vml_p93" class="to_tree" style="margin-top:1439px;" onClick="selectTreeElem( '93' );">←</A>
<A href="#svgcats_vml_p94" class="to_next_page" style="margin-top:1439px;">▼</A>
<A href="#svgcats_vml_p92" class="to_prev_page" style="margin-top:1439px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1450px; width:314px; height:129px;" fillcolor="white"/>
<DIV id="text93_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1467px; line-height:15px; white-space:nowrap">
<A name="TextStream_Write">
Write (TextStream)</A></DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:1496px; width:256px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text93_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:1503px; line-height:13px; white-space:nowrap">
Sub&nbsp; TextStream::Write( Text as string )</DIV>
<DIV id="text93_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1531px; line-height:15px; white-space:nowrap">
テキストストリームに出力します。</DIV>
<DIV id="text93_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:189px; margin-top:1467px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/cc428091.aspx" target="_blank">
(Web)</A></DIV>

<v:line from="0,1450" to="314,1450"/>
<v:line from="314,1450" to="314,1579"/>
<v:line from="314,1579" to="0,1579"/>
<v:line from="0,1579" to="0,1450"/>

</PAGE>
 
<!-- page 94 --> 
<PAGE>
<A id="svgcats_vml_p94" class="to_tree" style="margin-top:1584px;" onClick="selectTreeElem( '94' );">←</A>
<A href="#svgcats_vml_p95" class="to_next_page" style="margin-top:1584px;">▼</A>
<A href="#svgcats_vml_p93" class="to_prev_page" style="margin-top:1584px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1595px; width:342px; height:129px;" fillcolor="white"/>
<DIV id="text94_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1612px; line-height:15px; white-space:nowrap">
<A name="TextStream_WriteLine">
WriteLine (TextStream)</A></DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:1641px; width:280px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text94_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:1648px; line-height:13px; white-space:nowrap">
Sub&nbsp; TextStream::WriteLine( Text as string )</DIV>
<DIV id="text94_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1676px; line-height:15px; white-space:nowrap">
テキストストリームにテキストと改行を出力します。</DIV>

<v:line from="0,1595" to="342,1595"/>
<v:line from="342,1595" to="342,1724"/>
<v:line from="342,1724" to="0,1724"/>
<v:line from="0,1724" to="0,1595"/>

</PAGE>
 
<!-- page 95 --> 
<PAGE>
<A id="svgcats_vml_p95" class="to_tree" style="margin-top:1729px;" onClick="selectTreeElem( '95' );">←</A>
<A href="#svgcats_vml_p96" class="to_next_page" style="margin-top:1729px;">▼</A>
<A href="#svgcats_vml_p94" class="to_prev_page" style="margin-top:1729px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1740px; width:428px; height:129px;" fillcolor="white"/>
<DIV id="text95_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1757px; line-height:15px; white-space:nowrap">
<A name="TextStream_WriteBlankLines">
WriteBlankLines (TextStream)</A></DIV>
<DIV id="text95_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:249px; margin-top:1757px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/cc428062.aspx" target="_blank">
(Web)</A></DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:1786px; width:370px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text95_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:1793px; line-height:13px; white-space:nowrap">
Sub&nbsp; TextStream::WriteBlankLines( LengthOfLine as integer )</DIV>
<DIV id="text95_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1821px; line-height:15px; white-space:nowrap">
テキストストリームに複数の改行を出力します。</DIV>

<v:line from="0,1740" to="428,1740"/>
<v:line from="428,1740" to="428,1869"/>
<v:line from="428,1869" to="0,1869"/>
<v:line from="0,1869" to="0,1740"/>

</PAGE>
 
<!-- page 96 --> 
<PAGE>
<A id="svgcats_vml_p96" class="to_tree" style="margin-top:1874px;" onClick="selectTreeElem( '96' );">←</A>
<A href="#svgcats_vml_p97" class="to_next_page" style="margin-top:1874px;">▼</A>
<A href="#svgcats_vml_p95" class="to_prev_page" style="margin-top:1874px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1885px; width:562px; height:607px;" fillcolor="white"/>
<DIV id="text96_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1902px; line-height:15px; white-space:nowrap">
<A name="TextStream_exec">
Shell::Exec で実行すると、pause ができない</A></DIV>
<v:rect style="position:absolute; margin-left:24px; margin-top:2104px; width:502px; height:325px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text96_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:2110px; line-height:15px; white-space:nowrap">
'********************************************************************************<BR/>
'&nbsp; &lt;&lt;&lt; [EchoStream] echo supported No vbCRLF &gt;&gt;&gt;<BR/>
'********************************************************************************<BR/>
Dim&nbsp; g_EchoStreamBuf<BR/>
Sub&nbsp; EchoStream( StreamIn, StreamOut )<BR/>
&nbsp; Dim&nbsp; s, c<BR/>
<BR/>
&nbsp; Do Until StreamIn.AtEndOfStream<BR/>
&nbsp; &nbsp; c = StreamIn.Read(1)<BR/>
If g_EchoStreamBuf="続行するには何かキーを押してください . . ." Then<BR/>
&nbsp;Stop<BR/>
End If<BR/>
&nbsp; &nbsp; If c &lt;&gt; vbCR and c &lt;&gt; vbLF Then _<BR/>
&nbsp; &nbsp; &nbsp; g_EchoStreamBuf = g_EchoStreamBuf + c<BR/>
&nbsp; &nbsp; If c = vbLF Then<BR/>
&nbsp; &nbsp; &nbsp; WScript.Echo&nbsp; vbCR + g_EchoStreamBuf : g_EchoStreamBuf = ""<BR/>
&nbsp; &nbsp; Else<BR/>
&nbsp; &nbsp; &nbsp; StreamOut.Write&nbsp; c<BR/>
&nbsp; &nbsp; End If<BR/>
&nbsp; Loop<BR/>
End Sub</DIV>
<DIV id="text96_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:1940px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_02.html#WScript_Shell_Exec">
Shell::Exec</A></DIV>
<DIV id="text96_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:1940px; line-height:15px; white-space:nowrap">
で起動したコマンドライン・プログラムでは、バッチファイルの pause が正しく</DIV>
<DIV id="text96_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1957px; line-height:15px; white-space:nowrap">
動きません。</DIV>
<DIV id="text96_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1986px; line-height:15px; white-space:nowrap">
WshScriptExec::StdIn.ReadLine を呼ぶと、改行コードが入力されるまで戻ってきません。<BR/>
WshScriptExec::StdIn.AtEndOfStream や、Read、ReadAll もなぜか戻ってきません。<BR/>
このため、pause で表示される「続きを実行するとき…」のメッセージは表示されません。<BR/>
１文字ずつ表示しても、文字の終了が AtEndOfStream で判定しようとすると戻ってこなく<BR/>
なるので、使えません。</DIV>
<DIV id="text96_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2081px; line-height:15px; white-space:nowrap">
１文字ずつ表示する echo だが、AtEndOfStream で止まることの実証コード：</DIV>
<DIV id="text96_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:2445px; line-height:15px; white-space:nowrap">
2&amp;&gt;1 で標準エラー出力を標準出力にリダイレクトすると、止まらないことがあります。</DIV>

<v:line from="0,1885" to="562,1885"/>
<v:line from="562,1885" to="562,2492"/>
<v:line from="562,2492" to="0,2492"/>
<v:line from="0,2492" to="0,1885"/>

</PAGE>
 
<!-- page 97 --> 
<PAGE>
<A id="svgcats_vml_p97" class="to_tree" style="margin-top:2497px;" onClick="selectTreeElem( '97' );">←</A>
<A href="#svgcats_vml_p98" class="to_next_page" style="margin-top:2497px;">▼</A>
<A href="#svgcats_vml_p96" class="to_prev_page" style="margin-top:2497px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2508px; width:609px; height:805px;" fillcolor="white"/>
<DIV id="text97_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2525px; line-height:15px; white-space:nowrap">
<A name="copy_arg">
ファイルコピーの引数</A></DIV>
<DIV id="text97_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:2564px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_04.html#FileSystemObject_CopyFile">
CopyFile</A></DIV>
<DIV id="text97_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:99px; margin-top:2564px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_CopyFolder">
CopyFolder</A></DIV>
<DIV id="text97_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:176px; margin-top:2564px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_MoveFile">
MoveFile</A></DIV>
<DIV id="text97_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:239px; margin-top:2564px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_MoveFolder">
MoveFolder</A></DIV>
<DIV id="text97_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:15px; margin-top:2667px; line-height:15px; white-space:nowrap">
CopyFile、MoveFile</DIV>
<DIV id="text97_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:2731px; line-height:15px; white-space:nowrap">
dst 引数</DIV>
<DIV id="text97_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:2731px; line-height:15px; white-space:nowrap">
src 引数</DIV>
<DIV id="text97_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:2759px; line-height:15px; white-space:nowrap">
ファイル a.txt</DIV>
<DIV id="text97_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:2698px; line-height:15px; white-space:nowrap">
コピー先フォルダ&nbsp; C:\dst_folder が存在するとき</DIV>
<DIV id="text97_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:301px; margin-top:2731px; line-height:15px; white-space:nowrap">
動作</DIV>
<DIV id="text97_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:2759px; line-height:15px; white-space:nowrap">
C:\dst_folder</DIV>
<DIV id="text97_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:2759px; line-height:15px; white-space:nowrap">
エラー 800A0046 書き込みできません</DIV>
<DIV id="text97_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:2782px; line-height:15px; white-space:nowrap">
C:\dst_folder\a.txt</DIV>
<DIV id="text97_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:2782px; line-height:15px; white-space:nowrap">
dst_folder に a.txt をコピーします</DIV>
<DIV id="text97_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:2805px; line-height:15px; white-space:nowrap">
C:\dst_folder\b.txt</DIV>
<DIV id="text97_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:2805px; line-height:15px; white-space:nowrap">
ファイル名を b.txt に変えてコピーします</DIV>
<v:line style="position:absolute;" from="29,2752" to="557,2752" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text97_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:15px; margin-top:3019px; line-height:15px; white-space:nowrap">
CopyFolder、MoveFolder</DIV>
<v:line style="position:absolute;" from="29,3110" to="568,3110" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text97_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:3186px; line-height:15px; white-space:nowrap">
エラー 800A004C パスが見つかりません</DIV>
<DIV id="text97_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:3186px; line-height:15px; white-space:nowrap">
C:\dst_folder\bb\cc</DIV>
<DIV id="text97_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:3140px; line-height:15px; white-space:nowrap">
フォルダ aa を dst_folder の中にコピーします</DIV>
<DIV id="text97_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:3140px; line-height:15px; white-space:nowrap">
C:\dst_folder\aa</DIV>
<DIV id="text97_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:3117px; line-height:15px; white-space:nowrap">
フォルダ aa の内容を dst_folder にコピーします</DIV>
<DIV id="text97_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:3117px; line-height:15px; white-space:nowrap">
C:\dst_folder</DIV>
<DIV id="text97_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:301px; margin-top:3089px; line-height:15px; white-space:nowrap">
動作</DIV>
<DIV id="text97_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:3117px; line-height:15px; white-space:nowrap">
フォルダ aa</DIV>
<DIV id="text97_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:3089px; line-height:15px; white-space:nowrap">
src 引数</DIV>
<DIV id="text97_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:3089px; line-height:15px; white-space:nowrap">
dst 引数</DIV>
<DIV id="text97_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:3056px; line-height:15px; white-space:nowrap">
コピー先フォルダ&nbsp; C:\dst_folder が存在するとき</DIV>
<DIV id="text97_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:318px; margin-top:2564px; line-height:15px; white-space:nowrap">
に指定するパスがどうなっているかどうかで、</DIV>
<DIV id="text97_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:2579px; line-height:15px; white-space:nowrap">
どのような動きをするかをまとめています。</DIV>
<DIV id="text97_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:2828px; line-height:15px; white-space:nowrap">
C:\dst_folder\c\d.txt</DIV>
<DIV id="text97_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:2828px; line-height:15px; white-space:nowrap">
エラー 800A004C パスが見つかりません</DIV>
<DIV id="text97_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:3163px; line-height:15px; white-space:nowrap">
フォルダ名を bb に変えてコピーします</DIV>
<DIV id="text97_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:3163px; line-height:15px; white-space:nowrap">
C:\dst_folder\bb</DIV>
<DIV id="text97_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:3249px; line-height:15px; white-space:nowrap">
ワイルドカードは、コピー先にマッチしないときに限り使えます。<BR/>
フォルダ名を変えることはできません。</DIV>
<DIV id="text97_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:2899px; line-height:15px; white-space:nowrap">
ワイルドカード</DIV>
<DIV id="text97_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:2899px; line-height:15px; white-space:nowrap">
C:\dst_folder</DIV>
<DIV id="text97_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:2899px; line-height:15px; white-space:nowrap">
dst_folder にファイルをコピーします<BR/>
フォルダはコピーしません</DIV>
<DIV id="text97_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:2935px; line-height:15px; white-space:nowrap">
C:\dst_folder\c</DIV>
<DIV id="text97_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:2935px; line-height:15px; white-space:nowrap">
エラー 800A004C パスが見つかりません</DIV>
<DIV id="text97_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:3209px; line-height:15px; white-space:nowrap">
ワイルドカード</DIV>
<DIV id="text97_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:161px; margin-top:3209px; line-height:15px; white-space:nowrap">
C:\dst_folder</DIV>
<DIV id="text97_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:3209px; line-height:15px; white-space:nowrap">
フォルダを dst_folder の中にコピーします</DIV>
<DIV id="text97_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:125px; margin-top:2604px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_23.html#copy">
copy</A></DIV>
<DIV id="text97_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:2604px; line-height:15px; white-space:nowrap">
なお、vbslib の<BR/>
ありません。</DIV>
<DIV id="text97_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:156px; margin-top:2604px; line-height:15px; white-space:nowrap">
は、指定したパスがどうなっているかどうかによって動きが変わることは</DIV>
<DIV id="text97_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:227px; margin-top:2971px; line-height:12px; white-space:nowrap">
src にワイルドカードがあるときは、dst はフォルダーとして処理します。</DIV>
<DIV id="text97_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:214px; margin-top:2854px; line-height:13px; white-space:nowrap">
dst がフォルダーとして存在するときは、そのフォルダーの中にコピーします。<BR/>
そうでないときは、dst がファイルとして処理します。</DIV>

<v:line from="0,2508" to="609,2508"/>
<v:line from="609,2508" to="609,3313"/>
<v:line from="609,3313" to="0,3313"/>
<v:line from="0,3313" to="0,2508"/>

</PAGE>
 
<!-- page 98 --> 
<PAGE>
<A id="svgcats_vml_p98" class="to_tree" style="margin-top:3318px;" onClick="selectTreeElem( '98' );">←</A>
<A href="#svgcats_vml_p99" class="to_next_page" style="margin-top:3318px;">▼</A>
<A href="#svgcats_vml_p97" class="to_prev_page" style="margin-top:3318px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3329px; width:735px; height:1331px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:33px; margin-top:3396px; width:322px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text98_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:3402px; line-height:15px; white-space:nowrap">
Set fs = CreateObject("Scripting.FileSystemObject")<BR/>
fs.CopyFolder "public", "dst\public", True<BR/>
Set fs = Nothing</DIV>
<DIV id="text98_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:20px; margin-top:3369px; line-height:15px; white-space:nowrap">
<A name="folder_copy">
フォルダをコピーする</A></DIV>
<v:line style="position:absolute;" from="204,3434" to="309,3481" strokecolor="#008040" strokeweight="2pt"/>
<v:oval style="position:absolute; margin-left:200px; margin-top:3430px; width:7px; height:7px;" fillcolor="#008040" strokecolor="#008040" strokeweight="2pt"/>
<v:rect style="position:absolute; margin-left:190px; margin-top:3465px; width:237px; height:31px;" fillcolor="#FFFFFF" strokecolor="#FFFFFF" strokeweight="1pt"/>
<DIV id="text98_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:194px; margin-top:3467px; line-height:14px; white-space:nowrap">
新しくできるフォルダ名<BR/>
または、上書きするフォルダ名まで含める</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:4107px; width:712px; height:370px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text98_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:4113px; line-height:15px; white-space:nowrap">
WinCE = "C:\WINCE420"<BR/>
<BR/>
If MsgBox( "coredllをインストールします。"+Chr(13)+WinCE+"\platform\SG2_VR5500\drivers\ipLib\ipLibCom\ipLib-com.h" _<BR/>
&nbsp; &nbsp; &nbsp;+Chr(13)+WinCE+"\private\WINCEOS\COREOS\CORE\DLL"+Chr(13)+_<BR/>
&nbsp; &nbsp; &nbsp;WinCE+"\public\common\cesysgen\Makefile"+Chr(13)+_<BR/>
&nbsp; &nbsp; &nbsp;"を上書きし、"+Chr(13)+_<BR/>
&nbsp; &nbsp; &nbsp;WinCE+"\PLATFORM\SG2_VR5500\INC\ipLibCom.h などを作成します。"+Chr(13)+_<BR/>
&nbsp; &nbsp; &nbsp;"よろしいですか？ （ドライブは合っていますか？）"+Chr(13)+_<BR/>
&nbsp; &nbsp; &nbsp;"（リビルドするときや他の環境で使うときは、アンインストールしてください。）" ,_<BR/>
&nbsp; &nbsp;vbYesNo + vbExclamation, "上書き確認" ) = vbYes Then<BR/>
<BR/>
Set fs = CreateObject("Scripting.FileSystemObject")<BR/>
fs.CopyFolder "platform", WinCE+"\platform", TRUE<BR/>
fs.CopyFolder "private", WinCE+"\private", TRUE<BR/>
fs.CopyFolder "public", WinCE+"\public", TRUE<BR/>
Set fs = Nothing<BR/>
<BR/>
Set sh = WScript.CreateObject("WScript.Shell")<BR/>
sh.Run WinCE+"\PLATFORM\SG2_VR5500\DRIVERS\ipLib\ipLib-Headers-maker.vbs",1,True<BR/>
Set sh = Nothing<BR/>
<BR/>
MsgBox "インストールが完了しました。"<BR/>
<BR/>
End If</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:3549px; width:586px; height:505px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text98_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:3555px; line-height:15px; white-space:nowrap">
Sub main()<BR/>
<BR/>
&nbsp; Set args = WScript.Arguments<BR/>
&nbsp; If args.Count &lt;&gt; 2 Then MsgBox "This is update files copy script" _<BR/>
&nbsp; &nbsp; +vbCR+"ex) WScript.exe xcopy_pb.vbs c:\folder1 c:\folder2", vbOKOnly, "xcopy_pb" : Exit Sub<BR/>
<BR/>
&nbsp; Set fs = CreateObject( "Scripting.FileSystemObject" )<BR/>
&nbsp; Set folder1 = fs.GetFolder( args(0) )<BR/>
&nbsp; Set folder2 = fs.GetFolder( args(1) )<BR/>
<BR/>
&nbsp; For Each file In folder1.Files<BR/>
<BR/>
&nbsp; &nbsp; fname1 = args(0) + "\" + file.Name<BR/>
&nbsp; &nbsp; fname2 = args(1) + "\" + file.Name<BR/>
<BR/>
&nbsp; &nbsp; Set file1 = fs.GetFile( fname1 )<BR/>
<BR/>
&nbsp; &nbsp; On Error Resume Next<BR/>
&nbsp; &nbsp; Set file2 = fs.GetFile( fname2 )<BR/>
&nbsp; &nbsp; On Error Goto 0<BR/>
<BR/>
&nbsp; &nbsp; If IsEmpty( file2 ) Then<BR/>
&nbsp; &nbsp; &nbsp; fs.CopyFile fname1, fname2<BR/>
&nbsp; &nbsp; ElseIf&nbsp; file1.DateLastModified &gt; file2.DateLastModified Then<BR/>
&nbsp; &nbsp; &nbsp; fs.CopyFile fname1, fname2<BR/>
&nbsp; &nbsp; End If<BR/>
<BR/>
&nbsp; Next<BR/>
<BR/>
End Sub<BR/>
<BR/>
<BR/>
main</DIV>
<DIV id="text98_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:21px; margin-top:3522px; line-height:15px; white-space:nowrap">
<A name="copy_new">
新しいファイルのみコピーする</A></DIV>
<v:rect style="position:absolute; margin-left:347px; margin-top:3528px; width:188px; height:17px;" fillcolor="#FFFFFF" strokecolor="#FFFFFF" strokeweight="1pt"/>
<DIV id="text98_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:351px; margin-top:3530px; line-height:15px; white-space:nowrap">
（サブフォルダはコピーしません）</DIV>

<v:line from="0,3329" to="735,3329"/>
<v:line from="735,3329" to="735,4660"/>
<v:line from="735,4660" to="0,4660"/>
<v:line from="0,4660" to="0,3329"/>

</PAGE>
 
<!-- page 99 --> 
<PAGE>
<A id="svgcats_vml_p99" class="to_tree" style="margin-top:4665px;" onClick="selectTreeElem( '99' );">←</A>
<A href="#svgcats_vml_p100" class="to_next_page" style="margin-top:4665px;">▼</A>
<A href="#svgcats_vml_p98" class="to_prev_page" style="margin-top:4665px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4676px; width:498px; height:1241px;" fillcolor="white"/>
<DIV id="text99_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5098px; line-height:15px; white-space:nowrap">
<A name="file_list">
ファイル一覧</A></DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:5164px; width:394px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text99_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:5170px; line-height:15px; white-space:nowrap">
Dim g_fs, folder, file<BR/>
Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
Set folder = g_fs.GetFolder( "C:\folder" )<BR/>
For Each&nbsp; file&nbsp; In&nbsp; folder.Files<BR/>
&nbsp; &nbsp; file.Name,&nbsp; file.Path&nbsp; '// ここに処理を書く<BR/>
Next<BR/>
folder = Empty<BR/>
g_fs = Empty</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:5389px; width:394px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text99_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:5395px; line-height:15px; white-space:nowrap">
Dim g_fs, folder, sub_folder<BR/>
Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
Set folder = g_fs.GetFolder( "C:\folder" )<BR/>
For Each&nbsp; sub_folder&nbsp; In&nbsp; folder.SubFolders<BR/>
&nbsp; &nbsp; sub_folder.Name,&nbsp; sub_folder.Path&nbsp; '// ここに処理を書く<BR/>
Next<BR/>
folder = Empty<BR/>
g_fs = Empty</DIV>
<DIV id="text99_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:34px; margin-top:5324px; line-height:15px; white-space:nowrap">
<A name="folder_list">
サブフォルダ一覧 （１段下のみ）</A></DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:5567px; width:334px; height:205px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text99_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:5573px; line-height:15px; white-space:nowrap">
Dim g_fs<BR/>
Set g_fs = CreateObject("Scripting.FileSystemObject")<BR/>
EnumSubFolders_&nbsp; g_fs.GetFolder( "C:\folder" )<BR/>
<BR/>
Sub&nbsp; EnumSubFolders_( folder )<BR/>
&nbsp; &nbsp; Dim file, sub_folder<BR/>
&nbsp; &nbsp; For Each&nbsp; file&nbsp; In&nbsp; folder.Files<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; echo&nbsp; file.Path&nbsp; '// ここに処理を書く<BR/>
&nbsp; &nbsp; Next<BR/>
&nbsp; &nbsp; For Each&nbsp; sub_folder&nbsp; In&nbsp; folder.SubFolders <BR/>
&nbsp; &nbsp; &nbsp; &nbsp; EnumSubFolders_&nbsp; sub_folder<BR/>
&nbsp; &nbsp; Next<BR/>
End Sub</DIV>
<DIV id="text99_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:34px; margin-top:5542px; line-height:15px; white-space:nowrap">
<A name="files_list">
サブフォルダにあるファイル一覧 （再帰、ネスト）</A></DIV>
<DIV id="text99_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:5797px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<v:rect style="position:absolute; margin-left:112px; margin-top:5795px; width:117px; height:18px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text99_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:120px; margin-top:5797px; line-height:15px; white-space:nowrap">
SubFolders.vbs.lzh</DIV>
<DIV id="text99_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:63px; margin-top:5818px; line-height:15px; white-space:nowrap">
サブフォルダのすべてのファイルにコマンドを実行し、<BR/>
標準出力をファイルに出力します。</DIV>
<DIV id="text99_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4734px; line-height:15px; white-space:nowrap">
<A name="file_exist">
ファイルの存在</A></DIV>
<DIV id="text99_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:5122px; line-height:15px; white-space:nowrap">
フォルダの中にあるファイルの一覧です。<BR/>
フォルダの中のフォルダについては、</DIV>
<DIV id="text99_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:262px; margin-top:5137px; line-height:15px; white-space:nowrap">
<A href="#folder_list">
→ サブフォルダ一覧 （１段下のみ）</A></DIV>
<DIV id="text99_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:5350px; line-height:15px; white-space:nowrap">
フォルダの中にあるフォルダの一覧です。<BR/>
フォルダの中のファイルについては、</DIV>
<DIV id="text99_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:270px; margin-top:5365px; line-height:15px; white-space:nowrap">
<A href="#file_list">
→ ファイル一覧</A></DIV>
<DIV id="text99_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:30px; margin-top:4694px; line-height:15px; white-space:nowrap">
<A name="file_list">
ファイル一覧、存在</A></DIV>
<DIV id="text99_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:48px; margin-top:4768px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_FileExists">
→ FileSystemObject::FileExists</A></DIV>
<DIV id="text99_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:48px; margin-top:4789px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_FolderExists">
→ FileSystemObject::FolderExists</A></DIV>
<DIV id="text99_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4843px; line-height:15px; white-space:nowrap">
<A name="open_not_exist">
存在しないファイルを開く</A></DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:4867px; width:418px; height:190px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text99_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:4873px; line-height:15px; white-space:nowrap">
&nbsp; Dim i<BR/>
&nbsp; For i = 1 To 9999<BR/>
&nbsp; &nbsp; If i&lt;9999 Then On Error Resume Next&nbsp; 'try<BR/>
&nbsp; &nbsp; &nbsp; If i=1 Then : Test_LogFName = "test_log.txt"<BR/>
&nbsp; &nbsp; &nbsp; Else : Test_LogFName = "test_log" &amp; i &amp; ".txt" : End If<BR/>
&nbsp; &nbsp; &nbsp; Set g_log = g_fs.CreateTextFile( Test_LogFName, True, False )<BR/>
&nbsp; &nbsp; e.Copy( Err ) : On Error GoTo 0 : If e.num &lt;&gt; 0 Then&nbsp; 'catch<BR/>
&nbsp; &nbsp; &nbsp; If e.num &lt;&gt; 70 Then&nbsp; e.Raise<BR/>
&nbsp; &nbsp; Else<BR/>
&nbsp; &nbsp; &nbsp; Exit For<BR/>
&nbsp; &nbsp; End If<BR/>
&nbsp; Next</DIV>
<DIV id="text99_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:313px; margin-top:5200px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#folder_obj">
→ Folder オブジェクト</A></DIV>
<DIV id="text99_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:312px; margin-top:5425px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#folder_obj">
→ Folder オブジェクト</A></DIV>
<DIV id="text99_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:88px; margin-top:5869px; line-height:15px; white-space:nowrap">
→ ファイル一覧</DIV>
<DIV id="text99_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:47px; margin-top:5869px; line-height:15px; white-space:nowrap">
関連</DIV>

<v:line from="0,4676" to="498,4676"/>
<v:line from="498,4676" to="498,5917"/>
<v:line from="498,5917" to="0,5917"/>
<v:line from="0,5917" to="0,4676"/>

</PAGE>
 
<!-- page 100 --> 
<PAGE>
<A id="svgcats_vml_p100" class="to_tree" style="margin-top:5922px;" onClick="selectTreeElem( '100' );">←</A>
<A href="#svgcats_vml_p101" class="to_next_page" style="margin-top:5922px;">▼</A>
<A href="#svgcats_vml_p99" class="to_prev_page" style="margin-top:5922px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5933px; width:524px; height:1794px;" fillcolor="white"/>
<DIV id="text100_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:20px; margin-top:5951px; line-height:15px; white-space:nowrap">
<A name="fileaxs">
ファイル内アクセス（テキスト）</A></DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:6283px; width:448px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text100_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:6289px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
&nbsp; &nbsp; Set file = g_fs.CreateTextFile( path ******, True, False )<BR/>
<BR/>
&nbsp; &nbsp; file.Write&nbsp; "改行なし。"<BR/>
&nbsp; &nbsp; file.WriteLine "ファイル= " &amp; path&nbsp; '// 最後に 0x0D, 0x0A を出します<BR/>
&nbsp; &nbsp; file.WriteBlankLines 1&nbsp; '// ブランク行を1行書き込む<BR/>
<BR/>
&nbsp; &nbsp; file.Close&nbsp; '// 必要<BR/>
&nbsp; &nbsp; file = Empty<BR/>
&nbsp; &nbsp; g_fs = Empty</DIV>
<DIV id="text100_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6260px; line-height:15px; white-space:nowrap">
<A name="txt_write">
テキストファイルを作成する (Write)</A></DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:6519px; width:418px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text100_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:6525px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
&nbsp; &nbsp; Set f = g_fs.OpenTextFile( path ******,,,-2 )<BR/>
<BR/>
&nbsp; &nbsp; Do Until f.AtEndOfStream<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; line = f.ReadLine()&nbsp; '// 改行(vbCR+vbLF)は含まない<BR/>
&nbsp; &nbsp; Loop<BR/>
<BR/>
&nbsp; &nbsp; f.Close&nbsp; '// 必要<BR/>
&nbsp; &nbsp; f = Empty<BR/>
&nbsp; &nbsp; g_fs = Empty</DIV>
<DIV id="text100_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6494px; line-height:15px; white-space:nowrap">
<A name="txt_read">
テキストファイルの内容を読む (Read)</A></DIV>
<v:rect style="position:absolute; margin-left:340px; margin-top:6322px; width:130px; height:18px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text100_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:346px; margin-top:6324px; line-height:15px; white-space:nowrap">
↑上書き、非Unicode</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:7132px; width:442px; height:205px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text100_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:7138px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set&nbsp; g_fs = CreateObject( "Scripting.FileSystemObject" )<BR/>
<BR/>
&nbsp; &nbsp; Set f = g_fs.OpenTextFile( read_path1 ****** )<BR/>
&nbsp; &nbsp; t = f.ReadAll<BR/>
&nbsp; &nbsp; f = Empty&nbsp; '// 無くてもよい（ガベージコレクタでクローズされるため）<BR/>
<BR/>
&nbsp; &nbsp; Set f = g_fs.OpenTextFile( read_path2 ****** )<BR/>
&nbsp; &nbsp; t = t + f.ReadAll<BR/>
&nbsp; &nbsp; f = Empty<BR/>
<BR/>
&nbsp; &nbsp; Set f = g_fs.CreateTextFile( write_path ******, True )<BR/>
&nbsp; &nbsp; f.Write&nbsp; t<BR/>
&nbsp; &nbsp; f = Empty</DIV>
<DIV id="text100_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7112px; line-height:15px; white-space:nowrap">
<A name="txt_join">
テキストファイルを結合する</A></DIV>
<DIV id="text100_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:5991px; line-height:15px; white-space:nowrap">
<A href="#txt_write">
→ テキストファイルを作成する (Write)</A></DIV>
<DIV id="text100_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:6010px; line-height:15px; white-space:nowrap">
<A href="#txt_read">
→ テキストファイルの内容を読む (Read)</A></DIV>
<v:rect style="position:absolute; margin-left:257px; margin-top:6126px; width:127px; height:18px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text100_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:265px; margin-top:6128px; line-height:15px; white-space:nowrap">
→ base64.zip (VBS)</DIV>
<DIV id="text100_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:6106px; line-height:15px; white-space:nowrap">
バイナリファイルは扱えないようです。</DIV>
<DIV id="text100_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:6165px; line-height:15px; white-space:nowrap">
CreateTextFile の返り値は、TextStreamオブジェクトです。</DIV>
<DIV id="text100_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:82px; margin-top:6129px; line-height:12px; white-space:nowrap">
ADOのStreamを使えばできるらしい</DIV>
<DIV id="text100_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:6187px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/script56/html/jsmthcreateTextFile.asp" target="_blank">
→ CreateTextFile メソッド (Web)</A></DIV>
<DIV id="text100_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:6048px; line-height:15px; white-space:nowrap">
<A href="#txt_join">
→ テキストファイルを結合する</A></DIV>
<DIV id="text100_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:6209px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_OpenTextFile">
→ FileSystemObject::OpenTextFile</A></DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:6965px; width:442px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text100_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:6971px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Dim g_fs, f<BR/>
<BR/>
&nbsp; &nbsp; Set g_fs = CreateObject( "Scripting.FileSystemObject" )<BR/>
<BR/>
&nbsp; &nbsp; Const&nbsp; ForAppending = 8<BR/>
&nbsp; &nbsp; Set f = g_fs.OpenTextFile( path ******, ForAppending, True, False )<BR/>
&nbsp; &nbsp; f.WriteLine&nbsp; "A"</DIV>
<DIV id="text100_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6942px; line-height:15px; white-space:nowrap">
<A name="txt_append">
テキストファイルに追記する (Appending Write)</A></DIV>
<DIV id="text100_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:6029px; line-height:15px; white-space:nowrap">
<A href="#txt_append">
→ テキストファイルに追記する (Appending Write)</A></DIV>
<DIV id="text100_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:154px; margin-top:6586px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_05.html#TextStream_ReadLine">
ReadLine</A></DIV>
<DIV id="text100_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:154px; margin-top:6541px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_OpenTextFile">
OpenTextFile</A></DIV>
<DIV id="text100_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:155px; margin-top:7169px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_OpenTextFile">
OpenTextFile</A></DIV>
<DIV id="text100_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:172px; margin-top:6305px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_CreateTextFile">
CreateTextFile</A></DIV>
<DIV id="text100_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:155px; margin-top:7289px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_CreateTextFile">
CreateTextFile</A></DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:6743px; width:418px; height:175px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text100_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:6749px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set g_fs = WScript.CreateObject( "Scripting.FileSystemObject" )<BR/>
&nbsp; &nbsp; Set f = g_fs.OpenTextFile( path ****** )<BR/>
<BR/>
&nbsp; &nbsp; t = ""<BR/>
&nbsp; &nbsp; On Error Resume Next<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; t = f.ReadAll()<BR/>
&nbsp; &nbsp; en = Err.Number : ed = Err.Description : On Error GoTo 0<BR/>
&nbsp; &nbsp; If en = E_EndOfFile Then&nbsp; en = 0<BR/>
&nbsp; &nbsp; If en &lt;&gt; 0 Then&nbsp; Err.Raise en,,ed<BR/>
<BR/>
&nbsp; &nbsp; f = Empty </DIV>
<DIV id="text100_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:46px; margin-top:6724px; line-height:15px; white-space:nowrap">
ReadAll を使う場合</DIV>
<DIV id="text100_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:23px; margin-top:7378px; line-height:15px; white-space:nowrap">
<A name="txt_rep">
テキストファイルの一部を置き換える</A></DIV>
<DIV id="text100_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:6069px; line-height:15px; white-space:nowrap">
<A href="#txt_rep">
→ テキストファイルの一部を置き換える</A></DIV>
<DIV id="text100_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:277px; margin-top:6187px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#TextStream">
→ TextStream</A></DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:7401px; width:376px; height:295px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text100_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:7407px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set&nbsp; g_fs = CreateObject( "Scripting.FileSystemObject" )<BR/>
&nbsp; &nbsp; Dim&nbsp; rf, wf, line, src_path, dst_path<BR/>
<BR/>
&nbsp; &nbsp; src_path = folder_path + "\sample.c"<BR/>
&nbsp; &nbsp; dst_path = folder_path + "\sample.c_"<BR/>
<BR/>
&nbsp; &nbsp; If Not g_fs.FileExists( dst_path ) Then<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; mkdir&nbsp; &nbsp; g_fs.GetParentFolderName( dst_path )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set rf = g_fs.OpenTextFile( src_path )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set wf = g_fs.CreateTextFile( dst_path, True )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Do Until rf.AtEndOfStream<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; line = rf.ReadLine()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; line = Replace( line, "from", "to" )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wf.WriteLine&nbsp; line<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Loop<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; rf = Empty : wf = Empty<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; copy dst_path, src_path<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; del&nbsp; dst_path<BR/>
&nbsp; &nbsp; End If</DIV>
<DIV id="text100_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:143px; margin-top:7453px; line-height:13px; white-space:nowrap">
folder_path + "\sample.c"</DIV>
<DIV id="text100_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:143px; margin-top:7468px; line-height:13px; white-space:nowrap">
folder_path + "\sample.c_"</DIV>
<DIV id="text100_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:311px; margin-top:7588px; line-height:13px; white-space:nowrap">
to</DIV>
<DIV id="text100_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:263px; margin-top:7588px; line-height:13px; white-space:nowrap">
from</DIV>
<DIV id="text100_36" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:167px; margin-top:7588px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_10.html#Replace">
Replace</A></DIV>
<DIV id="text100_37" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:185px; margin-top:7543px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_CreateTextFile">
CreateTextFile</A></DIV>
<DIV id="text100_38" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:185px; margin-top:7528px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_OpenTextFile">
OpenTextFile</A></DIV>
<DIV id="text100_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:176px; margin-top:6724px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_25.html#ReadAll">
→ ReadAll</A></DIV>
<DIV id="text100_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:6691px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text100_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:88px; margin-top:6691px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_29.html#OpenForRead">
→ OpenForRead (vbslib)</A></DIV>
<DIV id="text100_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:93px; margin-top:6452px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_30.html#OpenForWrite">
→ OpenForWrite (vbslib)</A></DIV>
<DIV id="text100_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:6452px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text100_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:277px; margin-top:6106px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_15.html#ADODB_Stream">
→ ADODB.Stream</A></DIV>

<v:line from="0,5933" to="524,5933"/>
<v:line from="524,5933" to="524,7727"/>
<v:line from="524,7727" to="0,7727"/>
<v:line from="0,7727" to="0,5933"/>

</PAGE>
 
<!-- page 101 --> 
<PAGE>
<A id="svgcats_vml_p101" class="to_tree" style="margin-top:7732px;" onClick="selectTreeElem( '101' );">←</A>
<A href="#svgcats_vml_p102" class="to_next_page" style="margin-top:7732px;">▼</A>
<A href="#svgcats_vml_p100" class="to_prev_page" style="margin-top:7732px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7743px; width:537px; height:918px;" fillcolor="white"/>
<DIV id="text101_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7840px; line-height:15px; white-space:nowrap">
<A name="DeleteFolderR">
DeleteFolderR</A></DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:7869px; width:472px; height:760px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text101_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:7875px; line-height:15px; white-space:nowrap">
'***********************************************************************<BR/>
'&nbsp; &lt;&lt;&lt; [DeleteFolderR] リードオンリーファイルを含むフォルダでも削除する &gt;&gt;&gt; <BR/>
'************************************************************************/<BR/>
Sub DeleteFolderR( path )<BR/>
<BR/>
&nbsp; Set fs = CreateObject( "Scripting.FileSystemObject" )<BR/>
<BR/>
&nbsp; If fs.FolderExists( path ) Then Exit Sub<BR/>
<BR/>
&nbsp; path2 = path&nbsp; ' 末尾の \ 記号を取る<BR/>
&nbsp; If Right( path2, 1 ) = "\" Then&nbsp; path2 = Left( path2, Len( path2 ) - 1 )<BR/>
<BR/>
&nbsp; nFolder = 1<BR/>
&nbsp; ReDim folderPathes(nFolder)<BR/>
&nbsp; folderPathes(nFolder) = path2<BR/>
<BR/>
&nbsp; ' サブフォルダを列挙する<BR/>
&nbsp; iFolder = 1<BR/>
&nbsp; While iFolder &lt;= nFolder<BR/>
&nbsp; &nbsp; Set fo = fs.GetFolder( folderPathes(iFolder) )<BR/>
&nbsp; &nbsp; For Each sub in fo.SubFolders<BR/>
&nbsp; &nbsp; &nbsp; nFolder = nFolder + 1<BR/>
&nbsp; &nbsp; &nbsp; ReDim folderPathes(nFolder)<BR/>
&nbsp; &nbsp; &nbsp; folderPathes(nFolder) = sub.Path<BR/>
&nbsp; &nbsp; Next<BR/>
&nbsp; &nbsp; Set fo = Nothing<BR/>
&nbsp; &nbsp; iFolder = iFolder + 1<BR/>
&nbsp; WEnd<BR/>
<BR/>
&nbsp; ' すべてのサブフォルダにあるファイルのリードオンリー属性を外す<BR/>
&nbsp; For iFolder = 1 To nFolder<BR/>
&nbsp; &nbsp; Set fo = fs.GetFolder( folderPathes(iFolder) )<BR/>
&nbsp; &nbsp; For Each f in fo.Files<BR/>
&nbsp; &nbsp; &nbsp; Set file = fs.GetFile( f.Path )<BR/>
&nbsp; &nbsp; &nbsp; file.Attributes = file.Attributes And Not ReadOnly<BR/>
&nbsp; &nbsp; &nbsp; Set file = Nothing<BR/>
&nbsp; &nbsp; Next<BR/>
&nbsp; &nbsp; Set fo = Nothing<BR/>
&nbsp; Next<BR/>
<BR/>
&nbsp; ' フォルダを削除する<BR/>
&nbsp; fs.DeleteFolder( path )<BR/>
<BR/>
&nbsp; Set fs = Nothing<BR/>
<BR/>
End Sub<BR/>
<BR/>
<BR/>
<BR/>
&nbsp;</DIV>
<DIV id="text101_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7761px; line-height:15px; white-space:nowrap">
<A name="CreateFolder">
CreateFolder</A></DIV>
<DIV id="text101_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:41px; margin-top:7792px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_05.html#FileSystemObject_CreateFolder">
→ FileSystemObject::CreateFolder</A></DIV>

<v:line from="0,7743" to="537,7743"/>
<v:line from="537,7743" to="537,8661"/>
<v:line from="537,8661" to="0,8661"/>
<v:line from="0,8661" to="0,7743"/>

</PAGE>
 
<!-- page 102 --> 
<PAGE>
<A id="svgcats_vml_p102" class="to_tree" style="margin-top:8666px;" onClick="selectTreeElem( '102' );">←</A>
<A href="#svgcats_vml_p103" class="to_next_page" style="margin-top:8666px;">▼</A>
<A href="#svgcats_vml_p101" class="to_prev_page" style="margin-top:8666px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8677px; width:579px; height:1124px;" fillcolor="white"/>
<DIV id="text102_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8694px; line-height:15px; white-space:nowrap">
<A name="array">
変数、Empty、型、配列</A></DIV>
<v:rect style="position:absolute; margin-left:28px; margin-top:9028px; width:178px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text102_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:36px; margin-top:9034px; line-height:15px; white-space:nowrap">
Option Explicit<BR/>
Dim&nbsp; v1, v2<BR/>
Set&nbsp; v1 = CreateObject(...)<BR/>
&nbsp; :<BR/>
fs = Empty</DIV>
<DIV id="text102_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:225px; margin-top:9030px; line-height:15px; white-space:nowrap">
Option Explicit は、変数宣言が必要である<BR/>
ようにします。</DIV>
<DIV id="text102_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:225px; margin-top:9062px; line-height:15px; white-space:nowrap">
Set する前に Dim で宣言する必要があります。</DIV>
<v:rect style="position:absolute; margin-left:28px; margin-top:9262px; width:148px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text102_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:36px; margin-top:9269px; line-height:13px; white-space:nowrap">
If IsEmpty( var ) Then</DIV>
<DIV id="text102_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:201px; margin-top:9267px; line-height:15px; white-space:nowrap">
Dim var して、初期化していないときは、Empty</DIV>
<DIV id="text102_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:8799px; line-height:15px; white-space:nowrap">
<A href="#dim">
→ Dim の詳細</A></DIV>
<v:rect style="position:absolute; margin-left:28px; margin-top:9294px; width:136px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text102_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:36px; margin-top:9300px; line-height:15px; white-space:nowrap">
Set a = Nothing<BR/>
If a is Nothing Then</DIV>
<DIV id="text102_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:9392px; line-height:15px; white-space:nowrap">
Empty は、変数に何も値が入っていないことを示します。 未初期化と同じです。<BR/>
Null は、変数に何も値が入っていないことを示します。 初期化済みとは区別できます。<BR/>
Null と比較すると、演算結果は常に Null （False として分岐）になります。 If Empty &lt;&gt; 0 Then <BR/>
は True として分岐しますが、If Null &lt;&gt; 0 Then は False として分岐するので注意してください。<BR/>
Nothing は、何も無いことを示すオブジェクトです。<BR/>
返り値がオブジェクトのときは、呼び出し側が Set を使うので、<BR/>
Nothing を返したほうがいいでしょう。</DIV>
<DIV id="text102_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:8820px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_07.html#redim">
→ 配列、Redim Preserve</A></DIV>
<DIV id="text102_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:9518px; line-height:15px; white-space:nowrap">
Empty などの比較は、次のようになります。</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:9542px; width:166px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text102_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:9548px; line-height:15px; white-space:nowrap">
Empty = ""&nbsp; &nbsp;'// True, 真<BR/>
not Empty&nbsp; &nbsp; '// -1,&nbsp; &nbsp;真<BR/>
Null = ""&nbsp; &nbsp; '// Null, 偽<BR/>
Null &lt;&gt; ""&nbsp; &nbsp;'// Null, 偽</DIV>
<v:rect style="position:absolute; margin-left:28px; margin-top:9149px; width:286px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text102_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:36px; margin-top:9156px; line-height:13px; white-space:nowrap">
If IsObject( b ) Then&nbsp; Set a = b&nbsp; Else&nbsp; a = b</DIV>
<DIV id="text102_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:20px; margin-top:9126px; line-height:15px; white-space:nowrap">
下記のようにすれば、オブジェクトでもそうでなくても代入できます。</DIV>
<v:rect style="position:absolute; margin-left:28px; margin-top:9341px; width:130px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text102_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:36px; margin-top:9347px; line-height:15px; white-space:nowrap">
a = Null<BR/>
If IsNull( a ) Then</DIV>
<DIV id="text102_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:23px; margin-top:9646px; line-height:15px; white-space:nowrap">
<A name="is">
Is 演算子</A></DIV>
<DIV id="text102_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:9674px; line-height:15px; white-space:nowrap">
２つの変数が参照しているオブジェクトが同じ１つのオブジェクトかどうかを<BR/>
比較します。 メンバ変数の値が全く同じでもオブジェクトが異なるときは、<BR/>
False となります。 is 演算子の意味は、クラスの is-a 関係とは異なります。<BR/>
C言語における、ポインタの値の比較に相当します。</DIV>
<DIV id="text102_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:20px; margin-top:9226px; line-height:15px; white-space:nowrap">
<A name="Empty">
Empty, Nothing, Null</A></DIV>
<DIV id="text102_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8931px; line-height:15px; white-space:nowrap">
<A name="Set">
Set 命令</A></DIV>
<DIV id="text102_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:8736px; line-height:15px; white-space:nowrap">
<A href="#Set">
→ Set 命令</A></DIV>
<DIV id="text102_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:171px; margin-top:8736px; line-height:15px; white-space:nowrap">
オブジェクトを代入します</DIV>
<DIV id="text102_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:8953px; line-height:15px; white-space:nowrap">
オブジェクトを代入します。 左辺がオブジェクト型かどうかではなく、右辺がオブジェクト<BR/>
型なら、Set 命令を使ってください。 Set 命令を使わなければ、右辺の Value プロパティの<BR/>
値が代入されます。 なお、VBScript の変数には型がないので、そもそも左辺がオブジェクト型<BR/>
かどうかは判定できません。</DIV>
<DIV id="text102_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:8757px; line-height:15px; white-space:nowrap">
<A href="#Empty">
→ Empty, Nothing</A></DIV>
<DIV id="text102_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:171px; margin-top:8757px; line-height:15px; white-space:nowrap">
「無い」値</DIV>
<DIV id="text102_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:8778px; line-height:15px; white-space:nowrap">
<A href="#is">
→ Is 演算子</A></DIV>
<DIV id="text102_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:8862px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_07.html#typeif">
→ 型の判定</A></DIV>
<DIV id="text102_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:171px; margin-top:8778px; line-height:15px; white-space:nowrap">
同一オブジェクトの判定</DIV>
<DIV id="text102_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:171px; margin-top:8862px; line-height:15px; white-space:nowrap">
変数に入っている値の型</DIV>
<DIV id="text102_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:8841px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_07.html#arr_one_multi">
→ 単体と配列の共用変数</A></DIV>
<DIV id="text102_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:182px; margin-top:9299px; line-height:15px; white-space:nowrap">
Nothing はオブジェクトなので Set が必要<BR/>
Nothing かどうかは、is で判定</DIV>
<DIV id="text102_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:182px; margin-top:9344px; line-height:15px; white-space:nowrap">
Null は値なので Set が不要</DIV>
<v:rect style="position:absolute; margin-left:58px; margin-top:9744px; width:172px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text102_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:66px; margin-top:9751px; line-height:13px; white-space:nowrap">
If objs(i) is obj Then ...</DIV>
<DIV id="text102_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:233px; margin-top:9229px; line-height:12px; white-space:nowrap">
キーワード：</DIV>
<DIV id="text102_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:297px; margin-top:9229px; line-height:12px; white-space:nowrap">
<A name="IsNull">
IsEmpty, IsNull</A></DIV>
<DIV id="text102_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:403px; margin-top:9175px; line-height:12px; white-space:nowrap">
キーワード：</DIV>
<DIV id="text102_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:459px; margin-top:9175px; line-height:12px; white-space:nowrap">
<A name="IsObject">
IsObject</A></DIV>

<v:line from="0,8677" to="579,8677"/>
<v:line from="579,8677" to="579,9801"/>
<v:line from="579,9801" to="0,9801"/>
<v:line from="0,9801" to="0,8677"/>

</PAGE>
 
<!-- page 103 --> 
<PAGE>
<A id="svgcats_vml_p103" class="to_tree" style="margin-top:9806px;" onClick="selectTreeElem( '103' );">←</A>
<A href="vbs_memo_07.html#svgcats_vml_p104" class="to_next_page" style="margin-top:9806px;">▼</A>
<A href="#svgcats_vml_p102" class="to_prev_page" style="margin-top:9806px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9817px; width:564px; height:319px;" fillcolor="white"/>
<DIV id="text103_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9834px; line-height:15px; white-space:nowrap">
<A name="dim">
Dim の詳細</A></DIV>
<DIV id="text103_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9877px; line-height:15px; white-space:nowrap">
Dim は、グローバルで実行するとグローバルスコープに、<BR/>
プロシージャで実行するとローカルスコープになります。<BR/>
グローバルスコープとローカルスコープの両方で宣言すると、ローカルスコープの変数だけ<BR/>
見えますが、グローバルスコープの変数も別に存在します。</DIV>
<DIV id="text103_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:10004px; line-height:15px; white-space:nowrap">
プロシージャの中で Execute してインクルードしたコードは、ローカルスコープになります。</DIV>
<DIV id="text103_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:10038px; line-height:15px; white-space:nowrap">
Dim した後で、同じ変数名を Dim したときは、すでに使えるので無視され、<BR/>
エラーにもなりません。</DIV>
<DIV id="text103_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9957px; line-height:15px; white-space:nowrap">
Dim は実行フェーズで評価されます。 文法解析時は評価しません。<BR/>
Dim していない変数であるというエラーは、変数を評価するときに発生します。</DIV>
<DIV id="text103_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:32px; margin-top:10088px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/script56/html/vsstmDim.asp" target="_blank">
→ Dim ステートメント (Web)</A></DIV>

<v:line from="0,9817" to="564,9817"/>
<v:line from="564,9817" to="564,10136"/>
<v:line from="564,10136" to="0,10136"/>
<v:line from="0,10136" to="0,9817"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10136px;">
<A id="svgcats_vml_p103" class="to_tree" onClick="selectTreeElem( '103' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10136px;">
<A id="page_group_bottom" href="vbs_memo_07.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
