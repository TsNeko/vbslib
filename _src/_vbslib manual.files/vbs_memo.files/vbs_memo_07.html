<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>VBSメモ</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbs_memo.html?f1=vbs_memo.files/vbs_memo_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbs_memo.files/vbs_memo_07.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbs_memo.files/vbs_memo_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbs_memo.html?f1=vbs_memo.files/vbs_memo_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbs_memo.files/vbs_memo_07.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 105 --> 
<PAGE>
<A id="svgcats_vml_p105" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '105' );">←</A>
<A href="#svgcats_vml_p106" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbs_memo_06.html#svgcats_vml_p104" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbs_memo_06.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:564px; height:319px;" fillcolor="white"/>
<DIV id="text105_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="dim">
Dim の詳細</A></DIV>
<DIV id="text105_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:60px; line-height:15px; white-space:nowrap">
Dim は、グローバルで実行するとグローバルスコープに、<BR/>
プロシージャで実行するとローカルスコープになります。<BR/>
グローバルスコープとローカルスコープの両方で宣言すると、ローカルスコープの変数だけ<BR/>
見えますが、グローバルスコープの変数も別に存在します。</DIV>
<DIV id="text105_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:187px; line-height:15px; white-space:nowrap">
プロシージャの中で Execute してインクルードしたコードは、ローカルスコープになります。</DIV>
<DIV id="text105_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:221px; line-height:15px; white-space:nowrap">
Dim した後で、同じ変数名を Dim したときは、すでに使えるので無視され、<BR/>
エラーにもなりません。</DIV>
<DIV id="text105_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:140px; line-height:15px; white-space:nowrap">
Dim は実行フェーズで評価されます。 文法解析時は評価しません。<BR/>
Dim していない変数であるというエラーは、変数を評価するときに発生します。</DIV>
<DIV id="text105_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:32px; margin-top:271px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/script56/html/vsstmDim.asp" target="_blank">
→ Dim ステートメント (Web)</A></DIV>

<v:line from="0,0" to="564,0"/>
<v:line from="564,0" to="564,319"/>
<v:line from="564,319" to="0,319"/>
<v:line from="0,319" to="0,0"/>

</PAGE>
 
<!-- page 106 --> 
<PAGE>
<A id="svgcats_vml_p106" class="to_tree" style="margin-top:324px;" onClick="selectTreeElem( '106' );">←</A>
<A href="#svgcats_vml_p107" class="to_next_page" style="margin-top:324px;">▼</A>
<A href="#svgcats_vml_p105" class="to_prev_page" style="margin-top:324px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:335px; width:582px; height:2006px;" fillcolor="white"/>
<DIV id="text106_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:352px; line-height:15px; white-space:nowrap">
<A name="OptionExplicit">
Option Explicit 変数宣言不要論</A></DIV>
<DIV id="text106_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:382px; line-height:15px; white-space:nowrap">
変数の宣言が必要なプログラミング言語の場合、変数の宣言をし忘れて書き直すことが<BR/>
よくあり、コストになっています。 さらに、任意型の宣言は、意味がよく分からないため、<BR/>
可読性を下げます。 逆に言えば、変数宣言が不要であれば、可読性を上げるのです。<BR/>
このためか、新しいプログラミング言語 Python などは、ローカル変数の宣言を無くしています。</DIV>
<DIV id="text106_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:1983px; line-height:15px; white-space:nowrap">
Option Explicit の無い VBScript では、<BR/>
・変数宣言が不要になります<BR/>
・グローバル変数やメンバー変数に定義されていない名前を、関数の中で使った場合、<BR/>
　期待通り、ローカル変数になります<BR/>
・グローバル変数やメンバー変数に定義してある名前を、関数の中で使った場合、<BR/>
　ローカル変数のつもりで使ったものは、実はグローバル変数なので、期待した動作に<BR/>
　なりません。（対処法は、上記、変数名が衝突する問題を参照）<BR/>
<BR/>
次の点は、Option Explicit があってもなくても変わりません。<BR/>
・関数から呼び出し元に戻ったら、ローカル変数は削除されます。<BR/>
・引数は、ローカル変数になります。<BR/>
・ 呼び出し元のローカル変数の名前と衝突しても、期待通り、別のメモリの変数になります。<BR/>
　 （ちなみに、bash の場合は、同じメモリになる）</DIV>
<DIV id="text106_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:867px; line-height:15px; white-space:nowrap">
変数名が衝突する問題</DIV>
<DIV id="text106_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:40px; margin-top:900px; line-height:15px; white-space:nowrap">
変数宣言を不要とした場合、変数名が衝突していないことを裏付けることが、Dim <BR/>
文を実行するときから、テストに合格するときまで遅れます。 これにより、衝突して<BR/>
いる問題を解決することが、少しだけ難しくなります。</DIV>
<DIV id="text106_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:74px; margin-top:460px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_01.html#OptionExplicit_vbslib">
→ Option Explicit 変数宣言について (vbslib)</A></DIV>
<DIV id="text106_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:460px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text106_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:77px; margin-top:2289px; line-height:15px; white-space:nowrap">
<A href="http://www.asahi-net.or.jp/~ef2o-inue/vba_k/sub04_200_030.html" target="_blank">
→ 変数宣言を強制しないといけないのか。 (Web)</A></DIV>
<DIV id="text106_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:36px; margin-top:2289px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text106_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:364px; margin-top:2289px; line-height:15px; white-space:nowrap">
(cache)</DIV>
<DIV id="text106_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:483px; line-height:15px; white-space:nowrap">
→ T_NoOptionExplicit フォルダ</DIV>
<DIV id="text106_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:483px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text106_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1677px; line-height:15px; white-space:nowrap">
エラー・メッセージの違い</DIV>
<v:rect style="position:absolute; margin-left:52px; margin-top:1782px; width:460px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text106_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:60px; margin-top:1789px; line-height:13px; white-space:nowrap">
&lt;ERROR err_number='500' err_description='この変数は宣言されていません。'/&gt;</DIV>
<DIV id="text106_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:1760px; line-height:15px; white-space:nowrap">
Option Explicit があるとき</DIV>
<v:rect style="position:absolute; margin-left:52px; margin-top:1845px; width:382px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text106_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:60px; margin-top:1852px; line-height:13px; white-space:nowrap">
&lt;ERROR err_number='13' err_description='型が一致しません。'/&gt;</DIV>
<DIV id="text106_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:1825px; line-height:15px; white-space:nowrap">
Option Explicit がないとき</DIV>
<DIV id="text106_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:1707px; line-height:15px; white-space:nowrap">
関数として定義されていないシンボルを使って関数呼び出しをしようとすると、<BR/>
Option Explicit があるときと、無いときで、エラーメッセージが異なります。</DIV>
<DIV id="text106_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:646px; line-height:15px; white-space:nowrap">
VBScript の Dim は、変数名の衝突を早期に検出すること以外に機能はありません。 <BR/>
プログラミング言語によっては変数の型を決めることがありますが、VBScript は、<BR/>
変数にどの型の値でも入るため変数の型を決める機能はありません。<BR/>
<BR/>
衝突を検出するだけの命令文は、プログラムが何かをする命令文ではありません。<BR/>
これは問題です。 プログラムが何をしようとしているのかを理解しようとするときに、<BR/>
実は何もしていないモノに遭遇しても、何をしようとしているのか懸命に探します。 <BR/>
この脳の状態で、実は何もしていない、ということに気づくのは大変なことです。 <BR/>
大きなコストになります。 また、何もしていないことを読まされることは不快です。 <BR/>
<BR/>
Dim 命令の説明でよくあるのが、使っている変数を挙げているとありますが、別に <BR/>
Dim 命令が無くても使っている変数は分かります。 変数を初期化している文で、<BR/>
よく理解できます。 Dim はくどいのです。</DIV>
<DIV id="text106_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:60px; margin-top:1876px; line-height:15px; white-space:nowrap">
なぜ、型が一致しませんと表示されるかというと、定義されていない関数と同じ<BR/>
名前の新しい変数が自動的に生成され、初期値である Empty が入り、Empty <BR/>
を使って関数呼び出しをしようと WSH が解釈してしまうからです。</DIV>
<DIV id="text106_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:2236px; line-height:15px; white-space:nowrap">
下記のホームページでは、Dim の必要性を説明していますが、必要の根拠となる機能<BR/>
が無くても、すぐに別のエラーで知ることが出来るため、問題として挙げられていること<BR/>
が真の問題の解決を困難にすることはありません。</DIV>
<DIV id="text106_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:525px; line-height:15px; white-space:nowrap">
VBScript で、Option Explicit を使った場合、よく遭遇するのは、変数を宣言していない<BR/>
というエラーです。 このエラーを対処するには、デバッガーを使う形で最初からやり直して、<BR/>
衝突している変数を知って、Dim 宣言を追加して、また最初からやり直す必要があります。 <BR/>
つまり、２回も再起動が必要になります。 これは結構なコストです。 もし、デバッガー<BR/>
が無ければ、対処は更に困難になります。<BR/>
Option Explicit を使っている人は、このコストの大きさに気づいていません。<BR/>
（私も気づくのに時間がかかりました）</DIV>
<DIV id="text106_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:17px; margin-top:1958px; line-height:15px; white-space:nowrap">
Option Explicit があるときとないときの違い </DIV>
<DIV id="text106_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:17px; margin-top:2208px; line-height:15px; white-space:nowrap">
その他の問題</DIV>
<DIV id="text106_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:1209px; line-height:15px; white-space:nowrap">
ローカル変数同士が衝突した場合、原因は、その関数の中だけに絞られます。<BR/>
つまり、呼び出した先の関数に原因がある一般的なミスに比べると、原因がある範囲が<BR/>
限定的なので、対処が比較的簡単です。</DIV>
<v:rect style="position:absolute; margin-left:84px; margin-top:990px; width:208px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text106_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:92px; margin-top:996px; line-height:15px; white-space:nowrap">
Sub&nbsp; MyTest()<BR/>
&nbsp; name = "MyName"<BR/>
&nbsp; name = "YourName"<BR/>
&nbsp; Assert&nbsp; FuncA( name ) = "Taro"<BR/>
End Sub</DIV>
<DIV id="text106_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:40px; margin-top:963px; line-height:15px; white-space:nowrap">
どれだけ難しくなるかを、見てみましょう。</DIV>
<DIV id="text106_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:40px; margin-top:1089px; line-height:15px; white-space:nowrap">
これは、name = "MyName" であることを期待しているテスト・スクリプトで、name が <BR/>
"YourName" に変わったためにテストに失敗しています。 この原因を追究するときは、<BR/>
name の値をどこで代入しているかを調べることになります。 name を上方向に検索して、<BR/>
name = "YourName" が見つかり、それを対処することになります。<BR/>
実は、これは、変数が衝突したときよりも発生頻度が高い、一般的なミスによって name<BR/>
の値が違っているケースと同じ対処法です。 確かに Dim 文によって衝突を検出した<BR/>
方が速く原因が特定できますが、検出しなくても一般的な対処法で済むわけです。</DIV>
<DIV id="text106_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:1422px; line-height:15px; white-space:nowrap">
変数名が衝突するミスは、Dim 文の記述を忘れるミスに比べると、かなり発生頻度が<BR/>
低いです。 衝突する頻度が低い理由は、意味が異なる変数には、通常異なる名前を<BR/>
付けるからです。 Dim 文の記述を忘れることが多い理由かは、Dim が何かをする<BR/>
命令文ではないからです。 何かをさせるために記述しているときに、させることが全て<BR/>
記述できたら、完成と思うからです。<BR/>
<BR/>
以上から、発生頻度と修正コストを総合して考えると、Option Explicit をつけた方が<BR/>
コストが高くなるというわけです。</DIV>
<DIV id="text106_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:1330px; line-height:15px; white-space:nowrap">
ローカル変数のつもりで使った変数が、実はグローバル変数やメンバー変数だったとき、<BR/>
つまり、グローバル変数やメンバー変数がローカル変数に衝突した場合は、ローカル<BR/>
変数のつもりでデバッグを行おうとするため、対処が困難でしょう。 しかし、グローバル<BR/>
変数の名前の先頭に "g_" を付けるコーディング・ルールなどを適用すれば、その問題は<BR/>
無くなります。 Python では、「global」 命令によって問題を回避しています。</DIV>
<DIV id="text106_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:38px; margin-top:1268px; line-height:15px; white-space:nowrap">
グローバル変数同士やメンバー変数同士の衝突は、一般的なバグの対処と変わりません。 <BR/>
また、Option Explicit を使っても、VBS ファイルをモジュール別に分けていると、Dim を<BR/>
使っても衝突を検出できません。</DIV>
<DIV id="text106_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1582px; line-height:15px; white-space:nowrap">
後でグローバル変数や関数が追加されて、ローカル変数と衝突した場合</DIV>
<DIV id="text106_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:1611px; line-height:15px; white-space:nowrap">
後でグローバル変数や関数が追加されて、ローカル変数と衝突した場合は、<BR/>
ローカル変数に対して Dim 宣言すれば問題に対処できます。</DIV>

<v:line from="0,335" to="582,335"/>
<v:line from="582,335" to="582,2341"/>
<v:line from="582,2341" to="0,2341"/>
<v:line from="0,2341" to="0,335"/>

</PAGE>
 
<!-- page 107 --> 
<PAGE>
<A id="svgcats_vml_p107" class="to_tree" style="margin-top:2346px;" onClick="selectTreeElem( '107' );">←</A>
<A href="#svgcats_vml_p108" class="to_next_page" style="margin-top:2346px;">▼</A>
<A href="#svgcats_vml_p106" class="to_prev_page" style="margin-top:2346px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2357px; width:589px; height:2089px;" fillcolor="white"/>
<DIV id="text107_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2374px; line-height:15px; white-space:nowrap">
<A name="name_space_contamination">
名前空間の汚染の対策</A></DIV>
<DIV id="text107_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2407px; line-height:15px; white-space:nowrap">
グローバル変数を、１つのオブジェクトにまとめると、アプリケーションや組み合わせる<BR/>
ライブラリが使えるグローバル変数名に制限が少なくなります。 言いかえれば、名前空間を<BR/>
汚染することが最小限の抑えることができます。</DIV>
<v:rect style="position:absolute; margin-left:70px; margin-top:2529px; width:196px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text107_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:78px; margin-top:2535px; line-height:15px; white-space:nowrap">
Sub&nbsp; SampleFunction()<BR/>
&nbsp; &nbsp; Set g = g_VBScriptLibraryX<BR/>
&nbsp; &nbsp; g.DoFunction<BR/>
&nbsp; &nbsp; g.Variable = 1<BR/>
End Sub</DIV>
<DIV id="text107_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:3297px; line-height:15px; white-space:nowrap">
関数の定義は、クラスの中のメソッドに定義します。</DIV>
<v:rect style="position:absolute; margin-left:64px; margin-top:3532px; width:370px; height:250px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text107_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:72px; margin-top:3538px; line-height:15px; white-space:nowrap">
Dim&nbsp; g_VBScriptLibraryX<BR/>
Set&nbsp; g_VBScriptLibraryX = new VBScriptLibraryX_Class<BR/>
<BR/>
Class&nbsp; VBScriptLibraryX_Class<BR/>
&nbsp; &nbsp; Public&nbsp; LibraryFunction<BR/>
&nbsp; &nbsp; Public&nbsp; LibraryVariable<BR/>
<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set g = Me<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set g.LibraryFunction = GetRef( "LibraryFunction" )<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class<BR/>
<BR/>
Sub&nbsp; LibraryFunction()<BR/>
&nbsp; &nbsp; '// ...<BR/>
End Sub</DIV>
<DIV id="text107_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:3476px; line-height:15px; white-space:nowrap">
すでにある関数の定義から、名前空間の汚染に対策するまでの移行期間では、<BR/>
次のように、関数の参照をメンバー変数に代入します。<BR/>
（なお、VBScript では、匿名関数を定義できません。）</DIV>
<v:rect style="position:absolute; margin-left:64px; margin-top:3320px; width:328px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text107_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:72px; margin-top:3326px; line-height:15px; white-space:nowrap">
Dim&nbsp; g_VBScriptLibraryX<BR/>
Set&nbsp; g_VBScriptLibraryX = new VBScriptLibraryX_Class<BR/>
<BR/>
Class&nbsp; VBScriptLibraryX_Class<BR/>
&nbsp; &nbsp; Public Sub&nbsp; LibraryFunction()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; '// ...<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class</DIV>
<DIV id="text107_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:51px; margin-top:3835px; line-height:15px; white-space:nowrap">
VBScript では、クラスをクラスの中に入れることができません。<BR/>
オブジェクトを生成するメソッド（new_&lt;クラス名&gt;）を用意し、実際のクラス名の先頭に、固有<BR/>
のライブラリの名前を付けるようにします。</DIV>
<v:rect style="position:absolute; margin-left:64px; margin-top:3890px; width:472px; height:250px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text107_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:72px; margin-top:3896px; line-height:15px; white-space:nowrap">
Class&nbsp; VBScriptLibraryX_Class<BR/>
&nbsp; &nbsp; Public&nbsp; new_SampleClass<BR/>
<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set g = Me<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set g.new_SampleClass = GetRef( "new_VBScriptLibraryX_SampleClass" )<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class<BR/>
<BR/>
Class&nbsp; VBScriptLibraryX_SampleClass<BR/>
&nbsp; &nbsp; '// ...<BR/>
End Class<BR/>
<BR/>
Function&nbsp; new_VBScriptLibraryX_SampleClass()<BR/>
&nbsp; &nbsp; Set new_VBScriptLibraryX_SampleClass = new VBScriptLibraryX_SampleClass<BR/>
End Function</DIV>
<v:rect style="position:absolute; margin-left:64px; margin-top:4192px; width:334px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text107_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:72px; margin-top:4198px; line-height:15px; white-space:nowrap">
Sub&nbsp; SampleFunction()<BR/>
&nbsp; &nbsp; Set g = g_VBScriptLibraryX<BR/>
&nbsp; &nbsp; Set object = g.new_VBScriptLibraryX_SampleClass()<BR/>
End Sub</DIV>
<DIV id="text107_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:51px; margin-top:4170px; line-height:15px; white-space:nowrap">
オブジェクトを生成するときは、次のようになります。</DIV>
<v:roundrect style="position:absolute; margin-left:200px; margin-top:2371px; width:56px; height:20px;" arcsize="0.500000" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text107_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:208px; margin-top:2374px; line-height:15px; white-space:nowrap">
未確認</DIV>
<DIV id="text107_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2785px; line-height:15px; white-space:nowrap">
<A name="name_spaced_variable">
変数</A></DIV>
<DIV id="text107_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3269px; line-height:15px; white-space:nowrap">
<A name="name_spaced_function">
関数</A></DIV>
<DIV id="text107_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3806px; line-height:15px; white-space:nowrap">
<A name="name_spaced_class">
クラス</A></DIV>
<DIV id="text107_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2470px; line-height:15px; white-space:nowrap">
この問題の対策は、ライブラリ固有の長めの名前のグローバル変数を使い、ライブラリを<BR/>
使うときは、１文字の変数に代入してから使います。 なお、すべての関数の先頭に、この<BR/>
代入が必要になります。</DIV>
<v:rect style="position:absolute; margin-left:64px; margin-top:2843px; width:328px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text107_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:72px; margin-top:2849px; line-height:15px; white-space:nowrap">
Dim&nbsp; g_VBScriptLibraryX<BR/>
Set&nbsp; g_VBScriptLibraryX = new VBScriptLibraryX_Class<BR/>
<BR/>
Class&nbsp; VBScriptLibraryX_Class<BR/>
&nbsp; &nbsp; Public&nbsp; LibraryVariable<BR/>
<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; LibraryVariable = 1<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class</DIV>
<DIV id="text107_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:39px; margin-top:2633px; line-height:15px; white-space:nowrap">
<A href="#name_spaced_variable">
→ 変数</A></DIV>
<DIV id="text107_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:39px; margin-top:2653px; line-height:15px; white-space:nowrap">
<A href="#name_spaced_function">
→ 関数</A></DIV>
<DIV id="text107_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:39px; margin-top:2673px; line-height:15px; white-space:nowrap">
<A href="#name_spaced_class">
→ クラス</A></DIV>
<DIV id="text107_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:2815px; line-height:15px; white-space:nowrap">
変数は、メンバー変数にします。</DIV>
<DIV id="text107_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4300px; line-height:15px; white-space:nowrap">
<A name="name_space_dynamic_member">
メンバー変数の拡張</A></DIV>
<DIV id="text107_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:51px; margin-top:4325px; line-height:15px; white-space:nowrap">
VBScript のクラスは、動的にメンバー変数を追加することができません。<BR/>
このため、ライブラリが、複数の .vbs ファイルに分かれていると、関数などを１つの<BR/>
クラスのメソッドにまとめることができません。</DIV>
<DIV id="text107_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:51px; margin-top:4383px; line-height:15px; white-space:nowrap">
１つのファイルに集めるスクリプトを動かしてから、ライブラリを動かす（関数定義する）<BR/>
とよいでしょう。</DIV>
<DIV id="text107_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:39px; margin-top:2693px; line-height:15px; white-space:nowrap">
<A href="#name_space_dynamic_member">
→ メンバー変数の拡張</A></DIV>
<DIV id="text107_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:63px; margin-top:2730px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_13.html#get_ModuleConsts">
→ get_ModuleConsts : クラスの定数 (vbsool)</A></DIV>
<DIV id="text107_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2730px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text107_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:3021px; line-height:15px; white-space:nowrap">
すでにあるグローバル変数の定義から、名前空間の汚染に対策するまでの移行期間では、<BR/>
次のように、プロパティを使います。</DIV>
<v:rect style="position:absolute; margin-left:64px; margin-top:3059px; width:460px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text107_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:72px; margin-top:3065px; line-height:15px; white-space:nowrap">
Dim&nbsp; g_VBScriptLibraryX<BR/>
Set&nbsp; g_VBScriptLibraryX = new VBScriptLibraryX_Class<BR/>
<BR/>
Class&nbsp; VBScriptLibraryX_Class<BR/>
&nbsp; &nbsp; '//[Variable]<BR/>
&nbsp; &nbsp; Public Property Let&nbsp; Variable( x ) : g_Variable = x : End Property<BR/>
&nbsp; &nbsp; Public Property Get&nbsp; Variable() : Variable = g_Variable : End Property<BR/>
End Class<BR/>
<BR/>
Dim&nbsp; g_Variable</DIV>

<v:line from="0,2357" to="589,2357"/>
<v:line from="589,2357" to="589,4446"/>
<v:line from="589,4446" to="0,4446"/>
<v:line from="0,4446" to="0,2357"/>

</PAGE>
 
<!-- page 108 --> 
<PAGE>
<A id="svgcats_vml_p108" class="to_tree" style="margin-top:4451px;" onClick="selectTreeElem( '108' );">←</A>
<A href="#svgcats_vml_p109" class="to_next_page" style="margin-top:4451px;">▼</A>
<A href="#svgcats_vml_p107" class="to_prev_page" style="margin-top:4451px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4462px; width:599px; height:1661px;" fillcolor="white"/>
<DIV id="text108_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4479px; line-height:15px; white-space:nowrap">
<A name="redim">
配列、Array、ReDim Preserve</A></DIV>
<DIV id="text108_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:22px; margin-top:6035px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/script56/html/vsstmDim.asp" target="_blank">
→ Dim ステートメント (Web)</A></DIV>
<DIV id="text108_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:22px; margin-top:6055px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/script56/html/vsstmRedim.asp" target="_blank">
→ ReDim ステートメント (Web)</A></DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:5022px; width:250px; height:310px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text108_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:5028px; line-height:15px; white-space:nowrap">
Dim&nbsp; a(), b<BR/>
ReDim&nbsp; a(1), b(1)<BR/>
a(1) = "abc"<BR/>
WScript.Echo "1=" &amp; a(1)&nbsp; ' 1=abc<BR/>
ReDim Preserve&nbsp; a(2)<BR/>
WScript.Echo "0=" &amp; a(0)&nbsp; ' 0=<BR/>
WScript.Echo "1=" &amp; a(1)&nbsp; ' 1=abc<BR/>
WScript.Echo "2=" &amp; a(2)&nbsp; ' 2=<BR/>
'WScript.Echo "3=" &amp; a(3)&nbsp; ' エラー<BR/>
<BR/>
Array_echo( a )<BR/>
<BR/>
Sub Array_echo( arr )<BR/>
&nbsp; Dim i<BR/>
<BR/>
&nbsp; WScript.Echo&nbsp; "UBound="&amp;UBound( arr )<BR/>
&nbsp; For Each i In arr<BR/>
&nbsp; &nbsp; WScript.Echo&nbsp; "each = " + i<BR/>
&nbsp; Next<BR/>
End Sub</DIV>
<DIV id="text108_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:289px; margin-top:5095px; line-height:15px; white-space:nowrap">
ReDim Preserve は、要素の内容を<BR/>
保持したまま、要素の数を変える。</DIV>
<DIV id="text108_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:289px; margin-top:5028px; line-height:15px; white-space:nowrap">
ReDim するなら Dim&nbsp; は不要。 () も不要。<BR/>
ReDim&nbsp; a(1) で、a(0)〜a(1) が使える</DIV>
<DIV id="text108_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:289px; margin-top:5271px; line-height:15px; white-space:nowrap">
For Each が使える</DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:5411px; width:76px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text108_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:5417px; line-height:15px; white-space:nowrap">
1=abc<BR/>
0=<BR/>
1=abc<BR/>
2=<BR/>
UBound=2<BR/>
each =<BR/>
each = abc<BR/>
each =</DIV>
<DIV id="text108_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:5391px; line-height:15px; white-space:nowrap">
出力</DIV>
<DIV id="text108_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:289px; margin-top:5209px; line-height:15px; white-space:nowrap">
配列は引数に渡せる</DIV>
<DIV id="text108_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:4951px; line-height:15px; white-space:nowrap">
Dim a() とすると a は配列になりますが、配列に固定されてしまいます。<BR/>
Dim b : ReDim b(1) としても b は配列になり、後で b に配列以外を格納することもできます。<BR/>
Redim Preserve&nbsp; a(-1) もできますが、Excel では a = Array() とする必要があります。<BR/>
二次元配列は Redim&nbsp; a( 2, 3 ) のようにコンマで区切ります。</DIV>
<DIV id="text108_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:4688px; line-height:15px; white-space:nowrap">
{ 1, 2, 3 } のような初期化子はありませんが、a = Array( 1, 2, 3 ) はできます。<BR/>
空要素を指定したり、階層化することもできます。</DIV>
<DIV id="text108_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:20px; margin-top:5859px; line-height:15px; white-space:nowrap">
<A name="array_add">
配列の最後に追加する</A></DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:5898px; width:256px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text108_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:5904px; line-height:15px; white-space:nowrap">
ReDim Preserve&nbsp; arr( UBound( arr ) + 1 )<BR/>
arr( UBound( arr ) ) = 1234</DIV>
<DIV id="text108_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:5941px; line-height:15px; white-space:nowrap">
配列のメンバ変数に対する Redim は、メンバ関数の中でしかできません。</DIV>
<DIV id="text108_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:5342px; line-height:15px; white-space:nowrap">
返り値を ReDim で配列にすることはできませんが、配列変数を返り値に代入できます。<BR/>
引数に渡した配列は、関数内で ReDim して要素数を変えることができます。</DIV>
<DIV id="text108_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:22px; margin-top:6015px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_12.html#new_objs">
→ オブジェクトの配列を生成する new_ClassA_array</A></DIV>
<DIV id="text108_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:22px; margin-top:6075px; line-height:15px; white-space:nowrap">
<A href="http://www012.upp.so-net.ne.jp/scotchegg/VBScript/Array.htm" target="_blank">
→ Deep Decryption - VBScript Tips - 配列再考 (Web)</A></DIV>
<DIV id="text108_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:20px; margin-top:5665px; line-height:15px; white-space:nowrap">
<A name="copy_array">
配列全体のコピー</A></DIV>
<v:rect style="position:absolute; margin-left:34px; margin-top:5689px; width:118px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text108_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:42px; margin-top:5695px; line-height:15px; white-space:nowrap">
Dim&nbsp; a, b<BR/>
a = Array( 1, 2 )<BR/>
b = a</DIV>
<DIV id="text108_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:5753px; line-height:15px; white-space:nowrap">
b = a のように代入すると、すべての配列の要素をコピーします。<BR/>
C 言語のような参照ではありません。<BR/>
Dim&nbsp; b() と宣言すると、コピーできなくなります。<BR/>
関数の返り値に配列を渡すこともできます。</DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:4738px; width:142px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text108_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:4744px; line-height:15px; white-space:nowrap">
Dim&nbsp; a<BR/>
a = Array( 1, 2, 3 )<BR/>
<BR/>
a = Array( )<BR/>
a = Array( 1 )<BR/>
a = Array( 1, "ABC" )<BR/>
a = Array( , "ABC" )<BR/>
FuncA&nbsp; Array( _<BR/>
&nbsp; Array( 1, "ABC" ),_<BR/>
&nbsp; Array( 2, "DEF" ) )</DIV>
<DIV id="text108_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:209px; margin-top:5905px; line-height:13px; white-space:nowrap">
arr</DIV>
<DIV id="text108_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:131px; margin-top:5905px; line-height:13px; white-space:nowrap">
arr</DIV>
<DIV id="text108_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:113px; margin-top:5920px; line-height:13px; white-space:nowrap">
arr</DIV>
<DIV id="text108_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:35px; margin-top:5920px; line-height:13px; white-space:nowrap">
arr</DIV>
<DIV id="text108_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:173px; margin-top:5920px; line-height:13px; white-space:nowrap">
1234</DIV>
<DIV id="text108_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:190px; margin-top:4758px; line-height:15px; white-space:nowrap">
← Array 関数は、配列を返します。<BR/>
　　a(0)=1, a(1)=2, a(2)=3, UBound(a)=要素数-1<BR/>
← 空の配列, UBound(a) = -1<BR/>
← 要素数が１つの配列<BR/>
← 数値と文字列が混在した配列<BR/>
← 空要素を含む配列。 VarType( a(0) ) = vbError<BR/>
← 配列が入っている配列を関数 FuncA に渡す</DIV>
<DIV id="text108_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:209px; margin-top:4863px; line-height:15px; white-space:nowrap">
<A name="structed_array">
（階層化配列）</A></DIV>
<DIV id="text108_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4664px; line-height:15px; white-space:nowrap">
<A name="array_func">
Array 関数</A></DIV>
<DIV id="text108_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:20px; margin-top:4922px; line-height:15px; white-space:nowrap">
<A name="dim_redim">
Dim と ReDim</A></DIV>
<DIV id="text108_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:4547px; line-height:15px; white-space:nowrap">
<A href="#copy_array">
→ 配列全体のコピー</A></DIV>
<DIV id="text108_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:4565px; line-height:15px; white-space:nowrap">
<A href="#array_add">
→ 配列の最後に追加する</A></DIV>
<DIV id="text108_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:4511px; line-height:15px; white-space:nowrap">
<A href="#array_func">
→ Array 関数</A></DIV>
<DIV id="text108_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:4529px; line-height:15px; white-space:nowrap">
<A href="#dim_redim">
→ Dim と ReDim</A></DIV>
<DIV id="text108_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:4583px; line-height:15px; white-space:nowrap">
<A href="#IsArray">
→ 配列かどうかの判定 IsArray</A></DIV>
<DIV id="text108_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:5570px; line-height:15px; white-space:nowrap">
配列のメンバ変数に対する Redim は、メンバ関数の中でしかできません。<BR/>
オブジェクトのメンバを参照するピリオド演算子を使った時点で、Redim した内容は<BR/>
メンバ変数には反映されません。<BR/>
ArrayClass(vbslib) を使えば、クラスの外から配列の要素数を変えることができます。</DIV>
<DIV id="text108_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:5964px; line-height:15px; white-space:nowrap">
上記のように、１要素ずつ増やすと、処理速度はかなり遅くなります。</DIV>
<DIV id="text108_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:4601px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_16.html#speed_array_arg">
→ 引数に配列を渡す速度</A></DIV>
<DIV id="text108_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:52px; margin-top:4619px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_16.html#speed_array_redim">
→ 配列要素を追加する速度</A></DIV>

<v:line from="0,4462" to="599,4462"/>
<v:line from="599,4462" to="599,6123"/>
<v:line from="599,6123" to="0,6123"/>
<v:line from="0,6123" to="0,4462"/>

</PAGE>
 
<!-- page 109 --> 
<PAGE>
<A id="svgcats_vml_p109" class="to_tree" style="margin-top:6128px;" onClick="selectTreeElem( '109' );">←</A>
<A href="#svgcats_vml_p110" class="to_next_page" style="margin-top:6128px;">▼</A>
<A href="#svgcats_vml_p108" class="to_prev_page" style="margin-top:6128px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6139px; width:478px; height:467px;" fillcolor="white"/>
<DIV id="text109_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6156px; line-height:15px; white-space:nowrap">
<A name="Split">
Split</A></DIV>
<v:rect style="position:absolute; margin-left:34px; margin-top:6340px; width:262px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text109_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:42px; margin-top:6346px; line-height:15px; white-space:nowrap">
Dim&nbsp; a, e<BR/>
a = Split( "abc, 123 ,""ABC""", "," )<BR/>
For Each e In a : echo "["+ e +"]" : Next</DIV>
<v:rect style="position:absolute; margin-left:28px; margin-top:6188px; width:418px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text109_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:36px; margin-top:6195px; line-height:13px; white-space:nowrap">
Function&nbsp; Split( Str as stirng, Term as string ) as Array of string</DIV>
<DIV id="text109_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:6225px; line-height:15px; white-space:nowrap">
文字列を、指定の文字で区切って、配列に格納します。</DIV>
<DIV id="text109_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:6251px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text109_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:100px; margin-top:6251px; line-height:15px; white-space:nowrap">
Str</DIV>
<DIV id="text109_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:100px; margin-top:6270px; line-height:15px; white-space:nowrap">
Term</DIV>
<DIV id="text109_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:6251px; line-height:15px; white-space:nowrap">
分割しようとする文字列</DIV>
<DIV id="text109_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:6270px; line-height:15px; white-space:nowrap">
区切り文字</DIV>
<DIV id="text109_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:100px; margin-top:6289px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text109_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:6289px; line-height:15px; white-space:nowrap">
分割した文字列の配列</DIV>
<DIV id="text109_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:176px; margin-top:6158px; line-height:12px; white-space:nowrap">
<A href="#redim">
[ 親: vbs の配列 ]</A></DIV>
<DIV id="text109_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:6402px; line-height:15px; white-space:nowrap">
a(0) = [abc]<BR/>
a(1) = [ 123 ]<BR/>
a(2) = ["ABC"]</DIV>
<DIV id="text109_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:119px; margin-top:6155px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/cc410311.aspx" target="_blank">
(Web)</A></DIV>
<DIV id="text109_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:6518px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_46.html#MeltCSV">
→ MeltCSV</A></DIV>
<DIV id="text109_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6518px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text109_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6317px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:34px; margin-top:6474px; width:274px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text109_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:42px; margin-top:6481px; line-height:13px; white-space:nowrap">
Split( "a,b," )&nbsp; &nbsp;'// Array( "a", "b", "" )</DIV>
<DIV id="text109_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:6558px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_10.html#Join">
→ Join</A></DIV>
<DIV id="text109_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:6538px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_35.html#get_PathNameRegularExpression">
→ get_PathNameRegularExpression</A></DIV>

<v:line from="0,6139" to="478,6139"/>
<v:line from="478,6139" to="478,6606"/>
<v:line from="478,6606" to="0,6606"/>
<v:line from="0,6606" to="0,6139"/>

</PAGE>
 
<!-- page 110 --> 
<PAGE>
<A id="svgcats_vml_p110" class="to_tree" style="margin-top:6611px;" onClick="selectTreeElem( '110' );">←</A>
<A href="#svgcats_vml_p111" class="to_next_page" style="margin-top:6611px;">▼</A>
<A href="#svgcats_vml_p109" class="to_prev_page" style="margin-top:6611px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6622px; width:591px; height:1962px;" fillcolor="white"/>
<DIV id="text110_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6639px; line-height:15px; white-space:nowrap">
<A name="byte_arr">
Byte 配列</A></DIV>
<DIV id="text110_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:168px; margin-top:6687px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_16.html#Read_ADODB_Stream">
Read (ADODB.Stream)</A></DIV>
<DIV id="text110_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:304px; margin-top:6687px; line-height:15px; white-space:nowrap">
すると、Byte 型の配列が返ります。</DIV>
<DIV id="text110_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6687px; line-height:15px; white-space:nowrap">
バイナリ・ストリームから</DIV>
<DIV id="text110_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6670px; line-height:15px; white-space:nowrap">
VBScript には、バイナリ（Byte 型配列）を作ることはできませんが、ADODB を使うと作れます。</DIV>
<DIV id="text110_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:352px; margin-top:6721px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_16.html#Write_ADODB_Stream">
Write (ADODB.Stream)</A></DIV>
<DIV id="text110_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6720px; line-height:15px; white-space:nowrap">
バイナリ・データの一部をリードしたByte 配列は、そのまま</DIV>
<DIV id="text110_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:483px; margin-top:6721px; line-height:15px; white-space:nowrap">
することが</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:7400px; width:280px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:7406px; line-height:15px; white-space:nowrap">
Dim&nbsp; binary&nbsp; '// as Byte()<BR/>
Dim&nbsp; strbin&nbsp; '// as String<BR/>
Dim&nbsp; value&nbsp; &nbsp;'// as Integer<BR/>
<BR/>
value = AscB( binary )&nbsp; '// 先頭バイトの値<BR/>
<BR/>
strbin = MidB( binary, 2, 1 )&nbsp; '// 2バイト目<BR/>
value = AscB( strbin )<BR/>
<BR/>
bin = binary(1)&nbsp; '// ( ) を使うとエラー</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:6760px; width:418px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:6766px; line-height:15px; white-space:nowrap">
Dim&nbsp; rf, wf&nbsp; '// as ADODB.Stream<BR/>
rf.Position = &amp;h10<BR/>
binary = rf.Read( &amp;h28 )<BR/>
wf.Write&nbsp; binary&nbsp; &nbsp;'// rf のオフセット &amp;h10 から %h28バイトを wf へ</DIV>
<DIV id="text110_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7328px; line-height:15px; white-space:nowrap">
バイナリの内容を確認するには、AscB と MidB を使います。 AscB 関数だけで、バイナリの<BR/>
数値を取得できますが、AscB 関数は先頭の文字（バイト）しか数値に変換しないので、多くの<BR/>
場合で MidB も使うことになります。 ちなみに、MidB の代わりに Byte 配列の配列番号を<BR/>
使って参照しようとするとエラーになります。</DIV>
<DIV id="text110_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:24px; margin-top:7788px; line-height:15px; white-space:nowrap">
ただし、MidB などの文字列操作関数や + 演算子で返される文字列は、Byte配列ではなく <BR/>
String 型になるため、 ADODB.Stream の Write に渡すことができません。</DIV>
<DIV id="text110_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7671px; line-height:15px; white-space:nowrap">
AscB や MidB が使えるのは、VBScript が Byte 配列を String 型（文字列）に暗黙的に変換<BR/>
しているからです。 ただし、VBScript の通常の文字列は、Unicode（2バイト文字）なので、<BR/>
通常、バイト単位の文字として扱う末尾にBが付いた関数を使います。 <BR/>
ChrB, LeftB, RightB, LenB, StrComp 関数や、+ 演算子などが使えます。</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:7828px; width:280px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:7834px; line-height:15px; white-space:nowrap">
Dim&nbsp; rf, wf&nbsp; '// as ADODB.Stream<BR/>
binary = rf.Read( adRealAll )<BR/>
strbin = MidB( binary, &amp;h10, &amp;h28 )<BR/>
wf.Write&nbsp; strbin&nbsp; &nbsp;'// String 型なのでエラー</DIV>
<DIV id="text110_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6735px; line-height:15px; white-space:nowrap">
できます。 つまり、バイナリ・データの一部を抽出することができます。</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:7743px; width:400px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:7750px; line-height:13px; white-space:nowrap">
strbin = LeftB( binary, 3 ) + ChrB( &amp;h0A ) + RightB( binary, 3 )</DIV>
<DIV id="text110_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:14px; margin-top:7301px; line-height:15px; white-space:nowrap">
<A name="bytevalue">
バイナリの内容を確認する</A></DIV>
<DIV id="text110_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:14px; margin-top:7646px; line-height:15px; white-space:nowrap">
<A name="binedit">
バイナリの内容を加工する （文字列としての Byte 配列）</A></DIV>
<DIV id="text110_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:6870px; line-height:15px; white-space:nowrap">
<A href="#bytevalue">
→ バイナリの内容を確認する</A></DIV>
<DIV id="text110_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:6888px; line-height:15px; white-space:nowrap">
<A href="#binedit">
→ バイナリの内容を加工する （文字列としての Byte 配列）</A></DIV>
<DIV id="text110_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:6852px; line-height:15px; white-space:nowrap">
<A href="#binlimit">
→ Byte 配列の制限</A></DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:7187px; width:178px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:7194px; line-height:13px; white-space:nowrap">
ReDim Preverve&nbsp; binary（10)</DIV>
<DIV id="text110_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7130px; line-height:15px; white-space:nowrap">
次のコードはエラーになります。</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:7154px; width:70px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:7161px; line-height:13px; white-space:nowrap">
binary(0)</DIV>
<DIV id="text110_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6993px; line-height:15px; white-space:nowrap">
Byte 配列は、配列を使う関数のうち一部の関数しか使えません。 次の関数は使えます。</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:7018px; width:178px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:7025px; line-height:13px; white-space:nowrap">
Size = UBound( binary ) + 1</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:7049px; width:184px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:7056px; line-height:13px; white-space:nowrap">
LBound( binary )&nbsp; '// 常に 0</DIV>
<DIV id="text110_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:15px; margin-top:6964px; line-height:15px; white-space:nowrap">
<A name="binlimit">
Byte 配列の制限</A></DIV>
<DIV id="text110_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7230px; line-height:15px; white-space:nowrap">
Byte 配列は、( ) を使って配列の要素にアクセスできない代わりに、String 型に暗黙変換<BR/>
することができるので、文字列を扱う関数を使うことができます。（後述）</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:7080px; width:286px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:7087px; line-height:13px; white-space:nowrap">
VarType( binary ) = vbArray + vbByte = &amp;h2011</DIV>
<DIV id="text110_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7921px; line-height:15px; white-space:nowrap">
つまり、VBScript では、文字列関数や配列機能を使ってバイナリを編集することはできません。<BR/>
編集するには、ADODB.Stream を活用することで、間接的に編集することができます。<BR/>
なお、以下に説明する内容は、</DIV>
<DIV id="text110_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7980px; line-height:15px; white-space:nowrap">
まず、バイナリのすべての値 0x00〜0xFF を Unicode を使ってストリームに作成します。<BR/>
その後、必要に応じて、バイナリを格納する別のストリームに</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:8022px; width:442px; height:235px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:8028px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Dim&nbsp; i, f<BR/>
&nbsp; &nbsp; Set f = CreateObject( "ADODB.Stream" )<BR/>
&nbsp; &nbsp; f.Charset = "unicode"<BR/>
&nbsp; &nbsp; f.Open<BR/>
<BR/>
&nbsp; &nbsp; '// FE FF 00 01 02 ... FD FE FF<BR/>
&nbsp; &nbsp; For i=0 To 255 Step 2 : f.WriteText&nbsp; ChrW( i + (i+1)*&amp;h100 ) : Next<BR/>
&nbsp; &nbsp; f.Position = 0<BR/>
&nbsp; &nbsp; f.Type = Me.adTypeBinary<BR/>
<BR/>
&nbsp; &nbsp; f.Position = Values + 2<BR/>
&nbsp; &nbsp; f2.Position = ...<BR/>
&nbsp; &nbsp; f.CopyTo&nbsp; f2, 1<BR/>
<BR/>
&nbsp; &nbsp; f.Close</DIV>
<DIV id="text110_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:507px; margin-top:7995px; line-height:15px; white-space:nowrap">
します。</DIV>
<DIV id="text110_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:360px; margin-top:7995px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_16.html#CopyTo_ADODB_Stream">
CopyTo (ADODB.Stream)</A></DIV>
<DIV id="text110_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:308px; margin-top:7951px; line-height:15px; white-space:nowrap">
の内部で使われています。</DIV>
<DIV id="text110_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:196px; margin-top:7951px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_42.html#BinaryArray">
BinaryArray (vbslib)</A></DIV>
<DIV id="text110_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:14px; margin-top:8287px; line-height:15px; white-space:nowrap">
<A name="BinComp">
バイナリの内容を比較する</A></DIV>
<DIV id="text110_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:6906px; line-height:15px; white-space:nowrap">
<A href="#BinComp">
→ バイナリの内容を比較する</A></DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:8353px; width:310px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text110_40" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:8359px; line-height:15px; white-space:nowrap">
Dim&nbsp; f1, f2&nbsp; '// as ADODB.Stream<BR/>
bin1 = f1.Read( adRealAll )<BR/>
bin2 = f2.Read( adRealAll )<BR/>
If StrComp( bin1, bin2, 0 ) = 0 Then&nbsp; echo "same"</DIV>
<DIV id="text110_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8314px; line-height:15px; white-space:nowrap">
Byte 配列を StrComp に渡すことで、バイナリ比較ができます。<BR/>
文字列のように大小比較もできます。</DIV>
<DIV id="text110_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:44px; margin-top:7573px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text110_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:83px; margin-top:7594px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_42.html#ReadStruct_BinaryArray">
→ ReadStruct (BinaryArray) (vbslib)</A></DIV>
<DIV id="text110_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:14px; margin-top:8465px; line-height:15px; white-space:nowrap">
<A name="BinZero">
サイズ 0 のバイト配列</A></DIV>
<DIV id="text110_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8492px; line-height:15px; white-space:nowrap">
バイナリ・ストリームから Read (ADODB.Stream) すると、Byte 型の配列が返りますが、<BR/>
サイズ = 0 で Read すると、Null が返ります。 サイズ 0 のバイト配列は取得できません。</DIV>
<DIV id="text110_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8534px; line-height:15px; white-space:nowrap">
そして、Null を Write すると、エラーになります。</DIV>
<DIV id="text110_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:83px; margin-top:7573px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_42.html#new_BinaryArray">
→ new_BinaryArray と GetEchoStr によるダンプ (vbslib)</A></DIV>

<v:line from="0,6622" to="591,6622"/>
<v:line from="591,6622" to="591,8584"/>
<v:line from="591,8584" to="0,8584"/>
<v:line from="0,8584" to="0,6622"/>

</PAGE>
 
<!-- page 111 --> 
<PAGE>
<A id="svgcats_vml_p111" class="to_tree" style="margin-top:8589px;" onClick="selectTreeElem( '111' );">←</A>
<A href="#svgcats_vml_p112" class="to_next_page" style="margin-top:8589px;">▼</A>
<A href="#svgcats_vml_p110" class="to_prev_page" style="margin-top:8589px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8600px; width:568px; height:1322px;" fillcolor="white"/>
<DIV id="text111_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8617px; line-height:15px; white-space:nowrap">
<A name="arr_one_multi">
単体と配列の共用変数</A></DIV>
<DIV id="text111_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8654px; line-height:15px; white-space:nowrap">
VBScipt は、１つの変数に一般的な変数と配列のどちらでも入れることができます。<BR/>
これを応用して、１つの値の指定と、複数の値の指定を、１つの変数で対応できます。</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:8697px; width:214px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text111_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:8703px; line-height:15px; white-space:nowrap">
Sub&nbsp; main()<BR/>
&nbsp; Dim&nbsp; a<BR/>
&nbsp; a = 1 : FuncA&nbsp; a<BR/>
&nbsp; a = Array( 1, 2, 3 ) : FuncA&nbsp; a<BR/>
&nbsp; a = Empty : FuncA&nbsp; a<BR/>
End Sub</DIV>
<DIV id="text111_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8925px; line-height:15px; white-space:nowrap">
下記のように、関数の実際の処理を行う前に配列に統一すると、以降の処理で場合分け<BR/>
しなくて済みます。</DIV>
<DIV id="text111_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9227px; line-height:15px; white-space:nowrap">
FuncA_sub をわざわざ作っている理由は、下記のように配列を ByVal 引数にすると、<BR/>
コピーが発生して遅くなってしまうのを避けるためです。</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:9264px; width:340px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text111_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:9270px; line-height:15px; white-space:nowrap">
Sub&nbsp; FuncA( ByVal Param )&nbsp; '// コピーが発生<BR/>
&nbsp; If not IsArray( Param ) Then&nbsp; Param = Array( Param )<BR/>
<BR/>
&nbsp; Dim&nbsp; elem<BR/>
&nbsp; For Each elem&nbsp; In Param<BR/>
&nbsp; &nbsp; WScript.Echo&nbsp; elem<BR/>
&nbsp; Next<BR/>
End Sub</DIV>
<DIV id="text111_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:9415px; line-height:15px; white-space:nowrap">
→ ByValArrBench.zip</DIV>
<DIV id="text111_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:9415px; line-height:15px; white-space:nowrap">
ByVal 配列のコピーにかかる時間の計測</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:8961px; width:286px; height:250px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text111_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:8967px; line-height:15px; white-space:nowrap">
Sub&nbsp; FuncA( Param )<BR/>
&nbsp; If IsArray( Param ) Then<BR/>
&nbsp; &nbsp; FuncA_sub&nbsp; Param<BR/>
&nbsp; ElseIf IsEmpty( Param ) Then<BR/>
&nbsp; &nbsp; FuncA_sub&nbsp; Array( )<BR/>
&nbsp; Else<BR/>
&nbsp; &nbsp; FuncA_sub&nbsp; Array( Param )<BR/>
&nbsp; End If<BR/>
End Sub<BR/>
<BR/>
Sub&nbsp; FuncA_sub( Param )&nbsp; '// Param は必ず配列<BR/>
&nbsp; Dim&nbsp; elem<BR/>
&nbsp; For Each elem&nbsp; In Param<BR/>
&nbsp; &nbsp; WScript.Echo&nbsp; elem<BR/>
&nbsp; Next<BR/>
End Sub</DIV>
<DIV id="text111_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:16px; margin-top:8895px; line-height:15px; white-space:nowrap">
<A name="arr_one_multi_arg">
関数の引数に、単体と配列のどちらでも指定できるようにする</A></DIV>
<DIV id="text111_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:16px; margin-top:9457px; line-height:15px; white-space:nowrap">
<A name="arr_one_multi_prop">
プロパティに、単体と配列のどちらでも格納できるようにする (ToStandard)</A></DIV>
<DIV id="text111_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9484px; line-height:15px; white-space:nowrap">
プロパティに、一般変数と配列変数を設定できるとき、処理を行う前に次のメソッドを<BR/>
呼び出すと、すべて配列として処理を記述できます。</DIV>
<v:rect style="position:absolute; margin-left:54px; margin-top:9532px; width:262px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text111_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:62px; margin-top:9538px; line-height:15px; white-space:nowrap">
&nbsp; Public Sub&nbsp; ToStandard()<BR/>
&nbsp; &nbsp; If IsEmpty( Me.m_PropA ) Then<BR/>
&nbsp; &nbsp; &nbsp; Me.m_PropA = Array( )<BR/>
&nbsp; &nbsp; ElseIf not IsArray( Me.m_PropA ) Then<BR/>
&nbsp; &nbsp; &nbsp; Me.m_PropA = Array( Me.m_PropA )<BR/>
&nbsp; &nbsp; End If<BR/>
&nbsp; End Sub</DIV>
<DIV id="text111_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9664px; line-height:15px; white-space:nowrap">
（メモ） Property Set で実現する方法も考えられますが、配列のコピーが入ってしまいます。</DIV>
<v:rect style="position:absolute; margin-left:54px; margin-top:9686px; width:238px; height:205px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text111_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:62px; margin-top:9692px; line-height:15px; white-space:nowrap">
&nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; Me.m_PropA = Array( )<BR/>
&nbsp; End Sub<BR/>
<BR/>
&nbsp; Public Property Set&nbsp; PropA( Value )<BR/>
&nbsp; &nbsp; If IsEmpty( Value ) Then<BR/>
&nbsp; &nbsp; &nbsp; Me.m_PropA = Array( )<BR/>
&nbsp; &nbsp; ElseIf not IsArray( Value ) Then<BR/>
&nbsp; &nbsp; &nbsp; Me.m_PropA = Array( Value )<BR/>
&nbsp; &nbsp; Else<BR/>
&nbsp; &nbsp; &nbsp; Me.m_PropA = Value<BR/>
&nbsp; &nbsp; End If<BR/>
&nbsp; End Sub</DIV>
<DIV id="text111_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:39px; margin-top:8817px; line-height:15px; white-space:nowrap">
<A href="#arr_one_multi_arg">
→ 関数の引数に、単体と配列のどちらでも受け取れるようにする</A></DIV>
<DIV id="text111_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:39px; margin-top:8837px; line-height:15px; white-space:nowrap">
<A href="#arr_one_multi_prop">
→ プロパティに、単体と配列のどちらでも格納できるようにする</A></DIV>

<v:line from="0,8600" to="568,8600"/>
<v:line from="568,8600" to="568,9922"/>
<v:line from="568,9922" to="0,9922"/>
<v:line from="0,9922" to="0,8600"/>

</PAGE>
 
<!-- page 112 --> 
<PAGE>
<A id="svgcats_vml_p112" class="to_tree" style="margin-top:9927px;" onClick="selectTreeElem( '112' );">←</A>
<A href="vbs_memo_08.html#svgcats_vml_p113" class="to_next_page" style="margin-top:9927px;">▼</A>
<A href="#svgcats_vml_p111" class="to_prev_page" style="margin-top:9927px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9938px; width:647px; height:799px;" fillcolor="white"/>
<DIV id="text112_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:321px; margin-top:10029px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/cc392346.aspx" target="_blank">
(Web)</A></DIV>
<DIV id="text112_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10150px; line-height:13px; white-space:nowrap">
If file Is Nothing Then</DIV>
<DIV id="text112_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10184px; line-height:13px; white-space:nowrap">
If IsNull( a ) Then</DIV>
<DIV id="text112_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:570px; margin-top:10182px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/library/ja/script56/html/vsfctIsNull.asp" target="_blank">
(Web)</A></DIV>
<DIV id="text112_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10264px; line-height:15px; white-space:nowrap">
<A name="IsNumericSamp">
If IsNumeric( a ) Then<BR/>
If VarType( a ) = vbInteger Then</A></DIV>
<DIV id="text112_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10232px; line-height:13px; white-space:nowrap">
vbString(=8)</DIV>
<DIV id="text112_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10150px; line-height:13px; white-space:nowrap">
Nothing</DIV>
<DIV id="text112_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10116px; line-height:13px; white-space:nowrap">
Empty</DIV>
<DIV id="text112_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10116px; line-height:13px; white-space:nowrap">
If IsEmpty( file ) Then</DIV>
<DIV id="text112_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10184px; line-height:13px; white-space:nowrap">
Null</DIV>
<DIV id="text112_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10116px; line-height:13px; white-space:nowrap">
vbEmpty(=0)</DIV>
<DIV id="text112_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:301px; margin-top:10078px; line-height:15px; white-space:nowrap">
VarType</DIV>
<v:line style="position:absolute;" from="31,10099" to="607,10099" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text112_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10150px; line-height:13px; white-space:nowrap">
-</DIV>
<DIV id="text112_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10232px; line-height:13px; white-space:nowrap">
文字列</DIV>
<DIV id="text112_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:567px; margin-top:10523px; line-height:15px; white-space:nowrap">
<A href="http://msdn.microsoft.com/ja-jp/library/cc410251.aspx" target="_blank">
(Web)</A></DIV>
<v:rect style="position:absolute; margin-left:30px; margin-top:9993px; width:280px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text112_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:38px; margin-top:10000px; line-height:13px; white-space:nowrap">
Function&nbsp; TypeName( s as variant ) as string</DIV>
<DIV id="text112_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9960px; line-height:15px; white-space:nowrap">
<A name="typeif">
型の判定 (TypeName, VarType)</A></DIV>
<DIV id="text112_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:400px; margin-top:10078px; line-height:15px; white-space:nowrap">
判定文の例</DIV>
<v:rect style="position:absolute; margin-left:30px; margin-top:10024px; width:280px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text112_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:38px; margin-top:10031px; line-height:13px; white-space:nowrap">
Function&nbsp; VarType( s as variant ) as integer</DIV>
<v:line style="position:absolute;" from="110,10077" to="110,10706" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text112_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:201px; margin-top:10078px; line-height:15px; white-space:nowrap">
TypeName</DIV>
<DIV id="text112_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:566px; margin-top:10078px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text112_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10116px; line-height:13px; white-space:nowrap">
"Empty"</DIV>
<DIV id="text112_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10150px; line-height:13px; white-space:nowrap">
"Nothing"</DIV>
<DIV id="text112_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10184px; line-height:13px; white-space:nowrap">
"Null"</DIV>
<DIV id="text112_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10232px; line-height:13px; white-space:nowrap">
"String"</DIV>
<DIV id="text112_28" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10525px; line-height:13px; white-space:nowrap">
Class Foo</DIV>
<DIV id="text112_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10525px; line-height:13px; white-space:nowrap">
"Foo"</DIV>
<DIV id="text112_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10524px; line-height:15px; white-space:nowrap">
If IsObject( a ) Then<BR/>
If TypeName( a ) = "Foo" Then</DIV>
<DIV id="text112_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10266px; line-height:13px; white-space:nowrap">
"Integer"</DIV>
<DIV id="text112_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10266px; line-height:13px; white-space:nowrap">
整数</DIV>
<v:line style="position:absolute;" from="34,10213" to="615,10213" strokecolor="#C0C0C0" strokeweight="1pt"/>
<DIV id="text112_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10434px; line-height:15px; white-space:nowrap">
浮動小数<BR/>
（倍精度）</DIV>
<DIV id="text112_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10435px; line-height:13px; white-space:nowrap">
"Double"</DIV>
<DIV id="text112_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10078px; line-height:15px; white-space:nowrap">
型</DIV>
<DIV id="text112_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:128px; margin-top:10078px; line-height:15px; white-space:nowrap">
定数(例)</DIV>
<DIV id="text112_38" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10116px; line-height:13px; white-space:nowrap">
Empty</DIV>
<DIV id="text112_39" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10150px; line-height:13px; white-space:nowrap">
Nothing</DIV>
<DIV id="text112_40" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10184px; line-height:13px; white-space:nowrap">
Null</DIV>
<DIV id="text112_41" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10232px; line-height:13px; white-space:nowrap">
"ABC"</DIV>
<DIV id="text112_42" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10266px; line-height:13px; white-space:nowrap">
123</DIV>
<DIV id="text112_43" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10435px; line-height:13px; white-space:nowrap">
1.2</DIV>
<DIV id="text112_44" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10232px; line-height:13px; white-space:nowrap">
If VarType( a ) = vbString Then</DIV>
<DIV id="text112_45" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10569px; line-height:13px; white-space:nowrap">
配列</DIV>
<v:line style="position:absolute;" from="34,10507" to="615,10507" strokecolor="#C0C0C0" strokeweight="1pt"/>
<DIV id="text112_47" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10569px; line-height:13px; white-space:nowrap">
"Variant()"</DIV>
<DIV id="text112_48" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:313px; margin-top:10569px; line-height:13px; white-space:nowrap">
8024</DIV>
<DIV id="text112_49" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10569px; line-height:13px; white-space:nowrap">
<A name="IsArray">
If IsArray( a ) Then</A></DIV>
<DIV id="text112_50" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10641px; line-height:13px; white-space:nowrap">
vbDate(=7)</DIV>
<DIV id="text112_51" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10641px; line-height:13px; white-space:nowrap">
日付</DIV>
<DIV id="text112_52" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10640px; line-height:15px; white-space:nowrap">
CDate("7/4")<BR/>
#7/4#</DIV>
<DIV id="text112_53" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:213px; margin-top:10641px; line-height:13px; white-space:nowrap">
"Date"</DIV>
<DIV id="text112_54" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10641px; line-height:13px; white-space:nowrap">
If IsDate( a ) Then</DIV>
<DIV id="text112_55" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10525px; line-height:13px; white-space:nowrap">
new Foo</DIV>
<DIV id="text112_56" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10569px; line-height:13px; white-space:nowrap">
Array(1,2)</DIV>
<DIV id="text112_57" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:310px; margin-top:10184px; line-height:13px; white-space:nowrap">
1</DIV>
<DIV id="text112_58" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10265px; line-height:13px; white-space:nowrap">
vbInteger(=2)</DIV>
<DIV id="text112_59" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10433px; line-height:13px; white-space:nowrap">
vbDouble(=5)</DIV>
<DIV id="text112_60" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10525px; line-height:13px; white-space:nowrap">
vbObject(=9)</DIV>
<DIV id="text112_61" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10481px; line-height:13px; white-space:nowrap">
論理</DIV>
<DIV id="text112_62" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10481px; line-height:13px; white-space:nowrap">
True,False</DIV>
<DIV id="text112_63" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:297px; margin-top:10481px; line-height:13px; white-space:nowrap">
vbBoolean(=11)</DIV>
<DIV id="text112_64" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10481px; line-height:13px; white-space:nowrap">
"Boolean"</DIV>
<DIV id="text112_65" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10432px; line-height:15px; white-space:nowrap">
If IsNumeric( a ) Then<BR/>
If VarType( a ) = vbDouble Then</DIV>
<DIV id="text112_66" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10595px; line-height:15px; white-space:nowrap">
a=Array(,1)<BR/>
の a(0)</DIV>
<DIV id="text112_67" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10595px; line-height:15px; white-space:nowrap">
配列の<BR/>
空要素</DIV>
<DIV id="text112_68" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10596px; line-height:13px; white-space:nowrap">
"Error"</DIV>
<DIV id="text112_69" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10596px; line-height:13px; white-space:nowrap">
vbError(=10)</DIV>
<DIV id="text112_70" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10596px; line-height:13px; white-space:nowrap">
If VarType( a(i) ) = vbError Then</DIV>
<DIV id="text112_71" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10385px; line-height:15px; white-space:nowrap">
浮動小数<BR/>
（倍精度）</DIV>
<DIV id="text112_72" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:201px; margin-top:10386px; line-height:13px; white-space:nowrap">
"Single"</DIV>
<DIV id="text112_73" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10386px; line-height:13px; white-space:nowrap">
vbSingle(=4)</DIV>
<DIV id="text112_74" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10385px; line-height:15px; white-space:nowrap">
If IsNumeric( a ) Then<BR/>
If VarType( a ) = vbSingle Then</DIV>
<DIV id="text112_75" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:10684px; line-height:13px; white-space:nowrap">
関数</DIV>
<DIV id="text112_76" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:128px; margin-top:10684px; line-height:13px; white-space:nowrap">
Sub/Function</DIV>
<DIV id="text112_77" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:219px; margin-top:10684px; line-height:13px; white-space:nowrap">
"Object"</DIV>
<DIV id="text112_78" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10684px; line-height:13px; white-space:nowrap">
vbObject(=9)</DIV>
<DIV id="text112_79" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10684px; line-height:13px; white-space:nowrap">
If IsObject( a ) Then</DIV>
<DIV id="text112_80" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:397px; margin-top:10480px; line-height:13px; white-space:nowrap">
If VarType( a ) = vbBoolean Then</DIV>
<DIV id="text112_81" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:359px; margin-top:10029px; line-height:15px; white-space:nowrap">
← すべての型の一覧</DIV>
<DIV id="text112_82" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:202px; margin-top:10321px; line-height:13px; white-space:nowrap">
"Byte"</DIV>
<DIV id="text112_83" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:298px; margin-top:10321px; line-height:13px; white-space:nowrap">
vbByte(=17)</DIV>
<DIV id="text112_84" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:202px; margin-top:10345px; line-height:13px; white-space:nowrap">
"Long"</DIV>
<DIV id="text112_85" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:297px; margin-top:10345px; line-height:13px; white-space:nowrap">
vbLong(=3)</DIV>
<DIV id="text112_86" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:570px; margin-top:10321px; line-height:13px; white-space:nowrap">
0〜255</DIV>
<DIV id="text112_87" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:432px; margin-top:10298px; line-height:13px; white-space:nowrap">
-32768〜32767, &amp;h0000〜&amp;hFFFF</DIV>
<DIV id="text112_88" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:468px; margin-top:10344px; text-align: right; line-height:13px; white-space:nowrap">
-2147483648〜2147483647<BR/>
&amp;h10000〜&amp;hFFFFFFFF</DIV>
<DIV id="text112_89" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:415px; margin-top:10641px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_08.html#IsDate">
IsDate</A></DIV>

<v:line from="0,9938" to="647,9938"/>
<v:line from="647,9938" to="647,10737"/>
<v:line from="647,10737" to="0,10737"/>
<v:line from="0,10737" to="0,9938"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10737px;">
<A id="svgcats_vml_p112" class="to_tree" onClick="selectTreeElem( '112' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10737px;">
<A id="page_group_bottom" href="vbs_memo_08.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
