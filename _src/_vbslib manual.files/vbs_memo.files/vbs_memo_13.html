<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>VBSメモ</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbs_memo.html?f1=vbs_memo.files/vbs_memo_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbs_memo.files/vbs_memo_13.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbs_memo.files/vbs_memo_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbs_memo.html?f1=vbs_memo.files/vbs_memo_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbs_memo.files/vbs_memo_13.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 191 --> 
<PAGE>
<A id="svgcats_vml_p191" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '191' );">←</A>
<A href="#svgcats_vml_p192" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbs_memo_12.html#svgcats_vml_p190" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbs_memo_12.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:579px; height:1318px;" fillcolor="white"/>
<DIV id="text191_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="get_ModuleConsts">
get_ModuleConsts : クラスの定数 (vbsool)</A></DIV>
<DIV id="text191_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:50px; line-height:15px; white-space:nowrap">
定数は、静的オブジェクトのメンバー変数に格納します。<BR/>
定数シンボルが、グローバル・スコープのシンボルではなくなるので、名前の衝突の可能性が<BR/>
低くなります。</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:766px; width:448px; height:520px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text191_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:772px; line-height:15px; white-space:nowrap">
Class&nbsp; SampleClass<BR/>
&nbsp; &nbsp; Public&nbsp; c<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set Me.c = get_SampleConst()<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class<BR/>
<BR/>
<BR/>
'***********************************************************************<BR/>
'* Function: get_SampleConst<BR/>
'***********************************************************************<BR/>
Dim&nbsp; g_SampleConst<BR/>
<BR/>
Function&nbsp; get_SampleConst()<BR/>
&nbsp; &nbsp; If IsEmpty( g_SampleConst ) Then _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set g_SampleConst = new SampleConstClass<BR/>
&nbsp; &nbsp; Set get_SampleConst = g_SampleConst<BR/>
End Function<BR/>
<BR/>
Class&nbsp; SampleConstClass<BR/>
&nbsp; &nbsp; Public&nbsp; CutTag, ExistOnly<BR/>
<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; CutTag = 1<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; ExistOnly = 2<BR/>
&nbsp; &nbsp; End Sub<BR/>
<BR/>
&nbsp; &nbsp; Public Function&nbsp; ToStr( Number )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Select Case&nbsp; Number<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case CutTag : ToStr = "CutTag"<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case ExistOnly : ToStr = "ExistOnly"<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; End Select<BR/>
&nbsp; &nbsp; End Function<BR/>
End Class</DIV>
<DIV id="text191_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:745px; line-height:15px; white-space:nowrap">
<A name="get_ModuleConsts_Example2">
定義例：</A></DIV>
<DIV id="text191_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:158px; line-height:15px; white-space:nowrap">
使用例１：</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:181px; width:220px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text191_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:187px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set c = get_SampleConstClass()<BR/>
<BR/>
&nbsp; &nbsp; copy_ex&nbsp; src, dst, c.CutTag</DIV>
<DIV id="text191_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:191px; margin-top:218px; line-height:13px; white-space:nowrap">
c.CutTag</DIV>
<DIV id="text191_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:125px; margin-top:188px; line-height:13px; white-space:nowrap">
get_SampleConstClass</DIV>
<DIV id="text191_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:125px; margin-top:1073px; line-height:13px; white-space:nowrap">
CutTag</DIV>
<DIV id="text191_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:101px; margin-top:1118px; line-height:13px; white-space:nowrap">
CutTag</DIV>
<DIV id="text191_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:264px; line-height:15px; white-space:nowrap">
使用例２：</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:287px; width:310px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text191_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:293px; line-height:15px; white-space:nowrap">
Sub&nbsp; main()<BR/>
&nbsp; &nbsp; Set object = new ClassA<BR/>
&nbsp; &nbsp; copy_ex&nbsp; source, destination, object.c.CutTag<BR/>
End Sub</DIV>
<DIV id="text191_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:257px; margin-top:324px; line-height:13px; white-space:nowrap">
object.c.CutTag</DIV>
<DIV id="text191_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:167px; margin-top:818px; line-height:13px; white-space:nowrap">
get_SampleConst</DIV>
<DIV id="text191_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:120px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_07.html#name_space_contamination">
→ 名前空間の汚染の対策</A></DIV>
<DIV id="text191_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:26px; margin-top:120px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text191_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:387px; line-height:15px; white-space:nowrap">
<A name="get_ModuleConsts_Example1">
定義例：</A></DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:408px; width:448px; height:295px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text191_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:414px; line-height:15px; white-space:nowrap">
'***********************************************************************<BR/>
'* Function: get_SampleConst<BR/>
'***********************************************************************<BR/>
Dim&nbsp; g_SampleConst<BR/>
<BR/>
Function&nbsp; get_SampleConst()<BR/>
&nbsp; &nbsp; If IsEmpty( g_SampleConst ) Then _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set g_SampleConst = new SampleConstClass<BR/>
&nbsp; &nbsp; Set get_SampleConst = g_SampleConst<BR/>
End Function<BR/>
<BR/>
Class&nbsp; SampleConstClass<BR/>
&nbsp; &nbsp; Public&nbsp; CutTag, ExistOnly<BR/>
<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; CutTag = 1<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; ExistOnly = 2<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class</DIV>
<DIV id="text191_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:113px; margin-top:490px; line-height:13px; white-space:nowrap">
get_SampleConst</DIV>
<DIV id="text191_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:376px; margin-top:23px; line-height:12px; white-space:nowrap">
キーワード：</DIV>
<DIV id="text191_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:443px; margin-top:23px; line-height:12px; white-space:nowrap">
<A name="ConstClass">
ConstClass</A></DIV>
<DIV id="text191_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:104px; margin-top:387px; line-height:15px; white-space:nowrap">
グローバル変数</DIV>
<DIV id="text191_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:112px; margin-top:745px; line-height:15px; white-space:nowrap">
メンバー変数、文字列変換</DIV>
<DIV id="text191_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:179px; margin-top:1178px; line-height:13px; white-space:nowrap">
ToStr</DIV>
<DIV id="text191_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:125px; margin-top:595px; line-height:13px; white-space:nowrap">
CutTag</DIV>
<DIV id="text191_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:101px; margin-top:640px; line-height:13px; white-space:nowrap">
CutTag</DIV>
<DIV id="text191_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:110px; margin-top:264px; line-height:15px; white-space:nowrap">
<A href="#get_ModuleConsts_Example2">
→ 定義例</A></DIV>
<DIV id="text191_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:110px; margin-top:158px; line-height:15px; white-space:nowrap">
<A href="#get_ModuleConsts_Example1">
→ 定義例</A></DIV>

<v:line from="0,0" to="579,0"/>
<v:line from="579,0" to="579,1318"/>
<v:line from="579,1318" to="0,1318"/>
<v:line from="0,1318" to="0,0"/>

</PAGE>
 
<!-- page 192 --> 
<PAGE>
<A id="svgcats_vml_p192" class="to_tree" style="margin-top:1323px;" onClick="selectTreeElem( '192' );">←</A>
<A href="#svgcats_vml_p193" class="to_next_page" style="margin-top:1323px;">▼</A>
<A href="#svgcats_vml_p191" class="to_prev_page" style="margin-top:1323px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1334px; width:581px; height:702px;" fillcolor="white"/>
<v:line style="position:absolute;" from="193,1629" to="226,1629" strokecolor="#000000" strokeweight="1pt">
    <v:stroke dashstyle="dash"/>
</v:line>
<v:line style="position:absolute;" from="226,1629" to="215,1625" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="226,1629" to="215,1633" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text192_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:1702px; line-height:15px; white-space:nowrap">
多くの場合、クラスに所属しない関数の中の最初で get_Object した後で、Validate メソッド<BR/>
を呼び出します。 Validate は、パラメータに指定した状態にオブジェクトをするメソッドです。</DIV>
<v:rect style="position:absolute; margin-left:56px; margin-top:1740px; width:328px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text192_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:64px; margin-top:1746px; line-height:15px; white-space:nowrap">
Sub&nbsp; FuncA()<BR/>
&nbsp; Dim&nbsp; m : Set m = get_ClassA() : m.Validate&nbsp; Empty <BR/>
&nbsp; m.MethodA<BR/>
End Sub</DIV>
<DIV id="text192_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:1386px; line-height:15px; white-space:nowrap">
演算器的なオブジェクトとは、インスタンスを特定する必要が無いオブジェクトのことで、<BR/>
切り替えることはあっても同時に複数存在しなくても目的の出力が得られるものです。<BR/>
ユーザーは演算器の種類 (ClassV) を指定します。</DIV>
<DIV id="text192_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:28px; margin-top:1881px; line-height:15px; white-space:nowrap">
ClassV_validate で取得したオブジェクトを明示的に削除する必要はありません。<BR/>
明示的に削除を指定したり、削除する許可をしたりする ClassI のメンバ関数を作っても<BR/>
構いませんが、キャッシュのように、状況に応じて自動的に判断することが処理効率が<BR/>
良いこともあります。</DIV>
<v:rect style="position:absolute; margin-left:56px; margin-top:1617px; width:136px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text192_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:64px; margin-top:1624px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_obj as ClassI</DIV>
<DIV id="text192_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:64px; margin-top:1649px; line-height:15px; white-space:nowrap">
インターフェイスを<BR/>
参照する変数</DIV>
<v:line style="position:absolute;" from="234,1629" to="350,1629" strokecolor="#000000" strokeweight="1pt">
    <v:stroke dashstyle="dash"/>
</v:line>
<v:shape style="position:absolute; margin-left:234px; margin-top:1624px; width:10px; height:10px"
 fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"
 path="m 0,500 l 1000,1000, 1000,0 x e"/>
<A href="vbs_memo_12.html#vbsool_ClassI">
<v:rect style="position:absolute; margin-left:345px; margin-top:1603px; width:54px; height:18px;" fillcolor="#FFFFFF" strokecolor="#C0C0C0" strokeweight="1pt">
<v:fill opacity="0.00"/>
</v:rect>
</A>
<DIV id="text192_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:355px; margin-top:1605px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_12.html#vbsool_ClassI">
ClassI</A></DIV>
<v:line style="position:absolute;" from="434,1629" to="365,1629" strokecolor="#000000" strokeweight="1pt"/>
<v:oval style="position:absolute; margin-left:362px; margin-top:1626px; width:5px; height:5px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text192_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:296px; margin-top:1641px; line-height:15px; white-space:nowrap">
オブジェクトの<BR/>
インターフェイス</DIV>
<DIV id="text192_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:406px; margin-top:1648px; line-height:15px; white-space:nowrap">
オブジェクト（アトム）</DIV>
<A href="vbs_memo_12.html#vbsool_ClassA">
<v:rect style="position:absolute; margin-left:423px; margin-top:1616px; width:55px; height:26px;" fillcolor="#F0F3FF" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text192_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:431px; margin-top:1622px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_12.html#vbsool_ClassA">
ClassA</A></DIV>
<DIV id="text192_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:237px; margin-top:1605px; line-height:15px; white-space:nowrap">
get_Object 関数</DIV>
<DIV id="text192_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:1541px; line-height:15px; white-space:nowrap">
オブジェクトを操作するインターフェイス(ClassI）は、演算器の種類(ClassV)と異なることが<BR/>
あります。 さらに ClassV は、インスタンスのクラス(ClassA)と異なることもあります。<BR/>
たとえば、ClassI =コンパイラ、ClassV = C言語コンパイラ、ClassA = A社製コンパイラver2。</DIV>
<DIV id="text192_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:1447px; line-height:15px; white-space:nowrap">
状況や設定に応じて、適切な ClassA のインスタンスが返ります。 内部で、インスタンスが<BR/>
生成されるかもしれないし、引数をそのまま維持するだけかもしれません。基本的に<BR/>
インスタンスは１つ（シングレトン）ですが、マルチコアを生かしたり、マルチスレッドでレイテ<BR/>
ンシを短くするために、Opt 引数に、新規インスタンスを指定することがあるかもしれません。<BR/>
（VBScript は、基本的にシングルスレッドですが）</DIV>
<DIV id="text192_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:13px; margin-top:1850px; line-height:15px; white-space:nowrap">
演算器的なオブジェクトのライフサイクル</DIV>
<DIV id="text192_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:55px; margin-top:1972px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_54.html#g_test_data">
→ グローバル・テスト・オブジェクト, SampleTest</A></DIV>
<DIV id="text192_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:20px; margin-top:1353px; line-height:15px; white-space:nowrap">
<A name="op_obj">
ライブラリ・オブジェクト、演算器的なオブジェクト</A></DIV>
<DIV id="text192_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:12px; margin-top:1972px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text192_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:352px; margin-top:1354px; line-height:12px; white-space:nowrap">
<A href="vbs_memo_12.html#vbsool">
[ 親: vbsool : オブジェクト記述法 ]</A></DIV>
<DIV id="text192_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:55px; margin-top:1992px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_62.html#var">
→ バージョン判定、環境変数</A></DIV>

<v:line from="0,1334" to="581,1334"/>
<v:line from="581,1334" to="581,2036"/>
<v:line from="581,2036" to="0,2036"/>
<v:line from="0,2036" to="0,1334"/>

</PAGE>
 
<!-- page 193 --> 
<PAGE>
<A id="svgcats_vml_p193" class="to_tree" style="margin-top:2041px;" onClick="selectTreeElem( '193' );">←</A>
<A href="#svgcats_vml_p194" class="to_next_page" style="margin-top:2041px;">▼</A>
<A href="#svgcats_vml_p192" class="to_prev_page" style="margin-top:2041px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2052px; width:516px; height:1095px;" fillcolor="white"/>
<DIV id="text193_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2069px; line-height:15px; white-space:nowrap">
<A name="get_ObjectVer">
バージョンを表す静的オブジェクト</A></DIV>
<DIV id="text193_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2103px; line-height:15px; white-space:nowrap">
プログラムが使用する外部プログラムのバージョンが異なると、使用する<BR/>
データが微妙に異なったりします。 たとえば、Visual Studio のプロジェクト・<BR/>
ファイルを出力するプログラムは、Visual Studio のバージョンによって、<BR/>
出力するファイルの拡張子が変わります。<BR/>
<BR/>
プロジェクト・ファイルを出力する関数をプログラミングするときは、<BR/>
バージョンを判定して、出力内容を変えるというのが一般的ですが、<BR/>
規模が大きくなると、同じ条件分岐のコピーがたくさん記述されること<BR/>
になり、メンテナンス性が低くなります。<BR/>
<BR/>
たとえば、プロジェクト・ファイルの拡張子が変わると、ファイルを作成する<BR/>
コードと、使用するプロジェクト・ファイルをソリューション・ファイル内に<BR/>
記述するコードの２箇所に、バージョンを判定するコードが記述されます。<BR/>
この状態で、将来、バージョンと拡張子の関係が変わったら、２箇所の修正が<BR/>
必要なのに、１箇所だけ修正して完了としてしまうリスクがあるのです。</DIV>
<v:rect style="position:absolute; margin-left:54px; margin-top:2670px; width:430px; height:445px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text193_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:62px; margin-top:2676px; line-height:15px; white-space:nowrap">
Dim&nbsp; o : Set o = new MakeVS<BR/>
o.SetMakeProjContext&nbsp; MakeProjContext, get_MakeVSProjType( TypeName )<BR/>
o.MakeProj<BR/>
<BR/>
Class　MakeVSProjType<BR/>
　Public　VSVer　　　　　　 '// as integer<BR/>
　Public　TargetPlatform　　'// as string<BR/>
　Public　ProjectExtension　'// as string<BR/>
End Class <BR/>
<BR/>
Function　get_MakeVSProjType( TypeName )<BR/>
　Dim　ret, items<BR/>
　Select Case　TypeName　　　　　　　　'// VSVer, TargetPlatform<BR/>
　　Case　"VS2010Win32"　　: items = Array( 2010, "Win32" )<BR/>
　　Case　"VS2008Win32"　　: items = Array( 2008, "Win32" )<BR/>
　　Case　"VS2010Win32Lib" : items = Array( 2010, "Lib" )<BR/>
　　Case　"VS2008Win32Lib" : items = Array( 2008, "Lib" )<BR/>
　　Case Else　Error<BR/>
　End Select<BR/>
<BR/>
　Set ret = new MakeVSProjType<BR/>
　ret.VSVer　　　　　= items( 0 )<BR/>
　ret.TargetPlatform = items( 1 )<BR/>
　If ret.VSVer = 2010 Then<BR/>
　　ret.ProjectExtension = ".vcxproj"<BR/>
　Else<BR/>
　　ret.ProjectExtension = ".vcproj"<BR/>
　End If<BR/>
End Function</DIV>
<DIV id="text193_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2456px; line-height:15px; white-space:nowrap">
これを避けるには、プロジェクト・ファイルの拡張子を変数にすることです。<BR/>
この状態で、バージョンと拡張子の関係が変わったら、変数の値を代入する<BR/>
箇所だけを変えるだけで済みます。<BR/>
<BR/>
このような違いを集めたオブジェクトは、Visual Studio のバージョンによって<BR/>
異なるものであるため、バージョンごとに存在する静的オブジェクト（コンパ<BR/>
イル時に値が決定する static な構造体）になります。<BR/>
<BR/>
そして、静的オブジェクトを取得する関数を定義するとよいでしょう。 その<BR/>
定義は、下記のようにテーブルで記述するとよいでしょう。 また、相関関係が<BR/>
ある場合は、下記の ProjectExtension 変数のように条件分岐が使えます。<BR/>
この条件分岐は、静的オブジェクトを取得する関数の中にまとめられるため、<BR/>
メンテナンス性が高くなります。</DIV>
<v:rect style="position:absolute; margin-left:53px; margin-top:2348px; width:412px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text193_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:61px; margin-top:2354px; line-height:15px; white-space:nowrap">
　If VSVer &lt;= 2008 Then&nbsp; f.Open ".vcproj"&nbsp; Else&nbsp; f.Open ".vcxproj"<BR/>
　f.Close</DIV>
<v:rect style="position:absolute; margin-left:53px; margin-top:2397px; width:424px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text193_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:61px; margin-top:2403px; line-height:15px; white-space:nowrap">
　f.Open&nbsp; ".sln"<BR/>
　If VSVer &lt;= 2008 Then&nbsp; f.Write ".vcproj"&nbsp; Else&nbsp; f.Write ".vcxproj"</DIV>

<v:line from="0,2052" to="516,2052"/>
<v:line from="516,2052" to="516,3147"/>
<v:line from="516,3147" to="0,3147"/>
<v:line from="0,3147" to="0,2052"/>

</PAGE>
 
<!-- page 194 --> 
<PAGE>
<A id="svgcats_vml_p194" class="to_tree" style="margin-top:3152px;" onClick="selectTreeElem( '194' );">←</A>
<A href="#svgcats_vml_p195" class="to_next_page" style="margin-top:3152px;">▼</A>
<A href="#svgcats_vml_p193" class="to_prev_page" style="margin-top:3152px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3163px; width:692px; height:281px;" fillcolor="white"/>
<DIV id="text194_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3180px; line-height:15px; white-space:nowrap">
<A name="DerivedAttribute">
派生属性プロパティ キャッシュ</A></DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:3248px; width:580px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text194_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:3254px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; '// Derived property<BR/>
&nbsp; &nbsp; Private&nbsp; m_DerivedAttribute<BR/>
<BR/>
&nbsp; &nbsp; Public&nbsp; Property Get&nbsp; DerivedAttribute()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; If IsEmpty( m_DerivedAttribute ) Then&nbsp; m_DerivedAttribute = "Derived "+ Me.AnAttribute<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; DerivedAttribute = m_DerivedAttribute<BR/>
&nbsp; &nbsp; End Property</DIV>
<DIV id="text194_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:368px; margin-top:3180px; line-height:15px; white-space:nowrap">
read only attribute</DIV>
<DIV id="text194_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:255px; margin-top:3180px; line-height:15px; white-space:nowrap">
<A name="DerivedAttribute_en">
derived attribute</A></DIV>
<DIV id="text194_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:131px; margin-top:3270px; line-height:13px; white-space:nowrap">
DerivedAttribute</DIV>
<DIV id="text194_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3215px; line-height:15px; white-space:nowrap">
派生属性のキャッシュを持つときは、下記のようにコーディングします。</DIV>
<DIV id="text194_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:89px; margin-top:3330px; line-height:13px; white-space:nowrap">
DerivedAttribute</DIV>
<DIV id="text194_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:335px; margin-top:3315px; line-height:13px; white-space:nowrap">
DerivedAttribute</DIV>
<DIV id="text194_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:173px; margin-top:3315px; line-height:13px; white-space:nowrap">
DerivedAttribute</DIV>
<DIV id="text194_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:197px; margin-top:3300px; line-height:13px; white-space:nowrap">
DerivedAttribute</DIV>
<DIV id="text194_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:215px; margin-top:3330px; line-height:13px; white-space:nowrap">
DerivedAttribute</DIV>
<DIV id="text194_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:500px; margin-top:3182px; line-height:12px; white-space:nowrap">
<A href="vbs_memo_12.html#vbsool">
[ 親: vbsool : オブジェクト記述法 ]</A></DIV>
<DIV id="text194_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3381px; line-height:15px; white-space:nowrap">
m_ から始まるプライベート プロパティは、他の派生属性と並べると一覧性が高くてよいでしょう。<BR/>
複数の派生属性を同時にキャッシュに載せいた方が、処理速度は速いでしょう。</DIV>

<v:line from="0,3163" to="692,3163"/>
<v:line from="692,3163" to="692,3444"/>
<v:line from="692,3444" to="0,3444"/>
<v:line from="0,3444" to="0,3163"/>

</PAGE>
 
<!-- page 195 --> 
<PAGE>
<A id="svgcats_vml_p195" class="to_tree" style="margin-top:3449px;" onClick="selectTreeElem( '195' );">←</A>
<A href="#svgcats_vml_p196" class="to_next_page" style="margin-top:3449px;">▼</A>
<A href="#svgcats_vml_p194" class="to_prev_page" style="margin-top:3449px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3460px; width:544px; height:502px;" fillcolor="white"/>
<DIV id="text195_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:33px; margin-top:3896px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text195_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:77px; margin-top:3896px; line-height:15px; white-space:nowrap">
<A href="http://itpro.nikkeibp.co.jp/article/COLUMN/20051202/225609/" target="_blank">
→ Factory Methodパターン／Abstract Factoryパターン (Web)</A></DIV>
<DIV id="text195_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:308px; margin-top:3480px; line-height:12px; white-space:nowrap">
<A href="vbs_memo_12.html#vbsool">
[ 親: vbsool : オブジェクト記述法 ]</A></DIV>
<DIV id="text195_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:55px; margin-top:3710px; line-height:15px; white-space:nowrap">
<A href="#ListOfName">
→ 名前の一覧</A></DIV>
<DIV id="text195_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:55px; margin-top:3668px; line-height:15px; white-space:nowrap">
<A href="#name">
→ オブジェクトの Name と TrueName</A></DIV>
<DIV id="text195_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3478px; line-height:15px; white-space:nowrap">
<A name="naming">
Name プロパティ : 名前参照 (vbsool)</A></DIV>
<DIV id="text195_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:3810px; line-height:15px; white-space:nowrap">
→ T_NameDelegator フォルダ</DIV>
<DIV id="text195_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:29px; margin-top:3761px; line-height:15px; white-space:nowrap">
サンプルファイル</DIV>
<DIV id="text195_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:3829px; line-height:15px; white-space:nowrap">
→ T_NameList フォルダ</DIV>
<DIV id="text195_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:55px; margin-top:3689px; line-height:15px; white-space:nowrap">
<A href="#NameDelegate">
→ Name と TrueName が多対１の場合</A></DIV>
<DIV id="text195_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:3791px; line-height:15px; white-space:nowrap">
→ T_Name フォルダ</DIV>
<DIV id="text195_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:243px; margin-top:3791px; line-height:15px; white-space:nowrap">
Name と TrueName が、１対多の場合</DIV>
<DIV id="text195_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:243px; margin-top:3810px; line-height:15px; white-space:nowrap">
Name と TrueName が、多対１の場合</DIV>
<DIV id="text195_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:243px; margin-top:3829px; line-height:15px; white-space:nowrap">
Name と TrueName が、多対１の場合の一覧</DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:3509px; width:196px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text195_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:3516px; line-height:13px; white-space:nowrap">
Property Get&nbsp; Name() as string</DIV>
<DIV id="text195_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:3859px; line-height:15px; white-space:nowrap">
→ vbslib を使う vbsool サンプル</DIV>
<DIV id="text195_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3584px; line-height:15px; white-space:nowrap">
インスタンスの名前です。 クラス名と同じになることもあります。</DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:3543px; width:220px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text195_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:3550px; line-height:13px; white-space:nowrap">
Property Get&nbsp; TrueName() as string</DIV>
<DIV id="text195_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:32px; margin-top:3603px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_12.html#get_ClassA">
get_Object</A></DIV>
<DIV id="text195_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:3603px; line-height:15px; white-space:nowrap">
関数に指定する名前と同じです。</DIV>
<DIV id="text195_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:3640px; line-height:15px; white-space:nowrap">
以下は、一般名 (Name) と正式名 (TrueName) の違いから生じる問題の対策法です。</DIV>
<DIV id="text195_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:77px; margin-top:3914px; line-height:15px; white-space:nowrap">
→ Module Mixer 3 の実装</DIV>

<v:line from="0,3460" to="544,3460"/>
<v:line from="544,3460" to="544,3962"/>
<v:line from="544,3962" to="0,3962"/>
<v:line from="0,3962" to="0,3460"/>

</PAGE>
 
<!-- page 196 --> 
<PAGE>
<A id="svgcats_vml_p196" class="to_tree" style="margin-top:3967px;" onClick="selectTreeElem( '196' );">←</A>
<A href="#svgcats_vml_p197" class="to_next_page" style="margin-top:3967px;">▼</A>
<A href="#svgcats_vml_p195" class="to_prev_page" style="margin-top:3967px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3978px; width:614px; height:1337px;" fillcolor="white"/>
<DIV id="text196_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:521px; margin-top:4213px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_62.html#SetVar">
SetVar,</A></DIV>
<DIV id="text196_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:4228px; line-height:15px; white-space:nowrap">
GetVar など）に正式名を指定することもできます。 </DIV>
<DIV id="text196_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:21px; margin-top:4001px; line-height:15px; white-space:nowrap">
<A name="name">
オブジェクトの Name と TrueName</A></DIV>
<DIV id="text196_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:4035px; line-height:15px; white-space:nowrap">
クラス名やインスタンス名は、一般名と正式名があり、多くの場合、一般名を必要とします。しかし、<BR/>
new に指定する型の名前や、TypeName で取得できる型の名前はクラスの正式名であることが<BR/>
多く、扱いにくいでしょう。 そこで、</DIV>
<DIV id="text196_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:280px; margin-top:4003px; line-height:12px; white-space:nowrap">
<A href="vbs_memo_12.html#vbsool">
[ 親: vbsool : オブジェクト記述法 ]</A></DIV>
<DIV id="text196_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; font-weight: bold; margin-left:80px; margin-top:4507px; line-height:13px; white-space:nowrap">
<A href="#ClassN_no">
Sample_getTrueName</A></DIV>
<DIV id="text196_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:45px; margin-top:4471px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_12.html#get_ClassA">
get_Object</A></DIV>
<DIV id="text196_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:28px; margin-top:4443px; line-height:15px; white-space:nowrap">
処理フロー</DIV>
<DIV id="text196_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:101px; margin-top:4543px; line-height:13px; white-space:nowrap">
<A href="#get_TrueSample">
get_TrueSample</A></DIV>
<DIV id="text196_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:4140px; line-height:15px; white-space:nowrap">
一般名は場面によって（抽象度が変化して）変わります。 正式名はインスタンスの内容や定義の<BR/>
抽象度によって変わります。 一般名と正式名が、同じになることもあります。<BR/>
一般名と正式名は、１対多の関係があるので、場面に応じて、一般名から正式名を選択する必要<BR/>
があります。（同時に多対１の関係もありますが別の章を参照）。</DIV>
<DIV id="text196_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:111px; margin-top:4471px; line-height:13px; white-space:nowrap">
( "Sample" )</DIV>
<DIV id="text196_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:121px; margin-top:4558px; line-height:13px; white-space:nowrap">
new TrueSample</DIV>
<DIV id="text196_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:213px; margin-top:4469px; line-height:15px; white-space:nowrap">
一般名 "Sample" のオブジェクトを取得する</DIV>
<DIV id="text196_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:61px; margin-top:4489px; line-height:13px; white-space:nowrap">
<A href="#ClassN_no">
get_Sample</A></DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:4615px; width:340px; height:265px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text196_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:4621px; line-height:15px; white-space:nowrap">
'// Class&nbsp; Sample&nbsp; has_interface_of ClassI<BR/>
<BR/>
Function&nbsp; get_Sample()<BR/>
&nbsp; Set&nbsp; get_Sample = get_Object( Sample_getTrueName() )<BR/>
&nbsp; get_Sample.Name = "Sample"<BR/>
End Function<BR/>
<BR/>
Function&nbsp; Sample_getTrueName()<BR/>
&nbsp; Dim&nbsp; ret : ret = GetVar( "Sample" )<BR/>
&nbsp; If IsEmpty( ret ) Then<BR/>
&nbsp; &nbsp; '// default is ClassA fixed<BR/>
&nbsp; &nbsp; ret = "TrueSample" : SetVar "Sample", ret<BR/>
&nbsp; End If<BR/>
&nbsp; Sample_getTrueName = ret<BR/>
End Function<BR/>
<BR/>
'// 言語上の Class Sample の定義は不要です。</DIV>
<DIV id="text196_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:170px; margin-top:4742px; line-height:13px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_62.html#GetVar">
GetVar</A></DIV>
<DIV id="text196_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:4596px; line-height:15px; white-space:nowrap">
<A name="ClassN_no">
一般名(Sample)のクラス定義 (一般名と正式名が１対多だけの場合）</A></DIV>
<DIV id="text196_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:273px; margin-top:4505px; line-height:15px; white-space:nowrap">
一般名 "Sample" から正式名 "TrueSample" を選択</DIV>
<DIV id="text196_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:147px; margin-top:4525px; line-height:13px; white-space:nowrap">
( "TrueSample" )</DIV>
<DIV id="text196_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:80px; margin-top:4525px; line-height:13px; white-space:nowrap">
get_Object</DIV>
<DIV id="text196_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:4885px; line-height:15px; white-space:nowrap">
上記は ret = "TrueSample" 固定ですが、場面に応じて TrueSample 以外の正式名を<BR/>
返すように自動判定した方がよいです。</DIV>
<DIV id="text196_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:54px; margin-top:4095px; line-height:15px; white-space:nowrap">
Name プロパティは、インスタンスの一般名とします。<BR/>
TrueName プロパティは、インスタンスの正式名とします。</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:5018px; width:466px; height:265px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text196_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:5024px; line-height:15px; white-space:nowrap">
'// Class&nbsp; TrueSample&nbsp; has_interface_of ClassI<BR/>
<BR/>
Dim&nbsp; g_TrueSample<BR/>
<BR/>
Function&nbsp; &nbsp; get_TrueSample()&nbsp; '// has_interface_of ClassI<BR/>
&nbsp; If IsEmpty( g_TrueSample ) Then _<BR/>
&nbsp; &nbsp; Set g_TrueSample = new TrueSample<BR/>
&nbsp; Set get_TrueSample =&nbsp; &nbsp;g_TrueSample<BR/>
End Function<BR/>
<BR/>
Class&nbsp; TrueSample<BR/>
&nbsp; Public&nbsp; Name<BR/>
&nbsp; Public&nbsp; Property Get&nbsp; TrueName() : TrueName = TypeName(Me) : End Property<BR/>
&nbsp; '--- Name is factory pattern.<BR/>
&nbsp; Private Sub&nbsp; Class_Initialize() : Name = TypeName(Me) : End Sub<BR/>
&nbsp; &nbsp; :<BR/>
End Class</DIV>
<DIV id="text196_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:4998px; line-height:15px; white-space:nowrap">
<A name="get_TrueSample">
正式名(TrueSample)のクラス定義 (一般名と正式名が１対多だけの場合）</A></DIV>
<v:line style="position:absolute;" from="257,4401" to="225,4401" strokecolor="#000000" strokeweight="1pt"/>
<v:oval style="position:absolute; margin-left:222px; margin-top:4398px; width:5px; height:5px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="252,4369" to="225,4369" strokecolor="#000000" strokeweight="1pt"/>
<v:oval style="position:absolute; margin-left:222px; margin-top:4366px; width:5px; height:5px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text196_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:179px; margin-top:4363px; line-height:13px; white-space:nowrap">
ClassI</DIV>
<v:rect style="position:absolute; margin-left:252px; margin-top:4388px; width:54px; height:26px;" fillcolor="#E6E6FF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text196_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:260px; margin-top:4394px; line-height:15px; white-space:nowrap">
ClassB</DIV>
<DIV id="text196_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:179px; margin-top:4397px; line-height:13px; white-space:nowrap">
ClassI</DIV>
<v:rect style="position:absolute; margin-left:252px; margin-top:4354px; width:54px; height:26px;" fillcolor="#E6E6FF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text196_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:260px; margin-top:4360px; line-height:15px; white-space:nowrap">
ClassA</DIV>
<DIV id="text196_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:314px; margin-top:4360px; line-height:15px; white-space:nowrap">
Name = "ClassN", TrueName = "ClassA"</DIV>
<DIV id="text196_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:314px; margin-top:4394px; line-height:15px; white-space:nowrap">
Name = "ClassN", TrueName = "ClassB"</DIV>
<DIV id="text196_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:28px; margin-top:4339px; line-height:15px; white-space:nowrap">
データ構造</DIV>
<DIV id="text196_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:4298px; line-height:15px; white-space:nowrap">
→ T_Name フォルダ</DIV>
<DIV id="text196_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:28px; margin-top:4272px; line-height:15px; white-space:nowrap">
サンプルファイル</DIV>
<v:roundrect style="position:absolute; margin-left:36px; margin-top:4374px; width:95px; height:22px;" arcsize="0.454545" fillcolor="#E1EEE8" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text196_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:4378px; line-height:15px; white-space:nowrap">
一般名で選択</DIV>
<v:line style="position:absolute;" from="140,4385" to="165,4368" strokecolor="#000000" strokeweight="1pt">
    <v:stroke dashstyle="dash"/>
</v:line>
<v:line style="position:absolute;" from="165,4368" to="154,4370" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="165,4368" to="158,4377" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="140,4385" to="165,4402" strokecolor="#000000" strokeweight="1pt">
    <v:stroke dashstyle="dash"/>
</v:line>
<v:line style="position:absolute;" from="165,4402" to="158,4393" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="165,4402" to="154,4400" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text196_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:387px; margin-top:4095px; line-height:15px; white-space:nowrap">
例： Windows<BR/>
例： Windows XP, Windows7</DIV>
<DIV id="text196_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:273px; margin-top:4523px; line-height:15px; white-space:nowrap">
正式名 "TrueSample" のオブジェクトを取得する</DIV>
<DIV id="text196_41" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF8000; margin-left:215px; margin-top:4507px; line-height:13px; white-space:nowrap">
[Sample]</DIV>
<DIV id="text196_42" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF8000; margin-left:135px; margin-top:4489px; line-height:13px; white-space:nowrap">
[Sample]</DIV>
<DIV id="text196_43" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0080; margin-left:203px; margin-top:4543px; line-height:13px; white-space:nowrap">
[TrueSample]</DIV>
<DIV id="text196_44" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0080; margin-left:224px; margin-top:4558px; line-height:13px; white-space:nowrap">
[TrueSample]</DIV>
<DIV id="text196_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:192px; margin-top:4298px; line-height:15px; white-space:nowrap">
→ T_Name_vbslib フォルダ</DIV>
<DIV id="text196_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:367px; margin-top:4298px; line-height:15px; white-space:nowrap">
→ T_NameAdd_vbslib フォルダ</DIV>
<DIV id="text196_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:4213px; line-height:15px; white-space:nowrap">
多くの場合、自動判定を行いますが、環境変数（レジストリや、設定ファイルや、vbslib の</DIV>
<DIV id="text196_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:4929px; line-height:15px; white-space:nowrap">
上記の正式名を決める処理は、Sample_getTrueName 関数（一般名 "Sample" の<BR/>
getTrueName メソッド）ではなく、get_Sample 関数に書かれていることがあります。</DIV>

<v:line from="0,3978" to="614,3978"/>
<v:line from="614,3978" to="614,5315"/>
<v:line from="614,5315" to="0,5315"/>
<v:line from="0,5315" to="0,3978"/>

</PAGE>
 
<!-- page 197 --> 
<PAGE>
<A id="svgcats_vml_p197" class="to_tree" style="margin-top:5320px;" onClick="selectTreeElem( '197' );">←</A>
<A href="#svgcats_vml_p198" class="to_next_page" style="margin-top:5320px;">▼</A>
<A href="#svgcats_vml_p196" class="to_prev_page" style="margin-top:5320px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5331px; width:655px; height:2383px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:49px; margin-top:7243px; width:574px; height:385px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:57px; margin-top:7249px; line-height:15px; white-space:nowrap">
Dim&nbsp; g_NameDic : Set g_NameDic = CreateObject( "Scripting.Dictionary" )<BR/>
<BR/>
Function&nbsp; get_NameDelegator( Name, TrueName, InterfaceName )<BR/>
&nbsp; If g_NameDic.Exists( Name +"__"+ TrueName ) Then<BR/>
&nbsp; &nbsp; Set get_NameDelegator = g_NameDic.Item( Name +"__"+ TrueName +"_"+ InterfaceName )<BR/>
&nbsp; &nbsp; Exit Function<BR/>
&nbsp; End If<BR/>
<BR/>
&nbsp; Set&nbsp; get_NameDelegator = new_X( InterfaceName + "_Delegator" ) : With get_NameDelegator<BR/>
&nbsp; &nbsp; .Name = Name<BR/>
&nbsp; &nbsp; .m_Delegate = TrueName&nbsp; '// if validated was need.<BR/>
&nbsp; &nbsp; If not g_bNeedValidateDelegate Then _<BR/>
&nbsp; &nbsp; &nbsp; Set .m_Delegate = get_Object( TrueName )&nbsp; '// if validated was not need.<BR/>
&nbsp; End With<BR/>
<BR/>
&nbsp; Set&nbsp; g_NameDic.Item( Name +"__"+ TrueName +"_"+ InterfaceName ) = get_NameDelegator<BR/>
End Function<BR/>
<BR/>
<BR/>
Class NameDelegator&nbsp; '// defined_as_interface<BR/>
&nbsp; Public&nbsp; Name<BR/>
&nbsp; Public Property Get&nbsp; TrueName() : TrueName = NameDelegator_getTrueName( Me ) : End Property<BR/>
&nbsp; Public&nbsp; m_Delegate ' as ClassA or ClassB or string(before validated)<BR/>
&nbsp; Public Property Get&nbsp; DefineInfo() : Set DefineInfo = m_Delegate.DefineInfo : End Property<BR/>
End Class</DIV>
<DIV id="text197_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:7223px; line-height:15px; white-space:nowrap">
<A name="get_NameDelegator">
NameDelegator のクラス定義</A></DIV>
<DIV id="text197_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:5381px; line-height:15px; white-space:nowrap">
複数から同じインスタンスを参照し、オブジェクトから一般名（Nameプロパティ）を取得する必要が<BR/>
ある場合は、一般名と正式名が多対１の関係になり、次のような委譲をしないと、Name プロパティ<BR/>
がそれぞれの場面に応じた一般名になりません。</DIV>
<v:rect style="position:absolute; margin-left:49px; margin-top:6347px; width:496px; height:220px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:57px; margin-top:6353px; line-height:15px; white-space:nowrap">
'// Class&nbsp; Sample&nbsp; has_interface_of ClassI<BR/>
<BR/>
Function&nbsp; &nbsp; get_Sample()<BR/>
&nbsp; Set get_Sample = get_NameDelegator( "Sample", Sample_getTrueName(), "ClassI" )<BR/>
End Function<BR/>
<BR/>
Function&nbsp; Sample_getTrueName()<BR/>
&nbsp; Dim&nbsp; ret : ret = GetVar( "Sample" )<BR/>
&nbsp; If IsEmpty( ret ) Then<BR/>
&nbsp; &nbsp; '// default is ClassA fixed<BR/>
&nbsp; &nbsp; ret = "TrueSample" : SetVar "Sample", ret<BR/>
&nbsp; End If<BR/>
&nbsp; Sample_getTrueName = ret<BR/>
End Function</DIV>
<DIV id="text197_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:171px; margin-top:6459px; line-height:13px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_62.html#GetVar">
GetVar</A></DIV>
<v:rect style="position:absolute; margin-left:49px; margin-top:6618px; width:472px; height:295px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:57px; margin-top:6624px; line-height:15px; white-space:nowrap">
'// Class&nbsp; ClassA&nbsp; has_interface_of ClassI<BR/>
<BR/>
Dim&nbsp; g_TrueSample<BR/>
<BR/>
Function&nbsp; &nbsp; get_TrueSample()<BR/>
&nbsp; If IsEmpty( g_TrueSample ) Then _<BR/>
&nbsp; &nbsp; Set g_TrueSample = new TrueSample<BR/>
&nbsp; Set get_TrueSample =&nbsp; &nbsp;g_TrueSample<BR/>
End Function<BR/>
<BR/>
<BR/>
Class TrueSample<BR/>
&nbsp; Public&nbsp; Property Get&nbsp; Name()&nbsp; &nbsp; &nbsp;: Name&nbsp; &nbsp; &nbsp;= TypeName(Me) : End Property<BR/>
&nbsp; Public&nbsp; Property Get&nbsp; TrueName() : TrueName = TypeName(Me) : End Property<BR/>
&nbsp; '--- Name is factory pattern.<BR/>
<BR/>
&nbsp; Public&nbsp; Value<BR/>
&nbsp; Public Function&nbsp; Method1() : Method1 = "TrueSample.Method1" : End Function<BR/>
End Class</DIV>
<DIV id="text197_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:41px; margin-top:6328px; line-height:15px; white-space:nowrap">
<A name="ClassN">
一般名(Sample)のクラス定義 (一般名と正式名が多対１もある場合）</A></DIV>
<DIV id="text197_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:41px; margin-top:6599px; line-height:15px; white-space:nowrap">
<A name="NameClassA">
正式名(TrueSample)のクラス定義</A></DIV>
<DIV id="text197_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:171px; margin-top:6399px; line-height:13px; white-space:nowrap">
<A href="#get_NameDelegator">
get_NameDelegator</A></DIV>
<v:line style="position:absolute;" from="266,5490" to="214,5490" strokecolor="#000000" strokeweight="1pt"/>
<v:oval style="position:absolute; margin-left:211px; margin-top:5487px; width:5px; height:5px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="267,5464" to="215,5464" strokecolor="#000000" strokeweight="1pt"/>
<v:oval style="position:absolute; margin-left:212px; margin-top:5461px; width:5px; height:5px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:5582px; line-height:15px; white-space:nowrap">
Name プロパティは、ユーザーが取り扱っている場面（ドメイン）によって抽象度が変化して、同じ<BR/>
インスタンスに対して複数の一般名を持つことになります。 このケースに対応する実装は委譲の<BR/>
形態をとるとよいでしょう。<BR/>
<BR/>
他のドメインの名前を参照する必要は、ほとんどありませんが、もし参照するのであれば、Names<BR/>
という集合のプロパティになります。</DIV>
<v:roundrect style="position:absolute; margin-left:72px; margin-top:5452px; width:91px; height:22px;" arcsize="0.454545" fillcolor="#E1EEE8" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:5456px; line-height:15px; white-space:nowrap">
場面Aの関数</DIV>
<v:line style="position:absolute;" from="163,5464" to="206,5464" strokecolor="#000000" strokeweight="1pt">
    <v:stroke dashstyle="dash"/>
</v:line>
<v:line style="position:absolute;" from="206,5464" to="195,5460" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="206,5464" to="195,5468" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="163,5489" to="206,5489" strokecolor="#000000" strokeweight="1pt">
    <v:stroke dashstyle="dash"/>
</v:line>
<v:line style="position:absolute;" from="206,5489" to="195,5485" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="206,5489" to="195,5493" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="377,5464" to="395,5464" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="395,5464" to="395,5472" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="395,5489" to="377,5489" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="395,5472" to="420,5472" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:5688px; line-height:15px; white-space:nowrap">
オブジェクトの削除は、ガーベジコレクションに任せて、ClassI_Delegator が無くなるまで存在させ<BR/>
るとよいでしょう。<BR/>
<BR/>
実体のファイルが削除されたショートカットのように、ClassI_Delegator が参照する、正式名の<BR/>
オブジェクトだけを無くすときは、一般名から委譲先を参照している ClassI_Delegator::m_Delegate<BR/>
を Empty にしてガーベジコレクションを動かして削除します。 また、Empty にすれば、削除された<BR/>
オブジェクトにアクセスしようとしたときに、きちんと例外が発生するようになります。</DIV>
<DIV id="text197_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:351px; margin-top:5435px; line-height:15px; white-space:nowrap">
Name 以外は</DIV>
<DIV id="text197_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:172px; margin-top:5440px; line-height:15px; white-space:nowrap">
参照</DIV>
<v:rect style="position:absolute; margin-left:265px; margin-top:5453px; width:112px; height:20px;" fillcolor="#F0F3FF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:273px; margin-top:5456px; line-height:15px; white-space:nowrap">
場面Aでの Name</DIV>
<v:rect style="position:absolute; margin-left:265px; margin-top:5479px; width:112px; height:20px;" fillcolor="#F0F3FF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:273px; margin-top:5482px; line-height:15px; white-space:nowrap">
場面Bでの Name</DIV>
<v:rect style="position:absolute; margin-left:421px; margin-top:5464px; width:142px; height:26px;" fillcolor="#E6E6FF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:429px; margin-top:5470px; line-height:15px; white-space:nowrap">
ある１つのインスタンス</DIV>
<DIV id="text197_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:456px; margin-top:5492px; text-align: center; line-height:15px; white-space:nowrap">
TrueName<BR/>
（正式名）</DIV>
<DIV id="text197_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:270px; margin-top:5505px; text-align: center; line-height:10px; white-space:nowrap">
ClassI_Delegator クラス<BR/>
（一般名）</DIV>
<DIV id="text197_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:19px; margin-top:5351px; line-height:15px; white-space:nowrap">
<A name="NameDelegate">
Name と TrueName が多対１の場合</A></DIV>
<DIV id="text197_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; font-weight: bold; margin-left:77px; margin-top:6098px; line-height:13px; white-space:nowrap">
<A href="#ClassN">
Sample_getTrueName</A></DIV>
<DIV id="text197_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:42px; margin-top:6060px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_12.html#get_ClassA">
get_Object</A></DIV>
<DIV id="text197_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:25px; margin-top:6032px; line-height:15px; white-space:nowrap">
処理フロー</DIV>
<DIV id="text197_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:104px; margin-top:6060px; line-height:13px; white-space:nowrap">
( "Sample" )</DIV>
<DIV id="text197_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:248px; margin-top:6058px; line-height:15px; white-space:nowrap">
一般名 "Sample" のオブジェクトを取得する</DIV>
<DIV id="text197_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:276px; margin-top:6096px; line-height:15px; white-space:nowrap">
一般名 "Sample" から、正式名 "TrueSample" を選択</DIV>
<DIV id="text197_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:77px; margin-top:6118px; line-height:13px; white-space:nowrap">
<A href="#get_NameDelegator">
get_NameDelegator</A></DIV>
<DIV id="text197_36" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:134px; margin-top:6177px; line-height:13px; white-space:nowrap">
<A href="#ClassI_Delegator">
new_ClassI_Delegator</A></DIV>
<DIV id="text197_37" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:155px; margin-top:6193px; line-height:13px; white-space:nowrap">
new ClassI_Delegator</DIV>
<DIV id="text197_38" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:155px; margin-top:6274px; line-height:13px; white-space:nowrap">
new TrueSample</DIV>
<DIV id="text197_39" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:94px; margin-top:6141px; line-height:13px; white-space:nowrap">
If not g_NameDic.Exists( Name +"__"+ TrueName +"_"+ InterfaceName ) Then</DIV>
<DIV id="text197_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:294px; margin-top:6191px; line-height:15px; white-space:nowrap">
InterfaceName インターフェイスを持ち、<BR/>
TrueName へ委譲するオブジェクトを生成</DIV>
<DIV id="text197_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:263px; margin-top:6272px; line-height:15px; white-space:nowrap">
正式名のオブジェクトを生成する</DIV>
<DIV id="text197_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:25px; margin-top:5818px; line-height:15px; white-space:nowrap">
サンプルファイル</DIV>
<DIV id="text197_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:49px; margin-top:5843px; line-height:15px; white-space:nowrap">
→ T_NameDelegator フォルダ</DIV>
<DIV id="text197_44" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF8000; margin-left:152px; margin-top:6078px; line-height:13px; white-space:nowrap">
[Sample]</DIV>
<DIV id="text197_45" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF8000; margin-left:216px; margin-top:6098px; line-height:13px; white-space:nowrap">
[Sample]</DIV>
<DIV id="text197_46" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0080; margin-left:233px; margin-top:6256px; line-height:13px; white-space:nowrap">
[TrueSample]</DIV>
<v:roundrect style="position:absolute; margin-left:72px; margin-top:5478px; width:91px; height:22px;" arcsize="0.454545" fillcolor="#E1EEE8" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:5482px; line-height:15px; white-space:nowrap">
場面Bの関数</DIV>
<DIV id="text197_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:426px; margin-top:5435px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_14.html#m_Delegate">
委譲</A></DIV>
<v:line style="position:absolute;" from="395,5480" to="421,5480" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="395,5480" to="395,5489" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_51" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:60px; margin-top:6078px; line-height:13px; white-space:nowrap">
<A href="#ClassN_no">
get_Sample</A></DIV>
<DIV id="text197_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:25px; margin-top:5883px; line-height:15px; white-space:nowrap">
データ構造</DIV>
<DIV id="text197_53" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:148px; margin-top:5914px; line-height:13px; white-space:nowrap">
g_NameDic</DIV>
<DIV id="text197_54" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:5914px; line-height:13px; white-space:nowrap">
Dictionary</DIV>
<DIV id="text197_55" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:66px; margin-top:5952px; line-height:13px; white-space:nowrap">
<A href="#ClassN" style="color:#FF0000">
ClassI_Delegator</A></DIV>
<DIV id="text197_56" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:175px; margin-top:5952px; line-height:13px; white-space:nowrap">
.Item</DIV>
<DIV id="text197_57" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:175px; margin-top:5933px; line-height:13px; white-space:nowrap">
.Key</DIV>
<DIV id="text197_58" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:66px; margin-top:5933px; line-height:13px; white-space:nowrap">
string</DIV>
<DIV id="text197_59" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:215px; margin-top:5933px; line-height:13px; white-space:nowrap">
= Name +"__"+ TrueName +"_"+ InterfaceName</DIV>
<DIV id="text197_60" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:196px; margin-top:5971px; line-height:13px; white-space:nowrap">
.Name</DIV>
<DIV id="text197_61" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:196px; margin-top:5987px; line-height:13px; white-space:nowrap">
.m_Delegate</DIV>
<DIV id="text197_62" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:5971px; line-height:13px; white-space:nowrap">
string</DIV>
<DIV id="text197_63" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:84px; margin-top:5987px; line-height:13px; white-space:nowrap">
<A href="#NameClassA">
TrueSample</A></DIV>
<DIV id="text197_64" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:235px; margin-top:5971px; line-height:13px; white-space:nowrap">
= "Sample"</DIV>
<v:line style="position:absolute;" from="218,5957" to="408,5957" strokecolor="#C0C0C0" strokeweight="1pt"/>
<v:oval style="position:absolute; margin-left:405px; margin-top:5954px; width:5px; height:5px;" fillcolor="#FFFFFF" strokecolor="#C0C0C0" strokeweight="1pt"/>
<DIV id="text197_66" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:330px; margin-top:5966px; line-height:13px; white-space:nowrap">
ClassI</DIV>
<DIV id="text197_67" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:88px; margin-top:7663px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_22.html#get_NameDelegator">
→ get_NameDelegator (vbslib)</A></DIV>
<DIV id="text197_68" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:50px; margin-top:7663px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text197_69" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:6940px; line-height:15px; white-space:nowrap">
<A name="ClassI_Delegator">
ClassI_Delegator クラス定義</A></DIV>
<DIV id="text197_70" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:112px; margin-top:6158px; line-height:13px; white-space:nowrap">
new_X</DIV>
<DIV id="text197_71" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:148px; margin-top:6158px; line-height:13px; white-space:nowrap">
( InterfaceName + "_Delegator" )</DIV>
<DIV id="text197_72" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:181px; margin-top:6118px; line-height:13px; white-space:nowrap">
( Name, TrueName, InterfaceName )</DIV>
<DIV id="text197_73" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:201px; margin-top:5504px; line-height:12px; white-space:nowrap">
ClassI</DIV>
<DIV id="text197_74" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:112px; margin-top:6219px; line-height:15px; white-space:nowrap">
.Name = Name<BR/>
Set&nbsp; .m_Delegate = get_Object( TrueName )</DIV>
<DIV id="text197_75" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:57px; margin-top:7595px; line-height:13px; white-space:nowrap">
&nbsp; Public Property Get&nbsp; DefineInfo() : Set DefineInfo = m_Delegate.DefineInfo : End Property</DIV>
<DIV id="text197_76" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:7636px; line-height:15px; white-space:nowrap">
DefineInfo プロパティは、オプションです。</DIV>
<DIV id="text197_77" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:294px; margin-top:7636px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_14.html#DefineInfo">
→ DefineInfo プロパティ</A></DIV>
<DIV id="text197_78" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:226px; margin-top:6235px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_12.html#get_ClassA">
get_Object</A></DIV>
<DIV id="text197_79" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:134px; margin-top:6256px; line-height:13px; white-space:nowrap">
<A href="#NameClassA">
get_TrueSample</A></DIV>
<v:rect style="position:absolute; margin-left:49px; margin-top:6960px; width:574px; height:235px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text197_80" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:57px; margin-top:6966px; line-height:15px; white-space:nowrap">
Class ClassI_Delegator&nbsp; '// has_interface_of NameDelegator and ClassI<BR/>
&nbsp; Public&nbsp; Name<BR/>
&nbsp; Public Property Get&nbsp; TrueName() : TrueName = NameDelegator_getTrueName( Me ) : End Property<BR/>
&nbsp; Public&nbsp; m_Delegate ' as ClassA or ClassB or string(before validated)<BR/>
&nbsp; '--- Name is factory pattern.<BR/>
<BR/>
&nbsp; Public Property Let&nbsp; Value( v ) : m_Delegate.Value = v : End Property<BR/>
&nbsp; Public Property Get&nbsp; Value( )&nbsp; &nbsp;: Value = m_Delegate.Value : End Property<BR/>
&nbsp; Public Function&nbsp; Method1() : Method1 = m_Delegate.Method1() : End Function<BR/>
End Class<BR/>
<BR/>
<BR/>
Function&nbsp; new_ClassI_Delegator()&nbsp; '// has_interface_of NameDelegator and ClassI<BR/>
&nbsp; Set&nbsp; new_ClassI_Delegator = new ClassI_Delegator<BR/>
End Function</DIV>
<DIV id="text197_81" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#008000; margin-left:271px; margin-top:6176px; line-height:13px; white-space:nowrap">
[ClassI_Delegator]</DIV>
<v:line style="position:absolute;" from="217,5963" to="352,5963" strokecolor="#C0C0C0" strokeweight="1pt"/>
<v:oval style="position:absolute; margin-left:349px; margin-top:5960px; width:5px; height:5px;" fillcolor="#FFFFFF" strokecolor="#C0C0C0" strokeweight="1pt"/>
<DIV id="text197_83" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:388px; margin-top:5962px; line-height:13px; white-space:nowrap">
<A href="#get_NameDelegator">
NameDelegator</A></DIV>
<DIV id="text197_84" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:423px; margin-top:5949px; line-height:15px; white-space:nowrap">
一般名を持ったオブジェクト</DIV>
<DIV id="text197_85" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:289px; margin-top:5986px; line-height:15px; white-space:nowrap">
正式名を持ったオブジェクト</DIV>
<DIV id="text197_86" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:242px; margin-top:5843px; line-height:15px; white-space:nowrap">
→ T_NameDelegator_vbslib フォルダ</DIV>
<DIV id="text197_87" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:262px; margin-top:5531px; line-height:15px; white-space:nowrap">
例： Windows<BR/>
例： Windows7</DIV>
<DIV id="text197_88" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:419px; margin-top:5531px; line-height:15px; white-space:nowrap">
例： Windows7</DIV>

<v:line from="0,5331" to="655,5331"/>
<v:line from="655,5331" to="655,7714"/>
<v:line from="655,7714" to="0,7714"/>
<v:line from="0,7714" to="0,5331"/>

</PAGE>
 
<!-- page 198 --> 
<PAGE>
<A id="svgcats_vml_p198" class="to_tree" style="margin-top:7719px;" onClick="selectTreeElem( '198' );">←</A>
<A href="#svgcats_vml_p199" class="to_next_page" style="margin-top:7719px;">▼</A>
<A href="#svgcats_vml_p197" class="to_prev_page" style="margin-top:7719px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7730px; width:598px; height:385px;" fillcolor="white"/>
<DIV id="text198_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7747px; line-height:15px; white-space:nowrap">
<A name="ListOfName">
名前の一覧</A></DIV>
<DIV id="text198_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:7776px; line-height:15px; white-space:nowrap">
オブジェクトの名前を一覧するときは、<BR/>
取得して、Name プロパティを表示します。 TrueName は、必要なら補助的に表示します。</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:7933px; width:256px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text198_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:7940px; line-height:13px; white-space:nowrap">
Sub&nbsp; &nbsp;ClassI::Validate( Opt as variant )</DIV>
<DIV id="text198_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:7892px; line-height:15px; white-space:nowrap">
ただし、すべてのオブジェクトを生成すると時間がかかる場合、生成時に実行する初期化処理<BR/>
(Class_Initialize) を Validate メソッドに移すとよいでしょう。</DIV>
<DIV id="text198_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:243px; margin-top:7776px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_12.html#get_ObjectsFromFile">
get_ObjectsFormFile</A></DIV>
<DIV id="text198_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:362px; margin-top:7776px; line-height:15px; white-space:nowrap">
で一覧するすべてのオブジェクトを</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:7818px; width:454px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text198_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:7824px; line-height:15px; white-space:nowrap">
Dim&nbsp; samples, sample<BR/>
get_ObjectsFromFile&nbsp; "Lib\*_obj.vbs", "ClassI", samples '// [out] samples<BR/>
For Each sample&nbsp; In samples : echo&nbsp; sample.Name : Next</DIV>
<DIV id="text198_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:7982px; line-height:15px; white-space:nowrap">
一覧するときは、一般名が Name プロパティに入っているオブジェクトと、正式名が Name<BR/>
プロパティに入っているオブジェクトの両方を一覧します。</DIV>
<DIV id="text198_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:49px; margin-top:8067px; line-height:15px; white-space:nowrap">
→ T_NameList フォルダ</DIV>
<DIV id="text198_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:214px; margin-top:8067px; line-height:15px; white-space:nowrap">
→ T_NameList_vbslib フォルダ</DIV>
<DIV id="text198_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:30px; margin-top:8039px; line-height:15px; white-space:nowrap">
サンプルファイル</DIV>

<v:line from="0,7730" to="598,7730"/>
<v:line from="598,7730" to="598,8115"/>
<v:line from="598,8115" to="0,8115"/>
<v:line from="0,8115" to="0,7730"/>

</PAGE>
 
<!-- page 199 --> 
<PAGE>
<A id="svgcats_vml_p199" class="to_tree" style="margin-top:8120px;" onClick="selectTreeElem( '199' );">←</A>
<A href="#svgcats_vml_p200" class="to_next_page" style="margin-top:8120px;">▼</A>
<A href="#svgcats_vml_p198" class="to_prev_page" style="margin-top:8120px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8131px; width:622px; height:883px;" fillcolor="white"/>
<DIV id="text199_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8148px; line-height:15px; white-space:nowrap">
<A name="Item">
Item デフォルト・プロパティ : 動的定義メンバー (vbsool)</A></DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:8180px; width:322px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text199_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:8187px; line-height:13px; white-space:nowrap">
Default Property&nbsp; Item( Name as string ) as variant</DIV>
<DIV id="text199_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8216px; line-height:15px; white-space:nowrap">
VBScript は、ECMA Script (JavaScript) のように、動的にメンバーを定義することはできませんが、<BR/>
デフォルト・プロパティと、辞書（Dictionary クラス）を使うことで、同様のことができます。</DIV>
<DIV id="text199_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:8942px; line-height:15px; white-space:nowrap">
→ JavaScript のクラス</DIV>
<DIV id="text199_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:33px; margin-top:8942px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text199_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:215px; margin-top:8942px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_08.html#dic">
→ Dictionary クラス</A></DIV>
<DIV id="text199_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:74px; margin-top:8966px; line-height:15px; white-space:nowrap">
<A href="#Items">
→ Items プロパティ</A></DIV>
<DIV id="text199_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8263px; line-height:15px; white-space:nowrap">
Item プロパティは、Dictionary や FolderItem などに準拠しています。<BR/>
ArrayClass(vbslib) も、Item プロパティが使えます。</DIV>
<DIV id="text199_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:103px; margin-top:8309px; line-height:15px; white-space:nowrap">
→ T_Item フォルダ</DIV>
<DIV id="text199_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8309px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:8390px; width:310px; height:145px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text199_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:8396px; line-height:15px; white-space:nowrap">
&nbsp; Dim obj : Set obj = new ClassA<BR/>
&nbsp; obj.PropA&nbsp; &nbsp; = 1&nbsp; &nbsp;'// Static&nbsp; defined property<BR/>
&nbsp; obj("PropB") = 12&nbsp; '// Dynamic defined property<BR/>
&nbsp; obj("PropC") = "ABC"<BR/>
&nbsp; Set obj("PropD") = new ClassA<BR/>
<BR/>
&nbsp; WScript.Echo&nbsp; "PropA = "&amp; obj.PropA<BR/>
&nbsp; WScript.Echo&nbsp; "PropB = "&amp; obj("PropB")<BR/>
&nbsp; WScript.Echo&nbsp; "PropC = "&amp; obj("PropC").Value</DIV>
<DIV id="text199_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8369px; line-height:15px; white-space:nowrap">
使用例：</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:8581px; width:544px; height:340px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text199_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:8587px; line-height:15px; white-space:nowrap">
Class ClassA<BR/>
&nbsp; Public&nbsp; PropA&nbsp; '// Static defined property<BR/>
<BR/>
&nbsp; '//=== Dynamic defined property : Item, Items, Keys<BR/>
&nbsp; Public Default Property Get&nbsp; Item( Name ) : LetSet&nbsp; Item, m_Dic( Name ) : End Property<BR/>
&nbsp; Public Property Let&nbsp; Item( Name, Value ) : m_Dic( Name ) = Value : End Property<BR/>
&nbsp; Public Property Set&nbsp; Item( Name, Object ) : Set m_Dic( Name ) = Object : End Property<BR/>
<BR/>
&nbsp; Public Property Get&nbsp; Keys()&nbsp; : Keys&nbsp; = m_Dic.Keys&nbsp; : End Property<BR/>
&nbsp; Public Property Get&nbsp; Items() : Items = m_Dic.Items : End Property<BR/>
<BR/>
&nbsp; Public m_Dic&nbsp; ' as Dictionary<BR/>
&nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; Set m_Dic = CreateObject( "Scripting.Dictionary" )<BR/>
&nbsp; &nbsp; m_Dic.CompareMode = 1&nbsp; '// NotCaseSensitive<BR/>
&nbsp; End Sub<BR/>
<BR/>
End Class<BR/>
<BR/>
Sub&nbsp; LetSet( Out, In_ )<BR/>
&nbsp; If IsObject( In_ ) Then&nbsp; Set Out = In_ Else Out = In_<BR/>
End Sub</DIV>
<DIV id="text199_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8559px; line-height:15px; white-space:nowrap">
<A name="Item_def">
定義例： Item, Items, Keys プロパティがあるクラスの定義</A></DIV>
<DIV id="text199_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:271px; margin-top:8309px; line-height:15px; white-space:nowrap">
vbslib なし版</DIV>
<DIV id="text199_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:33px; margin-top:8966px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text199_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:204px; margin-top:8966px; line-height:15px; white-space:nowrap">
<A href="#Keys">
→ Keys プロパティ</A></DIV>
<DIV id="text199_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:103px; margin-top:8329px; line-height:15px; white-space:nowrap">
→ T_Item_vbslib フォルダ</DIV>
<DIV id="text199_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:271px; margin-top:8329px; line-height:15px; white-space:nowrap">
vbslib 使用版</DIV>
<DIV id="text199_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:331px; margin-top:8966px; line-height:15px; white-space:nowrap">
→ GetSetting 関数</DIV>

<v:line from="0,8131" to="622,8131"/>
<v:line from="622,8131" to="622,9014"/>
<v:line from="622,9014" to="0,9014"/>
<v:line from="0,9014" to="0,8131"/>

</PAGE>
 
<!-- page 200 --> 
<PAGE>
<A id="svgcats_vml_p200" class="to_tree" style="margin-top:9019px;" onClick="selectTreeElem( '200' );">←</A>
<A href="#svgcats_vml_p201" class="to_next_page" style="margin-top:9019px;">▼</A>
<A href="#svgcats_vml_p199" class="to_prev_page" style="margin-top:9019px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9030px; width:497px; height:363px;" fillcolor="white"/>
<DIV id="text200_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9047px; line-height:15px; white-space:nowrap">
<A name="Items">
Items プロパティ : 動的定義メンバーの値の集合 (vbsool)</A></DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:9079px; width:262px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text200_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:9086px; line-height:13px; white-space:nowrap">
Property Get&nbsp; Items() as array of variant</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:9180px; width:196px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text200_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:9186px; line-height:15px; white-space:nowrap">
&nbsp; For Each item&nbsp; In obj.Items<BR/>
&nbsp; &nbsp; If IsObject( item ) Then<BR/>
&nbsp; &nbsp; &nbsp; WScript.Echo&nbsp; item.Value<BR/>
&nbsp; &nbsp; Else<BR/>
&nbsp; &nbsp; &nbsp; WScript.Echo&nbsp; item<BR/>
&nbsp; &nbsp; End If<BR/>
&nbsp; Next</DIV>
<DIV id="text200_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9159px; line-height:15px; white-space:nowrap">
使用例：</DIV>
<DIV id="text200_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:97px; margin-top:9125px; line-height:15px; white-space:nowrap">
<A href="#Item">
→ Item プロパティ</A></DIV>
<DIV id="text200_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:9125px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text200_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9314px; line-height:15px; white-space:nowrap">
上記は標準形ですが、処理速度が要求されるときは次のようにしてください。</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:9336px; width:226px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text200_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:9343px; line-height:13px; white-space:nowrap">
&nbsp; For Each item&nbsp; In obj.m_Dic.Items</DIV>

<v:line from="0,9030" to="497,9030"/>
<v:line from="497,9030" to="497,9393"/>
<v:line from="497,9393" to="0,9393"/>
<v:line from="0,9393" to="0,9030"/>

</PAGE>
 
<!-- page 201 --> 
<PAGE>
<A id="svgcats_vml_p201" class="to_tree" style="margin-top:9398px;" onClick="selectTreeElem( '201' );">←</A>
<A href="#svgcats_vml_p202" class="to_next_page" style="margin-top:9398px;">▼</A>
<A href="#svgcats_vml_p200" class="to_prev_page" style="margin-top:9398px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9409px; width:497px; height:310px;" fillcolor="white"/>
<DIV id="text201_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9426px; line-height:15px; white-space:nowrap">
<A name="Keys">
Keys プロパティ : 動的定義メンバーのメンバー名の集合 (vbsool)</A></DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:9458px; width:250px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text201_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:9465px; line-height:13px; white-space:nowrap">
Property Get&nbsp; Keys() as array of string</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:9559px; width:184px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text201_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:9565px; line-height:15px; white-space:nowrap">
&nbsp; For Each name&nbsp; In obj.Keys<BR/>
&nbsp; &nbsp; WScript.Echo&nbsp; name<BR/>
&nbsp; Next</DIV>
<DIV id="text201_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9538px; line-height:15px; white-space:nowrap">
使用例：</DIV>
<DIV id="text201_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:97px; margin-top:9504px; line-height:15px; white-space:nowrap">
<A href="#Item">
→ Item プロパティ</A></DIV>
<DIV id="text201_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:9504px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text201_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9640px; line-height:15px; white-space:nowrap">
上記は標準形ですが、処理速度が要求されるときは次のようにしてください。</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:9662px; width:220px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text201_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:9669px; line-height:13px; white-space:nowrap">
&nbsp; For Each item&nbsp; In obj.m_Dic.Keys</DIV>

<v:line from="0,9409" to="497,9409"/>
<v:line from="497,9409" to="497,9719"/>
<v:line from="497,9719" to="0,9719"/>
<v:line from="0,9719" to="0,9409"/>

</PAGE>
 
<!-- page 202 --> 
<PAGE>
<A id="svgcats_vml_p202" class="to_tree" style="margin-top:9724px;" onClick="selectTreeElem( '202' );">←</A>
<A href="vbs_memo_14.html#svgcats_vml_p203" class="to_next_page" style="margin-top:9724px;">▼</A>
<A href="#svgcats_vml_p201" class="to_prev_page" style="margin-top:9724px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9735px; width:585px; height:1823px;" fillcolor="white"/>
<DIV id="text202_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9752px; line-height:15px; white-space:nowrap">
<A name="vbsool_event">
EventResponders : イベント応答 (vbsool)</A></DIV>
<DIV id="text202_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:61px; margin-top:11444px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_51.html#FuncRedir_add">
→ FuncRedir_add (vbslib)</A></DIV>
<DIV id="text202_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:11444px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text202_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:61px; margin-top:11486px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_14.html#delegate1">
→ １つの登録された関数を呼び出す変数、デリゲート</A></DIV>
<DIV id="text202_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:11444px; line-height:15px; white-space:nowrap">
関数定義のオーバーライド</DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:9932px; width:256px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text202_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:9939px; line-height:13px; white-space:nowrap">
Dim&nbsp; ClassE::OnEventX as EventResponders</DIV>
<DIV id="text202_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:9788px; line-height:15px; white-space:nowrap">
イベントとは、あるオブジェクトの状態変化のことです。<BR/>
イベントが発生したときに行う処理は、アプリケーションによって異なります。<BR/>
そこで、あるイベントが発生したときに行う処理を関数に記述して、その関数をオブジェクトに<BR/>
登録しておくことで、必要なときに必要な処理ができるようになります。<BR/>
他の言語では、関数ポインタ、コールバック関数、メソッドポインタなどと呼ばれています。</DIV>
<DIV id="text202_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10207px; line-height:15px; white-space:nowrap">
<A name="vbsool_event_declare">
定義： イベントごとに、メソッドを登録できるメンバー変数を宣言する</A></DIV>
<DIV id="text202_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:10025px; line-height:15px; white-space:nowrap">
<A href="#vbsool_event_declare">
→ 定義： イベントごとに、メソッドを登録できるメンバー変数を宣言する</A></DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:10268px; width:262px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text202_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:10274px; line-height:15px; white-space:nowrap">
Class&nbsp; ClassE<BR/>
&nbsp; Public&nbsp; OnEventX&nbsp; ' as EventResponders<BR/>
<BR/>
&nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; Set Me.OnEventX = new EventResponders<BR/>
&nbsp; End Sub<BR/>
End Class</DIV>
<v:rect style="position:absolute; margin-left:133px; margin-top:9969px; width:364px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text202_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:141px; margin-top:9976px; line-height:13px; white-space:nowrap">
Sub&nbsp; ClassA::OnEventX( Caller as ClassE, Args as variant )</DIV>
<v:line style="position:absolute;" from="78,9981" to="126,9981" strokecolor="#000000" strokeweight="1pt"/>
<v:shape style="position:absolute; margin-left:116px; margin-top:9976px; width:10px; height:10px"
 fillcolor="#000000" strokecolor="#000000" strokeweight="1pt"
 path="m 1000,500 l 0,0, 0,1000 x e"/>
<v:line style="position:absolute;" from="78,9981" to="78,9964" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text202_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10422px; line-height:15px; white-space:nowrap">
<A name="vbsool_event_add">
登録： コールバックされるメソッドを、メンバー変数に登録する</A></DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:10731px; width:508px; height:295px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text202_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:10737px; line-height:15px; white-space:nowrap">
Sub&nbsp; main()<BR/>
&nbsp; Dim&nbsp; obj : Set obj = new ClassE&nbsp; '// defined by Library<BR/>
&nbsp; Dim&nbsp; app : Set app = new ClassA&nbsp; '// defined by Application<BR/>
<BR/>
&nbsp; app.RespondFromClassE&nbsp; obj<BR/>
&nbsp; obj.Run&nbsp; '// call ClassA::OnEventX<BR/>
End Sub<BR/>
<BR/>
Class&nbsp; ClassA<BR/>
&nbsp; Public Sub&nbsp; RespondFromClassE( Caller )<BR/>
&nbsp; &nbsp; Caller.OnEventX.Add&nbsp; GetRef( "ClassA_onEventX" ), Me<BR/>
&nbsp; End Sub<BR/>
<BR/>
&nbsp; Public Sub&nbsp; OnEventX( Caller, Args )<BR/>
&nbsp; &nbsp; WScipt.Echo&nbsp; "Responded"<BR/>
&nbsp; End Sub<BR/>
End Class<BR/>
<BR/>
Sub&nbsp; ClassA_onEventX( Me_, Caller, Args ) : Me_.OnEventX( Caller, Args ) : End Sub</DIV>
<DIV id="text202_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:11073px; line-height:15px; white-space:nowrap">
<A name="vbsool_event_call">
呼び出し： イベントが発生したら、登録されているメソッドを呼び出す</A></DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:11147px; width:256px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text202_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:11153px; line-height:15px; white-space:nowrap">
Class ClassE<BR/>
&nbsp; Public&nbsp; OnEventX&nbsp; ' as EventResponders<BR/>
<BR/>
&nbsp; Public Sub&nbsp; Run()<BR/>
&nbsp; &nbsp; Me.OnEventX.Calls&nbsp; Me, Empty<BR/>
&nbsp; End Sub<BR/>
End Class</DIV>
<DIV id="text202_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:110px; margin-top:10290px; line-height:13px; white-space:nowrap">
OnEventX</DIV>
<DIV id="text202_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:62px; margin-top:10798px; line-height:13px; white-space:nowrap">
app</DIV>
<DIV id="text202_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:254px; margin-top:10888px; line-height:13px; white-space:nowrap">
ClassA_onEventX</DIV>
<DIV id="text202_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:10046px; line-height:15px; white-space:nowrap">
<A href="#vbsool_event_add">
→ 登録： コールバックされるメソッドを、メンバー変数に登録する</A></DIV>
<DIV id="text202_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:200px; margin-top:10798px; line-height:13px; white-space:nowrap">
obj</DIV>
<DIV id="text202_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:158px; margin-top:10948px; line-height:13px; white-space:nowrap">
Responded</DIV>
<DIV id="text202_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:92px; margin-top:11214px; line-height:13px; white-space:nowrap">
OnEventX</DIV>
<DIV id="text202_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:116px; margin-top:10335px; line-height:13px; white-space:nowrap">
OnEventX</DIV>
<DIV id="text202_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:10067px; line-height:15px; white-space:nowrap">
<A href="#vbsool_event_call">
→ 呼び出し： イベントが発生したら、登録されているメソッドを呼び出す</A></DIV>
<DIV id="text202_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:11272px; line-height:15px; white-space:nowrap">
複数のメソッドが登録されているときは、Calls メソッドを１度呼び出すだけで、複数の<BR/>
メソッドが呼び出されます。</DIV>
<DIV id="text202_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:61px; margin-top:11340px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_14.html#vbsool_event_consider">
→ イベント応答の実装方法の考察</A></DIV>
<DIV id="text202_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:10088px; line-height:15px; white-space:nowrap">
<A href="vbs_memo_14.html#EventResponders_ex">
→ EventResponders の実装例 (vbslib なし版）</A></DIV>
<DIV id="text202_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:61px; margin-top:11507px; line-height:15px; white-space:nowrap">
→ イベント関数とパラメータ取得関数 （C言語）</DIV>
<DIV id="text202_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:134px; margin-top:10933px; line-height:13px; white-space:nowrap">
OnEventX</DIV>
<DIV id="text202_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:61px; margin-top:11361px; line-height:15px; white-space:nowrap">
<A href="http://www.atmarkit.co.jp/fdotnet/vb6tonet/vb6tonet25/vb6tonet25_02.html" target="_blank">
→ ＠IT：VB.NETプログラミング　第25回 イベントとイベント・ハンドラ (Web)</A></DIV>
<DIV id="text202_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:11340px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text202_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:61px; margin-top:11465px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_51.html#CallForEach">
→ CallForEach (vbslib)</A></DIV>
<DIV id="text202_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:11465px; line-height:15px; white-space:nowrap">
関数を複数回呼び出す</DIV>
<DIV id="text202_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:61px; margin-top:11382px; line-height:15px; white-space:nowrap">
→ イベント(C#)</DIV>
<DIV id="text202_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:11104px; line-height:15px; white-space:nowrap">
イベントが発生したオブジェクトのメソッドから、イベントに応答するオブジェクトのメソッドを<BR/>
呼び出すコードを、通常、ライブラリが書きます。</DIV>
<DIV id="text202_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:10454px; line-height:15px; white-space:nowrap">
イベントが発生したらコールバックされるメソッドを、イベントが発生するオブジェクトに登録<BR/>
するコードを、通常、アプリケーションが書きます。</DIV>
<DIV id="text202_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:9882px; line-height:15px; white-space:nowrap">
通常、ライブラリにあるクラスが、イベントの定義とメソッドの呼び出しを行い、アプリケーション<BR/>
が、イベントに応答するメソッドの定義と、そのメソッドの登録を行います。</DIV>
<DIV id="text202_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:10241px; line-height:15px; white-space:nowrap">
通常、ライブラリにあるクラスが、イベントを定義します。</DIV>
<DIV id="text202_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:317px; margin-top:9937px; line-height:15px; white-space:nowrap">
ライブラリの中 （イベント発生元）</DIV>
<DIV id="text202_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:425px; margin-top:9997px; line-height:15px; white-space:nowrap">
アプリケーション</DIV>
<DIV id="text202_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:59px; margin-top:9984px; line-height:15px; white-space:nowrap">
呼び出し</DIV>
<DIV id="text202_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:10711px; line-height:15px; white-space:nowrap">
アプリケーションが定義する ClassA クラスが応答する場合：</DIV>
<DIV id="text202_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:10504px; line-height:15px; white-space:nowrap">
アプリケーションが定義する OnEventX 関数が応答する場合：</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:10524px; width:298px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text202_46" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:10530px; line-height:15px; white-space:nowrap">
Sub&nbsp; main()<BR/>
&nbsp; Dim&nbsp; obj : Set obj = new ClassE<BR/>
<BR/>
&nbsp; obj.OnEventX.Add&nbsp; GetRef( "OnEventX" ), Empty<BR/>
&nbsp; obj.Run&nbsp; '// call OnEventX<BR/>
End Sub<BR/>
<BR/>
Sub&nbsp; OnEventX( Dummy, Caller, Args )<BR/>
&nbsp; WScipt.Echo&nbsp; "Responded"<BR/>
End Sub</DIV>
<DIV id="text202_47" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:145px; margin-top:10651px; line-height:13px; white-space:nowrap">
Responded</DIV>
<DIV id="text202_48" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:223px; margin-top:10576px; line-height:13px; white-space:nowrap">
OnEventX</DIV>
<DIV id="text202_49" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:79px; margin-top:10636px; line-height:13px; white-space:nowrap">
OnEventX</DIV>
<DIV id="text202_50" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:116px; margin-top:10888px; line-height:13px; white-space:nowrap">
OnEventX</DIV>
<DIV id="text202_51" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:85px; margin-top:10576px; line-height:13px; white-space:nowrap">
OnEventX</DIV>
<DIV id="text202_52" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:139px; margin-top:10576px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_14.html#EventResponders_Add">
Add</A></DIV>
<DIV id="text202_53" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:200px; margin-top:10290px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_14.html#EventResponders_ex">
EventResponders</A></DIV>
<DIV id="text202_54" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:170px; margin-top:10888px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_14.html#EventResponders_Add">
Add</A></DIV>
<DIV id="text202_55" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:146px; margin-top:11214px; line-height:13px; white-space:nowrap">
<A href="vbs_memo_14.html#EventResponders_Calls">
Calls</A></DIV>
<DIV id="text202_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:101px; margin-top:10123px; line-height:15px; white-space:nowrap">
→ T_Item フォルダ</DIV>
<DIV id="text202_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:10123px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<DIV id="text202_58" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:269px; margin-top:10123px; line-height:15px; white-space:nowrap">
vbslib なし版</DIV>
<DIV id="text202_59" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:101px; margin-top:10143px; line-height:15px; white-space:nowrap">
→ T_Item_vbslib フォルダ</DIV>
<DIV id="text202_60" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:269px; margin-top:10143px; line-height:15px; white-space:nowrap">
vbslib 使用版</DIV>
<DIV id="text202_61" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:110px; margin-top:11169px; line-height:13px; white-space:nowrap">
<A href="#vbsool_event_declare">
OnEventX</A></DIV>
<DIV id="text202_62" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:326px; margin-top:10088px; line-height:15px; white-space:nowrap">
<A href="..\vbslib.files\vbslib_24.html#EventResponders">
→ （vbslib 使用版）</A></DIV>
<DIV id="text202_63" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:61px; margin-top:11403px; line-height:15px; white-space:nowrap">
<A href="http://d.hatena.ne.jp/m-hiyama/20071205/1196838087" target="_blank">
→ イベントモデルの概念と用語法が混乱しているので、イライライするんですが (Web)</A></DIV>

<v:line from="0,9735" to="585,9735"/>
<v:line from="585,9735" to="585,11558"/>
<v:line from="585,11558" to="0,11558"/>
<v:line from="0,11558" to="0,9735"/>

<DIV style="position:absolute; margin-left:0px; margin-top:11558px;">
<A id="svgcats_vml_p202" class="to_tree" onClick="selectTreeElem( '202' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:11558px;">
<A id="page_group_bottom" href="vbs_memo_14.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
