<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>vbslib</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbslib.files/vbslib_31.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbslib.files/vbslib_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbslib.files/vbslib_31.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 572 --> 
<PAGE>
<A id="svgcats_vml_p572" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '572' );">←</A>
<A href="#svgcats_vml_p573" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbslib_30.html#svgcats_vml_p571" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbslib_30.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:648px; height:835px;" fillcolor="white"/>
<DIV id="text572_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="AnalyzeCharacterCodeSet">
AnalyzeCharacterCodeSet</A></DIV>
<DIV id="text572_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:86px; line-height:15px; white-space:nowrap">
ファイルの文字 コード セットを判定します。</DIV>
<DIV id="text572_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:112px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text572_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:112px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text572_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:112px; line-height:15px; white-space:nowrap">
文字コードを判定するファイルのパス</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:47px; width:448px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text572_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:54px; line-height:13px; white-space:nowrap">
Function&nbsp; AnalyzeCharacterCodeSet( Path as string ) as integer or string</DIV>
<DIV id="text572_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:131px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text572_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:131px; line-height:15px; white-space:nowrap">
文字 コード セット</DIV>
<DIV id="text572_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:401px; line-height:15px; white-space:nowrap">
MIME</DIV>
<DIV id="text572_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:76px; margin-top:401px; line-height:15px; white-space:nowrap">
や</DIV>
<DIV id="text572_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:416px; line-height:15px; white-space:nowrap">
<A href="#new_TextFileCharSetStack">
new_TextFileCharSetStack</A></DIV>
<DIV id="text572_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:197px; margin-top:416px; line-height:15px; white-space:nowrap">
を使って開きなおしてください。</DIV>
<DIV id="text572_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:91px; margin-top:401px; line-height:15px; white-space:nowrap">
HTML</DIV>
<DIV id="text572_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:128px; margin-top:401px; line-height:15px; white-space:nowrap">
の charset によって、文字コードが指定される場合は、文字コードを調べて</DIV>
<DIV id="text572_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:278px; margin-top:552px; line-height:15px; white-space:nowrap">
XML宣言 (?xml)</DIV>
<DIV id="text572_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:377px; margin-top:552px; line-height:15px; white-space:nowrap">
の encoding="UTF-8" があるとき</DIV>
<DIV id="text572_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:49px; margin-top:534px; line-height:13px; white-space:nowrap">
c.No_BOM</DIV>
<DIV id="text572_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:49px; margin-top:554px; line-height:13px; white-space:nowrap">
c.UTF_8_No_BOM</DIV>
<DIV id="text572_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:160px; margin-top:532px; line-height:15px; white-space:nowrap">
先頭に BOM がなく、</DIV>
<DIV id="text572_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:160px; margin-top:552px; line-height:15px; white-space:nowrap">
先頭に BOM がなく、</DIV>
<DIV id="text572_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:49px; margin-top:613px; line-height:13px; white-space:nowrap">
(文字列)</DIV>
<DIV id="text572_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:377px; margin-top:611px; line-height:15px; white-space:nowrap">
の encoding があり、"UTF-8" 以外のとき</DIV>
<DIV id="text572_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:278px; margin-top:611px; line-height:15px; white-space:nowrap">
XML宣言 (?xml)</DIV>
<DIV id="text572_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:160px; margin-top:611px; line-height:15px; white-space:nowrap">
先頭に BOM がなく、</DIV>
<DIV id="text572_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:278px; margin-top:532px; line-height:15px; white-space:nowrap">
XML宣言 (?xml)</DIV>
<DIV id="text572_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:377px; margin-top:532px; line-height:15px; white-space:nowrap">
の encoding がないとき</DIV>
<DIV id="text572_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:160px; margin-top:588px; line-height:15px; white-space:nowrap">
new_TextFileCharSetStack が UTF-8 のとき</DIV>
<DIV id="text572_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:377px; margin-top:573px; line-height:15px; white-space:nowrap">
の encoding がなく、</DIV>
<DIV id="text572_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:278px; margin-top:573px; line-height:15px; white-space:nowrap">
XML宣言 (?xml)</DIV>
<DIV id="text572_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:160px; margin-top:573px; line-height:15px; white-space:nowrap">
先頭に BOM がなく、</DIV>
<DIV id="text572_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:25px; margin-top:460px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text572_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:307px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:330px; width:490px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text572_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:336px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set cs = new_TextFileCharSetStack( AnalyzeCharacterCodeSet( "File1.txt" ) )<BR/>
&nbsp; &nbsp; CreateFile&nbsp; "File1.txt", "abc"<BR/>
&nbsp; &nbsp; cs = Empty</DIV>
<DIV id="text572_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:114px; margin-top:307px; line-height:15px; white-space:nowrap">
同じ文字コードを使ってファイルを作成する</DIV>
<DIV id="text572_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:435px; margin-top:337px; line-height:13px; white-space:nowrap">
File1.txt</DIV>
<DIV id="text572_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:25px; margin-top:739px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text572_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:739px; line-height:15px; white-space:nowrap">
<A href="#new_TextFileCharSetStack">
→ new_TextFileCharSetStack</A></DIV>
<DIV id="text572_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:68px; margin-top:773px; line-height:15px; white-space:nowrap">
→ 文字エンコーディングの指定方法</DIV>
<DIV id="text572_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:756px; line-height:15px; white-space:nowrap">
<A href="vbslib_47.html#Read_XML_Encoding">
→ Read_XML_Encoding</A></DIV>
<DIV id="text572_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:790px; line-height:15px; white-space:nowrap">
<A href="#charcode_in_file">
→ ファイル内の文字コードの指定</A></DIV>
<DIV id="text572_41" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:49px; margin-top:513px; line-height:13px; white-space:nowrap">
c.UTF_8</DIV>
<DIV id="text572_42" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:49px; margin-top:492px; line-height:13px; white-space:nowrap">
c.Unicode</DIV>
<DIV id="text572_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:160px; margin-top:511px; line-height:15px; white-space:nowrap">
先頭に UTF-8 の BOM (EF BB BF) があるとき</DIV>
<DIV id="text572_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:160px; margin-top:490px; line-height:15px; white-space:nowrap">
先頭に UTF-16 の BOM (FF FE) があるとき</DIV>
<DIV id="text572_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:25px; margin-top:701px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text572_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:25px; margin-top:672px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text572_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:672px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text572_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:701px; line-height:15px; white-space:nowrap">
→ T_Binary.vbs</DIV>
<DIV id="text572_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:169px; line-height:15px; white-space:nowrap">
本関数は、バージョンによって解析の性能が異なります。<BR/>
現在のバージョンは、以下の方法で解析しています。</DIV>
<DIV id="text572_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:247px; line-height:15px; white-space:nowrap">
WHITE SQUARE エンコーディング判定法 （独自）</DIV>
<DIV id="text572_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:155px; margin-top:228px; line-height:15px; white-space:nowrap">
の encoding</DIV>
<DIV id="text572_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:228px; line-height:15px; white-space:nowrap">
XML宣言 (?xml)</DIV>
<DIV id="text572_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:209px; line-height:15px; white-space:nowrap">
Unicode の BOM (ByteOrderMaker)</DIV>
<DIV id="text572_54" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:49px; margin-top:637px; line-height:13px; white-space:nowrap">
Empty</DIV>
<DIV id="text572_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:160px; margin-top:635px; line-height:15px; white-space:nowrap">
解析できないとき、Windows の OEMのとき、ファイルがないとき</DIV>
<DIV id="text572_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:188px; margin-top:701px; line-height:15px; white-space:nowrap">
T_AnalyzeCharacterCodeSet</DIV>
<DIV id="text572_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:188px; margin-top:672px; line-height:15px; white-space:nowrap">
→ vbslib_helper.c</DIV>
<DIV id="text572_58" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:313px; margin-top:672px; line-height:15px; white-space:nowrap">
ReadCharacterEncodingCharacterCommand</DIV>

<v:line from="0,0" to="648,0"/>
<v:line from="648,0" to="648,835"/>
<v:line from="648,835" to="0,835"/>
<v:line from="0,835" to="0,0"/>

</PAGE>
 
<!-- page 573 --> 
<PAGE>
<A id="svgcats_vml_p573" class="to_tree" style="margin-top:840px;" onClick="selectTreeElem( '573' );">←</A>
<A href="#svgcats_vml_p574" class="to_next_page" style="margin-top:840px;">▼</A>
<A href="#svgcats_vml_p572" class="to_prev_page" style="margin-top:840px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:851px; width:530px; height:455px;" fillcolor="white"/>
<DIV id="text573_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:868px; line-height:15px; white-space:nowrap">
<A name="ReadUnicodeFileBOM">
ReadUnicodeFileBOM</A></DIV>
<DIV id="text573_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:937px; line-height:15px; white-space:nowrap">
ファイルの文字コードを判定するために、ファイルの先頭にある BOM を読みます。</DIV>
<DIV id="text573_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:963px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text573_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:963px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text573_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:963px; line-height:15px; white-space:nowrap">
文字コードを判定するファイルのパス</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:898px; width:358px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text573_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:905px; line-height:13px; white-space:nowrap">
Function&nbsp; ReadUnicodeFileBOM( Path as string ) as integer</DIV>
<DIV id="text573_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:982px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text573_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:982px; line-height:15px; white-space:nowrap">
BOM の文字コード</DIV>
<DIV id="text573_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1229px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text573_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:1229px; line-height:15px; white-space:nowrap">
→ T_File.vbs</DIV>
<DIV id="text573_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:148px; margin-top:1229px; line-height:15px; white-space:nowrap">
T_ReadUnicodeFileBOM</DIV>
<DIV id="text573_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1200px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text573_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:1200px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text573_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:25px; margin-top:1027px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text573_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:1120px; line-height:15px; white-space:nowrap">
ファイルが無いとき</DIV>
<DIV id="text573_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:63px; margin-top:1122px; line-height:13px; white-space:nowrap">
Empty</DIV>
<DIV id="text573_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:63px; margin-top:1080px; line-height:13px; white-space:nowrap">
c.UTF_8</DIV>
<DIV id="text573_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:63px; margin-top:1059px; line-height:13px; white-space:nowrap">
c.Unicode</DIV>
<DIV id="text573_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:1078px; line-height:15px; white-space:nowrap">
先頭に UTF-8 の BOM (EF BB BF) があるとき</DIV>
<DIV id="text573_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:1057px; line-height:15px; white-space:nowrap">
先頭に UTF-16 の BOM (FF FE) があるとき</DIV>
<DIV id="text573_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:25px; margin-top:1160px; line-height:15px; white-space:nowrap">
Set c = g_VBS_Lib です。</DIV>
<DIV id="text573_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:63px; margin-top:1101px; line-height:13px; white-space:nowrap">
c.No_BOM</DIV>
<DIV id="text573_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:1099px; line-height:15px; white-space:nowrap">
BOM がないとき</DIV>
<DIV id="text573_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1258px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text573_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:1258px; line-height:15px; white-space:nowrap">
<A href="#AnalyzeCharacterCodeSet">
→ AnalyzeCharacterCodeSet</A></DIV>

<v:line from="0,851" to="530,851"/>
<v:line from="530,851" to="530,1306"/>
<v:line from="530,1306" to="0,1306"/>
<v:line from="0,1306" to="0,851"/>

</PAGE>
 
<!-- page 574 --> 
<PAGE>
<A id="svgcats_vml_p574" class="to_tree" style="margin-top:1311px;" onClick="selectTreeElem( '574' );">←</A>
<A href="#svgcats_vml_p575" class="to_next_page" style="margin-top:1311px;">▼</A>
<A href="#svgcats_vml_p573" class="to_prev_page" style="margin-top:1311px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1322px; width:553px; height:719px;" fillcolor="white"/>
<DIV id="text574_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1339px; line-height:15px; white-space:nowrap">
<A name="GetStringFromCharacterCodeSet">
GetStringFromCharacterCodeSet</A></DIV>
<DIV id="text574_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:1421px; line-height:15px; white-space:nowrap">
vbslib の文字コード セットの数値から、文字列に変換します。</DIV>
<DIV id="text574_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:1447px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text574_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:1447px; line-height:15px; white-space:nowrap">
in_CharacterCodeSetConstant</DIV>
<DIV id="text574_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:289px; margin-top:1447px; line-height:15px; white-space:nowrap">
vbslib の文字コード セットの数値</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:1369px; width:400px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text574_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:1375px; line-height:15px; white-space:nowrap">
Function&nbsp; GetStringFromCharacterCodeSet(<BR/>
&nbsp; &nbsp; in_CharacterCodeSetConstant as integer or string ) as string</DIV>
<DIV id="text574_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:1466px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text574_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:289px; margin-top:1466px; line-height:15px; white-space:nowrap">
文字コード セットの文字列</DIV>
<DIV id="text574_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1505px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:1528px; width:484px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text574_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:1535px; line-height:13px; white-space:nowrap">
&nbsp; &nbsp; Assert&nbsp; GetStringFromCharacterCodeSet( g_VBS_Lib.Shift_JIS ) = "Shift_JIS"</DIV>
<DIV id="text574_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:69px; margin-top:1795px; line-height:13px; white-space:nowrap">
c.No_BOM</DIV>
<DIV id="text574_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1574px; line-height:15px; white-space:nowrap">
詳細</DIV>
<DIV id="text574_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:69px; margin-top:1663px; line-height:13px; white-space:nowrap">
c.Shift_JIS</DIV>
<DIV id="text574_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:177px; margin-top:1663px; line-height:13px; white-space:nowrap">
"Shift_JIS"</DIV>
<v:line style="position:absolute;" from="55,1654" to="291,1654" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text574_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:76px; margin-top:1595px; line-height:15px; white-space:nowrap">
vbslib の<BR/>
文字コード <BR/>
セットの数値</DIV>
<DIV id="text574_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:1610px; line-height:15px; white-space:nowrap">
文字コード <BR/>
セットの文字列</DIV>
<DIV id="text574_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:69px; margin-top:1685px; line-height:13px; white-space:nowrap">
c.EUC_JP</DIV>
<DIV id="text574_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:177px; margin-top:1685px; line-height:13px; white-space:nowrap">
"EUC-JP"</DIV>
<DIV id="text574_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:69px; margin-top:1707px; line-height:13px; white-space:nowrap">
c.Unicode</DIV>
<DIV id="text574_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:177px; margin-top:1707px; line-height:13px; white-space:nowrap">
"Unicode"</DIV>
<DIV id="text574_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1869px; line-height:15px; white-space:nowrap">
仕様の理由</DIV>
<DIV id="text574_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:1899px; line-height:15px; white-space:nowrap">
Shift_JIS は、 </DIV>
<DIV id="text574_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:124px; margin-top:1899px; line-height:15px; white-space:nowrap">
HTML</DIV>
<DIV id="text574_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:163px; margin-top:1899px; line-height:15px; white-space:nowrap">
の、META タグの charset 属性に指定できる値です。</DIV>
<DIV id="text574_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:69px; margin-top:1729px; line-height:13px; white-space:nowrap">
c.UTF_8</DIV>
<DIV id="text574_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:177px; margin-top:1729px; line-height:13px; white-space:nowrap">
"UTF-8"</DIV>
<DIV id="text574_28" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:69px; margin-top:1751px; line-height:13px; white-space:nowrap">
c.UTF_8_No_BOM</DIV>
<DIV id="text574_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:177px; margin-top:1751px; line-height:13px; white-space:nowrap">
"UTF-8-No-BOM"</DIV>
<DIV id="text574_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:69px; margin-top:1773px; line-height:13px; white-space:nowrap">
c.ISO_2022_JP</DIV>
<DIV id="text574_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:177px; margin-top:1773px; line-height:13px; white-space:nowrap">
"ISO-2022-JP"</DIV>
<DIV id="text574_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:69px; margin-top:1817px; line-height:13px; white-space:nowrap">
Empty</DIV>
<DIV id="text574_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:177px; margin-top:1795px; line-height:13px; white-space:nowrap">
"Shift_JIS"</DIV>
<DIV id="text574_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:177px; margin-top:1817px; line-height:13px; white-space:nowrap">
"Shift_JIS"</DIV>
<DIV id="text574_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1965px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text574_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:1965px; line-height:15px; white-space:nowrap">
→ T_File.vbs</DIV>
<DIV id="text574_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:148px; margin-top:1965px; line-height:15px; white-space:nowrap">
T_GetStringFromCharacterCodeSet</DIV>
<DIV id="text574_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1936px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text574_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:1936px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text574_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:1993px; line-height:15px; white-space:nowrap">
<A href="#GetCharacterCodeSetFromString">
→ GetCharacterCodeSetFromString</A></DIV>
<DIV id="text574_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1993px; line-height:15px; white-space:nowrap">
関連</DIV>

<v:line from="0,1322" to="553,1322"/>
<v:line from="553,1322" to="553,2041"/>
<v:line from="553,2041" to="0,2041"/>
<v:line from="0,2041" to="0,1322"/>

</PAGE>
 
<!-- page 575 --> 
<PAGE>
<A id="svgcats_vml_p575" class="to_tree" style="margin-top:2046px;" onClick="selectTreeElem( '575' );">←</A>
<A href="#svgcats_vml_p576" class="to_next_page" style="margin-top:2046px;">▼</A>
<A href="#svgcats_vml_p574" class="to_prev_page" style="margin-top:2046px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2057px; width:655px; height:664px;" fillcolor="white"/>
<DIV id="text575_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2074px; line-height:15px; white-space:nowrap">
<A name="GetCharacterCodeSetFromString">
GetCharacterCodeSetFromString</A></DIV>
<DIV id="text575_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2156px; line-height:15px; white-space:nowrap">
文字コード セットの文字列から、vbslib の数値に変換します。</DIV>
<DIV id="text575_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2182px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text575_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2182px; line-height:15px; white-space:nowrap">
in_CharacterCodeSetString</DIV>
<DIV id="text575_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:271px; margin-top:2182px; line-height:15px; white-space:nowrap">
文字コード セットの文字列</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:2104px; width:382px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text575_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:2110px; line-height:15px; white-space:nowrap">
Function&nbsp; GetCharacterCodeSetFromString(<BR/>
&nbsp; &nbsp; in_CharacterCodeSetString as string ) as integr or string</DIV>
<DIV id="text575_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2220px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text575_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:271px; margin-top:2220px; line-height:15px; white-space:nowrap">
vbslib の文字コード セットの数値</DIV>
<DIV id="text575_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2255px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:2278px; width:586px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text575_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:2285px; line-height:13px; white-space:nowrap">
&nbsp; &nbsp; Assert&nbsp; GetCharacterCodeSetFromString( "Shift_JIS",&nbsp; c.UTF_8_No_BOM ) = g_VBS_Lib.Shift_JIS</DIV>
<DIV id="text575_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2344px; line-height:15px; white-space:nowrap">
詳細</DIV>
<DIV id="text575_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:176px; margin-top:2433px; line-height:13px; white-space:nowrap">
c.Shift_JIS</DIV>
<DIV id="text575_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:62px; margin-top:2433px; line-height:13px; white-space:nowrap">
"Shift_JIS"</DIV>
<v:line style="position:absolute;" from="46,2424" to="598,2424" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text575_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:176px; margin-top:2365px; line-height:15px; white-space:nowrap">
vbslib の<BR/>
文字コード <BR/>
セットの数値</DIV>
<DIV id="text575_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:2380px; line-height:15px; white-space:nowrap">
文字コード <BR/>
セットの文字列</DIV>
<DIV id="text575_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:176px; margin-top:2455px; line-height:13px; white-space:nowrap">
c.EUC_JP</DIV>
<DIV id="text575_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:62px; margin-top:2455px; line-height:13px; white-space:nowrap">
"EUC-JP"</DIV>
<DIV id="text575_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:176px; margin-top:2477px; line-height:13px; white-space:nowrap">
c.Unicode</DIV>
<DIV id="text575_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:62px; margin-top:2477px; line-height:13px; white-space:nowrap">
"Unicode"</DIV>
<DIV id="text575_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:62px; margin-top:2521px; line-height:13px; white-space:nowrap">
"UTF-8"</DIV>
<DIV id="text575_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:176px; margin-top:2565px; line-height:13px; white-space:nowrap">
c.UTF_8_No_BOM</DIV>
<DIV id="text575_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:62px; margin-top:2565px; line-height:13px; white-space:nowrap">
"UTF-8-No-BOM"</DIV>
<DIV id="text575_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:176px; margin-top:2587px; line-height:13px; white-space:nowrap">
c.ISO_2022_JP</DIV>
<DIV id="text575_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:62px; margin-top:2587px; line-height:13px; white-space:nowrap">
"ISO-2022-JP"</DIV>
<DIV id="text575_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:176px; margin-top:2499px; line-height:13px; white-space:nowrap">
c.Unicode</DIV>
<DIV id="text575_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:62px; margin-top:2499px; line-height:13px; white-space:nowrap">
"UTF-16"</DIV>
<DIV id="text575_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2201px; line-height:15px; white-space:nowrap">
in_UTF_8_CharacterCodeSet</DIV>
<DIV id="text575_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:271px; margin-top:2201px; line-height:15px; white-space:nowrap">
"UTF-8" に対する vbslib の文字コード セットの数値</DIV>
<DIV id="text575_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:368px; margin-top:2519px; line-height:15px; white-space:nowrap">
in_UTF_8_CharacterCodeSet 引数の値、</DIV>
<DIV id="text575_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:176px; margin-top:2521px; line-height:13px; white-space:nowrap">
c.UTF_8_No_BOM</DIV>
<DIV id="text575_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:269px; margin-top:2519px; line-height:15px; white-space:nowrap">
または</DIV>
<DIV id="text575_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:306px; margin-top:2521px; line-height:13px; white-space:nowrap">
c.UTF_8</DIV>
<DIV id="text575_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:176px; margin-top:2543px; line-height:13px; white-space:nowrap">
c.UTF_8</DIV>
<DIV id="text575_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:62px; margin-top:2543px; line-height:13px; white-space:nowrap">
"UTF-8-BOM"</DIV>
<DIV id="text575_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:2608px; line-height:15px; white-space:nowrap">
その他</DIV>
<DIV id="text575_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:176px; margin-top:2608px; line-height:15px; white-space:nowrap">
in_CharacterCodeSetString 引数</DIV>
<DIV id="text575_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:2672px; line-height:15px; white-space:nowrap">
<A href="#GetStringFromCharacterCodeSet">
→ GetStringFromCharacterCodeSet</A></DIV>
<DIV id="text575_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2672px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text575_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2646px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text575_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:2646px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>

<v:line from="0,2057" to="655,2057"/>
<v:line from="655,2057" to="655,2721"/>
<v:line from="655,2721" to="0,2721"/>
<v:line from="0,2721" to="0,2057"/>

</PAGE>
 
<!-- page 576 --> 
<PAGE>
<A id="svgcats_vml_p576" class="to_tree" style="margin-top:2726px;" onClick="selectTreeElem( '576' );">←</A>
<A href="#svgcats_vml_p577" class="to_next_page" style="margin-top:2726px;">▼</A>
<A href="#svgcats_vml_p575" class="to_prev_page" style="margin-top:2726px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2737px; width:501px; height:357px;" fillcolor="white"/>
<DIV id="text576_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2754px; line-height:15px; white-space:nowrap">
<A name="ReadLineSeparator">
ReadLineSeparator</A></DIV>
<DIV id="text576_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2823px; line-height:15px; white-space:nowrap">
ファイルの先頭行を読んで、改行文字の種類を返します。</DIV>
<DIV id="text576_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2849px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text576_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2849px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text576_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:2849px; line-height:15px; white-space:nowrap">
改行文字の種類を判定するファイルのパス</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:2784px; width:352px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text576_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:2791px; line-height:13px; white-space:nowrap">
Function&nbsp; ReadLineSeparator( Path as string ) as integer</DIV>
<DIV id="text576_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2868px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text576_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:2868px; line-height:15px; white-space:nowrap">
vbCRLF または vbLF</DIV>
<DIV id="text576_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3046px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text576_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2942px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:2965px; width:328px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text576_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:2972px; line-height:13px; white-space:nowrap">
&nbsp; f.LineSeparator = ReadLineSeparator( "File1.txt" )</DIV>
<DIV id="text576_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:228px; margin-top:2753px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text576_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:3046px; line-height:15px; white-space:nowrap">
<A href="#new_TextFileLineSeparatorStack">
→ new_TextFileLineSeparatorStack</A></DIV>
<DIV id="text576_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3015px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text576_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:3015px; line-height:15px; white-space:nowrap">
→ T_File.vbs # [T_ReadLineSeparator]</DIV>
<DIV id="text576_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2901px; line-height:15px; white-space:nowrap">
ファイルによっては、改行文字の種類がバラバラになっていることもあります。</DIV>

<v:line from="0,2737" to="501,2737"/>
<v:line from="501,2737" to="501,3094"/>
<v:line from="501,3094" to="0,3094"/>
<v:line from="0,3094" to="0,2737"/>

</PAGE>
 
<!-- page 577 --> 
<PAGE>
<A id="svgcats_vml_p577" class="to_tree" style="margin-top:3099px;" onClick="selectTreeElem( '577' );">←</A>
<A href="#svgcats_vml_p578" class="to_next_page" style="margin-top:3099px;">▼</A>
<A href="#svgcats_vml_p576" class="to_prev_page" style="margin-top:3099px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3110px; width:517px; height:672px;" fillcolor="white"/>
<DIV id="text577_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3127px; line-height:15px; white-space:nowrap">
<A name="GetLineCount">
GetLineCount</A></DIV>
<v:rect style="position:absolute; margin-left:43px; margin-top:3318px; width:328px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text577_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:51px; margin-top:3324px; line-height:15px; white-space:nowrap">
Set c = g_VBS_Lib<BR/>
<BR/>
Assert&nbsp; GetLineCount( "a", Empty ) = 1<BR/>
Assert&nbsp; GetLineCount( "a" +vbCRLF, Empty ) = 1<BR/>
Assert&nbsp; GetLineCount( "a" +vbCRLF+ "b", Empty ) = 2<BR/>
Assert&nbsp; GetLineCount( "a" +vbLF+&nbsp; &nbsp;"b", Empty ) = 2<BR/>
Assert&nbsp; GetLineCount( "", Empty ) = 0<BR/>
<BR/>
Assert&nbsp; GetLineCount( "a", c.NoRound ) = 1<BR/>
Assert&nbsp; GetLineCount( "a" +vbCRLF, c.NoRound ) = 1.5</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:3157px; width:382px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text577_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:3164px; line-height:13px; white-space:nowrap">
Function&nbsp; GetLineCount( Text as string, RoundWay as integer )</DIV>
<DIV id="text577_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3194px; line-height:15px; white-space:nowrap">
文字列の行数をカウントします。</DIV>
<DIV id="text577_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3220px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text577_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:3220px; line-height:15px; white-space:nowrap">
Text</DIV>
<DIV id="text577_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:3239px; line-height:15px; white-space:nowrap">
RoundWay</DIV>
<DIV id="text577_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:3220px; line-height:15px; white-space:nowrap">
行数をカウントする文字列</DIV>
<DIV id="text577_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:3239px; line-height:15px; white-space:nowrap">
通常 Empty、g_VBS_Lib.NoRound も可能</DIV>
<DIV id="text577_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3703px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text577_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3295px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text577_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3677px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text577_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:3703px; line-height:15px; white-space:nowrap">
T_GetLineCount</DIV>
<DIV id="text577_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:78px; margin-top:3703px; line-height:15px; white-space:nowrap">
→ T_StrEx.vbs</DIV>
<DIV id="text577_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:78px; margin-top:3677px; line-height:15px; white-space:nowrap">
→ ToolsLib.vbs</DIV>
<DIV id="text577_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:3258px; line-height:15px; white-space:nowrap">
文字列の行数</DIV>
<DIV id="text577_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:3258px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text577_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3596px; line-height:15px; white-space:nowrap">
<A name="GetLineCount_RoundWay">
RoundWay 引数</A></DIV>
<DIV id="text577_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:3622px; line-height:15px; white-space:nowrap">
RoundWay 引数には、通常 Empty を指定します。<BR/>
g_VBS_Lib.NoRound を指定すると、最終行の行末が改行文字なら +0.5 します。</DIV>
<DIV id="text577_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:411px; margin-top:3239px; line-height:15px; white-space:nowrap">
<A href="#GetLineCount_RoundWay">
（下記）</A></DIV>
<DIV id="text577_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3506px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:43px; margin-top:3530px; width:364px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text577_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:51px; margin-top:3537px; line-height:13px; white-space:nowrap">
line_num = GetLineCount( Left( string, position ), Empty )</DIV>
<DIV id="text577_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:108px; margin-top:3506px; line-height:15px; white-space:nowrap">
position の位置の行番号を取得する</DIV>
<DIV id="text577_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:78px; margin-top:3729px; line-height:15px; white-space:nowrap">
<A href="#LineNumFromTextPositionClass">
→ LineNumFromTextPositionClass</A></DIV>
<DIV id="text577_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3729px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text577_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:298px; margin-top:3729px; line-height:15px; white-space:nowrap">
行番号をカウントします</DIV>

<v:line from="0,3110" to="517,3110"/>
<v:line from="517,3110" to="517,3782"/>
<v:line from="517,3782" to="0,3782"/>
<v:line from="0,3782" to="0,3110"/>

</PAGE>
 
<!-- page 578 --> 
<PAGE>
<A id="svgcats_vml_p578" class="to_tree" style="margin-top:3787px;" onClick="selectTreeElem( '578' );">←</A>
<A href="#svgcats_vml_p579" class="to_next_page" style="margin-top:3787px;">▼</A>
<A href="#svgcats_vml_p577" class="to_prev_page" style="margin-top:3787px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3798px; width:553px; height:383px;" fillcolor="white"/>
<DIV id="text578_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3815px; line-height:15px; white-space:nowrap">
<A name="LineNumFromTextPositionClass">
LineNumFromTextPositionClass</A></DIV>
<DIV id="text578_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3852px; line-height:15px; white-space:nowrap">
文字列の先頭からの位置から、行番号をカウントします。<BR/>
処理効率を良くするため、２回目以降は前回カウントした位置からカウントを再開します。</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:3936px; width:364px; height:145px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text578_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:3942px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set counter = new LineNumFromTextPositionClass<BR/>
&nbsp; &nbsp; counter.Text = _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "a"+ vbCRLF + _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "b"+ vbCRLF + _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "cde"<BR/>
&nbsp; &nbsp; Assert&nbsp; counter.GetNextLineNum( 4 )&nbsp; = 2&nbsp; '// "b"<BR/>
&nbsp; &nbsp; Assert&nbsp; counter.GetNextLineNum( 6 )&nbsp; = 2&nbsp; '// vbLF<BR/>
&nbsp; &nbsp; Assert&nbsp; counter.GetNextLineNum( 7 )&nbsp; = 3&nbsp; '// "c"<BR/>
&nbsp; &nbsp; Assert&nbsp; counter.GetNextLineNum( 10 ) = 3&nbsp; '// 最後の次</DIV>
<DIV id="text578_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3912px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text578_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:121px; margin-top:3958px; line-height:13px; white-space:nowrap">
<A href="#SetText_LineNumFromTextPositionClass">
Text</A></DIV>
<DIV id="text578_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:169px; margin-top:4018px; line-height:13px; white-space:nowrap">
<A href="#GetNextLineNum_LineNumFromTextPositionClass">
GetNextLineNum</A></DIV>
<DIV id="text578_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:78px; margin-top:4107px; line-height:15px; white-space:nowrap">
→ ToolsLib.vbs</DIV>
<DIV id="text578_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4133px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text578_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4107px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text578_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:4133px; line-height:15px; white-space:nowrap">
T_LineNumFromTextPosition</DIV>
<DIV id="text578_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:78px; margin-top:4133px; line-height:15px; white-space:nowrap">
→ T_StrEx.vbs</DIV>

<v:line from="0,3798" to="553,3798"/>
<v:line from="553,3798" to="553,4181"/>
<v:line from="553,4181" to="0,4181"/>
<v:line from="0,4181" to="0,3798"/>

</PAGE>
 
<!-- page 579 --> 
<PAGE>
<A id="svgcats_vml_p579" class="to_tree" style="margin-top:4186px;" onClick="selectTreeElem( '579' );">←</A>
<A href="#svgcats_vml_p580" class="to_next_page" style="margin-top:4186px;">▼</A>
<A href="#svgcats_vml_p578" class="to_prev_page" style="margin-top:4186px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4197px; width:578px; height:242px;" fillcolor="white"/>
<DIV id="text579_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4214px; line-height:15px; white-space:nowrap">
<A name="SetText_LineNumFromTextPositionClass">
Text (LineNumFromTextPositionClass)</A></DIV>
<DIV id="text579_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:4391px; line-height:15px; white-space:nowrap">
<A href="#ReplaceTextAtHere_LineNumFromTextPositionClass">
→ ReplaceTextAtHere</A></DIV>
<DIV id="text579_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4391px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text579_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:231px; margin-top:4391px; line-height:15px; white-space:nowrap">
現在位置以降の文字列を置き換える</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:4244px; width:418px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text579_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:4251px; line-height:13px; white-space:nowrap">
Property&nbsp; LineNumFromTextPositionClass::Text as string&nbsp; '// Get/Let</DIV>
<DIV id="text579_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4281px; line-height:15px; white-space:nowrap">
行番号を調べる対象となる文字列。</DIV>
<DIV id="text579_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4317px; line-height:15px; white-space:nowrap">
設定すると、前回調べた位置と行番号の情報はクリアされます。 参考</DIV>
<DIV id="text579_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:427px; margin-top:4317px; line-height:15px; white-space:nowrap">
<A href="#GetNextLineNum_LineNumFromTextPositionClass">
→ GetNextLineNum</A></DIV>
<DIV id="text579_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4356px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text579_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:95px; margin-top:4356px; line-height:15px; white-space:nowrap">
<A href="#LineNumFromTextPositionClass">
→ LineNumFromTextPositionClass</A></DIV>

<v:line from="0,4197" to="578,4197"/>
<v:line from="578,4197" to="578,4439"/>
<v:line from="578,4439" to="0,4439"/>
<v:line from="0,4439" to="0,4197"/>

</PAGE>
 
<!-- page 580 --> 
<PAGE>
<A id="svgcats_vml_p580" class="to_tree" style="margin-top:4444px;" onClick="selectTreeElem( '580' );">←</A>
<A href="#svgcats_vml_p581" class="to_next_page" style="margin-top:4444px;">▼</A>
<A href="#svgcats_vml_p579" class="to_prev_page" style="margin-top:4444px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4455px; width:664px; height:343px;" fillcolor="white"/>
<DIV id="text580_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4472px; line-height:15px; white-space:nowrap">
<A name="GetNextLineNum_LineNumFromTextPositionClass">
GetNextLineNum (LineNumFromTextPositionClass)</A></DIV>
<DIV id="text580_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:70px; margin-top:4750px; line-height:15px; white-space:nowrap">
<A href="#GetLineNum_LineNumFromTextPositionClass">
→ GetLineNum</A></DIV>
<DIV id="text580_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4750px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text580_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:188px; margin-top:4750px; line-height:15px; white-space:nowrap">
前回調べた位置より前にも対応した GetNextLineNum</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:4502px; width:544px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text580_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:4509px; line-height:13px; white-space:nowrap">
Function&nbsp; LineNumFromTextPositionClass::GetNextLineNum( Position as integer ) as integer</DIV>
<DIV id="text580_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4539px; line-height:15px; white-space:nowrap">
文字列の先頭からの位置から、行番号をカウントします。</DIV>
<DIV id="text580_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4565px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text580_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4565px; line-height:15px; white-space:nowrap">
Position</DIV>
<DIV id="text580_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:4565px; line-height:15px; white-space:nowrap">
文字列の先頭からの位置、1 以上</DIV>
<DIV id="text580_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:4584px; line-height:15px; white-space:nowrap">
Position 引数に指定した位置の行番号</DIV>
<DIV id="text580_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4584px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text580_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:38px; margin-top:4619px; line-height:15px; white-space:nowrap">
Position 引数は、1 = 先頭の文字です。<BR/>
前回調べた位置と行番号を Me の内部に格納しており、行番号を数える処理は、その続きから行うことで、<BR/>
効率よく処理します。<BR/>
前回 GetNextLineNum 関数に指定した値と同じか、それ以上の値を Position 引数に指定しなければ<BR/>
エラーになります。</DIV>
<DIV id="text580_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4716px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text580_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:95px; margin-top:4716px; line-height:15px; white-space:nowrap">
<A href="#LineNumFromTextPositionClass">
→ LineNumFromTextPositionClass</A></DIV>

<v:line from="0,4455" to="664,4455"/>
<v:line from="664,4455" to="664,4798"/>
<v:line from="664,4798" to="0,4798"/>
<v:line from="0,4798" to="0,4455"/>

</PAGE>
 
<!-- page 581 --> 
<PAGE>
<A id="svgcats_vml_p581" class="to_tree" style="margin-top:4803px;" onClick="selectTreeElem( '581' );">←</A>
<A href="#svgcats_vml_p582" class="to_next_page" style="margin-top:4803px;">▼</A>
<A href="#svgcats_vml_p580" class="to_prev_page" style="margin-top:4803px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4814px; width:623px; height:233px;" fillcolor="white"/>
<DIV id="text581_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4831px; line-height:15px; white-space:nowrap">
<A name="GetLineNum_LineNumFromTextPositionClass">
GetLineNum (LineNumFromTextPositionClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:4861px; width:520px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text581_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:4868px; line-height:13px; white-space:nowrap">
Function&nbsp; LineNumFromTextPositionClass::GetLineNum( Position as integer ) as integer</DIV>
<DIV id="text581_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4898px; line-height:15px; white-space:nowrap">
文字列の先頭からの位置から、行番号をカウントします。</DIV>
<DIV id="text581_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4924px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text581_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4924px; line-height:15px; white-space:nowrap">
Position</DIV>
<DIV id="text581_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:4924px; line-height:15px; white-space:nowrap">
文字列の先頭からの位置</DIV>
<DIV id="text581_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:4943px; line-height:15px; white-space:nowrap">
Position 引数に指定した位置の行番号</DIV>
<DIV id="text581_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4943px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text581_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:133px; margin-top:4980px; line-height:15px; white-space:nowrap">
との違いは、前回調べた位置より前の位置にも対応していることです。</DIV>
<DIV id="text581_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:33px; margin-top:4980px; line-height:15px; white-space:nowrap">
<A href="#GetNextLineNum_LineNumFromTextPositionClass">
GetNextLineNum</A></DIV>
<DIV id="text581_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4999px; line-height:15px; white-space:nowrap">
前回調べた位置より前の位置を Position 引数に指定したときは、文字列の先頭から数え直します。</DIV>

<v:line from="0,4814" to="623,4814"/>
<v:line from="623,4814" to="623,5047"/>
<v:line from="623,5047" to="0,5047"/>
<v:line from="0,5047" to="0,4814"/>

</PAGE>
 
<!-- page 582 --> 
<PAGE>
<A id="svgcats_vml_p582" class="to_tree" style="margin-top:5052px;" onClick="selectTreeElem( '582' );">←</A>
<A href="#svgcats_vml_p583" class="to_next_page" style="margin-top:5052px;">▼</A>
<A href="#svgcats_vml_p581" class="to_prev_page" style="margin-top:5052px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5063px; width:635px; height:519px;" fillcolor="white"/>
<DIV id="text582_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5080px; line-height:15px; white-space:nowrap">
<A name="ReplaceTextAtHere_LineNumFromTextPositionClass">
ReplaceTextAtHere (LineNumFromTextPositionClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:5110px; width:496px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text582_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:5117px; line-height:13px; white-space:nowrap">
Sub&nbsp; LineNumFromTextPositionClass::ReplaceTextAtHere( SecondHalfText as string )</DIV>
<DIV id="text582_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5147px; line-height:15px; white-space:nowrap">
行番号を調べる対象となる文字列のうち、前回調べた位置とそれ以降の部分文字列を置き換えます。</DIV>
<DIV id="text582_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:33px; margin-top:5209px; line-height:15px; white-space:nowrap">
<A href="#SetText_LineNumFromTextPositionClass">
SetText</A></DIV>
<DIV id="text582_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:88px; margin-top:5209px; line-height:15px; white-space:nowrap">
で置き換える場合と異なり、前回調べた位置と行番号の情報はクリアされません。</DIV>
<DIV id="text582_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5173px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text582_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:5173px; line-height:15px; white-space:nowrap">
SecondHalfText</DIV>
<DIV id="text582_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:201px; margin-top:5173px; line-height:15px; white-space:nowrap">
前回調べた位置とそれ以降に設定する行番号を調べる文字列</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:5273px; width:334px; height:175px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text582_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:5279px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set counter = new LineNumFromTextPositionClass<BR/>
&nbsp; &nbsp; counter.SetText _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "a"+ vbCRLF + _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "b"+ vbCRLF + _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "cde"<BR/>
&nbsp; &nbsp; Assert&nbsp; counter.GetNextLineNum( 4 )&nbsp; = 2&nbsp; '// "b"<BR/>
<BR/>
&nbsp; &nbsp; counter.ReplaceTextAtHere _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "XY"+ vbCRLF + _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "c"<BR/>
&nbsp; &nbsp; Assert&nbsp; counter.GetNextLineNum( 8 )&nbsp; = 3&nbsp; '// "c"</DIV>
<DIV id="text582_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5249px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text582_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:121px; margin-top:5385px; line-height:13px; white-space:nowrap">
ReplaceTextAtHere</DIV>
<v:rect style="position:absolute; margin-left:74px; margin-top:5495px; width:34px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text582_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:82px; margin-top:5501px; line-height:15px; white-space:nowrap">
a<BR/>
b<BR/>
cde</DIV>
<v:rect style="position:absolute; margin-left:191px; margin-top:5495px; width:28px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text582_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:199px; margin-top:5501px; line-height:15px; white-space:nowrap">
a<BR/>
XY<BR/>
c</DIV>
<DIV id="text582_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:5465px; line-height:15px; white-space:nowrap">
行番号を調べる対象となる文字列は、次のように置き換わります。</DIV>
<v:line style="position:absolute;" from="122,5522" to="179,5522" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="179,5522" to="168,5518" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="179,5522" to="168,5526" strokecolor="#000000" strokeweight="1pt"/>

<v:line from="0,5063" to="635,5063"/>
<v:line from="635,5063" to="635,5582"/>
<v:line from="635,5582" to="0,5582"/>
<v:line from="0,5582" to="0,5063"/>

</PAGE>
 
<!-- page 583 --> 
<PAGE>
<A id="svgcats_vml_p583" class="to_tree" style="margin-top:5587px;" onClick="selectTreeElem( '583' );">←</A>
<A href="#svgcats_vml_p584" class="to_next_page" style="margin-top:5587px;">▼</A>
<A href="#svgcats_vml_p582" class="to_prev_page" style="margin-top:5587px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5598px; width:511px; height:132px;" fillcolor="white"/>
<DIV id="text583_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5615px; line-height:15px; white-space:nowrap">
<A name="Position_LineNumFromTextPositionClass">
Position (LineNumFromTextPositionClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:5645px; width:454px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text583_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:5652px; line-height:13px; white-space:nowrap">
Property&nbsp; LineNumFromTextPositionClass::Position as integer&nbsp; '// Get only</DIV>
<DIV id="text583_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5682px; line-height:15px; white-space:nowrap">
前回調べた文字列の位置。</DIV>

<v:line from="0,5598" to="511,5598"/>
<v:line from="511,5598" to="511,5730"/>
<v:line from="511,5730" to="0,5730"/>
<v:line from="0,5730" to="0,5598"/>

</PAGE>
 
<!-- page 584 --> 
<PAGE>
<A id="svgcats_vml_p584" class="to_tree" style="margin-top:5735px;" onClick="selectTreeElem( '584' );">←</A>
<A href="#svgcats_vml_p585" class="to_next_page" style="margin-top:5735px;">▼</A>
<A href="#svgcats_vml_p583" class="to_prev_page" style="margin-top:5735px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5746px; width:505px; height:132px;" fillcolor="white"/>
<DIV id="text584_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5763px; line-height:15px; white-space:nowrap">
<A name="LineNum_LineNumFromTextPositionClass">
LineNum (LineNumFromTextPositionClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:5793px; width:448px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text584_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:5800px; line-height:13px; white-space:nowrap">
Property&nbsp; LineNumFromTextPositionClass::LineNum as integer&nbsp; '// Get only</DIV>
<DIV id="text584_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5830px; line-height:15px; white-space:nowrap">
前回調べた行番号。</DIV>

<v:line from="0,5746" to="505,5746"/>
<v:line from="505,5746" to="505,5878"/>
<v:line from="505,5878" to="0,5878"/>
<v:line from="0,5878" to="0,5746"/>

</PAGE>
 
<!-- page 585 --> 
<PAGE>
<A id="svgcats_vml_p585" class="to_tree" style="margin-top:5883px;" onClick="selectTreeElem( '585' );">←</A>
<A href="#svgcats_vml_p586" class="to_next_page" style="margin-top:5883px;">▼</A>
<A href="#svgcats_vml_p584" class="to_prev_page" style="margin-top:5883px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5894px; width:645px; height:1013px;" fillcolor="white"/>
<DIV id="text585_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5911px; line-height:15px; white-space:nowrap">
<A name="ReadVBS_Comment">
ReadVBS_Comment</A></DIV>
<DIV id="text585_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6813px; line-height:15px; white-space:nowrap">
テスト</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:5941px; width:586px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text585_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:5948px; line-height:13px; white-space:nowrap">
Function&nbsp; ReadVBS_Comment( Path as string, StartTag as string, EndTag as string, Opt as Empty )</DIV>
<DIV id="text585_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5978px; line-height:15px; white-space:nowrap">
VBScript のファイルの中のコメントを、複数行の文字列として読み込みます。</DIV>
<DIV id="text585_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6004px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text585_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:6004px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text585_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:6023px; line-height:15px; white-space:nowrap">
StartTag</DIV>
<DIV id="text585_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:6004px; line-height:15px; white-space:nowrap">
VBScript ファイルのパス、# 可能、Empty = </DIV>
<DIV id="text585_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:6023px; line-height:15px; white-space:nowrap">
VBScript ファイルの中の、読み込みを開始する1つ上の行にあるキーワード</DIV>
<DIV id="text585_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:6042px; line-height:15px; white-space:nowrap">
EndTag</DIV>
<DIV id="text585_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:6061px; line-height:15px; white-space:nowrap">
Opt</DIV>
<DIV id="text585_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:6080px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text585_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:6042px; line-height:15px; white-space:nowrap">
読み込む最後の行の1つ下の行にあるキーワード</DIV>
<DIV id="text585_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:6061px; line-height:15px; white-space:nowrap">
Empty を指定してください</DIV>
<DIV id="text585_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:6080px; line-height:15px; white-space:nowrap">
読み込んだ文字列。 先頭に ' は付きません</DIV>
<DIV id="text585_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6179px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:6231px; width:490px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text585_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:6237px; line-height:15px; white-space:nowrap">
text = ReadVBS_Comment( Empty, "["+"FileA.txt]", "[/"+"FileA.txt]", Empty )<BR/>
<BR/>
'-------------------------------------------------------------------[FileA.txt]<BR/>
'((( これはテキストファイルの代わりです )))<BR/>
'<BR/>
'END<BR/>
'------------------------------------------------------------------[/FileA.txt]</DIV>
<DIV id="text585_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:6207px; line-height:15px; white-space:nowrap">
スクリプト</DIV>
<DIV id="text585_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:6368px; line-height:15px; white-space:nowrap">
text に入った値</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:6390px; width:268px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text585_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:6396px; line-height:15px; white-space:nowrap">
((( これはテキストファイルの代わりです )))<BR/>
<BR/>
END</DIV>
<DIV id="text585_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:347px; margin-top:6429px; line-height:15px; white-space:nowrap">
最後の行の末尾には改行があります</DIV>
<DIV id="text585_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:6813px; line-height:15px; white-space:nowrap">
→ T_FileInScript.vbs</DIV>
<DIV id="text585_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:208px; margin-top:6813px; line-height:15px; white-space:nowrap">
T_ReadVBS_Comment</DIV>
<DIV id="text585_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6122px; line-height:15px; white-space:nowrap">
StartTag と EndTag に指定したキーワードがヒットしないよう、下記のサンプルにあるように + でつなぐ<BR/>
などの対策をしてください。</DIV>
<DIV id="text585_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:26px; margin-top:6784px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text585_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:87px; margin-top:6784px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text585_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:427px; margin-top:6004px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_02.html#ScriptFullName">
WScript.ScriptFullName</A></DIV>
<DIV id="text585_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:6861px; line-height:15px; white-space:nowrap">
<A href="vbslib_36.html#new_FilePathForFileInScript">
→ new_FilePathForFileInScript</A></DIV>
<DIV id="text585_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6842px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text585_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6474px; line-height:15px; white-space:nowrap">
Path に、URL のように # を付けると、StartTag と EndTag の一部になります。<BR/>
下記の２つは同じ動きをします。&nbsp; StartTag と EndTag に指定した引数は無視されます。</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:6511px; width:370px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text585_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:6518px; line-height:13px; white-space:nowrap">
text = ReadVBS_Comment( "#FileA.txt", Empty, Empty, Empty )</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:6544px; width:466px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text585_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:6551px; line-height:13px; white-space:nowrap">
text = ReadVBS_Comment( Empty, "["+"FileA.txt]", "[/"+"FileA.txt]", Empty )</DIV>
<DIV id="text585_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:6842px; line-height:15px; white-space:nowrap">
→ WriteVBS_Comment</DIV>
<DIV id="text585_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6594px; line-height:15px; white-space:nowrap">
XML をリードするには、次のようにします。</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:6617px; width:466px; height:145px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text585_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:6623px; line-height:15px; white-space:nowrap">
text = ReadVBS_Comment( Empty, "["+"A.xml]", "[/"+"A.xml]", Empty )<BR/>
Set root = LoadXML( text, g_VBS_Lib.StringData )<BR/>
echo&nbsp; root.tagName<BR/>
<BR/>
'-------------------------------------------------------------------[A.xml]<BR/>
'&lt;Root&gt;<BR/>
'<BR/>
'&lt;/Root&gt;<BR/>
'------------------------------------------------------------------[/A.xml]</DIV>

<v:line from="0,5894" to="645,5894"/>
<v:line from="645,5894" to="645,6907"/>
<v:line from="645,6907" to="0,6907"/>
<v:line from="0,6907" to="0,5894"/>

</PAGE>
 
<!-- page 586 --> 
<PAGE>
<A id="svgcats_vml_p586" class="to_tree" style="margin-top:6912px;" onClick="selectTreeElem( '586' );">←</A>
<A href="#svgcats_vml_p587" class="to_next_page" style="margin-top:6912px;">▼</A>
<A href="#svgcats_vml_p585" class="to_prev_page" style="margin-top:6912px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6923px; width:629px; height:1006px;" fillcolor="white"/>
<DIV id="text586_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6940px; line-height:15px; white-space:nowrap">
<A name="OpenForWrite">
OpenForWrite</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:6967px; width:448px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text586_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:6974px; line-height:13px; white-space:nowrap">
Function&nbsp; OpenForWrite( Path as string, Flags as integer ) as TextStream</DIV>
<DIV id="text586_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7005px; line-height:15px; white-space:nowrap">
テキストファイルを開きます。（ライト用＝ファイルへ出力します）</DIV>
<DIV id="text586_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7028px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text586_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:7028px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text586_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:7064px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text586_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:7028px; line-height:15px; white-space:nowrap">
開くファイルのパス</DIV>
<DIV id="text586_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:7064px; line-height:15px; white-space:nowrap">
ファイルのストリーム</DIV>
<DIV id="text586_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:221px; margin-top:7115px; line-height:15px; white-space:nowrap">
と異なり、エラーがあったら、エラーメッセージに Path が付きます。</DIV>
<DIV id="text586_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:34px; margin-top:7115px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_05.html#FileSystemObject_OpenTextFile">
FileSystemObject::OpenTextFile</A></DIV>
<v:rect style="position:absolute; margin-left:38px; margin-top:7233px; width:292px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text586_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:46px; margin-top:7239px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set w_= AppKey.NewWritable( "." ).Enable()<BR/>
&nbsp; &nbsp; Set file = OpenForWrite( "a.txt", Empty )<BR/>
&nbsp; &nbsp; file.WriteLine&nbsp; "abc"<BR/>
&nbsp; &nbsp; file = Empty</DIV>
<DIV id="text586_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7213px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text586_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:7774px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_05.html#FileSystemObject_CreateTextFile">
→ FileSystemObject::CreateTextFile</A></DIV>
<DIV id="text586_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7441px; line-height:13px; white-space:nowrap">
c.Unicode</DIV>
<DIV id="text586_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7338px; line-height:15px; white-space:nowrap">
Flags 引数</DIV>
<DIV id="text586_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:132px; margin-top:7338px; line-height:15px; white-space:nowrap">
Empty または 次の値</DIV>
<DIV id="text586_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7440px; line-height:15px; white-space:nowrap">
Unicode 形式ファイルにします。 指定しないときは、<BR/>
new_TextFileCharSetStack で指定した既定の文字コードになります。</DIV>
<DIV id="text586_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:6939px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text586_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:7046px; line-height:15px; white-space:nowrap">
Flags</DIV>
<DIV id="text586_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:7046px; line-height:15px; white-space:nowrap">
Empty、またはオプション（下記）</DIV>
<DIV id="text586_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7658px; line-height:13px; white-space:nowrap">
c.Append</DIV>
<DIV id="text586_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7656px; line-height:15px; white-space:nowrap">
追記します。<BR/>
Shift-JIS, Unicode, UTF-8(BOMあり) のときは、文字コードを指定しなくても、<BR/>
元のファイルと同じ文字コードになります。</DIV>
<DIV id="text586_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:7792px; line-height:15px; white-space:nowrap">
<A href="vbslib_33.html#ReplaceTextFile">
→ ReplaceTextFile</A></DIV>
<DIV id="text586_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7774px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text586_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:7810px; line-height:15px; white-space:nowrap">
<A href="vbslib_21.html#StringStream">
→ StringStream クラス</A></DIV>
<DIV id="text586_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:295px; margin-top:7028px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#fname">
→ ファイル名、パス</A></DIV>
<DIV id="text586_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:7828px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_01.html#txt2bintxt">
→ バイナリ混在テキスト生成 (txt2bintxt.exe)</A></DIV>
<DIV id="text586_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:7730px; line-height:15px; white-space:nowrap">
→ T_File.vbs [T_OpenForWrite]</DIV>
<DIV id="text586_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7730px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text586_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:226px; margin-top:7255px; line-height:13px; white-space:nowrap">
a.txt</DIV>
<DIV id="text586_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:7393px; line-height:15px; white-space:nowrap">
<A href="#new_TextFileCharSetStack">
new_TextFileCharSetStack</A></DIV>
<DIV id="text586_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:178px; margin-top:7393px; line-height:15px; white-space:nowrap">
を使うと、その他のフォーマットも指定できます。</DIV>
<DIV id="text586_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:160px; margin-top:7240px; line-height:13px; white-space:nowrap">
<A href="vbslib_30.html#AppKeyClass_NewWritable">
NewWritable</A></DIV>
<DIV id="text586_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7631px; line-height:15px; white-space:nowrap">
次の値と論理和をとることもできます。</DIV>
<DIV id="text586_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7376px; line-height:15px; white-space:nowrap">
文字コードの指定は、次のどれかが指定できます。</DIV>
<DIV id="text586_36" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7523px; line-height:13px; white-space:nowrap">
c.Shift_JIS</DIV>
<DIV id="text586_37" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7481px; line-height:13px; white-space:nowrap">
c.UTF_8</DIV>
<DIV id="text586_38" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7544px; line-height:13px; white-space:nowrap">
c.EUC_JP</DIV>
<DIV id="text586_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7479px; line-height:15px; white-space:nowrap">
BOM 付き UTF-8</DIV>
<DIV id="text586_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7521px; line-height:15px; white-space:nowrap">
Shift-JIS</DIV>
<DIV id="text586_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7542px; line-height:15px; white-space:nowrap">
EUC(JP)</DIV>
<DIV id="text586_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7500px; line-height:15px; white-space:nowrap">
BOM なし UTF-8</DIV>
<DIV id="text586_43" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7502px; line-height:13px; white-space:nowrap">
c.UTF_8_No_BOM</DIV>
<DIV id="text586_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:7864px; line-height:15px; white-space:nowrap">
<A href="vbslib_30.html#CreateFile">
→ CreateFile</A></DIV>
<DIV id="text586_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7410px; line-height:15px; white-space:nowrap">
下記の c は g_VBS_Lib です。</DIV>
<DIV id="text586_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:203px; margin-top:7410px; line-height:15px; white-space:nowrap">
<A href="vbslib_12.html#g_VBS_Lib">
→ g_VBS_Lib</A></DIV>
<DIV id="text586_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:34px; margin-top:7099px; line-height:15px; white-space:nowrap">
<A href="vbslib_30.html#AppKeyClass_NewWritable">
NewWritable</A></DIV>
<DIV id="text586_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:110px; margin-top:7099px; line-height:15px; white-space:nowrap">
メソッドを使って、Out of Writable 警告が出ないようにしておいてください。</DIV>
<DIV id="text586_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7588px; line-height:15px; white-space:nowrap">
改行コードの指定は、</DIV>
<DIV id="text586_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:339px; margin-top:7588px; line-height:15px; white-space:nowrap">
を使ってください。</DIV>
<DIV id="text586_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:149px; margin-top:7588px; line-height:15px; white-space:nowrap">
<A href="#new_TextFileLineSeparatorStack">
new_TextFileLineSeparatorStack</A></DIV>
<DIV id="text586_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7131px; line-height:15px; white-space:nowrap">
返り値を使って呼び出せるメソッドは、FileSystemObject::OpenTextFile と同じです。</DIV>
<DIV id="text586_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:7749px; line-height:15px; white-space:nowrap">
→ T_File.vbs [T_OpenForWrite_Overwrite]</DIV>
<DIV id="text586_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:89px; margin-top:7176px; line-height:15px; white-space:nowrap">
<A href="vbslib_33.html#StartReplace">
StartReplace</A></DIV>
<DIV id="text586_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7160px; line-height:15px; white-space:nowrap">
テキストファイルの内容を書き換えるときは、文字コード（Unicode ファイルのBOM）や改行文字を</DIV>
<DIV id="text586_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:166px; margin-top:7176px; line-height:15px; white-space:nowrap">
を使ってください。</DIV>
<DIV id="text586_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7176px; line-height:15px; white-space:nowrap">
継承する</DIV>
<DIV id="text586_58" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:283px; margin-top:7064px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_05.html#TextStream">
→ TextStream （VBScript）</A></DIV>
<DIV id="text586_59" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:7846px; line-height:15px; white-space:nowrap">
<A href="vbslib_60.html#LockByFileMutex">
→ LockByFileMutex</A></DIV>

<v:line from="0,6923" to="629,6923"/>
<v:line from="629,6923" to="629,7929"/>
<v:line from="629,7929" to="0,7929"/>
<v:line from="0,7929" to="0,6923"/>

</PAGE>
 
<!-- page 587 --> 
<PAGE>
<A id="svgcats_vml_p587" class="to_tree" style="margin-top:7934px;" onClick="selectTreeElem( '587' );">←</A>
<A href="#svgcats_vml_p588" class="to_next_page" style="margin-top:7934px;">▼</A>
<A href="#svgcats_vml_p586" class="to_prev_page" style="margin-top:7934px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7945px; width:552px; height:956px;" fillcolor="white"/>
<DIV id="text587_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7962px; line-height:15px; white-space:nowrap">
<A name="new_TextFileCharSetStack">
new_TextFileCharSetStack</A></DIV>
<v:rect style="position:absolute; margin-left:36px; margin-top:8487px; width:292px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text587_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:44px; margin-top:8493px; line-height:15px; white-space:nowrap">
&nbsp; Set cs = new_TextFileCharSetStack( "UTF-8" )<BR/>
&nbsp; CreateFile&nbsp; "File1.txt", "abc"</DIV>
<DIV id="text587_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8466px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text587_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:266px; margin-top:8494px; line-height:13px; white-space:nowrap">
"UTF-8"</DIV>
<DIV id="text587_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8031px; line-height:15px; white-space:nowrap">
ファイルの文字 コード セットを指定します。</DIV>
<DIV id="text587_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8057px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text587_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:8057px; line-height:15px; white-space:nowrap">
CharSet</DIV>
<DIV id="text587_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:178px; margin-top:8057px; line-height:15px; white-space:nowrap">
ファイルの文字 コード セット, Empty=デフォルト</DIV>
<DIV id="text587_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8237px; line-height:15px; white-space:nowrap">
デフォルト（本関数を一度も呼ばなかったとき）は、"Shift_JIS" です。<BR/>
CharSet 引数に指定する文字列の大文字小文字は区別しません。<BR/>
c.Unicode などの数値定数を指定することもできます。</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:7992px; width:490px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text587_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:7999px; line-height:13px; white-space:nowrap">
Function&nbsp; new_TextFileCharSetStack( CharSet as string ) as TextFileCharSetStack</DIV>
<DIV id="text587_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:8753px; line-height:15px; white-space:nowrap">
<A href="#OpenForWrite">
→ OpenForWrite</A></DIV>
<DIV id="text587_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8753px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text587_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8726px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text587_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:70px; margin-top:8726px; line-height:15px; white-space:nowrap">
→ T_File.vbs [T_OpenForWrite]</DIV>
<DIV id="text587_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:228px; margin-top:7961px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text587_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8092px; line-height:15px; white-space:nowrap">
新規作成するときの出力ファイルや、ファイルから読み込むときの文字コードを指定<BR/>
します。 返り値のオブジェクトが削除されたら、指定は無効になります。</DIV>
<DIV id="text587_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8301px; line-height:15px; white-space:nowrap">
"UTF-8" は、ファイルの先頭に</DIV>
<DIV id="text587_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:210px; margin-top:8301px; line-height:15px; white-space:nowrap">
BOM</DIV>
<DIV id="text587_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:241px; margin-top:8301px; line-height:15px; white-space:nowrap">
が付きます。 "UTF-8-No-BOM" は付きません。</DIV>
<DIV id="text587_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:8773px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_15.html#Charset_ADODB_Stream">
→ Charset (ADODB.Stream)</A></DIV>
<DIV id="text587_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8381px; line-height:15px; white-space:nowrap">
指定できる値は、レジストリの HKEY_CLASSES_ROOT\MIME\Database\Charset の<BR/>
サブキーを参照してください。 ただし、"UTF-8-No-BOM" はサブキーにありません。</DIV>
<DIV id="text587_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8134px; line-height:15px; white-space:nowrap">
CharSetの例：</DIV>
<DIV id="text587_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:146px; margin-top:8135px; line-height:15px; white-space:nowrap">
"Shift_JIS", "EUC-JP", "Unicode", "UTF-8", "UTF-8-No-BOM",<BR/>
"ISO-8859-1", "ISO-2022-JP"<BR/>
c.Shift_JIS, c.EUC_JP, c.Unicode, c.UTF_8, c.UTF_8_No_BOM, <BR/>
c.ISO_2022_JP, c.No_BOM(=c.Shift_JIS), Empty(=c.Shift_JIS)</DIV>
<DIV id="text587_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:184px; margin-top:8753px; line-height:15px; white-space:nowrap">
<A href="vbslib_30.html#CreateFile">
→ CreateFile</A></DIV>
<DIV id="text587_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8316px; line-height:15px; white-space:nowrap">
BOM を付けないときは XML の encoding や HTML の charset などを用いて文字<BR/>
コードを記述しなければ、多くのプログラムは文字化けを起こします。 一方で、<BR/>
BOM があるとエラーを起こす UTF-8 に対応していないプログラムも多くあります。</DIV>
<DIV id="text587_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:8793px; line-height:15px; white-space:nowrap">
<A href="vbslib_48.html#XmlWriteEncoding">
→ XmlWriteEncoding</A></DIV>
<DIV id="text587_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:8813px; line-height:15px; white-space:nowrap">
<A href="#ReadUnicodeFileBOM">
→ ReadUnicodeFileBOM</A></DIV>
<DIV id="text587_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8550px; line-height:15px; white-space:nowrap">
<A name="charcode_in_file">
ファイル内の文字コードの指定</A></DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:8597px; width:244px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text587_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:8604px; line-height:13px; white-space:nowrap">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;</DIV>
<DIV id="text587_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:8578px; line-height:15px; white-space:nowrap">
XML の場合</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:8656px; width:424px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text587_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:8663px; line-height:13px; white-space:nowrap">
&lt;META http-equiv="content-type" content="text/html; charset=UTF-8"/&gt;</DIV>
<DIV id="text587_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:8638px; line-height:15px; white-space:nowrap">
HTML の場合</DIV>
<DIV id="text587_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:236px; margin-top:8604px; line-height:13px; white-space:nowrap">
UTF-8</DIV>
<DIV id="text587_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:416px; margin-top:8663px; line-height:13px; white-space:nowrap">
UTF-8</DIV>
<DIV id="text587_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:249px; margin-top:8813px; line-height:15px; white-space:nowrap">
ファイルの先頭にある BOM を読みます。</DIV>
<DIV id="text587_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:249px; margin-top:8793px; line-height:15px; white-space:nowrap">
XML ファイルの文字コードを指定します。</DIV>
<DIV id="text587_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:8833px; line-height:15px; white-space:nowrap">
<A href="%vbslib_n_new%\_src\vbslib_n.svg#ConvertCharCodeInHref">
→ ConvertCharCodeInHref</A></DIV>
<DIV id="text587_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:8853px; line-height:15px; white-space:nowrap">
<A href="vbslib_43.html#Text_BinaryArray">
→ Text (BinaryArray)</A></DIV>
<DIV id="text587_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:249px; margin-top:8853px; line-height:15px; white-space:nowrap">
文字コードセットを変換します。</DIV>
<DIV id="text587_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:146px; margin-top:8197px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_15.html#Charset_ADODB_Stream">
→ Charset (ADODB.Stream)</A></DIV>
<DIV id="text587_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:169px; margin-top:8639px; line-height:15px; white-space:nowrap">
vbslib では、解析を行いません。</DIV>
<DIV id="text587_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:157px; margin-top:8578px; line-height:15px; white-space:nowrap">
<A href="vbslib_47.html#Read_XML_Encoding">
→ Read_XML_Encoding</A></DIV>
<DIV id="text587_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8425px; line-height:15px; white-space:nowrap">
現在指定されている文字 コード セットは、</DIV>
<DIV id="text587_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:269px; margin-top:8425px; line-height:15px; white-space:nowrap">
<A href="vbslib_32.html#g_FileOptions">
g_FileOptions</A></DIV>
<DIV id="text587_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:352px; margin-top:8425px; line-height:15px; white-space:nowrap">
で取得できます。</DIV>

<v:line from="0,7945" to="552,7945"/>
<v:line from="552,7945" to="552,8901"/>
<v:line from="552,8901" to="0,8901"/>
<v:line from="0,8901" to="0,7945"/>

</PAGE>
 
<!-- page 588 --> 
<PAGE>
<A id="svgcats_vml_p588" class="to_tree" style="margin-top:8906px;" onClick="selectTreeElem( '588' );">←</A>
<A href="#svgcats_vml_p589" class="to_next_page" style="margin-top:8906px;">▼</A>
<A href="#svgcats_vml_p587" class="to_prev_page" style="margin-top:8906px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8917px; width:603px; height:405px;" fillcolor="white"/>
<DIV id="text588_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8934px; line-height:15px; white-space:nowrap">
<A name="Decode_MIME_HeaderLine">
Decode_MIME_HeaderLine</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:8964px; width:376px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text588_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:8971px; line-height:13px; white-space:nowrap">
Function&nbsp; Decode_MIME_HeaderLine( Line as string ) as string</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:9142px; width:526px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text588_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:9148px; line-height:15px; white-space:nowrap">
str = Decode_MIME_HeaderLine( "Subject: =?ISO-2022-JP?B?YWJjGyRCJUYlOSVIGyhCZGVm?=" )<BR/>
Assert&nbsp; str = "Subject: abcテストdef"</DIV>
<DIV id="text588_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9001px; line-height:15px; white-space:nowrap">
MIME ヘッダーの１行を "=? … ?=" 形式から、通常の文字列に戻します。</DIV>
<DIV id="text588_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9027px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text588_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9027px; line-height:15px; white-space:nowrap">
Line</DIV>
<DIV id="text588_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:9027px; line-height:15px; white-space:nowrap">
MIME ヘッダーの１行</DIV>
<DIV id="text588_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:9046px; line-height:15px; white-space:nowrap">
Line からでコードした通常の文字列</DIV>
<DIV id="text588_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9046px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text588_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9203px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text588_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9119px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text588_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9083px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text588_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:9203px; line-height:15px; white-space:nowrap">
T_MIME</DIV>
<DIV id="text588_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9229px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text588_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:71px; margin-top:9229px; line-height:15px; white-space:nowrap">
→ MIME</DIV>
<DIV id="text588_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:138px; margin-top:9229px; line-height:15px; white-space:nowrap">
→ ISO-2022-JP</DIV>
<DIV id="text588_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:254px; margin-top:9229px; line-height:15px; white-space:nowrap">
→ Base64</DIV>
<DIV id="text588_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9255px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text588_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:9255px; line-height:15px; white-space:nowrap">
<A href="vbslib_43.html#Base64_BinaryArray">
→ Base64 (BinaryArray)</A></DIV>
<DIV id="text588_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:71px; margin-top:9203px; line-height:15px; white-space:nowrap">
→ T_Binary.vbs</DIV>
<DIV id="text588_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:9274px; line-height:15px; white-space:nowrap">
<A href="vbslib_43.html#Text_BinaryArray">
→ Text (BinaryArray)</A></DIV>
<DIV id="text588_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:89px; margin-top:9083px; line-height:15px; white-space:nowrap">
→ System.vbs</DIV>
<DIV id="text588_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:9274px; line-height:15px; white-space:nowrap">
文字コードの変換</DIV>

<v:line from="0,8917" to="603,8917"/>
<v:line from="603,8917" to="603,9322"/>
<v:line from="603,9322" to="0,9322"/>
<v:line from="0,9322" to="0,8917"/>

</PAGE>
 
<!-- page 589 --> 
<PAGE>
<A id="svgcats_vml_p589" class="to_tree" style="margin-top:9327px;" onClick="selectTreeElem( '589' );">←</A>
<A href="vbslib_32.html#svgcats_vml_p590" class="to_next_page" style="margin-top:9327px;">▼</A>
<A href="#svgcats_vml_p588" class="to_prev_page" style="margin-top:9327px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9338px; width:589px; height:1279px;" fillcolor="white"/>
<DIV id="text589_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9355px; line-height:15px; white-space:nowrap">
<A name="new_TextFileLineSeparatorStack">
new_TextFileLineSeparatorStack</A></DIV>
<DIV id="text589_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:274px; margin-top:9354px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text589_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9424px; line-height:15px; white-space:nowrap">
ファイルの改行文字コードを指定します。</DIV>
<DIV id="text589_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9450px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text589_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9450px; line-height:15px; white-space:nowrap">
LS</DIV>
<DIV id="text589_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:150px; margin-top:9450px; line-height:15px; white-space:nowrap">
ファイルの改行文字コード、または Empty</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:9385px; width:532px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text589_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:9392px; line-height:13px; white-space:nowrap">
Function&nbsp; new_TextFileLineSeparatorStack( LS as string ) as TextFileLineSeparatorStack</DIV>
<DIV id="text589_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9485px; line-height:15px; white-space:nowrap">
&nbsp;返り値のオブジェクトが削除されたら、指定は無効になります。</DIV>
<DIV id="text589_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9650px; line-height:15px; white-space:nowrap">
LS 引数</DIV>
<DIV id="text589_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:9700px; line-height:13px; white-space:nowrap">
vbCRLF, g_VBS_Lib.CRLF</DIV>
<DIV id="text589_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:9720px; line-height:13px; white-space:nowrap">
vbLF, g_VBS_Lib.LF</DIV>
<DIV id="text589_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:9740px; line-height:13px; white-space:nowrap">
g_VBS_Lib.KeepLineSeparators</DIV>
<DIV id="text589_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:9680px; line-height:13px; white-space:nowrap">
Empty</DIV>
<DIV id="text589_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:9818px; line-height:15px; white-space:nowrap">
リードするときは改行文字を自動判定、ライトするときは CR+LF、修正するとき（*下記）は<BR/>
改行文字の種類を継承します。</DIV>
<DIV id="text589_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:259px; margin-top:9698px; line-height:15px; white-space:nowrap">
CR+LF</DIV>
<DIV id="text589_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:259px; margin-top:9718px; line-height:15px; white-space:nowrap">
LF</DIV>
<DIV id="text589_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:259px; margin-top:9738px; line-height:15px; white-space:nowrap">
改行文字の種類を継承する（下記）</DIV>
<v:rect style="position:absolute; margin-left:40px; margin-top:9547px; width:496px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text589_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:48px; margin-top:9553px; line-height:15px; white-space:nowrap">
Dim ls : Set ls = new_TextFileLineSeparatorStack( g_VBS_Lib.KeepLineSeparators )<BR/>
Set f&nbsp; = OpenForRead( Path )<BR/>
ls = Empty<BR/>
text = f.ReadLine()</DIV>
<DIV id="text589_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9523px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text589_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10539px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text589_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:10539px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_15.html#LineSeparator_ADODB_Stream">
→ LineSeparator (ADODB.Stream)</A></DIV>
<DIV id="text589_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:44px; margin-top:9976px; line-height:15px; white-space:nowrap">
<A href="vbslib_32.html#OpenForReplace">
OpenForReplace</A></DIV>
<DIV id="text589_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:147px; margin-top:9976px; line-height:15px; white-space:nowrap">
など、修正前のテキストと修正後のテキストの両方を指定する vbslib</DIV>
<DIV id="text589_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:9914px; line-height:15px; white-space:nowrap">
「改行文字の種類を継承する」 とは、入力ファイルに書かれた改行文字の種類が、１行<BR/>
単位で、そのまま出力ファイルに書かれることです。 １つのファイルに複数の改行文字の<BR/>
種類が混ざっていても、そのまま継承されることです。</DIV>
<DIV id="text589_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9886px; line-height:15px; white-space:nowrap">
<A name="new_TextFileLineSeparatorStack_Inherit">
改行文字の種類を継承するときの動き (KeepLineSeparators)</A></DIV>
<DIV id="text589_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10294px; line-height:15px; white-space:nowrap">
TextStream::WriteLine に渡すテキストの末尾に vbCRLF または vbLF を付けることが<BR/>
できます。 付けたときは、その種類の改行文字が出力され、TextStream::WriteLine に<BR/>
よって自動的に改行文字を付けることはなくなります。 また、デフォルトの改行文字も<BR/>
指定した種類に変更されます。&nbsp; 改行文字を付けなかったときは、デフォルトの改行<BR/>
文字が自動的に付きます。 つまり、TextStream::ReadLine で入力した１行をそのまま<BR/>
TextStream::WriteLine に出力すると、改行文字の種類は継承され、末尾に改行文字<BR/>
を付けない新たな１行を TextStream::WriteLine に出力すると、前の行の改行文字の<BR/>
種類を継承します。</DIV>
<DIV id="text589_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:259px; margin-top:9678px; line-height:15px; white-space:nowrap">
自動判定 （下記）</DIV>
<DIV id="text589_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9792px; line-height:15px; white-space:nowrap">
<A name="new_TextFileLineSeparatorStack_Empty">
LS 引数 = Empty のときの動き</A></DIV>
<DIV id="text589_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:9992px; line-height:15px; white-space:nowrap">
の関数を使ったときは、その関数の中で改行文字の種類の継承処理が行われます。</DIV>
<DIV id="text589_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:106px; margin-top:10101px; line-height:15px; white-space:nowrap">
<A href="#ReadLineSeparator">
ReadLineSeparator</A></DIV>
<DIV id="text589_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:225px; margin-top:10101px; line-height:15px; white-space:nowrap">
を使って、入力ファイルの先頭行の改行文字の種類を</DIV>
<DIV id="text589_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10117px; line-height:15px; white-space:nowrap">
判定して、出力ファイルのデフォルト改行文字の種類を設定します。</DIV>
<DIV id="text589_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10145px; line-height:15px; white-space:nowrap">
入力ファイル、出力ファイル、ともに、g_VBS_Lib.KeepLineSeparators （上記） のモード<BR/>
を使うように、new_TextFileLineSeparatorStack を呼び出します。</DIV>
<DIV id="text589_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10231px; line-height:15px; white-space:nowrap">
TextStream::ReadLine の返り値である１行のテキストの末尾に改行文字が加わります。<BR/>
改行文字は、ファイルの内容によって、LF または CR+LF のどちらかになります。<BR/>
ただし、最終行の末尾に改行文字が無いときだけ、改行文字は加わりません。</DIV>
<DIV id="text589_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10101px; line-height:15px; white-space:nowrap">
はじめに、</DIV>
<DIV id="text589_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:10567px; line-height:15px; white-space:nowrap">
<A href="vbslib_34.html#CutCRLF">
→ CutCRLF</A></DIV>
<DIV id="text589_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10567px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text589_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10023px; line-height:15px; white-space:nowrap">
そうではなく、OpenForRead などを使ってテキストをリードして、OpenForWrite などを<BR/>
使ってテキストをライトする処理をプログラミングするときは、以下で説明する詳細な<BR/>
手順を参考に、改行文字の継承を行ってください。</DIV>
<DIV id="text589_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:44px; margin-top:10188px; line-height:15px; white-space:nowrap">
KeepLineSeparators モードでは、TextStream::ReadLine や TextStream::WriteLine に<BR/>
よってアクセスする１行のテキストの内容が、次のように変わります。</DIV>
<DIV id="text589_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10491px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text589_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:10491px; line-height:15px; white-space:nowrap">
→ T_Replace.vbs # T_StartReplace_KeepRet_1</DIV>
<DIV id="text589_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:10512px; line-height:15px; white-space:nowrap">
→ T_File.vbs # T_OpenFile_LineSepFromFS</DIV>
<DIV id="text589_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10432px; line-height:15px; white-space:nowrap">
TextStream::WriteLineDefault を使うと、渡したテキストの改行文字を、デフォルトの<BR/>
改行文字に置き換え、渡したテキストの最後に改行文字を追加して、出力します。</DIV>

<v:line from="0,9338" to="589,9338"/>
<v:line from="589,9338" to="589,10617"/>
<v:line from="589,10617" to="0,10617"/>
<v:line from="0,10617" to="0,9338"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10617px;">
<A id="svgcats_vml_p589" class="to_tree" onClick="selectTreeElem( '589' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10617px;">
<A id="page_group_bottom" href="vbslib_32.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
