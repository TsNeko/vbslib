<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>vbslib</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbslib.files/vbslib_30.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbslib.files/vbslib_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbslib.files/vbslib_30.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 557 --> 
<PAGE>
<A id="svgcats_vml_p557" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '557' );">←</A>
<A href="#svgcats_vml_p558" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbslib_29.html#svgcats_vml_p556" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbslib_29.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:513px; height:433px;" fillcolor="white"/>
<DIV id="text557_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="find">
find</A></DIV>
<v:rect style="position:absolute; margin-left:22px; margin-top:45px; width:382px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text557_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:30px; margin-top:52px; line-height:13px; white-space:nowrap">
Function&nbsp; find( keyword as string, path as string ) as string</DIV>
<DIV id="text557_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:80px; line-height:15px; white-space:nowrap">
テキストファイルの中で、指定したキーワードを含む行をまとめて返します。</DIV>
<DIV id="text557_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:106px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text557_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:94px; margin-top:106px; line-height:15px; white-space:nowrap">
keyword</DIV>
<DIV id="text557_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:151px; margin-top:106px; line-height:15px; white-space:nowrap">
検索するキーワード</DIV>
<DIV id="text557_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:151px; margin-top:144px; line-height:15px; white-space:nowrap">
キーワードを含む行、または複数行</DIV>
<DIV id="text557_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:94px; margin-top:144px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text557_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:94px; margin-top:125px; line-height:15px; white-space:nowrap">
path</DIV>
<DIV id="text557_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:151px; margin-top:125px; line-height:15px; white-space:nowrap">
テキストファイルのパス</DIV>
<DIV id="text557_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:109px; margin-top:16px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text557_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:185px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<v:rect style="position:absolute; margin-left:100px; margin-top:180px; width:274px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text557_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:108px; margin-top:187px; line-height:13px; white-space:nowrap">
&nbsp; lines = find( "&lt;ERROR", "Test_logs.txt" )</DIV>
<DIV id="text557_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:58px; margin-top:222px; line-height:15px; white-space:nowrap">
Test_logs.txt ファイルのサンプル</DIV>
<v:rect style="position:absolute; margin-left:80px; margin-top:240px; width:202px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text557_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:88px; margin-top:246px; line-height:15px; white-space:nowrap">
start main.vbs<BR/>
&lt;ERROR msg='not found symbol'/&gt;<BR/>
Fail.</DIV>
<DIV id="text557_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:58px; margin-top:306px; line-height:15px; white-space:nowrap">
返り値のサンプル</DIV>
<v:rect style="position:absolute; margin-left:80px; margin-top:324px; width:202px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text557_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:88px; margin-top:331px; line-height:13px; white-space:nowrap">
&lt;ERROR msg='not found symbol'/&gt;</DIV>
<DIV id="text557_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:385px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text557_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:74px; margin-top:385px; line-height:15px; white-space:nowrap">
<A href="vbslib_21.html#FindStringLines">
→ FindStringLines</A></DIV>

<v:line from="0,0" to="513,0"/>
<v:line from="513,0" to="513,433"/>
<v:line from="513,433" to="0,433"/>
<v:line from="0,433" to="0,0"/>

</PAGE>
 
<!-- page 558 --> 
<PAGE>
<A id="svgcats_vml_p558" class="to_tree" style="margin-top:438px;" onClick="selectTreeElem( '558' );">←</A>
<A href="#svgcats_vml_p559" class="to_next_page" style="margin-top:438px;">▼</A>
<A href="#svgcats_vml_p557" class="to_prev_page" style="margin-top:438px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:449px; width:454px; height:192px;" fillcolor="white"/>
<DIV id="text558_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:466px; line-height:15px; white-space:nowrap">
<A name="find_c">
find_c</A></DIV>
<v:rect style="position:absolute; margin-left:22px; margin-top:494px; width:400px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text558_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:30px; margin-top:501px; line-height:13px; white-space:nowrap">
Function&nbsp; find_c( keyword as string, path as string ) as integer</DIV>
<DIV id="text558_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:529px; line-height:15px; white-space:nowrap">
テキストファイルの中で、指定したキーワードを含む行数を返します。</DIV>
<DIV id="text558_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:555px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text558_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:94px; margin-top:555px; line-height:15px; white-space:nowrap">
keyword</DIV>
<DIV id="text558_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:94px; margin-top:574px; line-height:15px; white-space:nowrap">
path</DIV>
<DIV id="text558_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:151px; margin-top:555px; line-height:15px; white-space:nowrap">
検索するキーワード</DIV>
<DIV id="text558_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:151px; margin-top:574px; line-height:15px; white-space:nowrap">
テキストファイルのパス</DIV>
<DIV id="text558_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:151px; margin-top:593px; line-height:15px; white-space:nowrap">
キーワードを含む行数</DIV>
<DIV id="text558_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:94px; margin-top:593px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text558_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:119px; margin-top:465px; line-height:15px; white-space:nowrap">
(src)</DIV>

<v:line from="0,449" to="454,449"/>
<v:line from="454,449" to="454,641"/>
<v:line from="454,641" to="0,641"/>
<v:line from="0,641" to="0,449"/>

</PAGE>
 
<!-- page 559 --> 
<PAGE>
<A id="svgcats_vml_p559" class="to_tree" style="margin-top:646px;" onClick="selectTreeElem( '559' );">←</A>
<A href="#svgcats_vml_p560" class="to_next_page" style="margin-top:646px;">▼</A>
<A href="#svgcats_vml_p558" class="to_prev_page" style="margin-top:646px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:657px; width:627px; height:1497px;" fillcolor="white"/>
<DIV id="text559_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:674px; line-height:15px; white-space:nowrap">
<A name="SearchStringTemplate">
SearchStringTemplate</A></DIV>
<DIV id="text559_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2017px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text559_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:82px; margin-top:2017px; line-height:15px; white-space:nowrap">
→ T_fc.vbs</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:704px; width:532px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text559_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:710px; line-height:15px; white-space:nowrap">
Function&nbsp; SearchStringTemplate( FolderPath as string, RegularExpressionPart as string,<BR/>
&nbsp; &nbsp;TemplateStrings as array of string, Opt as Empty ) as array of array of GrepFound</DIV>
<DIV id="text559_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:759px; line-height:15px; white-space:nowrap">
テキストファイルの中をキーワードで検索し、どのテンプレートと一致するかを一覧します。</DIV>
<DIV id="text559_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:785px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text559_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:785px; line-height:15px; white-space:nowrap">
FolderPath</DIV>
<DIV id="text559_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:804px; line-height:15px; white-space:nowrap">
RegularExpressionPart</DIV>
<DIV id="text559_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:785px; line-height:15px; white-space:nowrap">
検索対象フォルダーやワイルドカード</DIV>
<DIV id="text559_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:804px; line-height:15px; white-space:nowrap">
テンプレートの中にあるキーワード。複数行不可</DIV>
<DIV id="text559_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:823px; line-height:15px; white-space:nowrap">
TemplateStrings</DIV>
<DIV id="text559_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:823px; line-height:15px; white-space:nowrap">
テンプレート（複数行可）、または、その配列</DIV>
<DIV id="text559_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:861px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text559_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:515px; margin-top:804px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_08.html#RegExp">
→ 正規表現</A></DIV>
<DIV id="text559_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:244px; margin-top:861px; line-height:15px; white-space:nowrap">
<A href="vbslib_29.html#GrepFound">
GrepFound オブジェクト</A></DIV>
<DIV id="text559_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:379px; margin-top:861px; line-height:15px; white-space:nowrap">
の配列の配列</DIV>
<DIV id="text559_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:82px; margin-top:1992px; line-height:15px; white-space:nowrap">
→ ToolsLib.vbs</DIV>
<DIV id="text559_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1992px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text559_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:169px; margin-top:2017px; line-height:15px; white-space:nowrap">
T_SearchStringTemplate</DIV>
<DIV id="text559_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2042px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text559_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:2106px; line-height:15px; white-space:nowrap">
<A href="..\replicmp.files\replicmp_01.html#PartCmp">
→ PartCmp</A></DIV>
<v:rect style="position:absolute; margin-left:62px; margin-top:1617px; width:370px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text559_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:70px; margin-top:1623px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; founds = SearchStringTemplate( "TargetFolder", "(((", _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "/***********" +vbCRLF+ _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "((( ${FunctionName} ))$\{)" +vbCRLF+ _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "************/" +vbCRLF, Empty )<BR/>
<BR/>
&nbsp; &nbsp; Assert&nbsp; founds(0)(0).LineNum = 1&nbsp; '// マッチした<BR/>
&nbsp; &nbsp; Assert&nbsp; founds(0)(1).LineNum = 5&nbsp; '// マッチした<BR/>
&nbsp; &nbsp; Assert&nbsp; founds(1)(0).LineNum = 9&nbsp; '// マッチしなかった</DIV>
<DIV id="text559_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1539px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text559_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:1564px; line-height:15px; white-space:nowrap">
TargetFolder フォルダーの中にあるテキストファイルの中から "(((" を検索し、見つかった<BR/>
位置に、テンプレート（下記の複数行の文字列） がマッチしているものと、マッチしていない<BR/>
ものに分けます。</DIV>
<v:rect style="position:absolute; margin-left:92px; margin-top:1787px; width:106px; height:175px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text559_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:100px; margin-top:1793px; line-height:15px; white-space:nowrap">
/***********<BR/>
((( FuncA ))${)<BR/>
************/<BR/>
<BR/>
/***********<BR/>
((( FuncB ))${)<BR/>
************/<BR/>
<BR/>
/***********<BR/>
((( FuncC )))<BR/>
************/</DIV>
<DIV id="text559_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:1765px; line-height:15px; white-space:nowrap">
検索対象のテキストファイル</DIV>
<DIV id="text559_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:65px; margin-top:1793px; text-align: right; line-height:15px; white-space:nowrap">
1:<BR/>
2:<BR/>
3:<BR/>
4:<BR/>
5:<BR/>
6:<BR/>
7:<BR/>
8:<BR/>
9:<BR/>
10:<BR/>
11:</DIV>
<DIV id="text559_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:218px; margin-top:1928px; line-height:15px; white-space:nowrap">
… RegularExpressionPart 引数に指定した ((( にヒットするが、<BR/>
　　テンプレートに指定した ${ がないのでマッチしない</DIV>
<DIV id="text559_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:900px; line-height:15px; white-space:nowrap">
キーワードが見つかった位置が、指定したテンプレートの一部であるものと、そうでないものを<BR/>
一覧します。 これを応用すれば、テンプレートの内容が違っていたり、古いテンプレートのまま<BR/>
になっていたりするものを見つけることができます。</DIV>
<DIV id="text559_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:996px; line-height:15px; white-space:nowrap">
テンプレートは、可変の部分を "${変数名}" のように記述してください。 可変の部分は、複数行<BR/>
にまたぐことができます。 SearchStringTemplate 関数はテンプレートの中の変数名を無視しま<BR/>
すが、テンプレートを ScanFromTemplate 関数などにそのまま渡すことができます。 <BR/>
${ 文字は "$\{" と記述してください。 $\ 文字は "$\\" と記述してください。</DIV>
<v:rect style="position:absolute; margin-left:79px; margin-top:1064px; width:160px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text559_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:87px; margin-top:1070px; line-height:15px; white-space:nowrap">
関数名： ${FunctionName}<BR/>
引数：&nbsp; &nbsp;${Arguments}<BR/>
返り値： ${RerutnValue}</DIV>
<DIV id="text559_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:2074px; line-height:15px; white-space:nowrap">
<A href="vbslib_20.html#ScanFromTemplate">
→ ScanFromTemplate</A></DIV>
<DIV id="text559_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:842px; line-height:15px; white-space:nowrap">
Opt</DIV>
<DIV id="text559_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:842px; line-height:15px; white-space:nowrap">
Empty を指定してください</DIV>
<DIV id="text559_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:2042px; line-height:15px; white-space:nowrap">
<A href="vbslib_32.html#ReplaceStringTemplate">
→ ReplaceStringTemplate</A></DIV>
<DIV id="text559_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:1167px; line-height:15px; white-space:nowrap">
返り値が founds のとき、founds(t)(i) の t は TemplateStrings 引数の配列番号、i はテンプレート<BR/>
にマッチした複数の場所に 0 から順番につけた番号です。 <BR/>
<BR/>
i が配列の要素数に一致する要素は、TemplateStrings 引数に指定したどのテンプレートにも<BR/>
マッチしなかったテキストについてです。</DIV>
<DIV id="text559_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:2090px; line-height:15px; white-space:nowrap">
<A href="#GetLineNumOfTemplateDifference">
→ GetLineNumOfTemplateDifference</A></DIV>
<DIV id="text559_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1144px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text559_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:970px; line-height:15px; white-space:nowrap">
TemplateStrings 引数</DIV>
<DIV id="text559_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:455px; margin-top:785px; line-height:15px; white-space:nowrap">
<A href="vbslib_29.html#Execute_GrepClass">
→ Execute (GrepClass)</A></DIV>
<DIV id="text559_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:2058px; line-height:15px; white-space:nowrap">
<A href="vbslib_33.html#EchoOld_ReplaceTemplateClass">
→ EchoOld (ReplaceTemplateClass)</A></DIV>
<DIV id="text559_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:141px; margin-top:1261px; line-height:15px; white-space:nowrap">
<A href="vbslib_29.html#GrepFound">
GrepFound オブジェクト</A></DIV>
<DIV id="text559_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:1261px; line-height:15px; white-space:nowrap">
配列の要素は、</DIV>
<DIV id="text559_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:274px; margin-top:1261px; line-height:15px; white-space:nowrap">
です。</DIV>
<DIV id="text559_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:1277px; line-height:15px; white-space:nowrap">
GrepFound オブジェクトのメンバー変数の内容は、次の通りです。</DIV>
<DIV id="text559_46" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:86px; margin-top:1303px; line-height:13px; white-space:nowrap">
.Path</DIV>
<DIV id="text559_47" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:86px; margin-top:1323px; line-height:13px; white-space:nowrap">
.LineNum</DIV>
<DIV id="text559_48" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:86px; margin-top:1343px; line-height:13px; white-space:nowrap">
.LineText</DIV>
<DIV id="text559_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:1301px; line-height:15px; white-space:nowrap">
ファイル名</DIV>
<DIV id="text559_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:1321px; line-height:15px; white-space:nowrap">
Empty</DIV>
<DIV id="text559_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:1341px; line-height:15px; white-space:nowrap">
Array( テンプレートの開始位置（1以上）, テンプレートの次の位置 )</DIV>
<DIV id="text559_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:1374px; line-height:15px; white-space:nowrap">
GetEchoStr に渡すと、次のように変わります。</DIV>
<DIV id="text559_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:1445px; line-height:15px; white-space:nowrap">
テンプレートにマッチしたファイルの中の内容。 複数行の場合あり</DIV>
<DIV id="text559_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:1425px; line-height:15px; white-space:nowrap">
行番号。 キーワードがある位置の行番号</DIV>
<DIV id="text559_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:1405px; line-height:15px; white-space:nowrap">
ファイル名</DIV>
<DIV id="text559_56" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:86px; margin-top:1447px; line-height:13px; white-space:nowrap">
.LineText</DIV>
<DIV id="text559_57" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:86px; margin-top:1427px; line-height:13px; white-space:nowrap">
.LineNum</DIV>
<DIV id="text559_58" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:86px; margin-top:1407px; line-height:13px; white-space:nowrap">
.Path</DIV>
<DIV id="text559_59" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:1483px; line-height:15px; white-space:nowrap">
<A href="vbslib_36.html#ExpandWildcard_Sort">
ExpandWildcard_Sort 変数</A></DIV>
<DIV id="text559_60" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:1483px; line-height:15px; white-space:nowrap">
が使えます。</DIV>

<v:line from="0,657" to="627,657"/>
<v:line from="627,657" to="627,2154"/>
<v:line from="627,2154" to="0,2154"/>
<v:line from="0,2154" to="0,657"/>

</PAGE>
 
<!-- page 560 --> 
<PAGE>
<A id="svgcats_vml_p560" class="to_tree" style="margin-top:2159px;" onClick="selectTreeElem( '560' );">←</A>
<A href="#svgcats_vml_p561" class="to_next_page" style="margin-top:2159px;">▼</A>
<A href="#svgcats_vml_p559" class="to_prev_page" style="margin-top:2159px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2170px; width:626px; height:656px;" fillcolor="white"/>
<DIV id="text560_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2187px; line-height:15px; white-space:nowrap">
<A name="GetLineNumOfTemplateDifference">
GetLineNumOfTemplateDifference</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:2217px; width:460px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text560_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:2223px; line-height:15px; white-space:nowrap">
Function&nbsp; GetLineNumOfTemplateDifference( TargetString as string,<BR/>
&nbsp; &nbsp; RegularExpressionPart as string, TemplateString as string ) as integer</DIV>
<DIV id="text560_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2269px; line-height:15px; white-space:nowrap">
指定した文字列の中で、テンプレートに一致しない場所の行番号を返します。</DIV>
<DIV id="text560_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2295px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text560_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2295px; line-height:15px; white-space:nowrap">
TargetString</DIV>
<DIV id="text560_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2314px; line-height:15px; white-space:nowrap">
RegularExpressionPart</DIV>
<DIV id="text560_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:2295px; line-height:15px; white-space:nowrap">
テンプレートが含まれる（はずの）文字列</DIV>
<DIV id="text560_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:2333px; line-height:15px; white-space:nowrap">
テンプレート（複数行可）</DIV>
<DIV id="text560_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2333px; line-height:15px; white-space:nowrap">
TemplateString</DIV>
<DIV id="text560_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2390px; line-height:15px; white-space:nowrap">
テンプレートの書き方について、</DIV>
<DIV id="text560_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:222px; margin-top:2390px; line-height:15px; white-space:nowrap">
<A href="#SearchStringTemplate">
→ SearchStringTemplate</A></DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:2466px; width:304px; height:235px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text560_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:2472px; line-height:15px; white-space:nowrap">
line_num = GetLineNumOfTemplateDifference( _<BR/>
&nbsp; &nbsp; &nbsp; "----" +vbCRLF+_<BR/>
&nbsp; &nbsp; &nbsp; "----" +vbCRLF+_<BR/>
&nbsp; &nbsp; &nbsp; "Parameter1: abc" +vbCRLF+_<BR/>
&nbsp; &nbsp; &nbsp; "Param2:&nbsp; &nbsp; &nbsp;def" +vbCRLF+_<BR/>
&nbsp; &nbsp; &nbsp; "Parameter3: ghi" +vbCRLF+_<BR/>
&nbsp; &nbsp; &nbsp; "----" +vbCRLF, _<BR/>
&nbsp; &nbsp; &nbsp; _<BR/>
&nbsp; &nbsp; &nbsp; "Parameter1", _<BR/>
&nbsp; &nbsp; &nbsp; _<BR/>
&nbsp; &nbsp; &nbsp; "Parameter1: ${1}" +vbCRLF+_<BR/>
&nbsp; &nbsp; &nbsp; "Parameter2: ${2}" +vbCRLF+_<BR/>
&nbsp; &nbsp; &nbsp; "Parameter3: ${3}" +vbCRLF )<BR/>
<BR/>
Assert&nbsp; line_num = 4&nbsp; '// Param2: の場所の行番号</DIV>
<DIV id="text560_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2436px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text560_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:2352px; line-height:15px; white-space:nowrap">
テンプレートに一致しない場所の行番号。 0=すべて一致</DIV>
<DIV id="text560_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2352px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text560_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:2314px; line-height:15px; white-space:nowrap">
テンプレートの中にあるキーワード。複数行不可</DIV>
<DIV id="text560_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:515px; margin-top:2314px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_08.html#RegExp">
→ 正規表現</A></DIV>
<DIV id="text560_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:82px; margin-top:2724px; line-height:15px; white-space:nowrap">
→ ToolsLib.vbs</DIV>
<DIV id="text560_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2724px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text560_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:82px; margin-top:2751px; line-height:15px; white-space:nowrap">
→ T_fc.vbs</DIV>
<DIV id="text560_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2751px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text560_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:2751px; line-height:15px; white-space:nowrap">
T_GetLineNumOfTemplateDifference</DIV>
<DIV id="text560_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:2778px; line-height:15px; white-space:nowrap">
<A href="vbslib_33.html#RunGetDifference_ReplaceTemplateClass">
→ RunGetDifference (ReplaceTemplateClass)</A></DIV>
<DIV id="text560_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2778px; line-height:15px; white-space:nowrap">
関連</DIV>

<v:line from="0,2170" to="626,2170"/>
<v:line from="626,2170" to="626,2826"/>
<v:line from="626,2826" to="0,2826"/>
<v:line from="0,2826" to="0,2170"/>

</PAGE>
 
<!-- page 561 --> 
<PAGE>
<A id="svgcats_vml_p561" class="to_tree" style="margin-top:2831px;" onClick="selectTreeElem( '561' );">←</A>
<A href="#svgcats_vml_p562" class="to_next_page" style="margin-top:2831px;">▼</A>
<A href="#svgcats_vml_p560" class="to_prev_page" style="margin-top:2831px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2842px; width:584px; height:838px;" fillcolor="white"/>
<DIV id="text561_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2859px; line-height:15px; white-space:nowrap">
<A name="CreateFile">
CreateFile</A></DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:2888px; width:400px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text561_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:2895px; line-height:13px; white-space:nowrap">
Function&nbsp; CreateFile( path as string, text as string ) as string</DIV>
<DIV id="text561_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:2923px; line-height:15px; white-space:nowrap">
指定のテキストを内容としたテキストファイルを作成します。</DIV>
<DIV id="text561_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:2949px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text561_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:2949px; line-height:15px; white-space:nowrap">
path</DIV>
<DIV id="text561_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:2968px; line-height:15px; white-space:nowrap">
text</DIV>
<DIV id="text561_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:150px; margin-top:2949px; line-height:15px; white-space:nowrap">
作成するテキストファイルのパス</DIV>
<DIV id="text561_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:150px; margin-top:2968px; line-height:15px; white-space:nowrap">
テキストファイルの内容</DIV>
<DIV id="text561_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:3596px; line-height:15px; white-space:nowrap">
<A href="vbslib_53.html#WaitForFile">
→ WaitForFile</A></DIV>
<DIV id="text561_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:142px; margin-top:2858px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text561_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:3084px; line-height:15px; white-space:nowrap">
text に指定した文字列の末尾に改行が自動的に入らないテキストが作成されます。</DIV>
<DIV id="text561_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:107px; margin-top:3119px; line-height:15px; white-space:nowrap">
カレントフォルダに a.txt ファイルを作る</DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:3140px; width:172px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text561_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:3147px; line-height:13px; white-space:nowrap">
CreateFile&nbsp; "a.txt", "ABC"</DIV>
<DIV id="text561_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:2987px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text561_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:150px; margin-top:2987px; line-height:15px; white-space:nowrap">
作成したテキストファイルのフル・パス</DIV>
<DIV id="text561_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:3485px; line-height:15px; white-space:nowrap">
path に相対パスを指定したとき、基準フォルダはカレント・フォルダになりますが、ワイルド<BR/>
カードが含まれていると、テンポラリ・フォルダになります。 詳しくは、</DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:3200px; width:238px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text561_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:3207px; line-height:13px; white-space:nowrap">
start&nbsp; CreateFile( "*.xml", obj.xml )</DIV>
<DIV id="text561_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:426px; margin-top:3500px; line-height:15px; white-space:nowrap">
<A href="vbslib_34.html#GetTempPath">
→ GetTempPath</A></DIV>
<DIV id="text561_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:174px; margin-top:3596px; line-height:15px; white-space:nowrap">
<A href="vbslib_34.html#GetTempPath">
→ GetTempPath</A></DIV>
<DIV id="text561_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:242px; margin-top:3207px; line-height:13px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_01.html#OutXML">
xml</A></DIV>
<DIV id="text561_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:50px; margin-top:3207px; line-height:13px; white-space:nowrap">
<A href="vbslib_48.html#start">
start</A></DIV>
<DIV id="text561_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:218px; margin-top:3207px; line-height:13px; white-space:nowrap">
obj</DIV>
<DIV id="text561_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:107px; margin-top:3180px; line-height:15px; white-space:nowrap">
obj の xml プロパティを、テンポラリファイルに出力して開く</DIV>
<DIV id="text561_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:299px; margin-top:3596px; line-height:15px; white-space:nowrap">
<A href="vbslib_31.html#OpenForWrite">
→ OpenForWrite</A></DIV>
<DIV id="text561_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3596px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text561_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:3614px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_06.html#txt_write">
→ テキストファイルを作成する (VBS)</A></DIV>
<DIV id="text561_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:3439px; line-height:15px; white-space:nowrap">
<A href="vbslib_31.html#new_TextFileCharSetStack">
new_TextFileCharSetStack</A></DIV>
<DIV id="text561_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:203px; margin-top:3439px; line-height:15px; white-space:nowrap">
を使うと、テキストファイルのフォーマットを指定できます。</DIV>
<DIV id="text561_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:73px; margin-top:3544px; line-height:15px; white-space:nowrap">
→ T_File.vbs [T_CreateFile]</DIV>
<DIV id="text561_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3544px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text561_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:3455px; line-height:15px; white-space:nowrap">
<A href="vbslib_32.html#new_IsSafeFileUpdateStack">
new_IsSafeFileUpdateStack</A></DIV>
<DIV id="text561_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:205px; margin-top:3455px; line-height:15px; white-space:nowrap">
を使うと、内部で</DIV>
<DIV id="text561_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:397px; margin-top:3455px; line-height:15px; white-space:nowrap">
を使います。</DIV>
<DIV id="text561_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:305px; margin-top:3455px; line-height:15px; white-space:nowrap">
<A href="vbslib_32.html#SafeFileUpdate">
SafeFileUpdate</A></DIV>
<DIV id="text561_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:3022px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#fname">
→ ファイル名、パス (Windows)</A></DIV>
<DIV id="text561_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:29px; margin-top:3022px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text561_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:3042px; line-height:15px; white-space:nowrap">
<A href="#owerr">
→ Out of Writable 警告 [E_OutOfWritable]</A></DIV>
<DIV id="text561_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:73px; margin-top:3632px; line-height:15px; white-space:nowrap">
→ FileT_create (clib)</DIV>
<DIV id="text561_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:184px; margin-top:2858px; line-height:15px; white-space:nowrap">
mini (src)</DIV>
<DIV id="text561_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:73px; margin-top:3561px; line-height:15px; white-space:nowrap">
→ T_File.vbs [T_CreateFile_Err]</DIV>
<DIV id="text561_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:29px; margin-top:3119px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text561_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:30px; margin-top:3180px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text561_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:30px; margin-top:3245px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:3289px; width:394px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text561_44" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:3295px; line-height:15px; white-space:nowrap">
path = "_work.txt"<BR/>
text = ReadFile( path )<BR/>
'// ここで text を変更<BR/>
Set cs = new_TextFileCharSetStack( ReadUnicodeFileBOM( path ) )<BR/>
CreateFile&nbsp; path, text<BR/>
cs = Empty</DIV>
<DIV id="text561_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3415px; line-height:15px; white-space:nowrap">
補足</DIV>
<DIV id="text561_46" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:260px; margin-top:3341px; line-height:13px; white-space:nowrap">
<A href="vbslib_31.html#ReadUnicodeFileBOM">
ReadUnicodeFileBOM</A></DIV>
<DIV id="text561_47" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:104px; margin-top:3341px; line-height:13px; white-space:nowrap">
<A href="vbslib_31.html#new_TextFileCharSetStack">
new_TextFileCharSetStack</A></DIV>
<DIV id="text561_48" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:92px; margin-top:3311px; line-height:13px; white-space:nowrap">
<A href="vbslib_26.html#ReadFile">
ReadFile</A></DIV>
<DIV id="text561_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:114px; margin-top:3243px; line-height:15px; white-space:nowrap">
Unicode 形式かどうかを維持してファイルの内容を変更する</DIV>
<DIV id="text561_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:179px; margin-top:3270px; line-height:15px; white-space:nowrap">
<A href="vbslib_32.html#Text_ReplaceTextFile1">
OpenForReplace の Text</A></DIV>
<DIV id="text561_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:42px; margin-top:3270px; line-height:15px; white-space:nowrap">
注意</DIV>
<DIV id="text561_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:3270px; line-height:15px; white-space:nowrap">
下記の方法より、</DIV>
<DIV id="text561_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:326px; margin-top:3270px; line-height:15px; white-space:nowrap">
を変更する方が扱いやすいでしょう。</DIV>

<v:line from="0,2842" to="584,2842"/>
<v:line from="584,2842" to="584,3680"/>
<v:line from="584,3680" to="0,3680"/>
<v:line from="0,3680" to="0,2842"/>

</PAGE>
 
<!-- page 562 --> 
<PAGE>
<A id="svgcats_vml_p562" class="to_tree" style="margin-top:3685px;" onClick="selectTreeElem( '562' );">←</A>
<A href="#svgcats_vml_p563" class="to_next_page" style="margin-top:3685px;">▼</A>
<A href="#svgcats_vml_p561" class="to_prev_page" style="margin-top:3685px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3696px; width:590px; height:1267px;" fillcolor="white"/>
<v:image src="562/image01.png"
   style="position:absolute; margin-left:51px; margin-top:3903px; width:247px; height:97px;"/>
<DIV id="text562_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4131px; line-height:15px; white-space:nowrap">
この警告が出る最も多い原因は、ユーザが設定した場所に書き込み許可を設定しなかった<BR/>
スクリプトのバグです。 スクリプト開発者は、</DIV>
<DIV id="text562_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3713px; line-height:15px; white-space:nowrap">
<A name="owerr">
Out of Writable 警告 [E_OutOfWritable]</A></DIV>
<v:rect style="position:absolute; margin-left:49px; margin-top:3818px; width:436px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text562_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:57px; margin-top:3824px; line-height:15px; white-space:nowrap">
[WARNING] Out of Writable, see "Out of Writable" in vbslib manual.<BR/>
&nbsp;"C:\home\scriptlib\vbslib_new\_src\Test\vbslib_test\T_Writable\work2"</DIV>
<DIV id="text562_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3747px; line-height:15px; white-space:nowrap">
スクリプトが想定していない場所に、ファイルを出力しようとしたとき、出力してよいかユーザに<BR/>
確認を取ります。</DIV>
<DIV id="text562_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:43px; margin-top:3797px; line-height:15px; white-space:nowrap">
コマンドプロンプトへの出力例：</DIV>
<DIV id="text562_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:43px; margin-top:3881px; line-height:15px; white-space:nowrap">
確認ウィンドウ：</DIV>
<DIV id="text562_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:268px; margin-top:4146px; line-height:15px; white-space:nowrap">
<A href="#AppKeyClass_NewWritable">
AppKeyClass::NewWritable</A></DIV>
<DIV id="text562_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:419px; margin-top:4146px; line-height:15px; white-space:nowrap">
を使ってください。</DIV>
<DIV id="text562_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4026px; line-height:15px; white-space:nowrap">
vbslib を使ったスクリプトは、ダブルクリックした .vbs ファイルがあるフォルダ、または、ユーザが<BR/>
設定した場所のフォルダのどちらかしか、ファイルを作成したり削除しないように作られます。<BR/>
このルールが守られなかったとき、警告が出ます。<BR/>
<BR/>
この機能は、スクリプト開発者のミスによって問題が起きないようにするためのものであり、<BR/>
悪意のあるスクリプトは、この警告を出さないでファイルを壊すこともあります。</DIV>
<DIV id="text562_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:4915px; line-height:15px; white-space:nowrap">
<A href="..\vbslib_test2.files\vbslib_test2_01.html#T_Writable">
→ T_Writable</A></DIV>
<DIV id="text562_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4274px; line-height:15px; white-space:nowrap">
<A name="OutOfWritableDebug">
Out of Writable 警告のデバッグ</A></DIV>
<DIV id="text562_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4304px; line-height:15px; white-space:nowrap">
デバッガでスクリプトを起動し、Out of Writable の警告で、プログラムの終了やキャンセルを<BR/>
選ぶと、例外によりブレークします。</DIV>
<v:rect style="position:absolute; margin-left:52px; margin-top:4359px; width:460px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text562_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:60px; margin-top:4365px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; &nbsp; Err.Raise&nbsp; E_OutOfWritable,, "Out of Writable """ &amp; CheckPath &amp; """"<BR/>
&nbsp; &nbsp; &nbsp; ' Watch&nbsp; g_CurrentWritables.CurrentPathes and CheckPath</DIV>
<DIV id="text562_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4410px; line-height:15px; white-space:nowrap">
g_CurrentWritables.CurrentPathes や CheckPath をウォッチウィンドウでチェックしてください。</DIV>
<DIV id="text562_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4483px; line-height:15px; white-space:nowrap">
コールツリー</DIV>
<DIV id="text562_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:40px; margin-top:4739px; line-height:13px; white-space:nowrap">
mkdir など</DIV>
<DIV id="text562_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:64px; margin-top:4758px; line-height:13px; white-space:nowrap">
g_AppKey.CheckWritable</DIV>
<DIV id="text562_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:85px; margin-top:4777px; line-height:13px; white-space:nowrap">
m_Key.CheckWritable</DIV>
<DIV id="text562_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:107px; margin-top:4796px; line-height:13px; white-space:nowrap">
g_CurrentWritables.CheckWritable</DIV>
<DIV id="text562_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:124px; margin-top:4816px; line-height:13px; white-space:nowrap">
m_Key.CheckPlusWritable</DIV>
<DIV id="text562_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:329px; margin-top:4794px; line-height:15px; white-space:nowrap">
"...\*" 以外のチェック</DIV>
<DIV id="text562_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:329px; margin-top:4814px; line-height:15px; white-space:nowrap">
"...\*" で追加されたものと比較</DIV>
<DIV id="text562_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:107px; margin-top:4860px; line-height:13px; white-space:nowrap">
m_Key.Ask</DIV>
<DIV id="text562_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:220px; margin-top:4858px; line-height:15px; white-space:nowrap">
警告の表示</DIV>
<DIV id="text562_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:107px; margin-top:4879px; line-height:13px; white-space:nowrap">
m_PlusWritables( UBound( m_PlusWritables ) ) = abs_path</DIV>
<DIV id="text562_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:453px; margin-top:4877px; line-height:15px; white-space:nowrap">
Writable を追加</DIV>
<DIV id="text562_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:281px; margin-top:4775px; line-height:15px; white-space:nowrap">
隠しキーのメソッド</DIV>
<DIV id="text562_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:264px; margin-top:4756px; line-height:15px; white-space:nowrap">
公開キーのメソッド</DIV>
<DIV id="text562_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4915px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text562_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4211px; line-height:15px; white-space:nowrap">
グローバル変数のデストラクタでファイル操作をすると、メイン関数で作成した Writables<BR/>
オブジェクトが削除された後なので、必ず警告が発生します。</DIV>
<DIV id="text562_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:107px; margin-top:4838px; line-height:13px; white-space:nowrap">
If IsEmpty( abs_path ) Then&nbsp; Exit Sub</DIV>
<DIV id="text562_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:356px; margin-top:4836px; line-height:15px; white-space:nowrap">
Writable の中なので OK</DIV>
<DIV id="text562_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:40px; margin-top:4517px; line-height:13px; white-space:nowrap">
AppKey.NewWritable</DIV>
<DIV id="text562_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:4534px; line-height:13px; white-space:nowrap">
Writables::SetPathes</DIV>
<DIV id="text562_36" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:73px; margin-top:4592px; line-height:13px; white-space:nowrap">
m_Pathes( UBound( m_Pathes ) ) = g_TempFile.m_FolderPath + "\"</DIV>
<DIV id="text562_37" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:73px; margin-top:4573px; line-height:13px; white-space:nowrap">
m_Pathes(i) = abs_path + "\"</DIV>
<DIV id="text562_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:265px; margin-top:4571px; line-height:15px; white-space:nowrap">
Writable の登録</DIV>
<DIV id="text562_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:265px; margin-top:4608px; line-height:15px; white-space:nowrap">
テンポラリを Writable に登録</DIV>
<DIV id="text562_40" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:73px; margin-top:4553px; line-height:13px; white-space:nowrap">
g_CurrentWritables.AskFileAccess</DIV>
<DIV id="text562_41" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:40px; margin-top:4639px; line-height:13px; white-space:nowrap">
Writables::Enable</DIV>
<DIV id="text562_42" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:4658px; line-height:13px; white-space:nowrap">
WritablesStack::PushPathes</DIV>
<DIV id="text562_43" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:70px; margin-top:4676px; line-height:13px; white-space:nowrap">
CurrentWritables::PushPathes</DIV>
<DIV id="text562_44" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:85px; margin-top:4694px; line-height:13px; white-space:nowrap">
m_PathesStack.Push</DIV>
<DIV id="text562_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:197px; margin-top:4637px; line-height:15px; white-space:nowrap">
Writable を有効にする</DIV>
<DIV id="text562_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:231px; margin-top:4426px; line-height:15px; white-space:nowrap">
<A href="#AppKeyClass_Watch">
AppKeyClass::Watch</A></DIV>
<DIV id="text562_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:354px; margin-top:4426px; line-height:15px; white-space:nowrap">
をばらまいてください。</DIV>
<DIV id="text562_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4426px; line-height:15px; white-space:nowrap">
Writable の状況を確認したいときは、</DIV>
<DIV id="text562_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:4343px; line-height:15px; white-space:nowrap">
AppKeyClass::Ask</DIV>
<DIV id="text562_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:4162px; line-height:15px; white-space:nowrap">
<A href="vbslib_34.html#temp">
テンポラリ フォルダー</A></DIV>
<DIV id="text562_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:151px; margin-top:4162px; line-height:15px; white-space:nowrap">
の中と、拡張子が .updating のパスについては、NewWritable を</DIV>
<DIV id="text562_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4178px; line-height:15px; white-space:nowrap">
使う必要はありません。</DIV>

<v:line from="0,3696" to="590,3696"/>
<v:line from="590,3696" to="590,4963"/>
<v:line from="590,4963" to="0,4963"/>
<v:line from="0,4963" to="0,3696"/>

</PAGE>
 
<!-- page 563 --> 
<PAGE>
<A id="svgcats_vml_p563" class="to_tree" style="margin-top:4968px;" onClick="selectTreeElem( '563' );">←</A>
<A href="#svgcats_vml_p564" class="to_next_page" style="margin-top:4968px;">▼</A>
<A href="#svgcats_vml_p562" class="to_prev_page" style="margin-top:4968px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4979px; width:548px; height:1449px;" fillcolor="white"/>
<DIV id="text563_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:19px; margin-top:4996px; line-height:15px; white-space:nowrap">
<A name="AppKeyClass_NewWritable">
NewWritable (AppKeyClass)</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:5026px; width:424px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text563_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:5033px; line-height:13px; white-space:nowrap">
Function&nbsp; AppKeyClass::NewWritable( Pathes as variant ) as Writables</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:5579px; width:400px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text563_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:5585px; line-height:15px; white-space:nowrap">
Sub&nbsp; Main( Opt, AppKey )<BR/>
&nbsp; &nbsp; Set w_= AppKey.NewWritable( "." ).Enable()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; '// 書き込み可能な範囲<BR/>
&nbsp; &nbsp; w_ = Empty&nbsp; '// これを書かないときは、関数が終わるまでが範囲<BR/>
End Sub</DIV>
<DIV id="text563_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:5557px; line-height:15px; white-space:nowrap">
サンプル１： カレントフォルダを書き込み可能にする</DIV>
<DIV id="text563_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6099px; line-height:15px; white-space:nowrap">
サンプル： 後で out フォルダを書き込み可能にする</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:6118px; width:244px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text563_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:6124px; line-height:15px; white-space:nowrap">
Sub&nbsp; Main( Opt, AppKey )<BR/>
&nbsp; Set wr = AppKey.NewWritable( "out" )<BR/>
<BR/>
&nbsp; sub2&nbsp; wr<BR/>
End Sub<BR/>
<BR/>
Sub&nbsp; sub2( wr )<BR/>
&nbsp; Set w_ = wr.Enable()<BR/>
&nbsp; &nbsp; '// "out" に書き込み可能な範囲<BR/>
End Sub</DIV>
<DIV id="text563_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5062px; line-height:15px; white-space:nowrap">
書き込み可能なフォルダの設定オブジェクトを生成します。</DIV>
<DIV id="text563_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5089px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text563_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:95px; margin-top:5089px; line-height:15px; white-space:nowrap">
Pathes</DIV>
<DIV id="text563_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:152px; margin-top:5089px; line-height:15px; white-space:nowrap">
書き込み可能なフォルダの</DIV>
<DIV id="text563_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:95px; margin-top:5110px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text563_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:152px; margin-top:5110px; line-height:15px; white-space:nowrap">
Writable 設定オブジェクト</DIV>
<DIV id="text563_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5184px; line-height:15px; white-space:nowrap">
通常は、サンプル１のように使い、NewWritable 関数の引数を調整します。<BR/>
もしくは、使っているオブジェクトの</DIV>
<DIV id="text563_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5279px; line-height:15px; white-space:nowrap">
渡すと、書き込み可能なフォルダの設定を不正に変えられる可能性があります。<BR/>
返り値である Writable 設定オブジェクトは、他の関数に渡すことができます。</DIV>
<DIV id="text563_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:31px; margin-top:5263px; line-height:15px; white-space:nowrap">
AppKey は、なるべく他の関数に渡さないようにしてください。</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:6008px; width:382px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text563_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:6014px; line-height:15px; white-space:nowrap">
Sub&nbsp; Main( Opt, AppKey )<BR/>
&nbsp; Set w_= AppKey.NewWritable( Array("out1","out2") ).Enable()<BR/>
&nbsp; &nbsp; '// 書き込み可能な範囲<BR/>
End Sub</DIV>
<DIV id="text563_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:5989px; line-height:15px; white-space:nowrap">
サンプル： 複数のフォルダを書き込み可能にする</DIV>
<DIV id="text563_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:269px; margin-top:5601px; line-height:13px; white-space:nowrap">
<A href="#Writables_Enable">
Enable</A></DIV>
<DIV id="text563_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5231px; line-height:15px; white-space:nowrap">
AppKeyClass は、</DIV>
<DIV id="text563_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:312px; margin-top:5110px; line-height:15px; white-space:nowrap">
<A href="#Writables_Enable">
→ Writables::Enable</A></DIV>
<DIV id="text563_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:155px; margin-top:5601px; line-height:13px; white-space:nowrap">
NewWritable( "." )</DIV>
<DIV id="text563_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:246px; margin-top:4996px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text563_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:333px; margin-top:5089px; line-height:15px; white-space:nowrap">
。文字列、または文字列の配列</DIV>
<DIV id="text563_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:304px; margin-top:5089px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#fname">
パス</A></DIV>
<DIV id="text563_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:62px; margin-top:6348px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#fname">
→ ファイル名、パス</A></DIV>
<DIV id="text563_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6306px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text563_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:62px; margin-top:6306px; line-height:15px; white-space:nowrap">
<A href="#owerr">
→ Out of Writable 警告</A></DIV>
<DIV id="text563_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:62px; margin-top:6327px; line-height:15px; white-space:nowrap">
<A href="#SetWritableMode">
→ SetWritableMode</A></DIV>
<DIV id="text563_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:5690px; line-height:15px; white-space:nowrap">
サンプル： デスクトップに新規フォルダの作成を可能にし、新規フォルダの中だけ<BR/>
書き込み可能にする。 <BR/>
新規フォルダを作成することができるフォルダのパスの後に \* を指定してください。</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:5745px; width:388px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text563_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:5751px; line-height:15px; white-space:nowrap">
Sub&nbsp; Main( Opt, AppKey )<BR/>
&nbsp; desktop = g_sh.SpecialFolders( "Desktop" )<BR/>
&nbsp; Set w_= AppKey.NewWritable( desktop+"\*" ).Enable()<BR/>
&nbsp; mkdir&nbsp; desktop+"\New Folder"<BR/>
&nbsp; &nbsp; '// 書き込み可能な範囲<BR/>
&nbsp; w_ = Empty&nbsp; '// これを書かないときは、関数が終わるまでが範囲<BR/>
End Sub</DIV>
<DIV id="text563_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5326px; line-height:15px; white-space:nowrap">
Pathes に指定するパスの最後に "\*" があると、新規フォルダの作成を可能にし、<BR/>
新規フォルダの中は書き込み可能にします。 "C:\folder1\*" とすると、C:\folder1<BR/>
にファイルを作成できませんが、フォルダは作成できます。<BR/>
すでに C:\folder1 にあるフォルダの中は、上書きされないように、書き込み不可<BR/>
になります。</DIV>
<DIV id="text563_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:161px; margin-top:5150px; line-height:15px; white-space:nowrap">
<A href="#owerr">
Out of Writable 警告</A></DIV>
<DIV id="text563_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:281px; margin-top:5150px; line-height:15px; white-space:nowrap">
が出ないようになります。</DIV>
<DIV id="text563_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5150px; line-height:15px; white-space:nowrap">
本関数を正しく使えば、</DIV>
<DIV id="text563_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:282px; margin-top:4999px; line-height:12px; white-space:nowrap">
<A href="#owerr">
[ 親: Out of Writable 警告 ]</A></DIV>
<DIV id="text563_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6380px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text563_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5466px; line-height:15px; white-space:nowrap">
Program Files などの OS のシステムフォルダを NewWritable に指定すると、<BR/>
System folder access の警告になります。 この警告を自動的に無視するときは、<BR/>
NewWritable を呼び出す前に</DIV>
<DIV id="text563_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:199px; margin-top:5496px; line-height:15px; white-space:nowrap">
<A href="#SetWritableMode">
SetWritableMode</A></DIV>
<DIV id="text563_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:301px; margin-top:5496px; line-height:15px; white-space:nowrap">
に F_IgnoreIfWarn を指定して、</DIV>
<DIV id="text563_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5511px; line-height:15px; white-space:nowrap">
呼び出してください。</DIV>
<DIV id="text563_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:77px; margin-top:6380px; line-height:15px; white-space:nowrap">
→ T_Writable フォルダ</DIV>
<DIV id="text563_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:221px; margin-top:6380px; line-height:15px; white-space:nowrap">
<A href="..\vbslib_test2.files\vbslib_test2_01.html#T_Writable">
→ [T_Writable] の説明</A></DIV>
<DIV id="text563_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:222px; margin-top:5199px; line-height:15px; white-space:nowrap">
<A href="#GetWritable">
GetWritable メソッド</A></DIV>
<DIV id="text563_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:333px; margin-top:5199px; line-height:15px; white-space:nowrap">
を使います。</DIV>
<DIV id="text563_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:194px; margin-top:5231px; line-height:15px; white-space:nowrap">
の第2引数である AppKey のクラスです。</DIV>
<DIV id="text563_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:128px; margin-top:5231px; line-height:15px; white-space:nowrap">
<A href="vbslib_60.html#main">
Main 関数</A></DIV>
<DIV id="text563_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:31px; margin-top:5418px; line-height:15px; white-space:nowrap">
<A href="vbslib_34.html#temp">
テンポラリ フォルダー</A></DIV>
<DIV id="text563_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:158px; margin-top:5418px; line-height:15px; white-space:nowrap">
の中と、拡張子が</DIV>
<DIV id="text563_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5434px; line-height:15px; white-space:nowrap">
を使う必要はありません。</DIV>
<v:rect style="position:absolute; margin-left:66px; margin-top:5893px; width:190px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text563_50" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:74px; margin-top:5900px; line-height:13px; white-space:nowrap">
Cannot overwrite NOT NEW file</DIV>
<DIV id="text563_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:41px; margin-top:5871px; line-height:15px; white-space:nowrap">
このエラーが発生したときは、次のいずれかがエラー メッセージに含まれます。</DIV>
<v:rect style="position:absolute; margin-left:66px; margin-top:5924px; width:202px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text563_52" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:74px; margin-top:5931px; line-height:13px; white-space:nowrap">
Cannot overwrite NOT NEW folder</DIV>
<DIV id="text563_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:261px; margin-top:5418px; line-height:15px; white-space:nowrap">
<A href="vbslib_32.html#updating">
.updating</A></DIV>
<DIV id="text563_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:318px; margin-top:5418px; line-height:15px; white-space:nowrap">
のパスについては、NewWritable</DIV>

<v:line from="0,4979" to="548,4979"/>
<v:line from="548,4979" to="548,6428"/>
<v:line from="548,6428" to="0,6428"/>
<v:line from="0,6428" to="0,4979"/>

</PAGE>
 
<!-- page 564 --> 
<PAGE>
<A id="svgcats_vml_p564" class="to_tree" style="margin-top:6433px;" onClick="selectTreeElem( '564' );">←</A>
<A href="#svgcats_vml_p565" class="to_next_page" style="margin-top:6433px;">▼</A>
<A href="#svgcats_vml_p563" class="to_prev_page" style="margin-top:6433px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6444px; width:429px; height:459px;" fillcolor="white"/>
<DIV id="text564_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6461px; line-height:15px; white-space:nowrap">
<A name="GetWritable">
GetWritable メソッド</A></DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:6616px; width:364px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text564_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:6622px; line-height:15px; white-space:nowrap">
Sub&nbsp; main2( Opt, AppKey )<BR/>
&nbsp; Dim&nbsp; writable : writable = m.GetWritable<BR/>
&nbsp; If not AppKey.InPath( writable, "..\out" ) Then&nbsp; Error<BR/>
<BR/>
&nbsp; Dim w_ : Set w_= AppKey.NewWritable( writable ).Enable()<BR/>
&nbsp; &nbsp; '// 書き込み可能な範囲<BR/>
&nbsp; w_ = Empty<BR/>
End Sub</DIV>
<DIV id="text564_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6597px; line-height:15px; white-space:nowrap">
使用サンプル：</DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:6491px; width:316px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text564_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:6498px; line-height:13px; white-space:nowrap">
Function&nbsp; ClassA::GetWritable() as array of string</DIV>
<DIV id="text564_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:6526px; line-height:15px; white-space:nowrap">
書き込み許可の設定が必要なフォルダーの一覧を取得します。</DIV>
<DIV id="text564_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:6558px; line-height:15px; white-space:nowrap">
GetWritable メソッドは、それぞれのクラスで定義してください。</DIV>
<DIV id="text564_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:137px; margin-top:6653px; line-height:13px; white-space:nowrap">
<A href="#InPath_AppKeyClass">
InPath</A></DIV>
<DIV id="text564_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:83px; margin-top:6638px; line-height:13px; white-space:nowrap">
writable</DIV>
<DIV id="text564_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:185px; margin-top:6653px; line-height:13px; white-space:nowrap">
writable</DIV>
<DIV id="text564_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:275px; margin-top:6683px; line-height:13px; white-space:nowrap">
writable</DIV>
<DIV id="text564_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:197px; margin-top:6683px; line-height:13px; white-space:nowrap">
<A href="#AppKeyClass_NewWritable">
NewWritable</A></DIV>
<DIV id="text564_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6766px; line-height:15px; white-space:nowrap">
定義サンプル：</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:6786px; width:214px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text564_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:6792px; line-height:15px; white-space:nowrap">
Class&nbsp; ClassA<BR/>
&nbsp; Public Function&nbsp; GetWritable()<BR/>
&nbsp; &nbsp; GetWritable = Array( "Work" )<BR/>
&nbsp; End Function<BR/>
End Class</DIV>

<v:line from="0,6444" to="429,6444"/>
<v:line from="429,6444" to="429,6903"/>
<v:line from="429,6903" to="0,6903"/>
<v:line from="0,6903" to="0,6444"/>

</PAGE>
 
<!-- page 565 --> 
<PAGE>
<A id="svgcats_vml_p565" class="to_tree" style="margin-top:6908px;" onClick="selectTreeElem( '565' );">←</A>
<A href="#svgcats_vml_p566" class="to_next_page" style="margin-top:6908px;">▼</A>
<A href="#svgcats_vml_p564" class="to_prev_page" style="margin-top:6908px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6919px; width:611px; height:265px;" fillcolor="white"/>
<DIV id="text565_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6936px; line-height:15px; white-space:nowrap">
<A name="InPath_AppKeyClass">
InPath (AppKeyClass)</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:6966px; width:556px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text565_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:6973px; line-height:13px; white-space:nowrap">
Function&nbsp; AppKeyClass::InPath( Paths as Array of string, EnablePath as string ) as boolean</DIV>
<DIV id="text565_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7136px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<DIV id="text565_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7003px; line-height:15px; white-space:nowrap">
Paths に指定したパスの集合が、EnablePath の中に含まれるかどうかを返します。</DIV>
<DIV id="text565_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7029px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text565_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7029px; line-height:15px; white-space:nowrap">
Paths</DIV>
<DIV id="text565_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7048px; line-height:15px; white-space:nowrap">
EnablePath</DIV>
<DIV id="text565_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:7029px; line-height:15px; white-space:nowrap">
パスの配列</DIV>
<DIV id="text565_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:7048px; line-height:15px; white-space:nowrap">
許可しているパス</DIV>
<DIV id="text565_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7067px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text565_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:7067px; line-height:15px; white-space:nowrap">
Paths の要素がすべて許可しているパスに含まれているかどうか</DIV>
<DIV id="text565_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7102px; line-height:15px; white-space:nowrap">
ファイル：</DIV>
<v:rect style="position:absolute; margin-left:94px; margin-top:7100px; width:75px; height:19px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text565_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:102px; margin-top:7104px; line-height:13px; white-space:nowrap">
vbslib.vbs</DIV>
<DIV id="text565_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:214px; margin-top:6936px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text565_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:102px; margin-top:7136px; line-height:15px; white-space:nowrap">
<A href="#GetWritable">
→ GetWritable メソッド</A></DIV>

<v:line from="0,6919" to="611,6919"/>
<v:line from="611,6919" to="611,7184"/>
<v:line from="611,7184" to="0,7184"/>
<v:line from="0,7184" to="0,6919"/>

</PAGE>
 
<!-- page 566 --> 
<PAGE>
<A id="svgcats_vml_p566" class="to_tree" style="margin-top:7189px;" onClick="selectTreeElem( '566' );">←</A>
<A href="#svgcats_vml_p567" class="to_next_page" style="margin-top:7189px;">▼</A>
<A href="#svgcats_vml_p565" class="to_prev_page" style="margin-top:7189px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7200px; width:528px; height:387px;" fillcolor="white"/>
<DIV id="text566_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7217px; line-height:15px; white-space:nowrap">
<A name="CheckWritable_AppKeyClass">
CheckWritable (AppKeyClass)</A></DIV>
<DIV id="text566_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:242px; margin-top:7217px; line-height:15px; white-space:nowrap">
(src)</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:7247px; width:406px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text566_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:7254px; line-height:13px; white-space:nowrap">
Sub&nbsp; AppKeyClass::CheckWritable( Path as string, Opt as variant )</DIV>
<DIV id="text566_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7284px; line-height:15px; white-space:nowrap">
指定したパスが、</DIV>
<DIV id="text566_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7310px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text566_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7310px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text566_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7329px; line-height:15px; white-space:nowrap">
Opt</DIV>
<DIV id="text566_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:154px; margin-top:7310px; line-height:15px; white-space:nowrap">
チェックするパス</DIV>
<DIV id="text566_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:154px; margin-top:7329px; line-height:15px; white-space:nowrap">
Empty または c.ForMkDir (*1)</DIV>
<DIV id="text566_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:132px; margin-top:7284px; line-height:15px; white-space:nowrap">
<A href="#Writables_Enable">
Enable (Writables)</A></DIV>
<DIV id="text566_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:240px; margin-top:7284px; line-height:15px; white-space:nowrap">
されているかどうかチェックします。</DIV>
<DIV id="text566_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7361px; line-height:15px; white-space:nowrap">
(*1)</DIV>
<DIV id="text566_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:309px; margin-top:7427px; line-height:15px; white-space:nowrap">
<A href="#owerr">
Out of Writable 警告</A></DIV>
<DIV id="text566_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7427px; line-height:15px; white-space:nowrap">
Path が、Enable (Writables) されていなかったら、</DIV>
<DIV id="text566_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:428px; margin-top:7427px; line-height:15px; white-space:nowrap">
が出ます。</DIV>
<DIV id="text566_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:7361px; line-height:15px; white-space:nowrap">
Opt 引数に、g_VBS_Lib.ForMkDir を指定すると、Path に指定したパスの<BR/>
フォルダーを作るために、Path の子フォルダー（Path より長いパス）だけが、<BR/>
Enable (Writables) されていたときでも、チェックに引っかからなくなります。</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:7490px; width:352px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text566_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:7497px; line-height:13px; white-space:nowrap">
g_AppKey.CheckWritable&nbsp; "C:\Users\user1\log.txt",&nbsp; Empty</DIV>
<DIV id="text566_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7466px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text566_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7540px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text566_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:7540px; line-height:15px; white-space:nowrap">
<A href="vbslib_26.html#mkdir_for">
→ mkdir_for</A></DIV>

<v:line from="0,7200" to="528,7200"/>
<v:line from="528,7200" to="528,7587"/>
<v:line from="528,7587" to="0,7587"/>
<v:line from="0,7587" to="0,7200"/>

</PAGE>
 
<!-- page 567 --> 
<PAGE>
<A id="svgcats_vml_p567" class="to_tree" style="margin-top:7592px;" onClick="selectTreeElem( '567' );">←</A>
<A href="#svgcats_vml_p568" class="to_next_page" style="margin-top:7592px;">▼</A>
<A href="#svgcats_vml_p566" class="to_prev_page" style="margin-top:7592px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7603px; width:466px; height:219px;" fillcolor="white"/>
<DIV id="text567_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7620px; line-height:15px; white-space:nowrap">
<A name="AppKeyClass_Watch">
Watch (AppKeyClass)</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:7650px; width:166px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text567_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:7657px; line-height:13px; white-space:nowrap">
Sub&nbsp; AppKeyClass::Watch()</DIV>
<DIV id="text567_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:7686px; line-height:15px; white-space:nowrap">
Writable の状態を echo 出力します。</DIV>
<DIV id="text567_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7721px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:7742px; width:100px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text567_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:7749px; line-height:13px; white-space:nowrap">
g_AppKey.Watch</DIV>
<DIV id="text567_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:7774px; line-height:15px; white-space:nowrap">
g_AppKey は、公開キーとして用意されているグローバル変数です。</DIV>
<DIV id="text567_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:210px; margin-top:7620px; line-height:15px; white-space:nowrap">
(src)</DIV>

<v:line from="0,7603" to="466,7603"/>
<v:line from="466,7603" to="466,7822"/>
<v:line from="466,7822" to="0,7822"/>
<v:line from="0,7822" to="0,7603"/>

</PAGE>
 
<!-- page 568 --> 
<PAGE>
<A id="svgcats_vml_p568" class="to_tree" style="margin-top:7827px;" onClick="selectTreeElem( '568' );">←</A>
<A href="#svgcats_vml_p569" class="to_next_page" style="margin-top:7827px;">▼</A>
<A href="#svgcats_vml_p567" class="to_prev_page" style="margin-top:7827px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7838px; width:543px; height:632px;" fillcolor="white"/>
<DIV id="text568_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7855px; line-height:15px; white-space:nowrap">
<A name="Writables_Enable">
Enable (Writables)</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:7885px; width:298px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text568_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:7892px; line-height:13px; white-space:nowrap">
Function&nbsp; Writables::Enable() as WritablesStack</DIV>
<DIV id="text568_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:7921px; line-height:15px; white-space:nowrap">
書き込み可能なフォルダを設定します。</DIV>
<DIV id="text568_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:7948px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text568_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:7948px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text568_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:150px; margin-top:7948px; line-height:15px; white-space:nowrap">
WritableStack オブジェクト</DIV>
<DIV id="text568_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:7982px; line-height:15px; white-space:nowrap">
Writables は、</DIV>
<DIV id="text568_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:259px; margin-top:7982px; line-height:15px; white-space:nowrap">
から取得できます。</DIV>
<DIV id="text568_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:107px; margin-top:7982px; line-height:15px; white-space:nowrap">
<A href="#AppKeyClass_NewWritable">
AppKeyClass::NewWritable</A></DIV>
<DIV id="text568_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:8064px; line-height:15px; white-space:nowrap">
返り値の WritableStack オブジェクトが、どこからも参照されなくなったら、書き込み<BR/>
可能では無くなります。<BR/>
１つ目の WritableStack が存在するときに、２つ目の Writable::Enable をすると、ネスト<BR/>
して、２つ目の WritableStack のみ有効になります。 ２つ目の WritableStack が参照<BR/>
されなくなったら、１つ目の WritableStack が有効になります。</DIV>
<v:rect style="position:absolute; margin-left:54px; margin-top:8154px; width:244px; height:250px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text568_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:62px; margin-top:8160px; line-height:15px; white-space:nowrap">
Set&nbsp; w1 = AppKey.NewWritable( "out1" )<BR/>
Set&nbsp; w2 = AppKey.NewWritable( "out2" )<BR/>
<BR/>
Set&nbsp; w1_ = w1.Enable()<BR/>
<BR/>
&nbsp; '// "out1" が書き込み可能<BR/>
<BR/>
Set&nbsp; w2_ = w2.Enable()<BR/>
<BR/>
&nbsp; '// "out2" が書き込み可能<BR/>
<BR/>
w2_ = Empty<BR/>
<BR/>
&nbsp; '// "out1" が書き込み可能<BR/>
<BR/>
w1_ = Empty</DIV>
<DIV id="text568_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:7855px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text568_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:61px; margin-top:8421px; line-height:15px; white-space:nowrap">
<A href="#owerr">
→ Out of Writable 警告</A></DIV>
<DIV id="text568_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8421px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text568_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:213px; margin-top:7858px; line-height:12px; white-space:nowrap">
<A href="#owerr">
[ 親: Out of Writable 警告 ]</A></DIV>
<v:rect style="position:absolute; margin-left:52px; margin-top:8010px; width:322px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text568_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:60px; margin-top:8017px; line-height:13px; white-space:nowrap">
&nbsp; Dim w_:Set w_= AppKey.NewWritable( "." ).Enable()</DIV>

<v:line from="0,7838" to="543,7838"/>
<v:line from="543,7838" to="543,8470"/>
<v:line from="543,8470" to="0,8470"/>
<v:line from="0,8470" to="0,7838"/>

</PAGE>
 
<!-- page 569 --> 
<PAGE>
<A id="svgcats_vml_p569" class="to_tree" style="margin-top:8475px;" onClick="selectTreeElem( '569' );">←</A>
<A href="#svgcats_vml_p570" class="to_next_page" style="margin-top:8475px;">▼</A>
<A href="#svgcats_vml_p568" class="to_prev_page" style="margin-top:8475px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8486px; width:566px; height:571px;" fillcolor="white"/>
<DIV id="text569_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8503px; line-height:15px; white-space:nowrap">
<A name="SetWritableMode">
SetWritableMode</A></DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:8535px; width:250px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text569_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:8542px; line-height:13px; white-space:nowrap">
Sub&nbsp; SetWritableMode( Mode as integer )</DIV>
<DIV id="text569_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:105px; margin-top:8606px; line-height:15px; white-space:nowrap">
で指定していないフォルダにライトしようとしたときの動きを設定します。</DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:8745px; width:184px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text569_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:8752px; line-height:13px; white-space:nowrap">
SetWritableMode&nbsp; F_ErrIfWarn</DIV>
<DIV id="text569_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:8724px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text569_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:38px; margin-top:8642px; line-height:13px; white-space:nowrap">
<A name="F_AskIfWarn">
F_AskIfWarn</A></DIV>
<DIV id="text569_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:146px; margin-top:8640px; line-height:15px; white-space:nowrap">
ユーザにライトしていいかどうかを確認します（デフォルト）</DIV>
<DIV id="text569_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:38px; margin-top:8663px; line-height:13px; white-space:nowrap">
<A name="F_ErrIfWarn">
F_ErrIfWarn</A></DIV>
<DIV id="text569_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:146px; margin-top:8661px; line-height:15px; white-space:nowrap">
E_OutOfWritable エラーにします</DIV>
<DIV id="text569_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:38px; margin-top:8684px; line-height:13px; white-space:nowrap">
<A name="F_IgnoreIfWarn">
F_IgnoreIfWarn</A></DIV>
<DIV id="text569_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:146px; margin-top:8682px; line-height:15px; white-space:nowrap">
警告を無視します（AppKeyClass::SetWritableMode でのみ指定可能）</DIV>
<DIV id="text569_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:8503px; line-height:15px; white-space:nowrap">
(src)</DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:8814px; width:346px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text569_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:8820px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; writable_path = env("%ProgramFiles%")+"\SampleApp"<BR/>
&nbsp; &nbsp; Assert&nbsp; InStr( writable_path, "Program Files" ) &gt; 0<BR/>
<BR/>
&nbsp; &nbsp; AppKey.SetWritableMode&nbsp; F_IgnoreIfWarn<BR/>
&nbsp; &nbsp; Set w_=AppKey.NewWritable( writable_path ).Enable()<BR/>
&nbsp; &nbsp; SetWritableMode&nbsp; F_AskIfWarn</DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:8567px; width:328px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text569_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:8574px; line-height:13px; white-space:nowrap">
Sub&nbsp; AppKeyClass::SetWritableMode( Mode as integer )</DIV>
<DIV id="text569_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:29px; margin-top:8606px; line-height:15px; white-space:nowrap">
<A href="#AppKeyClass_NewWritable">
NewWritable</A></DIV>
<DIV id="text569_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:9009px; line-height:15px; white-space:nowrap">
<A href="#owerr">
→ Out of Writable 警告</A></DIV>
<DIV id="text569_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:9009px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text569_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:213px; margin-top:8506px; line-height:12px; white-space:nowrap">
<A href="#owerr">
[ 親: Out of Writable 警告 ]</A></DIV>
<DIV id="text569_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:8793px; line-height:15px; white-space:nowrap">
サンプル： F_IgnoreIfWarn には、AppKey が必要</DIV>
<DIV id="text569_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:8922px; line-height:15px; white-space:nowrap">
Program Files に書き込み許可するときは、以下の手順が最も安全です。<BR/>
・パスに Program Files が入っていることをチェック<BR/>
・F_IgnoreIfWarn に設定して警告を抑制して書き込み許可を設定<BR/>
・F_AskIfWarn に設定を戻す</DIV>

<v:line from="0,8486" to="566,8486"/>
<v:line from="566,8486" to="566,9057"/>
<v:line from="566,9057" to="0,9057"/>
<v:line from="0,9057" to="0,8486"/>

</PAGE>
 
<!-- page 570 --> 
<PAGE>
<A id="svgcats_vml_p570" class="to_tree" style="margin-top:9062px;" onClick="selectTreeElem( '570' );">←</A>
<A href="#svgcats_vml_p571" class="to_next_page" style="margin-top:9062px;">▼</A>
<A href="#svgcats_vml_p569" class="to_prev_page" style="margin-top:9062px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9073px; width:410px; height:187px;" fillcolor="white"/>
<DIV id="text570_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9090px; line-height:15px; white-space:nowrap">
<A name="g_CurrentWritables_CurrentPathes">
g_CurrentWritables.CurrentPathes</A></DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:9122px; width:352px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text570_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:9129px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_CurrentWritables.CurrentPathes as array of string</DIV>
<DIV id="text570_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:9159px; line-height:15px; white-space:nowrap">
現在書き込みを許可しているパスの配列。</DIV>
<DIV id="text570_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:9192px; line-height:15px; white-space:nowrap">
<A href="#OutOfWritableDebug">
→ Out of Writable 警告のデバッグ</A></DIV>
<DIV id="text570_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9192px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text570_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:9212px; line-height:15px; white-space:nowrap">
<A href="vbslib_13.html#Code_ArrayClass">
→ Code (ArrayClass)</A></DIV>

<v:line from="0,9073" to="410,9073"/>
<v:line from="410,9073" to="410,9260"/>
<v:line from="410,9260" to="0,9260"/>
<v:line from="0,9260" to="0,9073"/>

</PAGE>
 
<!-- page 571 --> 
<PAGE>
<A id="svgcats_vml_p571" class="to_tree" style="margin-top:9265px;" onClick="selectTreeElem( '571' );">←</A>
<A href="vbslib_31.html#svgcats_vml_p572" class="to_next_page" style="margin-top:9265px;">▼</A>
<A href="#svgcats_vml_p570" class="to_prev_page" style="margin-top:9265px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9276px; width:536px; height:911px;" fillcolor="white"/>
<DIV id="text571_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9293px; line-height:15px; white-space:nowrap">
<A name="OpenForRead">
OpenForRead</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:9320px; width:334px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text571_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:9327px; line-height:13px; white-space:nowrap">
Function&nbsp; OpenForRead( Path as string ) as TextStream</DIV>
<DIV id="text571_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:9358px; line-height:15px; white-space:nowrap">
テキストファイルを開きます。（リード用＝ファイルから入力します）</DIV>
<DIV id="text571_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:9381px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text571_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:9381px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text571_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:9400px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text571_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:9381px; line-height:15px; white-space:nowrap">
開くファイルのパス</DIV>
<DIV id="text571_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:9400px; line-height:15px; white-space:nowrap">
ファイルのストリーム</DIV>
<DIV id="text571_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:221px; margin-top:9432px; line-height:15px; white-space:nowrap">
と異なり、エラーがあったら、</DIV>
<DIV id="text571_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:34px; margin-top:9432px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_05.html#FileSystemObject_OpenTextFile">
FileSystemObject::OpenTextFile</A></DIV>
<DIV id="text571_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:9448px; line-height:15px; white-space:nowrap">
エラーメッセージに Path が付きます。</DIV>
<v:rect style="position:absolute; margin-left:38px; margin-top:9543px; width:406px; height:235px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text571_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:46px; margin-top:9549px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set c = g_VBS_Lib<BR/>
&nbsp; &nbsp; Set args = WScript.Arguments.Unnamed<BR/>
<BR/>
&nbsp; &nbsp; If args.Count = 0 Then<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; path = InputPath( "ファイルのパス &gt;", c.CheckFileExists )<BR/>
&nbsp; &nbsp; Else<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; path = args(0)<BR/>
&nbsp; &nbsp; End If<BR/>
<BR/>
&nbsp; &nbsp; Set file = OpenForRead( path )<BR/>
&nbsp; &nbsp; Do Until&nbsp; file.AtEndOfStream<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; line = file.ReadLine()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; '// If InStr( line, "DEBUG" ) &gt; 0 Then&nbsp; echo&nbsp; line<BR/>
&nbsp; &nbsp; Loop<BR/>
&nbsp; &nbsp; file = Empty</DIV>
<DIV id="text571_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:34px; margin-top:9464px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_18.html#E_FileNotExist">
E_FileNotExist エラー</A></DIV>
<DIV id="text571_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:197px; margin-top:9465px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_18.html#E_PathNotFound">
E_PathNotFound エラー</A></DIV>
<DIV id="text571_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:156px; margin-top:9465px; line-height:15px; white-space:nowrap">
または</DIV>
<DIV id="text571_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:331px; margin-top:9465px; line-height:15px; white-space:nowrap">
になります。</DIV>
<DIV id="text571_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:10045px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_05.html#FileSystemObject_OpenTextFile">
→ FileSystemObject::OpenTextFile</A></DIV>
<DIV id="text571_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:10102px; line-height:15px; white-space:nowrap">
<A href="vbslib_33.html#ReplaceTextFile">
→ ReplaceTextFile</A></DIV>
<DIV id="text571_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:10121px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_06.html#txt_read">
→ VBScript - テキストファイルの内容を読む (Read)</A></DIV>
<DIV id="text571_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:295px; margin-top:9381px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#fname">
→ ファイル名、パス</A></DIV>
<DIV id="text571_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:64px; margin-top:10009px; line-height:15px; white-space:nowrap">
→ T_File.vbs # [T_OpenFile]</DIV>
<DIV id="text571_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10045px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text571_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10009px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text571_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:268px; margin-top:10064px; line-height:15px; white-space:nowrap">
既定の文字コードを指定します</DIV>
<DIV id="text571_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:10064px; line-height:15px; white-space:nowrap">
<A href="vbslib_31.html#new_TextFileCharSetStack">
→ new_TextFileCharSetStack</A></DIV>
<DIV id="text571_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:10083px; line-height:15px; white-space:nowrap">
<A href="vbslib_26.html#ReadFile">
→ ReadFile</A></DIV>
<DIV id="text571_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:9794px; line-height:15px; white-space:nowrap">
文字コードを指定するときは、</DIV>
<DIV id="text571_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:199px; margin-top:9794px; line-height:15px; white-space:nowrap">
<A href="vbslib_31.html#new_TextFileCharSetStack">
new_TextFileCharSetStack</A></DIV>
<DIV id="text571_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:353px; margin-top:9794px; line-height:15px; white-space:nowrap">
を使ってください。 </DIV>
<DIV id="text571_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:9811px; line-height:15px; white-space:nowrap">
ただし、Shift-JIS, Unicode, UTF-8(BOMあり) は、使わなくても自動的に文字コード<BR/>
を判定して、正しく読み込みます。</DIV>
<v:rect style="position:absolute; margin-left:55px; margin-top:9851px; width:298px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text571_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:63px; margin-top:9857px; line-height:15px; white-space:nowrap">
&nbsp; Set cs = new_TextFileCharSetStack( "EUC-JP" )<BR/>
&nbsp; Set file = OpenForRead( args(0) )<BR/>
&nbsp; cs = Empty<BR/>
&nbsp; Do Until&nbsp; file.AtEndOfStream<BR/>
&nbsp; &nbsp; line = file.ReadLine()<BR/>
&nbsp; Loop</DIV>
<DIV id="text571_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:10140px; line-height:15px; white-space:nowrap">
<A href="vbslib_21.html#StringStream">
→ StringStream クラス</A></DIV>
<DIV id="text571_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:9480px; line-height:15px; white-space:nowrap">
返り値を使って呼び出せるメソッドは、FileSystemObject::OpenTextFile と同じです。</DIV>
<DIV id="text571_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9522px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text571_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:295px; margin-top:9400px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_05.html#TextStream">
→ TextStream （VBScript）</A></DIV>
<DIV id="text571_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:9981px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text571_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:64px; margin-top:9981px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text571_38" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:136px; margin-top:9685px; line-height:13px; white-space:nowrap">
OpenForRead</DIV>

<v:line from="0,9276" to="536,9276"/>
<v:line from="536,9276" to="536,10187"/>
<v:line from="536,10187" to="0,10187"/>
<v:line from="0,10187" to="0,9276"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10187px;">
<A id="svgcats_vml_p571" class="to_tree" onClick="selectTreeElem( '571' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10187px;">
<A id="page_group_bottom" href="vbslib_31.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
