<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>vbslib</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbslib.files/vbslib_32.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbslib.files/vbslib_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbslib.files/vbslib_32.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 590 --> 
<PAGE>
<A id="svgcats_vml_p590" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '590' );">←</A>
<A href="#svgcats_vml_p591" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbslib_31.html#svgcats_vml_p589" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbslib_31.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:583px; height:311px;" fillcolor="white"/>
<DIV id="text590_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="new_IsSafeFileUpdateStack">
new_IsSafeFileUpdateStack</A></DIV>
<DIV id="text590_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:86px; line-height:15px; white-space:nowrap">
ファイルを作成するときに</DIV>
<DIV id="text590_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:115px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text590_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:115px; line-height:15px; white-space:nowrap">
IsEnabled</DIV>
<DIV id="text590_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:178px; margin-top:115px; line-height:15px; white-space:nowrap">
SafeFileUpdate を実行するかどうか</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:47px; width:526px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text590_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:54px; line-height:13px; white-space:nowrap">
Function&nbsp; new_IsSafeFileUpdateStack( IsEnabled as boolean ) as IsSafeFileUpdateStack</DIV>
<DIV id="text590_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:268px; margin-top:86px; line-height:15px; white-space:nowrap">
を実行します。</DIV>
<DIV id="text590_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:178px; margin-top:86px; line-height:15px; white-space:nowrap">
<A href="#SafeFileUpdate">
SafeFileUpdate</A></DIV>
<DIV id="text590_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:146px; line-height:15px; white-space:nowrap">
返り値のオブジェクトが削除されたら、指定は無効になります。</DIV>
<DIV id="text590_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:228px; margin-top:16px; line-height:15px; white-space:nowrap">
(src)</DIV>
<v:rect style="position:absolute; margin-left:36px; margin-top:200px; width:340px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text590_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:44px; margin-top:206px; line-height:15px; white-space:nowrap">
&nbsp; Dim&nbsp; sf : Set sf = new_IsSafeFileUpdateStack( True )<BR/>
&nbsp; CreateFile&nbsp; "File1.txt", "abc"</DIV>
<DIV id="text590_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:179px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text590_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:263px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text590_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:70px; margin-top:263px; line-height:15px; white-space:nowrap">
→ T_File.vbs [T_CreateFile]</DIV>

<v:line from="0,0" to="583,0"/>
<v:line from="583,0" to="583,311"/>
<v:line from="583,311" to="0,311"/>
<v:line from="0,311" to="0,0"/>

</PAGE>
 
<!-- page 591 --> 
<PAGE>
<A id="svgcats_vml_p591" class="to_tree" style="margin-top:316px;" onClick="selectTreeElem( '591' );">←</A>
<A href="#svgcats_vml_p592" class="to_next_page" style="margin-top:316px;">▼</A>
<A href="#svgcats_vml_p590" class="to_prev_page" style="margin-top:316px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:327px; width:566px; height:262px;" fillcolor="white"/>
<DIV id="text591_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:344px; line-height:15px; white-space:nowrap">
<A name="g_FileOptions">
g_FileOptions</A></DIV>
<v:rect style="position:absolute; margin-left:32px; margin-top:375px; width:502px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text591_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:40px; margin-top:381px; line-height:15px; white-space:nowrap">
g_FileOptions = new FileOptionsClass<BR/>
<BR/>
Class&nbsp; FileOptionsClass<BR/>
&nbsp; Public Property Get&nbsp; CharSet&nbsp; &nbsp; '// as lower case string.&nbsp; ADODB.Stream.Charset<BR/>
&nbsp; Public Property Get&nbsp; CharSetEx&nbsp; '// as Empty, c.UTF_8_No_BOM<BR/>
&nbsp; Public Property Get&nbsp; LineSeparator&nbsp; &nbsp; &nbsp;'// as ADODBConsts.Keep<BR/>
&nbsp; Public Property Get&nbsp; IsSafeFileUpdate&nbsp; '// as boolean<BR/>
End Class</DIV>
<DIV id="text591_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:38px; margin-top:522px; line-height:15px; white-space:nowrap">
<A href="vbslib_31.html#new_TextFileCharSetStack">
→ new_TextFileCharSetStack</A></DIV>
<DIV id="text591_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:38px; margin-top:541px; line-height:15px; white-space:nowrap">
<A href="#new_IsSafeFileUpdateStack">
→ new_IsSafeFileUpdateStack</A></DIV>
<DIV id="text591_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:143px; margin-top:343px; line-height:15px; white-space:nowrap">
(src)</DIV>

<v:line from="0,327" to="566,327"/>
<v:line from="566,327" to="566,589"/>
<v:line from="566,589" to="0,589"/>
<v:line from="0,589" to="0,327"/>

</PAGE>
 
<!-- page 592 --> 
<PAGE>
<A id="svgcats_vml_p592" class="to_tree" style="margin-top:594px;" onClick="selectTreeElem( '592' );">←</A>
<A href="#svgcats_vml_p593" class="to_next_page" style="margin-top:594px;">▼</A>
<A href="#svgcats_vml_p591" class="to_prev_page" style="margin-top:594px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:605px; width:643px; height:831px;" fillcolor="white"/>
<DIV id="text592_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:622px; line-height:15px; white-space:nowrap">
<A name="WriteVBS_Comment">
WriteVBS_Comment</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:652px; width:472px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text592_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:658px; line-height:15px; white-space:nowrap">
Sub&nbsp; WriteVBS_Comment( Path as string, StartTag as string, EndTag as string,<BR/>
&nbsp; &nbsp; Text as string, Opt as Empty )</DIV>
<DIV id="text592_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:707px; line-height:15px; white-space:nowrap">
VBScript のファイルの中のコメントに、複数行の文字列を書き込みます。</DIV>
<DIV id="text592_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:733px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text592_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:733px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text592_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:752px; line-height:15px; white-space:nowrap">
StartTag</DIV>
<DIV id="text592_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:733px; line-height:15px; white-space:nowrap">
VBScript ファイルのパス、Empty = </DIV>
<DIV id="text592_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:752px; line-height:15px; white-space:nowrap">
VBScript ファイルの中の、書き込みを開始する1つ上の行にあるキーワード</DIV>
<DIV id="text592_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:771px; line-height:15px; white-space:nowrap">
EndTag</DIV>
<DIV id="text592_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:809px; line-height:15px; white-space:nowrap">
Opt</DIV>
<DIV id="text592_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:771px; line-height:15px; white-space:nowrap">
書き込む最後の行の1つ下の行にあるキーワード</DIV>
<DIV id="text592_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:809px; line-height:15px; white-space:nowrap">
Empty を指定してください</DIV>
<DIV id="text592_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:856px; line-height:15px; white-space:nowrap">
StartTag と EndTag に指定したキーワードがヒットしないよう、下記のサンプルにあるように + でつなぐ<BR/>
などの対策をしてください。</DIV>
<DIV id="text592_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1358px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text592_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:1358px; line-height:15px; white-space:nowrap">
→ T_FileInScript.vbs</DIV>
<DIV id="text592_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:208px; margin-top:1358px; line-height:15px; white-space:nowrap">
T_WriteVBS_Comment</DIV>
<DIV id="text592_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:26px; margin-top:1329px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text592_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:87px; margin-top:1329px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text592_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:385px; margin-top:733px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_02.html#ScriptFullName">
WScript.ScriptFullName</A></DIV>
<DIV id="text592_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:790px; line-height:15px; white-space:nowrap">
Text</DIV>
<DIV id="text592_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:790px; line-height:15px; white-space:nowrap">
書き込む文字列。 先頭に ' は不要です</DIV>
<DIV id="text592_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:921px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:973px; width:490px; height:145px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text592_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:979px; line-height:15px; white-space:nowrap">
WriteVBS_Comment&nbsp; Empty, "["+"FileA.txt]", "[/"+"FileA.txt]", _<BR/>
&nbsp; &nbsp; "abc" +vbCRLF+_<BR/>
&nbsp; &nbsp; "DEF" +vbCRLF, Empty<BR/>
<BR/>
'-------------------------------------------------------------------[FileA.txt]<BR/>
'((( これはテキストファイルの代わりです )))<BR/>
'<BR/>
'END<BR/>
'------------------------------------------------------------------[/FileA.txt]</DIV>
<DIV id="text592_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:949px; line-height:15px; white-space:nowrap">
スクリプト（実行前）</DIV>
<DIV id="text592_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:1139px; line-height:15px; white-space:nowrap">
スクリプト（実行後）</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:1163px; width:490px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text592_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:1169px; line-height:15px; white-space:nowrap">
WriteVBS_Comment&nbsp; Empty, "["+"FileA.txt]", "[/"+"FileA.txt]", _<BR/>
&nbsp; &nbsp; "abc" +vbCRLF+_<BR/>
&nbsp; &nbsp; "DEF" +vbCRLF, Empty<BR/>
<BR/>
'-------------------------------------------------------------------[FileA.txt]<BR/>
'abc<BR/>
'DEF<BR/>
'------------------------------------------------------------------[/FileA.txt]</DIV>
<DIV id="text592_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:62px; margin-top:1244px; line-height:15px; white-space:nowrap">
abc<BR/>
DEF</DIV>
<DIV id="text592_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1388px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text592_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:1388px; line-height:15px; white-space:nowrap">
→ ReadVBS_Comment</DIV>

<v:line from="0,605" to="643,605"/>
<v:line from="643,605" to="643,1436"/>
<v:line from="643,1436" to="0,1436"/>
<v:line from="0,1436" to="0,605"/>

</PAGE>
 
<!-- page 593 --> 
<PAGE>
<A id="svgcats_vml_p593" class="to_tree" style="margin-top:1441px;" onClick="selectTreeElem( '593' );">←</A>
<A href="#svgcats_vml_p594" class="to_next_page" style="margin-top:1441px;">▼</A>
<A href="#svgcats_vml_p592" class="to_prev_page" style="margin-top:1441px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1452px; width:630px; height:524px;" fillcolor="white"/>
<DIV id="text593_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1469px; line-height:15px; white-space:nowrap">
<A name="WriteVBSLibHeader">
WriteVBSLibFooter</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:1498px; width:532px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text593_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:1505px; line-height:13px; white-space:nowrap">
Sub&nbsp; WriteVBSLibFooter( OutFileStream as TextStream, Opt as WriteVBSLibFooter_Option )</DIV>
<DIV id="text593_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:1559px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text593_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:1559px; line-height:15px; white-space:nowrap">
OutFileStream</DIV>
<DIV id="text593_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:1559px; line-height:15px; white-space:nowrap">
開いている書き込むファイル</DIV>
<DIV id="text593_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1781px; line-height:15px; white-space:nowrap">
WriteVBSLibFooter_Option</DIV>
<v:rect style="position:absolute; margin-left:40px; margin-top:1810px; width:286px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text593_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:48px; margin-top:1816px; line-height:15px; white-space:nowrap">
Class&nbsp; WriteVBSLibFooter_Option<BR/>
&nbsp; &nbsp; Public&nbsp; CommandPromptMode&nbsp; '// as integer<BR/>
End Class</DIV>
<DIV id="text593_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:1578px; line-height:15px; white-space:nowrap">
Opt</DIV>
<DIV id="text593_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:1578px; line-height:15px; white-space:nowrap">
オプション or Empty</DIV>
<DIV id="text593_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:164px; margin-top:1883px; line-height:15px; white-space:nowrap">
… Empty でないなら g_CommandPrompt の値を変更します</DIV>
<DIV id="text593_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:231px; margin-top:1468px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text593_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:1616px; line-height:15px; white-space:nowrap">
現在実行している、メイン.vbs ファイルの中にある --- start of vbslib include --- 以降を<BR/>
OutFileStream に出力します。<BR/>
--- start of vbslib include --- が Main 関数より前にあるときは、何もしません。</DIV>
<DIV id="text593_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:31px; margin-top:1533px; line-height:15px; white-space:nowrap">
<A href="vbslib_60.html#vbslib_include_f">
vbslib include</A></DIV>
<DIV id="text593_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:117px; margin-top:1533px; line-height:15px; white-space:nowrap">
を出力します。 （メイン.vbs ファイルの最後にするとき）</DIV>
<DIV id="text593_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1928px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text593_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:65px; margin-top:1928px; line-height:15px; white-space:nowrap">
<A href="#WriteVBSLibHeader">
→ WriteVBSLibHeader</A></DIV>
<DIV id="text593_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:41px; margin-top:1885px; line-height:13px; white-space:nowrap">
CommandPromptMode</DIV>
<v:rect style="position:absolute; margin-left:40px; margin-top:1724px; width:196px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text593_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:48px; margin-top:1731px; line-height:13px; white-space:nowrap">
WriteVBSLibFooter&nbsp; file, Empty</DIV>
<DIV id="text593_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1703px; line-height:15px; white-space:nowrap">
サンプル</DIV>

<v:line from="0,1452" to="630,1452"/>
<v:line from="630,1452" to="630,1976"/>
<v:line from="630,1976" to="0,1976"/>
<v:line from="0,1976" to="0,1452"/>

</PAGE>
 
<!-- page 594 --> 
<PAGE>
<A id="svgcats_vml_p594" class="to_tree" style="margin-top:1981px;" onClick="selectTreeElem( '594' );">←</A>
<A href="#svgcats_vml_p595" class="to_next_page" style="margin-top:1981px;">▼</A>
<A href="#svgcats_vml_p593" class="to_prev_page" style="margin-top:1981px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1992px; width:630px; height:335px;" fillcolor="white"/>
<DIV id="text594_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2009px; line-height:15px; white-space:nowrap">
<A name="WriteVBSLibHeader">
WriteVBSLibHeader</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:2038px; width:532px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text594_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:2045px; line-height:13px; white-space:nowrap">
Sub&nbsp; WriteVBSLibHeader( OutFileStream as TextStream, Opt as WriteVBSLibHeader_Option )</DIV>
<DIV id="text594_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:2099px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text594_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:2099px; line-height:15px; white-space:nowrap">
OutFileStream</DIV>
<DIV id="text594_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:2099px; line-height:15px; white-space:nowrap">
開いている書き込むファイル</DIV>
<DIV id="text594_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:29px; margin-top:2219px; line-height:15px; white-space:nowrap">
WriteVBSLibHeader_Option</DIV>
<v:rect style="position:absolute; margin-left:40px; margin-top:2240px; width:202px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text594_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:48px; margin-top:2246px; line-height:15px; white-space:nowrap">
Class&nbsp; WriteVBSLibHeader_Option<BR/>
&nbsp; Public&nbsp; m_OverCommandPrompt<BR/>
End Class</DIV>
<DIV id="text594_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:2118px; line-height:15px; white-space:nowrap">
Opt</DIV>
<DIV id="text594_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:2118px; line-height:15px; white-space:nowrap">
オプション or Empty</DIV>
<DIV id="text594_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:253px; margin-top:2260px; line-height:15px; white-space:nowrap">
… Empty でないなら g_CommandPrompt の値を変更します</DIV>
<DIV id="text594_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:231px; margin-top:2008px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text594_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:2151px; line-height:15px; white-space:nowrap">
現在実行している、メイン.vbs ファイルの中にある --- end of vbslib include --- まで（先頭から）を<BR/>
OutFileStream に出力します。<BR/>
--- start of vbslib include --- が Main 関数より後にあるときは、何もしません。</DIV>
<DIV id="text594_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:31px; margin-top:2073px; line-height:15px; white-space:nowrap">
<A href="vbslib_60.html#vbslib_include_f">
vbslib include</A></DIV>
<DIV id="text594_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:117px; margin-top:2073px; line-height:15px; white-space:nowrap">
を出力します。 （メイン.vbs ファイルの最初にするとき）</DIV>

<v:line from="0,1992" to="630,1992"/>
<v:line from="630,1992" to="630,2327"/>
<v:line from="630,2327" to="0,2327"/>
<v:line from="0,2327" to="0,1992"/>

</PAGE>
 
<!-- page 595 --> 
<PAGE>
<A id="svgcats_vml_p595" class="to_tree" style="margin-top:2332px;" onClick="selectTreeElem( '595' );">←</A>
<A href="#svgcats_vml_p596" class="to_next_page" style="margin-top:2332px;">▼</A>
<A href="#svgcats_vml_p594" class="to_prev_page" style="margin-top:2332px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2343px; width:621px; height:1125px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:47px; margin-top:2816px; width:472px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text595_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:2822px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set&nbsp; file = OpenForReplace( "file1.html", Empty )<BR/>
&nbsp; &nbsp; file.Replace&nbsp; "&lt;TopOfContexts/&gt;", "&lt;TopOfContexts/&gt;"+vbCRLF+ "new Topic"<BR/>
&nbsp; &nbsp; file = Empty</DIV>
<DIV id="text595_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2360px; line-height:15px; white-space:nowrap">
<A name="OpenForReplace">
OpenForReplace</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:2390px; width:520px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text595_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:2397px; line-height:13px; white-space:nowrap">
Function&nbsp; OpenForReplace( SrcPath as string, DstPath as string ) as ReplaceTextFile1</DIV>
<DIV id="text595_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2427px; line-height:15px; white-space:nowrap">
テキストファイルの内容を変更します。</DIV>
<DIV id="text595_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2453px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text595_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2453px; line-height:15px; white-space:nowrap">
SrcPath</DIV>
<DIV id="text595_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2472px; line-height:15px; white-space:nowrap">
DstPath</DIV>
<DIV id="text595_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:169px; margin-top:2453px; line-height:15px; white-space:nowrap">
変更前のテキストファイルのパス</DIV>
<DIV id="text595_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:169px; margin-top:2472px; line-height:15px; white-space:nowrap">
変更後のテキストファイルのパス。 SrcPath と同じ、または Empty 可。</DIV>
<DIV id="text595_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2491px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text595_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:169px; margin-top:2491px; line-height:15px; white-space:nowrap">
<A href="#ReplaceTextFile1">
→ ReplaceTextFile1 クラス</A></DIV>
<DIV id="text595_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:3013px; line-height:15px; white-space:nowrap">
ランダムアクセスに対応しています。 OpenForRead や OpenForWrite のようにシーケンシャル<BR/>
（ファイルの先頭から順番）にアクセスする必要はなく、ReplaceTextFile1::Replace などを<BR/>
任意の順番で呼び出すことができます。</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:2554px; width:328px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text595_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:2560px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set&nbsp; file = OpenForReplace( "file1.txt", Empty )<BR/>
&nbsp; &nbsp; file.Replace&nbsp; "Value = 0", "Value = 1"<BR/>
&nbsp; &nbsp; file = Empty</DIV>
<DIV id="text595_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:3071px; line-height:15px; white-space:nowrap">
DstPath を Empty にすると、DstPath = SrcPath にした時と同じ動きをします。</DIV>
<DIV id="text595_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:253px; margin-top:2561px; line-height:13px; white-space:nowrap">
file1.txt</DIV>
<DIV id="text595_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:169px; margin-top:2576px; line-height:13px; white-space:nowrap">
Value = 0</DIV>
<DIV id="text595_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:247px; margin-top:2576px; line-height:13px; white-space:nowrap">
Value = 1</DIV>
<DIV id="text595_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:3245px; line-height:15px; white-space:nowrap">
→ T_Replace.vbs</DIV>
<DIV id="text595_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3245px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text595_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3280px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text595_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:3280px; line-height:15px; white-space:nowrap">
<A href="vbslib_46.html#OpenForReplaceXML">
→ OpenForReplaceXML</A></DIV>
<DIV id="text595_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:113px; margin-top:2796px; line-height:15px; white-space:nowrap">
TopOfContexts タグの後ろに new Topic を追加する</DIV>
<DIV id="text595_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:113px; margin-top:2534px; line-height:15px; white-space:nowrap">
Value の設定値を 0 から 1 に変える</DIV>
<DIV id="text595_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:2957px; line-height:15px; white-space:nowrap">
変更する内容は、返り値のメソッドに指定します。</DIV>
<DIV id="text595_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:333px; margin-top:2957px; line-height:15px; white-space:nowrap">
<A href="#ReplaceTextFile1">
→ ReplaceTextFile1 クラス</A></DIV>
<DIV id="text595_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:113px; margin-top:2887px; line-height:15px; white-space:nowrap">
タグに囲まれた複数行を変更する</DIV>
<DIV id="text595_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:316px; margin-top:2887px; line-height:15px; white-space:nowrap">
<A href="#ReplaceRange_ReplaceTextFile1">
→ ReplaceRange (ReplaceTextFile1)</A></DIV>
<DIV id="text595_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:3300px; line-height:15px; white-space:nowrap">
<A href="vbslib_26.html#ReadFile">
→ ReadFile</A></DIV>
<DIV id="text595_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:147px; margin-top:3300px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_10.html#Replace">
→ Replace</A></DIV>
<DIV id="text595_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:227px; margin-top:3300px; line-height:15px; white-space:nowrap">
<A href="vbslib_30.html#CreateFile">
→ CreateFile</A></DIV>
<DIV id="text595_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:113px; margin-top:2635px; line-height:15px; white-space:nowrap">
上と同じ内容の短縮形</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:2655px; width:436px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text595_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:2662px; line-height:13px; white-space:nowrap">
OpenForReplace( "file1.txt", Empty ).Replace&nbsp; "Value = 0", "Value = 1"</DIV>
<DIV id="text595_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:157px; margin-top:2662px; line-height:13px; white-space:nowrap">
file1.txt</DIV>
<DIV id="text595_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:337px; margin-top:2662px; line-height:13px; white-space:nowrap">
Value = 0</DIV>
<DIV id="text595_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:415px; margin-top:2662px; line-height:13px; white-space:nowrap">
Value = 1</DIV>
<DIV id="text595_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:3320px; line-height:15px; white-space:nowrap">
<A href="vbslib_05.html#ReplaceSymbols">
→ ReplaceSymbols コマンド</A></DIV>
<DIV id="text595_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:3380px; line-height:15px; white-space:nowrap">
<A href="vbslib_20.html#StringReplaceSetClass">
→ StringReplaceSetClass</A></DIV>
<DIV id="text595_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3222px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text595_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2534px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text595_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2635px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text595_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2796px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text595_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2887px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text595_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2929px; line-height:15px; white-space:nowrap">
補足</DIV>
<DIV id="text595_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:3400px; line-height:15px; white-space:nowrap">
<A href="vbslib_33.html#StartReplace">
→ StartReplace</A></DIV>
<DIV id="text595_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:3222px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text595_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2702px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text595_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:113px; margin-top:2702px; line-height:15px; white-space:nowrap">
文字列を編集することでテキストファイルの内容を変更する</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:2722px; width:388px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text595_48" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:2728px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set&nbsp; file = OpenForReplace( "file1.txt", Empty )<BR/>
&nbsp; &nbsp; file.Text = Replace( file.Text, "Value = 0", "Value = 1" )<BR/>
&nbsp; &nbsp; file = Empty</DIV>
<DIV id="text595_49" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:277px; margin-top:2744px; line-height:13px; white-space:nowrap">
Value = 0</DIV>
<DIV id="text595_50" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:355px; margin-top:2744px; line-height:13px; white-space:nowrap">
Value = 1</DIV>
<DIV id="text595_51" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:253px; margin-top:2729px; line-height:13px; white-space:nowrap">
file1.txt</DIV>
<DIV id="text595_52" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:235px; margin-top:2744px; line-height:13px; white-space:nowrap">
<A href="#Text_ReplaceTextFile1">
Text</A></DIV>
<DIV id="text595_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:2985px; line-height:15px; white-space:nowrap">
変更前が Unicode 形式ファイルのときは、変更後も Unicode 形式ファイルになります。</DIV>
<DIV id="text595_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:3340px; line-height:15px; white-space:nowrap">
<A href="vbslib_06.html#Switches_sth">
→ Switches コマンド</A></DIV>
<DIV id="text595_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:3360px; line-height:15px; white-space:nowrap">
<A href="vbslib_34.html#Translate">
→ Translate コマンド</A></DIV>
<DIV id="text595_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:198px; margin-top:3245px; line-height:15px; white-space:nowrap">
T_OpenForReplace</DIV>
<DIV id="text595_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:3163px; line-height:15px; white-space:nowrap">
返り値のオブジェクトが削除されるタイミングでエラーが発生中（Err.Number &lt;&gt; 0&nbsp; or<BR/>
g_Err2.Number &lt;&gt; 0） のときは、ファイルを作成または更新しません。</DIV>
<DIV id="text595_58" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:3102px; line-height:15px; white-space:nowrap">
重要なファイルを上書き更新するときは、OpenForReplace の DstPath 引数に一時的に<BR/>
出力するパスを指定し、その一時ファイルを作成した後（ファイルを閉じた後）で、</DIV>
<DIV id="text595_59" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:48px; margin-top:3133px; line-height:15px; white-space:nowrap">
<A href="#SafeFileUpdateEx">
SafeFileUpdateEx</A></DIV>
<DIV id="text595_60" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:153px; margin-top:3133px; line-height:15px; white-space:nowrap">
を呼び出してください。 ただし、内部で２〜３回のファイルコピーを行います。&nbsp; </DIV>
<DIV id="text595_61" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:3420px; line-height:15px; white-space:nowrap">
<A href="#SafeFileUpdateEx">
→ SafeFileUpdateEx</A></DIV>
<DIV id="text595_62" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:220px; margin-top:3420px; line-height:15px; white-space:nowrap">
重要なファイルを上書き更新するとき</DIV>
<DIV id="text595_63" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:220px; margin-top:3400px; line-height:15px; white-space:nowrap">
行単位でファイルの一部を置き換える</DIV>

<v:line from="0,2343" to="621,2343"/>
<v:line from="621,2343" to="621,3468"/>
<v:line from="621,3468" to="0,3468"/>
<v:line from="0,3468" to="0,2343"/>

</PAGE>
 
<!-- page 596 --> 
<PAGE>
<A id="svgcats_vml_p596" class="to_tree" style="margin-top:3473px;" onClick="selectTreeElem( '596' );">←</A>
<A href="#svgcats_vml_p597" class="to_next_page" style="margin-top:3473px;">▼</A>
<A href="#svgcats_vml_p595" class="to_prev_page" style="margin-top:3473px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3484px; width:440px; height:300px;" fillcolor="white"/>
<DIV id="text596_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3501px; line-height:15px; white-space:nowrap">
<A name="ReplaceTextFile1">
ReplaceTextFile1 クラス</A></DIV>
<DIV id="text596_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:24px; margin-top:3692px; line-height:13px; white-space:nowrap">
<A href="#Replace_ReplaceTextFile1">
.Replace</A></DIV>
<DIV id="text596_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:225px; margin-top:3501px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text596_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:120px; margin-top:3690px; line-height:15px; white-space:nowrap">
テキストを置き換えます。</DIV>
<DIV id="text596_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:120px; margin-top:3737px; line-height:15px; white-space:nowrap">
テキストファイルの内容の変更を完了します。</DIV>
<DIV id="text596_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:24px; margin-top:3739px; line-height:13px; white-space:nowrap">
<A href="#Close_ReplaceTextFile1">
.Close</A></DIV>
<DIV id="text596_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:103px; margin-top:3593px; line-height:15px; white-space:nowrap">
<A href="#OpenForReplace">
→ OpenForReplace</A></DIV>
<DIV id="text596_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3593px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text596_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:24px; margin-top:3715px; line-height:13px; white-space:nowrap">
<A href="#ReplaceRange_ReplaceTextFile1">
.ReplaceRange</A></DIV>
<DIV id="text596_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:120px; margin-top:3713px; line-height:15px; white-space:nowrap">
指定のタグで囲まれたテキストを置き換えます。</DIV>
<DIV id="text596_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3622px; line-height:15px; white-space:nowrap">
取得</DIV>
<DIV id="text596_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:103px; margin-top:3622px; line-height:15px; white-space:nowrap">
<A href="#OpenForReplace">
→ OpenForReplace</A></DIV>
<DIV id="text596_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3535px; line-height:15px; white-space:nowrap">
テキストを置き換えます。<BR/>
指定のタグで囲まれたテキストを置き換えます。</DIV>
<DIV id="text596_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:24px; margin-top:3669px; line-height:13px; white-space:nowrap">
<A href="#Text_ReplaceTextFile1">
.Text</A></DIV>
<DIV id="text596_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:120px; margin-top:3667px; line-height:15px; white-space:nowrap">
編集中のファイルの内容。</DIV>

<v:line from="0,3484" to="440,3484"/>
<v:line from="440,3484" to="440,3784"/>
<v:line from="440,3784" to="0,3784"/>
<v:line from="0,3784" to="0,3484"/>

</PAGE>
 
<!-- page 597 --> 
<PAGE>
<A id="svgcats_vml_p597" class="to_tree" style="margin-top:3789px;" onClick="selectTreeElem( '597' );">←</A>
<A href="#svgcats_vml_p598" class="to_next_page" style="margin-top:3789px;">▼</A>
<A href="#svgcats_vml_p596" class="to_prev_page" style="margin-top:3789px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3800px; width:493px; height:337px;" fillcolor="white"/>
<DIV id="text597_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3817px; line-height:15px; white-space:nowrap">
<A name="Text_ReplaceTextFile1">
Text (ReplaceTextFile1) (OpenForReplace)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:3847px; width:238px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text597_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:3854px; line-height:13px; white-space:nowrap">
Dim&nbsp; ReplaceTextFile1::Text as string</DIV>
<DIV id="text597_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3884px; line-height:15px; white-space:nowrap">
編集中のファイルの内容。</DIV>
<DIV id="text597_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3912px; line-height:15px; white-space:nowrap">
この内容を直接変更することで、ファイルの内容を変更することができます。</DIV>
<DIV id="text597_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4047px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text597_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:4047px; line-height:15px; white-space:nowrap">
→ T_Replace.vbs</DIV>
<DIV id="text597_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:198px; margin-top:4047px; line-height:15px; white-space:nowrap">
T_OpenForReplaceText</DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:3969px; width:316px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text597_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:3975px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set rep = OpenForReplace( "file1.txt", Empty )<BR/>
&nbsp; &nbsp; rep.Text = Replace( rep.Text, "from", "to" )<BR/>
&nbsp; &nbsp; rep = Empty</DIV>
<DIV id="text597_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3949px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text597_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:4071px; line-height:15px; white-space:nowrap">
<A href="vbslib_21.html#FindStringLines">
→ FindStringLines</A></DIV>
<DIV id="text597_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4071px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text597_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:4089px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_08.html#RegExp_Replace">
→ Replace (RegExp)</A></DIV>

<v:line from="0,3800" to="493,3800"/>
<v:line from="493,3800" to="493,4137"/>
<v:line from="493,4137" to="0,4137"/>
<v:line from="0,4137" to="0,3800"/>

</PAGE>
 
<!-- page 598 --> 
<PAGE>
<A id="svgcats_vml_p598" class="to_tree" style="margin-top:4142px;" onClick="selectTreeElem( '598' );">←</A>
<A href="#svgcats_vml_p599" class="to_next_page" style="margin-top:4142px;">▼</A>
<A href="#svgcats_vml_p597" class="to_prev_page" style="margin-top:4142px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4153px; width:605px; height:542px;" fillcolor="white"/>
<DIV id="text598_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4170px; line-height:15px; white-space:nowrap">
<A name="Replace_ReplaceTextFile1">
Replace (ReplaceTextFile1)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:4200px; width:436px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text598_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:4207px; line-height:13px; white-space:nowrap">
Sub&nbsp; ReplaceTextFile1::Replace( FromText as string, ToText as string )</DIV>
<DIV id="text598_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4237px; line-height:15px; white-space:nowrap">
テキストを置き換えます。</DIV>
<DIV id="text598_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4263px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text598_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4263px; line-height:15px; white-space:nowrap">
FromText</DIV>
<DIV id="text598_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4282px; line-height:15px; white-space:nowrap">
ToText</DIV>
<DIV id="text598_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:170px; margin-top:4263px; line-height:15px; white-space:nowrap">
置き換える前のテキスト、または VBScript.RegExp</DIV>
<DIV id="text598_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:170px; margin-top:4282px; line-height:15px; white-space:nowrap">
置き換えた後のテキスト</DIV>
<DIV id="text598_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4408px; line-height:15px; white-space:nowrap">
置き換えた後のテキストが存在するときは、置き換えを行いません。<BR/>
これは、VBS の Replace 関数と結果が異なりますが、追加的な置き換えをしたときに、多重的に<BR/>
追加されることがなくなります。</DIV>
<DIV id="text598_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:4473px; line-height:15px; white-space:nowrap">
例：</DIV>
<v:rect style="position:absolute; margin-left:67px; margin-top:4468px; width:232px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text598_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:75px; margin-top:4475px; line-height:13px; white-space:nowrap">
f.Replace&nbsp; "a = 0",&nbsp; "a = 0 : b = 0"</DIV>
<DIV id="text598_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:75px; margin-top:4513px; line-height:15px; white-space:nowrap">
置き換える前</DIV>
<DIV id="text598_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:202px; margin-top:4513px; line-height:15px; white-space:nowrap">
置き換えた後</DIV>
<DIV id="text598_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:82px; margin-top:4543px; line-height:13px; white-space:nowrap">
a = 0</DIV>
<DIV id="text598_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:209px; margin-top:4543px; line-height:13px; white-space:nowrap">
a = 0 : b = 0</DIV>
<DIV id="text598_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:82px; margin-top:4563px; line-height:13px; white-space:nowrap">
a = 0 : b = 0</DIV>
<DIV id="text598_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:209px; margin-top:4563px; line-height:13px; white-space:nowrap">
a = 0 : b = 0</DIV>
<v:line style="position:absolute;" from="67,4532" to="565,4532" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text598_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:312px; margin-top:4563px; line-height:13px; white-space:nowrap">
… [a = 0 : b = 0 : b = 0] にはなりません</DIV>
<DIV id="text598_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:322px; margin-top:4473px; line-height:15px; white-space:nowrap">
a = 0 の後に b = 0 を追加する</DIV>
<DIV id="text598_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:307px; margin-top:4172px; line-height:12px; white-space:nowrap">
<A href="#ReplaceTextFile1">
[ 親: ReplaceTextFile1 クラス ]</A></DIV>
<DIV id="text598_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4626px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text598_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:4626px; line-height:15px; white-space:nowrap">
→ T_Replace.vbs</DIV>
<DIV id="text598_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:251px; margin-top:4648px; line-height:15px; white-space:nowrap">
T_OpenForReplaceCharSet</DIV>
<DIV id="text598_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:121px; margin-top:4648px; line-height:15px; white-space:nowrap">
T_OpenForReplace</DIV>
<DIV id="text598_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:4599px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text598_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4599px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text598_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:33px; margin-top:4317px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_08.html#RegExp">
VBScript.RegExp</A></DIV>
<DIV id="text598_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:135px; margin-top:4317px; line-height:15px; white-space:nowrap">
を FromText 引数に指定すると、パターンマッチングにより置き換え対象を</DIV>
<DIV id="text598_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4334px; line-height:15px; white-space:nowrap">
検索します。 ToText は、</DIV>
<DIV id="text598_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:176px; margin-top:4334px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_08.html#RegExp_Replace">
RegExp::Replace</A></DIV>
<DIV id="text598_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:271px; margin-top:4334px; line-height:15px; white-space:nowrap">
と同様に、$1 などを指定することもできます。</DIV>
<DIV id="text598_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:419px; margin-top:4648px; line-height:15px; white-space:nowrap">
T_OpenForReplaceRegExp</DIV>
<DIV id="text598_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:4360px; line-height:15px; white-space:nowrap">
例：</DIV>
<v:rect style="position:absolute; margin-left:67px; margin-top:4355px; width:502px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text598_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:75px; margin-top:4362px; line-height:13px; white-space:nowrap">
OpenForReplace( "file1.txt", Empty ).Replace&nbsp; new_RegExp( "from.*", False ), "to"</DIV>
<DIV id="text598_36" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:351px; margin-top:4362px; line-height:13px; white-space:nowrap">
<A href="vbslib_21.html#new_RegExp">
new_RegExp</A></DIV>
<DIV id="text598_37" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:75px; margin-top:4362px; line-height:13px; white-space:nowrap">
<A href="#OpenForReplace">
OpenForReplace</A></DIV>

<v:line from="0,4153" to="605,4153"/>
<v:line from="605,4153" to="605,4695"/>
<v:line from="605,4695" to="0,4695"/>
<v:line from="0,4695" to="0,4153"/>

</PAGE>
 
<!-- page 599 --> 
<PAGE>
<A id="svgcats_vml_p599" class="to_tree" style="margin-top:4700px;" onClick="selectTreeElem( '599' );">←</A>
<A href="#svgcats_vml_p600" class="to_next_page" style="margin-top:4700px;">▼</A>
<A href="#svgcats_vml_p598" class="to_prev_page" style="margin-top:4700px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4711px; width:601px; height:741px;" fillcolor="white"/>
<DIV id="text599_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4728px; line-height:15px; white-space:nowrap">
<A name="ReplaceRange_ReplaceTextFile1">
ReplaceRange (ReplaceTextFile1)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:4758px; width:544px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:4764px; line-height:15px; white-space:nowrap">
Sub&nbsp; ReplaceTextFile1::ReplaceRange( StartOfFromText as string, EndOfFromText as string,<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ToText as string )</DIV>
<DIV id="text599_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4810px; line-height:15px; white-space:nowrap">
指定のタグで囲まれたテキストを置き換えます。</DIV>
<DIV id="text599_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4836px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text599_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4836px; line-height:15px; white-space:nowrap">
StartOfFromText</DIV>
<DIV id="text599_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4855px; line-height:15px; white-space:nowrap">
EndOfFromText</DIV>
<DIV id="text599_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:211px; margin-top:4836px; line-height:15px; white-space:nowrap">
置き換える前のテキストが始まる場所にあるタグ（テキスト）</DIV>
<DIV id="text599_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:211px; margin-top:4855px; line-height:15px; white-space:nowrap">
置き換える前のテキストが終わる場所にあるタグ（テキスト）</DIV>
<DIV id="text599_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:211px; margin-top:4874px; line-height:15px; white-space:nowrap">
置き換えた後のテキスト。 通常、タグも含む。</DIV>
<DIV id="text599_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4874px; line-height:15px; white-space:nowrap">
ToText</DIV>
<DIV id="text599_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5098px; line-height:15px; white-space:nowrap">
置き換えサンプル</DIV>
<DIV id="text599_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:43px; margin-top:5125px; line-height:13px; white-space:nowrap">
StartOfFromText = "&lt;Tag&gt;", EndOfFromText = "&lt;/Tag&gt;" とします。</DIV>
<DIV id="text599_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:211px; margin-top:5175px; line-height:13px; white-space:nowrap">
ToText</DIV>
<DIV id="text599_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:43px; margin-top:5175px; line-height:13px; white-space:nowrap">
置き換える前</DIV>
<DIV id="text599_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:357px; margin-top:5175px; line-height:13px; white-space:nowrap">
置き換えた後</DIV>
<v:rect style="position:absolute; margin-left:35px; margin-top:5204px; width:136px; height:19px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:43px; margin-top:5208px; line-height:13px; white-space:nowrap">
abc&lt;Tag&gt;123&lt;/Tag&gt;def</DIV>
<v:rect style="position:absolute; margin-left:203px; margin-top:5204px; width:100px; height:19px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:211px; margin-top:5208px; line-height:13px; white-space:nowrap">
&lt;Tag&gt;456&lt;/Tag&gt;</DIV>
<v:rect style="position:absolute; margin-left:346px; margin-top:5204px; width:136px; height:19px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:354px; margin-top:5208px; line-height:13px; white-space:nowrap">
abc&lt;Tag&gt;456&lt;/Tag&gt;def</DIV>
<v:line style="position:absolute;" from="26,5194" to="527,5194" strokecolor="#000000" strokeweight="1pt"/>
<v:rect style="position:absolute; margin-left:35px; margin-top:5234px; width:136px; height:19px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:43px; margin-top:5238px; line-height:13px; white-space:nowrap">
abc&lt;Tag&gt;123&lt;/Tag&gt;def</DIV>
<v:rect style="position:absolute; margin-left:203px; margin-top:5234px; width:34px; height:19px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:211px; margin-top:5238px; line-height:13px; white-space:nowrap">
456</DIV>
<v:rect style="position:absolute; margin-left:346px; margin-top:5234px; width:70px; height:19px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:354px; margin-top:5238px; line-height:13px; white-space:nowrap">
abc456def</DIV>
<v:rect style="position:absolute; margin-left:35px; margin-top:5264px; width:52px; height:64px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:43px; margin-top:5267px; line-height:15px; white-space:nowrap">
&lt;Tag&gt;<BR/>
123<BR/>
456<BR/>
&lt;/Tag&gt;</DIV>
<v:rect style="position:absolute; margin-left:203px; margin-top:5264px; width:52px; height:49px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:211px; margin-top:5267px; line-height:15px; white-space:nowrap">
&lt;Tag&gt;<BR/>
789<BR/>
&lt;/Tag&gt;</DIV>
<v:rect style="position:absolute; margin-left:346px; margin-top:5264px; width:52px; height:49px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:354px; margin-top:5267px; line-height:15px; white-space:nowrap">
&lt;Tag&gt;<BR/>
789<BR/>
&lt;/Tag&gt;</DIV>
<v:line style="position:absolute;" from="323,5173" to="323,5333" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4951px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:4976px; width:388px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_28" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:4982px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set&nbsp; file = OpenForReplace( "file1.html", Empty )<BR/>
&nbsp; &nbsp; file.ReplaceRange&nbsp; "&lt;NewTopic&gt;", "&lt;/NewTopic&gt;", _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "&lt;NewTopic&gt;"+vbCRLF+ "new Topic" +vbCRLF+"&lt;/NewTopic&gt;"<BR/>
&nbsp; &nbsp; file = Empty</DIV>
<DIV id="text599_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5382px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text599_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:5382px; line-height:15px; white-space:nowrap">
→ T_Replace.vbs</DIV>
<DIV id="text599_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:5405px; line-height:15px; white-space:nowrap">
<A href="vbslib_26.html#ReadFileInTag">
→ ReadFileInTag</A></DIV>
<DIV id="text599_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5405px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text599_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4907px; line-height:15px; white-space:nowrap">
置き換える範囲は、複数行であってもかまいません。</DIV>
<DIV id="text599_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:307px; margin-top:4730px; line-height:12px; white-space:nowrap">
<A href="#ReplaceTextFile1">
[ 親: ReplaceTextFile1 クラス ]</A></DIV>
<v:line style="position:absolute;" from="178,5215" to="199,5215" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="199,5215" to="188,5211" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="199,5215" to="188,5219" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="312,5215" to="336,5215" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="336,5215" to="325,5211" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="336,5215" to="325,5219" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text599_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:198px; margin-top:5382px; line-height:15px; white-space:nowrap">
T_OpenForReplaceRange</DIV>
<DIV id="text599_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:5359px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text599_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5359px; line-height:15px; white-space:nowrap">
ソース</DIV>

<v:line from="0,4711" to="601,4711"/>
<v:line from="601,4711" to="601,5452"/>
<v:line from="601,5452" to="0,5452"/>
<v:line from="0,5452" to="0,4711"/>

</PAGE>
 
<!-- page 600 --> 
<PAGE>
<A id="svgcats_vml_p600" class="to_tree" style="margin-top:5457px;" onClick="selectTreeElem( '600' );">←</A>
<A href="#svgcats_vml_p601" class="to_next_page" style="margin-top:5457px;">▼</A>
<A href="#svgcats_vml_p599" class="to_prev_page" style="margin-top:5457px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5468px; width:494px; height:160px;" fillcolor="white"/>
<DIV id="text600_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5485px; line-height:15px; white-space:nowrap">
<A name="Close_ReplaceTextFile1">
Close (ReplaceTextFile1)</A></DIV>
<DIV id="text600_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5580px; line-height:15px; white-space:nowrap">
デストラクタから自動的に呼ばれますが、明示的に呼び出すこともできます。</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:5515px; width:196px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text600_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:5522px; line-height:13px; white-space:nowrap">
Sub&nbsp; ReplaceTextFile1::Close()</DIV>
<DIV id="text600_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5552px; line-height:15px; white-space:nowrap">
テキストファイルの内容の変更を完了します。</DIV>
<DIV id="text600_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:198px; margin-top:5485px; line-height:15px; white-space:nowrap">
<A href="#ReplaceTextFile1">
→ ReplaceTextFile1 クラス</A></DIV>

<v:line from="0,5468" to="494,5468"/>
<v:line from="494,5468" to="494,5628"/>
<v:line from="494,5628" to="0,5628"/>
<v:line from="0,5628" to="0,5468"/>

</PAGE>
 
<!-- page 601 --> 
<PAGE>
<A id="svgcats_vml_p601" class="to_tree" style="margin-top:5633px;" onClick="selectTreeElem( '601' );">←</A>
<A href="#svgcats_vml_p602" class="to_next_page" style="margin-top:5633px;">▼</A>
<A href="#svgcats_vml_p600" class="to_prev_page" style="margin-top:5633px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5644px; width:478px; height:160px;" fillcolor="white"/>
<DIV id="text601_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5661px; line-height:15px; white-space:nowrap">
<A name="IsSaveInTerminate_ReplaceTextFile1">
IsSaveInTerminate (ReplaceTextFile1)</A></DIV>
<DIV id="text601_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:288px; margin-top:5661px; line-height:15px; white-space:nowrap">
<A href="#ReplaceTextFile1">
→ ReplaceTextFile1 クラス</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:5691px; width:376px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text601_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:5698px; line-height:13px; white-space:nowrap">
Dim&nbsp; ReplaceTextFile1::IsSaveInTerminate as boolean or Empty</DIV>
<DIV id="text601_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5728px; line-height:15px; white-space:nowrap">
オブジェクトが削除されるタイミングで保存するかどうか。</DIV>
<DIV id="text601_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5756px; line-height:15px; white-space:nowrap">
Empty のときは、エラーが発生している状態でなければ保存します。</DIV>

<v:line from="0,5644" to="478,5644"/>
<v:line from="478,5644" to="478,5804"/>
<v:line from="478,5804" to="0,5804"/>
<v:line from="0,5804" to="0,5644"/>

</PAGE>
 
<!-- page 602 --> 
<PAGE>
<A id="svgcats_vml_p602" class="to_tree" style="margin-top:5809px;" onClick="selectTreeElem( '602' );">←</A>
<A href="#svgcats_vml_p603" class="to_next_page" style="margin-top:5809px;">▼</A>
<A href="#svgcats_vml_p601" class="to_prev_page" style="margin-top:5809px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5820px; width:640px; height:867px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:39px; margin-top:6038px; width:340px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text602_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:6044px; line-height:15px; white-space:nowrap">
temporary_path = "FileA.txt.updating"<BR/>
CreateFile&nbsp; temporary_path, "新情報！"<BR/>
SafeFileUpdateEx&nbsp; temporary_path,&nbsp; "FileA.txt",&nbsp; Empty</DIV>
<DIV id="text602_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5837px; line-height:15px; white-space:nowrap">
<A name="SafeFileUpdateEx">
SafeFileUpdateEx</A></DIV>
<v:rect style="position:absolute; margin-left:22px; margin-top:5866px; width:586px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text602_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:30px; margin-top:5873px; line-height:13px; white-space:nowrap">
Sub&nbsp; SafeFileUpdateEx( TemporaryFilePath as string,&nbsp; ToFilePath as string,&nbsp; Option_ as string )</DIV>
<DIV id="text602_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:5906px; line-height:15px; white-space:nowrap">
ファイルを安全に更新します。 上書き移動します。</DIV>
<DIV id="text602_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:5933px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text602_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:100px; margin-top:5933px; line-height:15px; white-space:nowrap">
TemporaryFilePath</DIV>
<DIV id="text602_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:100px; margin-top:5952px; line-height:15px; white-space:nowrap">
ToFilePath</DIV>
<DIV id="text602_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:5933px; line-height:15px; white-space:nowrap">
新しい内容が書かれた削除する一時ファイルのパス</DIV>
<DIV id="text602_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:5952px; line-height:15px; white-space:nowrap">
更新するファイルのパス</DIV>
<DIV id="text602_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:100px; margin-top:5971px; line-height:15px; white-space:nowrap">
Option_</DIV>
<DIV id="text602_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:5971px; line-height:15px; white-space:nowrap">
Empty、または、g_VBS_Lib.ToTrashBox</DIV>
<DIV id="text602_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6262px; line-height:15px; white-space:nowrap">
SafeFileUpdate を呼び出している途中で、ファイルの更新やバックアップなどに失敗<BR/>
したら、エラーが発生しますが、ファイルの内容は、消えることなく、元に戻ります。 <BR/>
ただし、新しい内容は保存できていないので、エラー復帰して、別のディスクに保存<BR/>
できるようにしてください。</DIV>
<DIV id="text602_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6008px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text602_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:6104px; line-height:15px; white-space:nowrap">
FileA.txt の内容を、"新情報！" という内容に更新します。<BR/>
一時的に存在するファイル temporary_path に、新しい内容を出力する必要があります。<BR/>
SafeFileUpdateEx を呼び出した後は、temporary_path の場所にファイルは無くなります。</DIV>
<DIV id="text602_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6170px; line-height:15px; white-space:nowrap">
更新するファイルを直接開いてライトするプログラムの場合、ライトしている途中で、<BR/>
容量不足になったり、接続できなくなったりしてエラーになると、更新する前の内容<BR/>
が消えてしまいます。 それだけでなく、更新した後の内容も保存できない可能性が<BR/>
あります。 その場合、ファイルに格納していた情報がすべて消えてしまいます。 <BR/>
SafeFileUpdate は、そのリスクを回避します。</DIV>
<DIV id="text602_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:78px; margin-top:6615px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text602_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6615px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text602_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6365px; line-height:15px; white-space:nowrap">
Option_ = g_VBS_Lib.ToTrashBox を指定すると、</DIV>
<DIV id="text602_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:294px; margin-top:6365px; line-height:15px; white-space:nowrap">
<A href="#SafeFileUpdate">
SafeFileUpdate</A></DIV>
<DIV id="text602_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:387px; margin-top:6365px; line-height:15px; white-space:nowrap">
と同じ動きになります。</DIV>
<DIV id="text602_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6639px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text602_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:73px; margin-top:6639px; line-height:15px; white-space:nowrap">
→ T_SafeCopy.vbs</DIV>
<DIV id="text602_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6497px; line-height:15px; white-space:nowrap">
また、一時的に存在するファイル（一時ファイル）のパスは、出力するファイルのパスの最後に<BR/>
updating という拡張子を追加したパスに標準化すれば、ファイルの上書き保存に失敗した<BR/>
という状況が推測しやすくなります。 また、拡張子を変更することで、不完全なファイルを<BR/>
アプリケーションに渡さないようになります。</DIV>
<DIV id="text602_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:343px; margin-top:6444px; line-height:15px; white-space:nowrap">
<A href="vbslib_30.html#AppKeyClass_NewWritable">
AppKeyClass::NewWritable</A></DIV>
<DIV id="text602_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6461px; line-height:15px; white-space:nowrap">
を使う必要がなくなります。</DIV>
<DIV id="text602_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:215px; margin-top:6060px; line-height:13px; white-space:nowrap">
"新情報！"</DIV>
<DIV id="text602_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:257px; margin-top:6075px; line-height:13px; white-space:nowrap">
"FileA.txt"</DIV>
<DIV id="text602_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:194px; margin-top:6639px; line-height:15px; white-space:nowrap">
T_SafeFileUpdate</DIV>
<DIV id="text602_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6408px; line-height:15px; white-space:nowrap">
<A name="updating">
拡張子 .updating</A></DIV>
<DIV id="text602_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:395px; margin-top:6045px; line-height:15px; white-space:nowrap">
<A href="#updating">
→ 拡張子 .updating</A></DIV>
<DIV id="text602_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6444px; line-height:15px; white-space:nowrap">
新しい内容を書くファイルの拡張子を .updating にすると、</DIV>
<v:rect style="position:absolute; margin-left:67px; margin-top:6569px; width:316px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text602_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:75px; margin-top:6576px; line-height:13px; white-space:nowrap">
SafeFileUpdateEx&nbsp; path +".updating",&nbsp; path,&nbsp; Empty</DIV>
<DIV id="text602_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:40px; margin-top:6574px; line-height:15px; white-space:nowrap">
例：</DIV>
<DIV id="text602_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6339px; line-height:15px; white-space:nowrap">
内部でファイルのコピーを２〜３回行います。</DIV>

<v:line from="0,5820" to="640,5820"/>
<v:line from="640,5820" to="640,6687"/>
<v:line from="640,6687" to="0,6687"/>
<v:line from="0,6687" to="0,5820"/>

</PAGE>
 
<!-- page 603 --> 
<PAGE>
<A id="svgcats_vml_p603" class="to_tree" style="margin-top:6692px;" onClick="selectTreeElem( '603' );">←</A>
<A href="#svgcats_vml_p604" class="to_next_page" style="margin-top:6692px;">▼</A>
<A href="#svgcats_vml_p602" class="to_prev_page" style="margin-top:6692px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6703px; width:505px; height:288px;" fillcolor="white"/>
<DIV id="text603_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6720px; line-height:15px; white-space:nowrap">
<A name="SafeFileUpdate">
SafeFileUpdate</A></DIV>
<v:rect style="position:absolute; margin-left:22px; margin-top:6749px; width:436px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text603_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:30px; margin-top:6756px; line-height:13px; white-space:nowrap">
Sub&nbsp; SafeFileUpdate( FromTmpFilePath as string, ToFilePath as string )</DIV>
<DIV id="text603_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:6789px; line-height:15px; white-space:nowrap">
ファイルを安全に更新します。 上書き移動して、元の内容はゴミ箱に入ります。</DIV>
<DIV id="text603_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:6816px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text603_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:100px; margin-top:6816px; line-height:15px; white-space:nowrap">
FromTmpFilePath</DIV>
<DIV id="text603_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:100px; margin-top:6835px; line-height:15px; white-space:nowrap">
ToFilePath</DIV>
<DIV id="text603_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:6816px; line-height:15px; white-space:nowrap">
新しい内容が書かれたファイルのパス</DIV>
<DIV id="text603_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:6835px; line-height:15px; white-space:nowrap">
更新するファイルのパス</DIV>
<DIV id="text603_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6898px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text603_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:73px; margin-top:6898px; line-height:15px; white-space:nowrap">
→ T_SafeCopy.vbs # [T_SafeFileUpdate]</DIV>
<DIV id="text603_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6927px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text603_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:6944px; line-height:15px; white-space:nowrap">
<A href="#new_IsSafeFileUpdateStack">
→ new_IsSafeFileUpdateStack</A></DIV>
<DIV id="text603_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:78px; margin-top:6869px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text603_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6869px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text603_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:73px; margin-top:6927px; line-height:15px; white-space:nowrap">
<A href="#SafeFileUpdateEx">
→ SafeFileUpdateEx</A></DIV>

<v:line from="0,6703" to="505,6703"/>
<v:line from="505,6703" to="505,6991"/>
<v:line from="505,6991" to="0,6991"/>
<v:line from="0,6991" to="0,6703"/>

</PAGE>
 
<!-- page 604 --> 
<PAGE>
<A id="svgcats_vml_p604" class="to_tree" style="margin-top:6996px;" onClick="selectTreeElem( '604' );">←</A>
<A href="#svgcats_vml_p605" class="to_next_page" style="margin-top:6996px;">▼</A>
<A href="#svgcats_vml_p603" class="to_prev_page" style="margin-top:6996px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7007px; width:588px; height:636px;" fillcolor="white"/>
<DIV id="text604_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7024px; line-height:15px; white-space:nowrap">
<A name="ConvertToFullPath">
ConvertToFullPath</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:7055px; width:436px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text604_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:7062px; line-height:13px; white-space:nowrap">
Sub&nbsp; ConvertToFullPath( SrcFilePath as string, DstFilePath as string )</DIV>
<DIV id="text604_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:7248px; line-height:13px; white-space:nowrap">
%FullPath(..\SampleLib)%</DIV>
<DIV id="text604_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7091px; line-height:15px; white-space:nowrap">
テキストファイルの中の相対パスや特殊フォルダのパスをフル・パスに変換してコピーします。</DIV>
<DIV id="text604_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:7214px; line-height:15px; white-space:nowrap">
変換前</DIV>
<DIV id="text604_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:261px; margin-top:7214px; line-height:15px; white-space:nowrap">
変換後の例</DIV>
<DIV id="text604_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:261px; margin-top:7248px; line-height:13px; white-space:nowrap">
C:\folder\SampleLib</DIV>
<DIV id="text604_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:7292px; line-height:13px; white-space:nowrap">
%DesktopPath%</DIV>
<DIV id="text604_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:261px; margin-top:7293px; line-height:13px; white-space:nowrap">
C:\Documents and Settings\user1\デスクトップ</DIV>
<DIV id="text604_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:7116px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text604_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:101px; margin-top:7116px; line-height:15px; white-space:nowrap">
SrcFilePath</DIV>
<DIV id="text604_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:101px; margin-top:7135px; line-height:15px; white-space:nowrap">
DstFilePath</DIV>
<DIV id="text604_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:200px; margin-top:7116px; line-height:15px; white-space:nowrap">
変換前のファイルのパス</DIV>
<DIV id="text604_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:200px; margin-top:7135px; line-height:15px; white-space:nowrap">
変換後のファイルのパス（新規作成または上書き）, Empty不可</DIV>
<DIV id="text604_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:186px; margin-top:7024px; line-height:15px; white-space:nowrap">
(src)</DIV>
<v:line style="position:absolute;" from="33,7236" to="543,7236" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text604_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:7328px; line-height:15px; white-space:nowrap">
DstFilePath 引数が指すファイルが入ったフォルダーを、相対パスの基準にしたフル・<BR/>
パスに変換します。 <BR/>
基準を SrcFilePath ではなく DstFilePath にしている理由は、１つのテンプレート的な<BR/>
ファイル(SrcFilePath) に対して、複数の場所(DstFilePath) で使用することができるように<BR/>
するためです。</DIV>
<DIV id="text604_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:65px; margin-top:7571px; line-height:15px; white-space:nowrap">
→ TextFileConvertFormat::Set_</DIV>
<DIV id="text604_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7571px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text604_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7595px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text604_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7474px; line-height:15px; white-space:nowrap">
Unicode ファイルにするときは、次のように設定してから ConvertToFullPath を呼んでください。</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:7498px; width:352px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text604_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:7504px; line-height:15px; white-space:nowrap">
Dim&nbsp; c : Set c = g_VBS_Lib<BR/>
Dim&nbsp; cs : Set cs = new_TextFileCharSetStack( c.Unicode )<BR/>
ConvertToFullPath&nbsp; "ans.txt", "ans_tmp.txt"</DIV>
<DIV id="text604_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:7270px; line-height:13px; white-space:nowrap">
%FullPath(.)%</DIV>
<DIV id="text604_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:261px; margin-top:7271px; line-height:13px; white-space:nowrap">
C:\folder\current</DIV>
<DIV id="text604_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:7595px; line-height:15px; white-space:nowrap">
→ T_ConvAbs.vbs # ConvertToFullPath</DIV>
<DIV id="text604_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:62px; margin-top:7432px; line-height:15px; white-space:nowrap">
<A href="#PercentFunction">
→ % を使った変換式</A></DIV>
<DIV id="text604_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7432px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text604_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7171px; line-height:15px; white-space:nowrap">
テキストファイルの中に書かれた %FullPath( )% などの % % で囲まれた部分を置き換えます。</DIV>
<DIV id="text604_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7328px; line-height:15px; white-space:nowrap">
(*1)</DIV>
<DIV id="text604_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:389px; margin-top:7246px; line-height:15px; white-space:nowrap">
(*1)</DIV>
<DIV id="text604_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:389px; margin-top:7269px; line-height:15px; white-space:nowrap">
(*1)</DIV>

<v:line from="0,7007" to="588,7007"/>
<v:line from="588,7007" to="588,7643"/>
<v:line from="588,7643" to="0,7643"/>
<v:line from="0,7643" to="0,7007"/>

</PAGE>
 
<!-- page 605 --> 
<PAGE>
<A id="svgcats_vml_p605" class="to_tree" style="margin-top:7648px;" onClick="selectTreeElem( '605' );">←</A>
<A href="#svgcats_vml_p606" class="to_next_page" style="margin-top:7648px;">▼</A>
<A href="#svgcats_vml_p604" class="to_prev_page" style="margin-top:7648px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7659px; width:579px; height:1085px;" fillcolor="white"/>
<DIV id="text605_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7676px; line-height:15px; white-space:nowrap">
<A name="PercentFunction">
% を使った文字列変換関数</A></DIV>
<DIV id="text605_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:93px; margin-top:7961px; line-height:13px; white-space:nowrap">
%FullPath(..\SampleLib)%</DIV>
<DIV id="text605_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:7927px; line-height:15px; white-space:nowrap">
変換前の例</DIV>
<DIV id="text605_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:261px; margin-top:7927px; line-height:15px; white-space:nowrap">
変換後の例</DIV>
<DIV id="text605_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:261px; margin-top:7961px; line-height:13px; white-space:nowrap">
C:\folder\SampleLib</DIV>
<DIV id="text605_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:93px; margin-top:8005px; line-height:13px; white-space:nowrap">
%DesktopPath%</DIV>
<DIV id="text605_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:261px; margin-top:8006px; line-height:13px; white-space:nowrap">
C:\Documents and Settings\user1\デスクトップ</DIV>
<v:line style="position:absolute;" from="21,7949" to="543,7949" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text605_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7714px; line-height:15px; white-space:nowrap">
vbslib の提供するいくつかの関数の中で、% を使った文字列変換関数が使えます。<BR/>
% を使った環境変数も展開されます。</DIV>
<DIV id="text605_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:93px; margin-top:7983px; line-height:13px; white-space:nowrap">
%FullPath(.)%</DIV>
<DIV id="text605_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:261px; margin-top:7984px; line-height:13px; white-space:nowrap">
C:\folder\current</DIV>
<DIV id="text605_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:93px; margin-top:8223px; line-height:15px; white-space:nowrap">
<A href="#ConvertToFullPath">
ConvertToFullPath</A></DIV>
<DIV id="text605_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:93px; margin-top:8162px; line-height:15px; white-space:nowrap">
<A href="vbslib_27.html#IsSameTextFile">
IsSameTextFile</A></DIV>
<DIV id="text605_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:188px; margin-top:8162px; line-height:15px; white-space:nowrap">
の c.RightHasPercentFunction</DIV>
<DIV id="text605_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:8126px; line-height:15px; white-space:nowrap">
(*1)</DIV>
<DIV id="text605_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:8204px; line-height:15px; white-space:nowrap">
(*2)</DIV>
<DIV id="text605_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7927px; line-height:15px; white-space:nowrap">
(*1)</DIV>
<DIV id="text605_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:51px; margin-top:7927px; line-height:15px; white-space:nowrap">
(*2)</DIV>
<DIV id="text605_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:7959px; line-height:15px; white-space:nowrap">
○</DIV>
<DIV id="text605_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:7959px; line-height:15px; white-space:nowrap">
○</DIV>
<DIV id="text605_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:8047px; line-height:15px; white-space:nowrap">
×</DIV>
<DIV id="text605_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:8047px; line-height:15px; white-space:nowrap">
○</DIV>
<DIV id="text605_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:7981px; line-height:15px; white-space:nowrap">
○</DIV>
<DIV id="text605_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:7981px; line-height:15px; white-space:nowrap">
○</DIV>
<DIV id="text605_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:8003px; line-height:15px; white-space:nowrap">
○</DIV>
<DIV id="text605_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:8003px; line-height:15px; white-space:nowrap">
○</DIV>
<DIV id="text605_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:93px; margin-top:8049px; line-height:13px; white-space:nowrap">
%RegExp(.*)%</DIV>
<DIV id="text605_28" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:261px; margin-top:8049px; line-height:13px; white-space:nowrap">
正規表現にマッチする任意の文字列</DIV>
<DIV id="text605_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:8126px; line-height:15px; white-space:nowrap">
比較対象も指定する関数で使えるかどうか。</DIV>
<DIV id="text605_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:8146px; line-height:15px; white-space:nowrap">
例：</DIV>
<DIV id="text605_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:8223px; line-height:15px; white-space:nowrap">
例：</DIV>
<DIV id="text605_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:8203px; line-height:15px; white-space:nowrap">
比較対象を指定しない関数で使えるかどうか。</DIV>
<DIV id="text605_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7771px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:7803px; width:130px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text605_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:7809px; line-height:15px; white-space:nowrap">
ABC<BR/>
***%FullPath(.)%***<BR/>
***%RegExp(.*)%***</DIV>
<v:rect style="position:absolute; margin-left:275px; margin-top:7803px; width:118px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text605_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:283px; margin-top:7809px; line-height:15px; white-space:nowrap">
ABC<BR/>
***C:\FolderA***<BR/>
***01234567879***</DIV>
<DIV id="text605_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:208px; margin-top:7809px; line-height:15px; white-space:nowrap">
展開</DIV>
<v:line style="position:absolute;" from="186,7831" to="261,7831" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="261,7831" to="250,7827" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="261,7831" to="250,7835" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text605_38" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:93px; margin-top:8071px; line-height:13px; white-space:nowrap">
%MultiLine%</DIV>
<DIV id="text605_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:8069px; line-height:15px; white-space:nowrap">
×</DIV>
<DIV id="text605_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:8069px; line-height:15px; white-space:nowrap">
○</DIV>
<DIV id="text605_41" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:261px; margin-top:8071px; line-height:13px; white-space:nowrap">
複数行にマッチする (*4)</DIV>
<DIV id="text605_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:8342px; line-height:15px; white-space:nowrap">
(*4)</DIV>
<DIV id="text605_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7892px; line-height:15px; white-space:nowrap">
関数一覧</DIV>
<DIV id="text605_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:8342px; line-height:15px; white-space:nowrap">
%MultiLine% は、任意の複数行とマッチします。<BR/>
また、%MultiLine% の直後にテキスト（%を使った関数可能）を置くと、その複数行が<BR/>
マッチするかどうかをチェックします。</DIV>
<v:rect style="position:absolute; margin-left:85px; margin-top:8404px; width:82px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text605_45" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:93px; margin-top:8410px; line-height:15px; white-space:nowrap">
start<BR/>
%MultiLine%<BR/>
end</DIV>
<v:rect style="position:absolute; margin-left:277px; margin-top:8404px; width:46px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text605_46" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:285px; margin-top:8410px; line-height:15px; white-space:nowrap">
start<BR/>
Line1<BR/>
Line2<BR/>
Line3<BR/>
end</DIV>
<DIV id="text605_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:210px; margin-top:8410px; line-height:15px; white-space:nowrap">
展開</DIV>
<v:line style="position:absolute;" from="188,8432" to="263,8432" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="263,8432" to="252,8428" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="263,8432" to="252,8436" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="265,8549" to="340,8549" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="340,8549" to="329,8545" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="340,8549" to="329,8553" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text605_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:287px; margin-top:8527px; line-height:15px; white-space:nowrap">
展開</DIV>
<v:rect style="position:absolute; margin-left:354px; margin-top:8521px; width:82px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text605_51" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:362px; margin-top:8527px; line-height:15px; white-space:nowrap">
start<BR/>
C:\FolderA&gt;<BR/>
C:\FolderA&gt;<BR/>
C:\FolderA&gt;<BR/>
end</DIV>
<v:rect style="position:absolute; margin-left:85px; margin-top:8521px; width:166px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text605_52" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:93px; margin-top:8527px; line-height:15px; white-space:nowrap">
start<BR/>
%MultiLine%%FullPath(.)%&gt;<BR/>
end</DIV>
<DIV id="text605_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:93px; margin-top:8146px; line-height:15px; white-space:nowrap">
<A href="vbslib_57.html#AssertFC">
AssertFC</A></DIV>
<DIV id="text605_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8624px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text605_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:8642px; line-height:15px; white-space:nowrap">
→ URL にプレースホルダーを含める</DIV>
<DIV id="text605_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:8660px; line-height:15px; white-space:nowrap">
<A href="vbslib_20.html#sscanf">
→ sscanf</A></DIV>
<DIV id="text605_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:24px; margin-top:8701px; line-height:12px; white-space:nowrap">
キーワード：</DIV>
<DIV id="text605_58" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#000000; margin-left:98px; margin-top:8701px; line-height:12px; white-space:nowrap">
<A name="percent_FullPath">
%FullPath(.)%, %RegExp(.*)%, %MultiLine%, %DesktopPath%</A></DIV>
<DIV id="text605_59" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:468px; margin-top:8047px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_08.html#RegExp">
→ 正規表現</A></DIV>
<DIV id="text605_60" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:93px; margin-top:8027px; line-height:13px; white-space:nowrap">
%Env(USERPROFILE)%</DIV>
<DIV id="text605_61" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:8025px; line-height:15px; white-space:nowrap">
○</DIV>
<DIV id="text605_62" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:8025px; line-height:15px; white-space:nowrap">
○</DIV>
<DIV id="text605_63" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:261px; margin-top:8027px; line-height:13px; white-space:nowrap">
環境変数 USERPROFILE の値</DIV>
<DIV id="text605_64" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:8624px; line-height:15px; white-space:nowrap">
<A href="vbslib_14.html#LazyDictionaryClass">
→ ${ } 変数, LazyDictionaryClass</A></DIV>
<DIV id="text605_65" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:8268px; line-height:15px; white-space:nowrap">
%FullPath(x)% の x に相対パスを指定したときの基準フォルダーは、%FullPath(x)% を<BR/>
記述したファイルがあるフォルダーです。</DIV>
<DIV id="text605_66" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:381px; margin-top:7961px; line-height:13px; white-space:nowrap">
(*3)</DIV>
<DIV id="text605_67" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:8268px; line-height:15px; white-space:nowrap">
(*3)</DIV>
<DIV id="text605_68" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:62px; margin-top:8301px; line-height:15px; white-space:nowrap">
<A href="#ConvertToFullPath">
→ ConvertToFullPath</A></DIV>
<DIV id="text605_69" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:381px; margin-top:7982px; line-height:15px; white-space:nowrap">
<A href="#ConvertToFullPath">
→ ConvertToFullPath</A></DIV>

<v:line from="0,7659" to="579,7659"/>
<v:line from="579,7659" to="579,8744"/>
<v:line from="579,8744" to="0,8744"/>
<v:line from="0,8744" to="0,7659"/>

</PAGE>
 
<!-- page 606 --> 
<PAGE>
<A id="svgcats_vml_p606" class="to_tree" style="margin-top:8749px;" onClick="selectTreeElem( '606' );">←</A>
<A href="#svgcats_vml_p607" class="to_next_page" style="margin-top:8749px;">▼</A>
<A href="#svgcats_vml_p605" class="to_prev_page" style="margin-top:8749px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8760px; width:631px; height:412px;" fillcolor="white"/>
<DIV id="text606_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8777px; line-height:15px; white-space:nowrap">
<A name="ParsePercentVariableString">
ParsePercentVariableString</A></DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:8983px; width:472px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text606_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:8989px; line-height:15px; white-space:nowrap">
ParsePercentVariableString&nbsp; "abc %VAR1%, %VAR2% def", sub_strings, variables<BR/>
Assert&nbsp; IsSameArray( sub_strings, Array( "abc ", ", ", " def" ) )<BR/>
Assert&nbsp; IsSameArray( variables, Array( "%VAR1%", "%VAR2%" ) )</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:8807px; width:574px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text606_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:8813px; line-height:15px; white-space:nowrap">
Sub&nbsp; ParsePercentVariableString( the_String as string, out_SubStringArray as array of string,<BR/>
&nbsp; &nbsp; out_VariableArray as array of string )</DIV>
<DIV id="text606_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8861px; line-height:15px; white-space:nowrap">
文字列の中の % を使った変数の部分とそれ以外の部分に分割します。</DIV>
<DIV id="text606_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8887px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text606_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:8887px; line-height:15px; white-space:nowrap">
the_String</DIV>
<DIV id="text606_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:8906px; line-height:15px; white-space:nowrap">
out_SubStringArray</DIV>
<DIV id="text606_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:226px; margin-top:8887px; line-height:15px; white-space:nowrap">
分割する前の文字列</DIV>
<DIV id="text606_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:226px; margin-top:8906px; line-height:15px; white-space:nowrap">
変数以外の部分の配列</DIV>
<DIV id="text606_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:8925px; line-height:15px; white-space:nowrap">
out_VariableArray</DIV>
<DIV id="text606_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:226px; margin-top:8925px; line-height:15px; white-space:nowrap">
変数の部分の配列</DIV>
<DIV id="text606_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8960px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text606_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9061px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text606_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9103px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text606_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:9103px; line-height:15px; white-space:nowrap">
<A href="vbslib_20.html#ScanFromTemplate">
→ ScanFromTemplate</A></DIV>
<DIV id="text606_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:75px; margin-top:9061px; line-height:15px; white-space:nowrap">
→ ToolsLib.vbs</DIV>
<DIV id="text606_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:75px; margin-top:9082px; line-height:15px; white-space:nowrap">
→ T_Str.vbs</DIV>
<DIV id="text606_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9082px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text606_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:9082px; line-height:15px; white-space:nowrap">
T_ParseDollarVariableString</DIV>
<DIV id="text606_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:9124px; line-height:15px; white-space:nowrap">
<A href="vbslib_15.html#ParseDollarVariableString">
→ ParseDollarVariableString</A></DIV>

<v:line from="0,8760" to="631,8760"/>
<v:line from="631,8760" to="631,9172"/>
<v:line from="631,9172" to="0,9172"/>
<v:line from="0,9172" to="0,8760"/>

</PAGE>
 
<!-- page 607 --> 
<PAGE>
<A id="svgcats_vml_p607" class="to_tree" style="margin-top:9177px;" onClick="selectTreeElem( '607' );">←</A>
<A href="vbslib_33.html#svgcats_vml_p608" class="to_next_page" style="margin-top:9177px;">▼</A>
<A href="#svgcats_vml_p606" class="to_prev_page" style="margin-top:9177px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9188px; width:627px; height:1168px;" fillcolor="white"/>
<DIV id="text607_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9205px; line-height:15px; white-space:nowrap">
<A name="ReplaceStringTemplate">
ReplaceStringTemplate</A></DIV>
<DIV id="text607_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10174px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text607_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:82px; margin-top:10174px; line-height:15px; white-space:nowrap">
→ ToolsLib.vbs</DIV>
<DIV id="text607_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10196px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text607_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:82px; margin-top:10196px; line-height:15px; white-space:nowrap">
→ T_fc.vbs</DIV>
<DIV id="text607_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:169px; margin-top:10196px; line-height:15px; white-space:nowrap">
T_ReplaceStringTemplate</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:9235px; width:508px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text607_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:9241px; line-height:15px; white-space:nowrap">
Sub&nbsp; ReplaceStringTemplate( FolderPath as string, RegularExpressionPart as string,<BR/>
&nbsp; &nbsp; TemplateBefore as string, TemplateAfter as string, Opt as Empty )</DIV>
<DIV id="text607_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9290px; line-height:15px; white-space:nowrap">
テキストファイルの中をキーワードで検索し、テンプレートを置き換えます。</DIV>
<DIV id="text607_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9316px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text607_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9316px; line-height:15px; white-space:nowrap">
FolderPath</DIV>
<DIV id="text607_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9335px; line-height:15px; white-space:nowrap">
RegularExpressionPart</DIV>
<DIV id="text607_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:9316px; line-height:15px; white-space:nowrap">
検索対象フォルダーやワイルドカード</DIV>
<DIV id="text607_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9354px; line-height:15px; white-space:nowrap">
TemplateBefore</DIV>
<DIV id="text607_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:9354px; line-height:15px; white-space:nowrap">
置き換える前のテンプレート（複数行可）</DIV>
<DIV id="text607_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9392px; line-height:15px; white-space:nowrap">
Opt</DIV>
<DIV id="text607_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:9392px; line-height:15px; white-space:nowrap">
オプション、または、Empty</DIV>
<DIV id="text607_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:9335px; line-height:15px; white-space:nowrap">
置き換える前のキーワード。複数行不可</DIV>
<DIV id="text607_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:483px; margin-top:9335px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_08.html#RegExp">
→ 正規表現</A></DIV>
<DIV id="text607_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:244px; margin-top:9373px; line-height:15px; white-space:nowrap">
置き換えた後のテンプレート（複数行可）</DIV>
<DIV id="text607_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9373px; line-height:15px; white-space:nowrap">
TemplateAfter</DIV>
<DIV id="text607_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10224px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text607_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:10258px; line-height:15px; white-space:nowrap">
<A href="..\replicmp.files\replicmp_02.html#PartRep">
→ PartRep</A></DIV>
<DIV id="text607_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:10241px; line-height:15px; white-space:nowrap">
<A href="vbslib_30.html#SearchStringTemplate">
→ SearchStringTemplate</A></DIV>
<DIV id="text607_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:10094px; line-height:15px; white-space:nowrap">
テンプレートの中に次の予約変数を記述することができます。</DIV>
<DIV id="text607_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:67px; margin-top:10125px; line-height:13px; white-space:nowrap">
${FileName}</DIV>
<DIV id="text607_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:175px; margin-top:10123px; line-height:15px; white-space:nowrap">
ファイル名に置き換わります</DIV>
<DIV id="text607_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9484px; line-height:15px; white-space:nowrap">
置き換えた後のテンプレートにある変数が、置き換える前のテンプレートにないときは、<BR/>
変数のまま残ります。 ただし、Opt 引数に dictionary 型を指定して、変数に一致する<BR/>
キーに対応した値に置き換えることもできます。</DIV>
<v:rect style="position:absolute; margin-left:59px; margin-top:9723px; width:154px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text607_28" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:67px; margin-top:9729px; line-height:15px; white-space:nowrap">
@param&nbsp; &nbsp;${Arguments}<BR/>
@return&nbsp; ${RerutnValue}</DIV>
<DIV id="text607_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9677px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:274px; margin-top:9723px; width:160px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text607_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:282px; margin-top:9729px; line-height:15px; white-space:nowrap">
関数名： ${FunctionName}<BR/>
引数：&nbsp; &nbsp;${Arguments}<BR/>
返り値： ${RerutnValue}<BR/>
補足：&nbsp; &nbsp;${Note}</DIV>
<DIV id="text607_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:9703px; line-height:15px; white-space:nowrap">
TemplateBefore</DIV>
<DIV id="text607_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:258px; margin-top:9703px; line-height:15px; white-space:nowrap">
TemplateAfter</DIV>
<v:line style="position:absolute;" from="227,9743" to="254,9743" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="254,9743" to="243,9739" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="254,9743" to="243,9747" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text607_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:9808px; line-height:15px; white-space:nowrap">
のように指定した場合、FolderPath にマッチしたあるファイルの内容は、次のように変化します。</DIV>
<v:rect style="position:absolute; margin-left:59px; margin-top:9835px; width:160px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text607_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:67px; margin-top:9841px; line-height:15px; white-space:nowrap">
@param&nbsp; &nbsp;First Parameter<BR/>
@return&nbsp; None</DIV>
<v:line style="position:absolute;" from="233,9855" to="260,9855" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="260,9855" to="249,9851" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="260,9855" to="249,9859" strokecolor="#000000" strokeweight="1pt"/>
<v:rect style="position:absolute; margin-left:274px; margin-top:9835px; width:160px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text607_37" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:282px; margin-top:9841px; line-height:15px; white-space:nowrap">
関数名： ${FunctionName}<BR/>
引数：&nbsp; &nbsp;First Parameter<BR/>
返り値： None<BR/>
補足：&nbsp; &nbsp;</DIV>
<DIV id="text607_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10065px; line-height:15px; white-space:nowrap">
予約変数</DIV>
<DIV id="text607_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9543px; line-height:15px; white-space:nowrap">
RegularExpressionPart 引数に指定するキーワードは、TemplateBefore に含まれるキーワードを<BR/>
正規表現で指定します。 キーワードは、TemplateAfter に含まれていなくても構いません。 <BR/>
この引数を使って内部で高速なファイル検索が行われます。 <BR/>
"" を指定すると、すべてのファイルに対して置き換えを試みます。</DIV>
<DIV id="text607_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:9961px; line-height:15px; white-space:nowrap">
ただし、Opt 引数に次のように指定したものとします。</DIV>
<v:rect style="position:absolute; margin-left:59px; margin-top:9984px; width:184px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text607_41" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:67px; margin-top:9991px; line-height:13px; white-space:nowrap">
Dict(Array( "${Note}", "" ))</DIV>
<DIV id="text607_42" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:67px; margin-top:9991px; line-height:13px; white-space:nowrap">
<A href="vbslib_15.html#Dict">
Dict</A></DIV>
<DIV id="text607_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:10275px; line-height:15px; white-space:nowrap">
<A href="vbslib_30.html#GetLineNumOfTemplateDifference">
→ GetLineNumOfTemplateDifference</A></DIV>
<DIV id="text607_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:455px; margin-top:9316px; line-height:15px; white-space:nowrap">
<A href="vbslib_29.html#Execute_GrepClass">
→ Execute (GrepClass)</A></DIV>
<DIV id="text607_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:10224px; line-height:15px; white-space:nowrap">
<A href="vbslib_33.html#RunReplace_ReplaceTemplateClass">
→ RunReplace (ReplaceTemplateClass)</A></DIV>
<DIV id="text607_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:10292px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_10.html#Replace">
→ Replace</A></DIV>
<DIV id="text607_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:82px; margin-top:10309px; line-height:15px; white-space:nowrap">
<A href="vbslib_14.html#LazyDictionaryClass">
→ ${ } 変数, LazyDictionaryClass</A></DIV>
<DIV id="text607_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9440px; line-height:15px; white-space:nowrap">
TemplateBefore に指定した変数（${ … } の部分）は、TemplateAfter に指定した ${ … } の<BR/>
部分に入ります。</DIV>
<DIV id="text607_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9617px; line-height:15px; white-space:nowrap">
Opt 引数には、Empty か、辞書型で変数のデフォルト値を指定できます。 TemplateBefore に<BR/>
ない変数が TemplateAfter にあるときは、その変数をここで指定した値に置き換えます。</DIV>
<DIV id="text607_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:9926px; line-height:15px; white-space:nowrap">
以上のテンプレートは、XML ファイルに記述することができます。</DIV>
<DIV id="text607_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:415px; margin-top:9926px; line-height:15px; white-space:nowrap">
<A href="vbslib_33.html#new_ReplaceTemplateClass">
→ new_ReplaceTemplateClass</A></DIV>
<DIV id="text607_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:102px; margin-top:9677px; line-height:15px; white-space:nowrap">
テンプレートのサンプル</DIV>

<v:line from="0,9188" to="627,9188"/>
<v:line from="627,9188" to="627,10356"/>
<v:line from="627,10356" to="0,10356"/>
<v:line from="0,10356" to="0,9188"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10356px;">
<A id="svgcats_vml_p607" class="to_tree" onClick="selectTreeElem( '607' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10356px;">
<A id="page_group_bottom" href="vbslib_33.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
