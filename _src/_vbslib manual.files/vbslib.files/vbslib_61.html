<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>vbslib</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbslib.files/vbslib_61.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbslib.files/vbslib_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbslib.files/vbslib_61.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 1146 --> 
<PAGE>
<A id="svgcats_vml_p1146" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '1146' );">←</A>
<A href="#svgcats_vml_p1147" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbslib_60.html#svgcats_vml_p1145" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbslib_60.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:609px; height:453px;" fillcolor="white"/>
<DIV id="text1146_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="main2">
main2</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:45px; width:340px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1146_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:52px; line-height:13px; white-space:nowrap">
Sub&nbsp; main2( Opt as dictionary, AppKey as AppKeyClass )</DIV>
<DIV id="text1146_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:77px; line-height:15px; white-space:nowrap">
vbslib を使うスクリプトは、main2 から内容を記述します。</DIV>
<DIV id="text1146_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:313px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:334px; width:316px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1146_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:340px; line-height:15px; white-space:nowrap">
Sub&nbsp; main2( Opt, AppKey )<BR/>
&nbsp; Dim w_:Set w_=AppKey.NewWritable( "." ).Enable()<BR/>
<BR/>
&nbsp; echo "Hello, world!"<BR/>
End Sub</DIV>
<DIV id="text1146_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:145px; line-height:15px; white-space:nowrap">
ユーザ定義関数です。<BR/>
<BR/>
ファイルを出力するスクリプトは、出力するフォルダを、下記サンプルの NewWritable の引数に<BR/>
指定することで、出力して良いかユーザに確認しなくなります。 ただし、Windows フォルダや<BR/>
Program Files フォルダなどは必ず確認します。</DIV>
<DIV id="text1146_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:185px; margin-top:356px; line-height:13px; white-space:nowrap">
<A href="vbslib_30.html#AppKeyClass_NewWritable">
NewWritable</A></DIV>
<DIV id="text1146_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:321px; margin-top:302px; text-align: center; line-height:15px; white-space:nowrap">
にファイルを出力できるようにする</DIV>
<DIV id="text1146_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:207px; margin-top:302px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#path_syntax">
カレント・フォルダー</A></DIV>
<DIV id="text1146_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:236px; line-height:15px; white-space:nowrap">
main 関数が呼ばれるときのカレント・フォルダーは、スクリプトがあるフォルダーになります。 <BR/>
WSH を起動したときのカレント・フォルダー（作業フォルダー）は、</DIV>
<DIV id="text1146_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:474px; margin-top:251px; line-height:15px; white-space:nowrap">
に入っています。</DIV>
<DIV id="text1146_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:388px; margin-top:251px; line-height:15px; white-space:nowrap">
<A href="#g_start_in_path">
g_start_in_path</A></DIV>
<DIV id="text1146_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:269px; margin-top:317px; line-height:15px; white-space:nowrap">
↓</DIV>
<DIV id="text1146_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:31px; margin-top:114px; line-height:15px; white-space:nowrap">
廃止予定です。 main を使ってください。</DIV>
<DIV id="text1146_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:477px; margin-top:17px; line-height:15px; white-space:nowrap">
<A href="vbslib_60.html#vbs_inc">
&lt;&lt; vbs_inc</A></DIV>

<v:line from="0,0" to="609,0"/>
<v:line from="609,0" to="609,453"/>
<v:line from="609,453" to="0,453"/>
<v:line from="0,453" to="0,0"/>

</PAGE>
 
<!-- page 1147 --> 
<PAGE>
<A id="svgcats_vml_p1147" class="to_tree" style="margin-top:458px;" onClick="selectTreeElem( '1147' );">←</A>
<A href="#svgcats_vml_p1148" class="to_next_page" style="margin-top:458px;">▼</A>
<A href="#svgcats_vml_p1146" class="to_prev_page" style="margin-top:458px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:469px; width:564px; height:416px;" fillcolor="white"/>
<DIV id="text1147_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:486px; line-height:15px; white-space:nowrap">
<A name="SetupVbslibParameters">
SetupVbslibParameters</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:516px; width:184px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1147_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:523px; line-height:13px; white-space:nowrap">
Sub&nbsp; SetupVbslibParameters()</DIV>
<DIV id="text1147_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:553px; line-height:15px; white-space:nowrap">
vbslib include の設定をします。</DIV>
<DIV id="text1147_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:581px; line-height:15px; white-space:nowrap">
ユーザー定義関数です。 通常、メイン・スクリプト・ファイルの最後にあります。</DIV>
<DIV id="text1147_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:632px; line-height:15px; white-space:nowrap">
<A href="#g_debug">
→ g_debug</A></DIV>
<DIV id="text1147_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:231px; margin-top:632px; line-height:15px; white-space:nowrap">
<A href="#g_debug_process">
→ g_debug_process</A></DIV>
<DIV id="text1147_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:127px; margin-top:632px; line-height:15px; white-space:nowrap">
<A href="#g_debug_tree">
→ g_debug_tree</A></DIV>
<DIV id="text1147_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:609px; line-height:15px; white-space:nowrap">
次の変数を設定できます。</DIV>
<DIV id="text1147_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:694px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:720px; width:490px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1147_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:726px; line-height:15px; white-space:nowrap">
Sub&nbsp; SetupVbslibParameters()<BR/>
&nbsp; &nbsp; '--- start of parameters for vbslib include -------------------------------<BR/>
&nbsp; &nbsp; '// g_Vers("OldMain") = 1<BR/>
&nbsp; &nbsp; g_vbslib_path = "scriptlib\vbs_inc.vbs"<BR/>
&nbsp; &nbsp; g_CommandPrompt = 2<BR/>
&nbsp; &nbsp; g_debug = 0<BR/>
&nbsp; &nbsp; '--- end of parameters for vbslib include ---------------------------------<BR/>
End Sub</DIV>
<DIV id="text1147_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:152px; margin-top:650px; line-height:15px; white-space:nowrap">
<A href="#g_CommandPrompt">
→ g_CommandPrompt</A></DIV>
<DIV id="text1147_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:50px; margin-top:650px; line-height:15px; white-space:nowrap">
<A href="#g_vbslib_path">
→ g_vbslib_path</A></DIV>
<DIV id="text1147_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:74px; margin-top:787px; line-height:13px; white-space:nowrap">
<A href="#g_CommandPrompt">
g_CommandPrompt</A></DIV>
<DIV id="text1147_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:74px; margin-top:772px; line-height:13px; white-space:nowrap">
<A href="#g_vbslib_path">
g_vbslib_path</A></DIV>
<DIV id="text1147_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:74px; margin-top:802px; line-height:13px; white-space:nowrap">
<A href="#g_debug">
g_debug</A></DIV>
<DIV id="text1147_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:416px; margin-top:486px; line-height:15px; white-space:nowrap">
<A href="vbslib_60.html#vbs_inc">
&lt;&lt; vbs_inc</A></DIV>

<v:line from="0,469" to="564,469"/>
<v:line from="564,469" to="564,885"/>
<v:line from="564,885" to="0,885"/>
<v:line from="0,885" to="0,469"/>

</PAGE>
 
<!-- page 1148 --> 
<PAGE>
<A id="svgcats_vml_p1148" class="to_tree" style="margin-top:890px;" onClick="selectTreeElem( '1148' );">←</A>
<A href="#svgcats_vml_p1149" class="to_next_page" style="margin-top:890px;">▼</A>
<A href="#svgcats_vml_p1147" class="to_prev_page" style="margin-top:890px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:901px; width:479px; height:216px;" fillcolor="white"/>
<DIV id="text1148_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:918px; line-height:15px; white-space:nowrap">
<A name="g_fs">
g_fs</A></DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:950px; width:262px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1148_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:957px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_fs&nbsp; as&nbsp; Scripting.FileSystemObject</DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:1060px; width:418px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1148_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:1067px; line-height:13px; white-space:nowrap">
Dim g_fs : Set&nbsp; g_fs = CreateObject( "Scripting.FileSystemObject" )</DIV>
<DIV id="text1148_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:986px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_05.html#FileSystemObject">
FileSystemObject</A></DIV>
<DIV id="text1148_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:110px; margin-top:918px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1148_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:22px; margin-top:1039px; line-height:15px; white-space:nowrap">
実装コード：</DIV>
<DIV id="text1148_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:143px; margin-top:986px; line-height:15px; white-space:nowrap">
を参照するグローバル変数です。</DIV>
<DIV id="text1148_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:364px; margin-top:918px; line-height:15px; white-space:nowrap">
<A href="vbslib_60.html#vbs_inc">
&lt;&lt; vbs_inc</A></DIV>

<v:line from="0,901" to="479,901"/>
<v:line from="479,901" to="479,1117"/>
<v:line from="479,1117" to="0,1117"/>
<v:line from="0,1117" to="0,901"/>

</PAGE>
 
<!-- page 1149 --> 
<PAGE>
<A id="svgcats_vml_p1149" class="to_tree" style="margin-top:1122px;" onClick="selectTreeElem( '1149' );">←</A>
<A href="#svgcats_vml_p1150" class="to_next_page" style="margin-top:1122px;">▼</A>
<A href="#svgcats_vml_p1148" class="to_prev_page" style="margin-top:1122px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1133px; width:449px; height:202px;" fillcolor="white"/>
<DIV id="text1149_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1150px; line-height:15px; white-space:nowrap">
<A name="g_sh">
g_sh</A></DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:1182px; width:184px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1149_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:1189px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_sh&nbsp; as&nbsp; WScript.Shell</DIV>
<DIV id="text1149_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:1246px; line-height:13px; white-space:nowrap">
vbs_inc.vbs をインクルードした後に使えます。</DIV>
<v:rect style="position:absolute; margin-left:29px; margin-top:1278px; width:388px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1149_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:37px; margin-top:1285px; line-height:13px; white-space:nowrap">
Dim g_sh : Set&nbsp; g_sh = WScript.CreateObject( "WScript.Shell" )</DIV>
<DIV id="text1149_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:1220px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_02.html#WScript_Shell">
→ WScript.Shell オブジェクト (WshShell オブジェクト)</A></DIV>
<DIV id="text1149_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:110px; margin-top:1150px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1149_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:348px; margin-top:1150px; line-height:15px; white-space:nowrap">
<A href="vbslib_60.html#vbs_inc">
&lt;&lt; vbs_inc</A></DIV>

<v:line from="0,1133" to="449,1133"/>
<v:line from="449,1133" to="449,1335"/>
<v:line from="449,1335" to="0,1335"/>
<v:line from="0,1335" to="0,1133"/>

</PAGE>
 
<!-- page 1150 --> 
<PAGE>
<A id="svgcats_vml_p1150" class="to_tree" style="margin-top:1340px;" onClick="selectTreeElem( '1150' );">←</A>
<A href="#svgcats_vml_p1151" class="to_next_page" style="margin-top:1340px;">▼</A>
<A href="#svgcats_vml_p1149" class="to_prev_page" style="margin-top:1340px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1351px; width:183px; height:80px;" fillcolor="white"/>
<DIV id="text1150_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1368px; line-height:15px; white-space:nowrap">
<A name="debug_g">
動作モード、デバッグ</A></DIV>

<v:line from="0,1351" to="183,1351"/>
<v:line from="183,1351" to="183,1431"/>
<v:line from="183,1431" to="0,1431"/>
<v:line from="0,1431" to="0,1351"/>

</PAGE>
 
<!-- page 1151 --> 
<PAGE>
<A id="svgcats_vml_p1151" class="to_tree" style="margin-top:1436px;" onClick="selectTreeElem( '1151' );">←</A>
<A href="#svgcats_vml_p1152" class="to_next_page" style="margin-top:1436px;">▼</A>
<A href="#svgcats_vml_p1150" class="to_prev_page" style="margin-top:1436px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1447px; width:581px; height:443px;" fillcolor="white"/>
<DIV id="text1151_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1464px; line-height:15px; white-space:nowrap">
<A name="g_debug">
g_debug</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:1492px; width:160px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1151_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:1499px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_debug&nbsp; as integer</DIV>
<DIV id="text1151_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:1531px; line-height:15px; white-space:nowrap">
デバッガに接続しているかどうか（するかどうか）。 何番目のエラーでブレークするか。</DIV>
<DIV id="text1151_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:63px; margin-top:1706px; line-height:15px; white-space:nowrap">
<A href="vbslib_64.html#debug">
→ g_debug - デバッグを開始する</A></DIV>
<DIV id="text1151_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:126px; margin-top:1464px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1151_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:406px; margin-top:1550px; line-height:15px; white-space:nowrap">
にユーザが記述します。</DIV>
<DIV id="text1151_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:1550px; line-height:15px; white-space:nowrap">
g_debug は、</DIV>
<DIV id="text1151_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:1579px; line-height:15px; white-space:nowrap">
0 = デバッガに接続しない<BR/>
1 = デバッガに接続する、BreakErrID = 1<BR/>
1.5 = デバッガに接続する、BreakErrID = 1.5<BR/>
2 = デバッガに接続する、BreakErrID = 2<BR/>
：<BR/>
-1 = デバッガに接続しないが、</DIV>
<DIV id="text1151_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:63px; margin-top:1726px; line-height:15px; white-space:nowrap">
<A href="vbslib_63.html#Err2_BreakErrID">
→ Err2::BreakErrID</A></DIV>
<DIV id="text1151_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1706px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text1151_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:1804px; line-height:15px; white-space:nowrap">
<A href="..\vbslib_test2.files\vbslib_test2_02.html#T_ErrInfo">
→ [T_ErrInfo] ユーザへのエラー通知とデバッガ接続</A></DIV>
<DIV id="text1151_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1804px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text1151_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:1823px; line-height:15px; white-space:nowrap">
<A href="..\vbslib_test2.files\vbslib_test2_02.html#T_Err2">
→ [T_Err2] Err2 オブジェクトとデバッガーのテスト</A></DIV>
<DIV id="text1151_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:45px; margin-top:1670px; line-height:15px; white-space:nowrap">
99 など大きい数 = デバッガに接続する（エラーが発生しないとき）</DIV>
<DIV id="text1151_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:222px; margin-top:1654px; line-height:15px; white-space:nowrap">
<A href="vbslib_65.html#SetupDebugTools">
SetupDebugTools</A></DIV>
<DIV id="text1151_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:321px; margin-top:1654px; line-height:15px; white-space:nowrap">
を呼び出す。</DIV>
<DIV id="text1151_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:63px; margin-top:1746px; line-height:15px; white-space:nowrap">
<A href="vbslib_64.html#err_break">
→ エラーが発生した瞬間のスクリプト内部の様子を調べる</A></DIV>
<DIV id="text1151_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:1842px; line-height:15px; white-space:nowrap">
<A href="..\vbslib_test2.files\vbslib_test2_01.html#T_StartFromOther">
→ [T_StartFromOther] スクリプトが無いフォルダーから起動したとき</A></DIV>
<DIV id="text1151_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:266px; margin-top:1550px; line-height:15px; white-space:nowrap">
<A href="#SetupVbslibParameters">
SetupVbslibParameters</A></DIV>
<DIV id="text1151_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:212px; margin-top:1550px; line-height:15px; white-space:nowrap">
もしくは、</DIV>
<DIV id="text1151_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:99px; margin-top:1550px; line-height:15px; white-space:nowrap">
<A href="vbslib_64.html#g_debug_cmd">
/g_debug オプション</A></DIV>
<DIV id="text1151_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:63px; margin-top:1766px; line-height:15px; white-space:nowrap">
<A href="#g_is_debug">
→ g_is_debug</A></DIV>

<v:line from="0,1447" to="581,1447"/>
<v:line from="581,1447" to="581,1890"/>
<v:line from="581,1890" to="0,1890"/>
<v:line from="0,1890" to="0,1447"/>

</PAGE>
 
<!-- page 1152 --> 
<PAGE>
<A id="svgcats_vml_p1152" class="to_tree" style="margin-top:1895px;" onClick="selectTreeElem( '1152' );">←</A>
<A href="#svgcats_vml_p1153" class="to_next_page" style="margin-top:1895px;">▼</A>
<A href="#svgcats_vml_p1151" class="to_prev_page" style="margin-top:1895px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1906px; width:612px; height:350px;" fillcolor="white"/>
<DIV id="text1152_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1923px; line-height:15px; white-space:nowrap">
<A name="g_debug_tree">
g_debug_tree</A></DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:1954px; width:244px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1152_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:1961px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_debug_tree&nbsp; as Array of integer</DIV>
<DIV id="text1152_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:1989px; line-height:15px; white-space:nowrap">
エラーが発生した場所の詳細情報。 ブレークするために使われる情報です。</DIV>
<DIV id="text1152_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:2099px; line-height:15px; white-space:nowrap">
プログラムを On Error Resume Next 〜 On Error Goto 0 のブロックのツリー構造として<BR/>
見たときの情報になっています。 ユーザーは、エラーが発生したときに表示される<BR/>
g_debug_tree に設定する値をそのままお使いください。 表示されなかったときは、設定<BR/>
する必要はありません。</DIV>
<DIV id="text1152_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2208px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text1152_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:70px; margin-top:2208px; line-height:15px; white-space:nowrap">
→ T_Err2_Tree フォルダ</DIV>
<DIV id="text1152_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:164px; margin-top:1923px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1152_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:2036px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:2055px; width:214px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1152_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:2062px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_debug_tree = Array( 1, 2 )</DIV>
<DIV id="text1152_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:63px; margin-top:2183px; line-height:15px; white-space:nowrap">
<A href="vbslib_64.html#debug">
→ g_debug - デバッグを開始する</A></DIV>
<DIV id="text1152_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2183px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text1152_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:437px; margin-top:2006px; line-height:15px; white-space:nowrap">
にユーザが記述します。</DIV>
<DIV id="text1152_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:2006px; line-height:15px; white-space:nowrap">
g_debug_tree は、</DIV>
<DIV id="text1152_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:297px; margin-top:2006px; line-height:15px; white-space:nowrap">
<A href="#SetupVbslibParameters">
SetupVbslibParameters</A></DIV>
<DIV id="text1152_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:243px; margin-top:2006px; line-height:15px; white-space:nowrap">
もしくは、</DIV>
<DIV id="text1152_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:130px; margin-top:2006px; line-height:15px; white-space:nowrap">
<A href="vbslib_64.html#g_debug_cmd">
/g_debug オプション</A></DIV>

<v:line from="0,1906" to="612,1906"/>
<v:line from="612,1906" to="612,2256"/>
<v:line from="612,2256" to="0,2256"/>
<v:line from="0,2256" to="0,1906"/>

</PAGE>
 
<!-- page 1153 --> 
<PAGE>
<A id="svgcats_vml_p1153" class="to_tree" style="margin-top:2261px;" onClick="selectTreeElem( '1153' );">←</A>
<A href="#svgcats_vml_p1154" class="to_next_page" style="margin-top:2261px;">▼</A>
<A href="#svgcats_vml_p1152" class="to_prev_page" style="margin-top:2261px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2272px; width:649px; height:917px;" fillcolor="white"/>
<DIV id="text1153_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2289px; line-height:15px; white-space:nowrap">
<A name="g_debug_process">
g_debug_process</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:2317px; width:208px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1153_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:2324px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_debug_process&nbsp; as integer</DIV>
<DIV id="text1153_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:2356px; line-height:15px; white-space:nowrap">
何回目の子プロセスを起動したときにデバッガに接続するかどうか。 </DIV>
<DIV id="text1153_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:2400px; line-height:15px; white-space:nowrap">
0 = メイン・プロセスをデバッガに接続する（g_debug&gt;0 のとき）<BR/>
1 = １回目にメイン・プロセスが起動した子プロセスをデバッガに接続する<BR/>
2 = ２回目にメイン・プロセスが起動した子プロセスをデバッガに接続する<BR/>
：</DIV>
<DIV id="text1153_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2754px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text1153_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:69px; margin-top:2754px; line-height:15px; white-space:nowrap">
→ T_ChildProcessIDNest_Manually.vbs # Array</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:2578px; width:184px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1153_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:2585px; line-height:13px; white-space:nowrap">
g_debug_process = Array(3,1)</DIV>
<DIV id="text1153_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:2554px; line-height:15px; white-space:nowrap">
孫プロセスを起動したときにデバッガに接続することもできます。</DIV>
<DIV id="text1153_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:57px; margin-top:2609px; line-height:15px; white-space:nowrap">
3回目に起動した子プロセスから１回目に呼び出す孫プロセス</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:2503px; width:130px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1153_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:2510px; line-height:13px; white-space:nowrap">
g_debug_process = 1</DIV>
<DIV id="text1153_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2484px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text1153_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:69px; margin-top:2734px; line-height:15px; white-space:nowrap">
<A href="vbslib_64.html#debug">
→ g_debug - デバッグを開始する</A></DIV>
<DIV id="text1153_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2734px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text1153_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:457px; margin-top:2373px; line-height:15px; white-space:nowrap">
にユーザが記述します。</DIV>
<DIV id="text1153_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:2373px; line-height:15px; white-space:nowrap">
g_debug_process は、</DIV>
<DIV id="text1153_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:317px; margin-top:2373px; line-height:15px; white-space:nowrap">
<A href="#SetupVbslibParameters">
SetupVbslibParameters</A></DIV>
<DIV id="text1153_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:263px; margin-top:2373px; line-height:15px; white-space:nowrap">
もしくは、</DIV>
<DIV id="text1153_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:150px; margin-top:2373px; line-height:15px; white-space:nowrap">
<A href="vbslib_64.html#g_debug_cmd">
/g_debug オプション</A></DIV>
<DIV id="text1153_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2834px; line-height:15px; white-space:nowrap">
コールツリー</DIV>
<DIV id="text1153_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:76px; margin-top:2881px; line-height:13px; white-space:nowrap">
'// g_debug_process</DIV>
<DIV id="text1153_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#800000; margin-left:286px; margin-top:2881px; line-height:13px; white-space:nowrap">
// "/g_debug" オプションを g_debug_process 変数へ</DIV>
<DIV id="text1153_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:211px; margin-top:2879px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1153_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:3110px; line-height:13px; white-space:nowrap">
CallFinalizeInModules</DIV>
<DIV id="text1153_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:200px; margin-top:3108px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1153_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:2863px; line-height:13px; white-space:nowrap">
ChangeScriptMode</DIV>
<DIV id="text1153_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:82px; margin-top:3129px; line-height:13px; white-space:nowrap">
If g_debug_process &gt; 0 Then</DIV>
<DIV id="text1153_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:108px; margin-top:3145px; line-height:13px; white-space:nowrap">
WScript.Echo&nbsp; "&lt;WARNING msg=""g_debug_process &gt; 0 です。</DIV>
<DIV id="text1153_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:2916px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1153_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:2918px; line-height:13px; white-space:nowrap">
InitializeModule</DIV>
<DIV id="text1153_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:76px; margin-top:2935px; line-height:15px; white-space:nowrap">
If IsNumeric( g_debug_process ) Then<BR/>
&nbsp; &nbsp; g_Err2.Break_ChildProcess_CallID.Add&nbsp; g_debug_process<BR/>
ElseIf IsArray( g_debug_process ) Then<BR/>
&nbsp; &nbsp; g_Err2.Break_ChildProcess_CallID.Copy&nbsp; g_debug_process</DIV>
<DIV id="text1153_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#800000; margin-left:241px; margin-top:2918px; line-height:13px; white-space:nowrap">
// g_Err2.Break_ChildProcess_CallID へ</DIV>
<DIV id="text1153_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#800000; margin-left:290px; margin-top:3129px; line-height:13px; white-space:nowrap">
// デバッグ モードから戻すように警告する</DIV>
<DIV id="text1153_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:3015px; line-height:13px; white-space:nowrap">
RunProg</DIV>
<DIV id="text1153_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:108px; margin-top:3013px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1153_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:108px; margin-top:3072px; line-height:13px; white-space:nowrap">
cmdline = "cscript //x "+ </DIV>
<DIV id="text1153_36" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:76px; margin-top:3054px; line-height:13px; white-space:nowrap">
If g_InterProcess.ProcessCallID(i) + 1 = g_Err2.Break_ChildProcess_CallID(i) Then</DIV>
<DIV id="text1153_37" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#808080; margin-left:76px; margin-top:3036px; line-height:13px; white-space:nowrap">
'// Break in ChildProcess by "g_debug_process"</DIV>
<DIV id="text1153_38" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#800000; margin-left:296px; margin-top:3072px; line-height:13px; white-space:nowrap">
// デバッガーと接続して起動する</DIV>
<DIV id="text1153_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:69px; margin-top:2774px; line-height:15px; white-space:nowrap">
→ T_ChildProcessIDNest_Manually2.vbs</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:2673px; width:226px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1153_40" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:2680px; line-height:13px; white-space:nowrap">
g_InterProcess.ProcessCallID(0) + 1</DIV>
<DIV id="text1153_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2649px; line-height:15px; white-space:nowrap">
現在は何回目のプロセス番号か</DIV>

<v:line from="0,2272" to="649,2272"/>
<v:line from="649,2272" to="649,3189"/>
<v:line from="649,3189" to="0,3189"/>
<v:line from="0,3189" to="0,2272"/>

</PAGE>
 
<!-- page 1154 --> 
<PAGE>
<A id="svgcats_vml_p1154" class="to_tree" style="margin-top:3194px;" onClick="selectTreeElem( '1154' );">←</A>
<A href="#svgcats_vml_p1155" class="to_next_page" style="margin-top:3194px;">▼</A>
<A href="#svgcats_vml_p1153" class="to_prev_page" style="margin-top:3194px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3205px; width:202px; height:146px;" fillcolor="white"/>
<DIV id="text1154_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3222px; line-height:15px; white-space:nowrap">
<A name="g_is_debug">
g_is_debug</A></DIV>
<DIV id="text1154_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:3252px; line-height:15px; white-space:nowrap">
False = 接続していない<BR/>
True = 接続している</DIV>
<v:rect style="position:absolute; margin-left:31px; margin-top:3294px; width:124px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1154_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:39px; margin-top:3301px; line-height:13px; white-space:nowrap">
If g_is_debug Then</DIV>

<v:line from="0,3205" to="202,3205"/>
<v:line from="202,3205" to="202,3351"/>
<v:line from="202,3351" to="0,3351"/>
<v:line from="0,3351" to="0,3205"/>

</PAGE>
 
<!-- page 1155 --> 
<PAGE>
<A id="svgcats_vml_p1155" class="to_tree" style="margin-top:3356px;" onClick="selectTreeElem( '1155' );">←</A>
<A href="#svgcats_vml_p1156" class="to_next_page" style="margin-top:3356px;">▼</A>
<A href="#svgcats_vml_p1154" class="to_prev_page" style="margin-top:3356px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3367px; width:514px; height:311px;" fillcolor="white"/>
<DIV id="text1155_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:19px; margin-top:3384px; line-height:15px; white-space:nowrap">
<A name="g_debug_params">
g_debug_params</A></DIV>
<v:rect style="position:absolute; margin-left:24px; margin-top:3412px; width:202px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1155_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:3419px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_debug_params&nbsp; as integer</DIV>
<DIV id="text1155_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:3451px; line-height:15px; white-space:nowrap">
デバッガに接続するときのコマンドライン・パラメータ</DIV>
<DIV id="text1155_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:3481px; line-height:15px; white-space:nowrap">
通常、.vbs ファイルをダブルクリックすると、コマンドライン・パラメータは何も設定<BR/>
されませんが、g_debug_param に代入すると設定されます。<BR/>
g_debug = -1 または 1以上に設定しないと、g_debug_params は無効になります。</DIV>
<DIV id="text1155_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:3552px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:3573px; width:346px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1155_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:3579px; line-height:15px; white-space:nowrap">
&nbsp; '--- start of parameters for vbslib include ---------<BR/>
Dim g_debug_params : g_debug_params = "test.txt"</DIV>
<DIV id="text1155_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:163px; margin-top:3384px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1155_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:75px; margin-top:3630px; line-height:15px; white-space:nowrap">
→ T_DebugParam フォルダ</DIV>
<DIV id="text1155_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:32px; margin-top:3630px; line-height:15px; white-space:nowrap">
テスト</DIV>

<v:line from="0,3367" to="514,3367"/>
<v:line from="514,3367" to="514,3678"/>
<v:line from="514,3678" to="0,3678"/>
<v:line from="0,3678" to="0,3367"/>

</PAGE>
 
<!-- page 1156 --> 
<PAGE>
<A id="svgcats_vml_p1156" class="to_tree" style="margin-top:3683px;" onClick="selectTreeElem( '1156' );">←</A>
<A href="#svgcats_vml_p1157" class="to_next_page" style="margin-top:3683px;">▼</A>
<A href="#svgcats_vml_p1155" class="to_prev_page" style="margin-top:3683px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3694px; width:504px; height:171px;" fillcolor="white"/>
<DIV id="text1156_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3711px; line-height:15px; white-space:nowrap">
<A name="g_debug_or_test">
g_debug_or_test</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:3739px; width:208px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1156_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:3746px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_debug_or_test&nbsp; as integer</DIV>
<DIV id="text1156_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3775px; line-height:15px; white-space:nowrap">
デバッグ時、またはデバッグ時のテストかどうか。</DIV>
<DIV id="text1156_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3802px; line-height:15px; white-space:nowrap">
自動テストを行うことができるデバッグ機能は、g_debug ではなく g_debug_or_test<BR/>
値が True のときに行います。</DIV>
<DIV id="text1156_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:173px; margin-top:3711px; line-height:15px; white-space:nowrap">
(src)</DIV>

<v:line from="0,3694" to="504,3694"/>
<v:line from="504,3694" to="504,3865"/>
<v:line from="504,3865" to="0,3865"/>
<v:line from="0,3865" to="0,3694"/>

</PAGE>
 
<!-- page 1157 --> 
<PAGE>
<A id="svgcats_vml_p1157" class="to_tree" style="margin-top:3870px;" onClick="selectTreeElem( '1157' );">←</A>
<A href="#svgcats_vml_p1158" class="to_next_page" style="margin-top:3870px;">▼</A>
<A href="#svgcats_vml_p1156" class="to_prev_page" style="margin-top:3870px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3881px; width:642px; height:896px;" fillcolor="white"/>
<DIV id="text1157_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3898px; line-height:15px; white-space:nowrap">
<A name="g_CommandPrompt">
g_CommandPrompt</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:3926px; width:208px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1157_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:3933px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_CommandPrompt&nbsp; as integer</DIV>
<DIV id="text1157_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:3965px; line-height:15px; white-space:nowrap">
コマンドプロンプトを表示するかどうか</DIV>
<DIV id="text1157_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:3995px; line-height:15px; white-space:nowrap">
0= コマンドプロンプトなし。メッセージは標準ダイアログで表示。<BR/>
1= コマンドプロンプトあり。終了するとすぐに閉じる。 エラーが発生したときは閉じない。<BR/>
2= コマンドプロンプトあり。終了しても閉じない。<BR/>
+4=コマンドプロンプトを最小化ウィンドウで表示。</DIV>
<DIV id="text1157_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:303px; margin-top:4099px; line-height:15px; white-space:nowrap">
にユーザが記述します。</DIV>
<DIV id="text1157_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:4099px; line-height:15px; white-space:nowrap">
g_CommandPrompt は、</DIV>
<DIV id="text1157_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:4070px; line-height:15px; white-space:nowrap">
+4 は、他のオプションと複合するオプションです。</DIV>
<DIV id="text1157_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4624px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text1157_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:4641px; line-height:15px; white-space:nowrap">
<A href="..\vbslib_test2.files\vbslib_test2_02.html#T_ErrInfo">
→ [T_ErrInfo] ユーザへのエラー通知とデバッガ接続</A></DIV>
<DIV id="text1157_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:4624px; line-height:15px; white-space:nowrap">
<A href="..\vbslib_test2.files\vbslib_test2_01.html#T_CommandPrompt">
→ [T_CommandPrompt] プロンプトを開く、閉じるテスト</A></DIV>
<DIV id="text1157_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:4178px; line-height:15px; white-space:nowrap">
コマンドプロンプトなし(=0)のときは、wscript.exe で実行します。</DIV>
<DIV id="text1157_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:167px; margin-top:4100px; line-height:15px; white-space:nowrap">
<A href="#SetupVbslibParameters">
SetupVbslibParameters</A></DIV>
<DIV id="text1157_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:4256px; line-height:15px; white-space:nowrap">
<A href="#ChangeScriptMode">
→ ChangeScriptMode</A></DIV>
<DIV id="text1157_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:4693px; line-height:15px; white-space:nowrap">
<A href="#g_is_cscript_exe">
→ g_is_cscript_exe</A></DIV>
<DIV id="text1157_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4675px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text1157_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:4322px; line-height:15px; white-space:nowrap">
コマンドプロンプトから cscript.exe 経由でスクリプトを起動したときは、同じウィンドウで実行します。<BR/>
ただし、64ビットのコマンドプロンプトから起動したとき、</DIV>
<DIV id="text1157_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:348px; margin-top:4337px; line-height:15px; white-space:nowrap">
<A href="#g_is64bitWSH">
g_is64bitWSH</A></DIV>
<DIV id="text1157_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:428px; margin-top:4337px; line-height:15px; white-space:nowrap">
が False（デフォルト）なら、</DIV>
<DIV id="text1157_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:4353px; line-height:15px; white-space:nowrap">
32ビットのコマンド・プロンプト（cmd.exe）である、新しいウィンドウで実行します。</DIV>
<DIV id="text1157_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:4209px; line-height:15px; white-space:nowrap">
コマンドプロンプトありのときは、cscript.exe で実行します。<BR/>
ただし、vbs ファイルをダブルクリックした瞬間はwscript.exe で実行しますが、wscript.exe が新しく<BR/>
コマンド・プロンプト（cmd.exe）のプロセスを作成し、そこで cscript.exe を実行します。</DIV>
<DIV id="text1157_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:58px; margin-top:4414px; line-height:15px; white-space:nowrap">
64ビット cmd.exe</DIV>
<DIV id="text1157_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:4386px; line-height:15px; white-space:nowrap">
64ビットWindows</DIV>
<DIV id="text1157_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:387px; margin-top:4386px; line-height:15px; white-space:nowrap">
32ビットWindows</DIV>
<v:line style="position:absolute;" from="41,4404" to="597,4404" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1157_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:58px; margin-top:4435px; line-height:15px; white-space:nowrap">
32ビット cmd.exe</DIV>
<DIV id="text1157_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:180px; margin-top:4416px; line-height:13px; white-space:nowrap">
%windir%\System32\cmd.exe</DIV>
<DIV id="text1157_27" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:180px; margin-top:4437px; line-height:13px; white-space:nowrap">
%windir%\SysWOW64\cmd.exe</DIV>
<DIV id="text1157_28" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:387px; margin-top:4437px; line-height:13px; white-space:nowrap">
%windir%\System32\cmd.exe</DIV>
<DIV id="text1157_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:387px; margin-top:4416px; line-height:13px; white-space:nowrap">
-</DIV>
<DIV id="text1157_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:4711px; line-height:15px; white-space:nowrap">
<A href="..\dos_batch.files\dos_batch_01.html#cmd">
→ コマンドプロンプト、コンソール (cmd.exe)</A></DIV>
<DIV id="text1157_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:204px; margin-top:3898px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1157_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:4675px; line-height:15px; white-space:nowrap">
<A href="#close_option">
→ /close オプション</A></DIV>
<DIV id="text1157_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:4729px; line-height:15px; white-space:nowrap">
<A href="vbslib_62.html#fin">
→ 正常終了時の動作</A></DIV>
<DIV id="text1157_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:42px; margin-top:4289px; line-height:15px; white-space:nowrap">
<A href="vbslib_62.html#vbs_inc_flow">
→ 処理フロー （vbs_inc/setting）</A></DIV>
<DIV id="text1157_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4147px; line-height:15px; white-space:nowrap">
動作のしくみ</DIV>
<DIV id="text1157_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4490px; line-height:15px; white-space:nowrap">
<A name="g_CommandPrompt_NoWindowTrou">
ウィンドウが開いてしまうとき</A></DIV>
<DIV id="text1157_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:4517px; line-height:15px; white-space:nowrap">
g_CommandPrompt = 0 を設定していても、ウィンドウが開いてしまう原因は、他にもあります。</DIV>
<DIV id="text1157_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:63px; margin-top:4578px; line-height:15px; white-space:nowrap">
・コマンドライン用の exe を実行したとき （g_CommandPrompt = 5 で最小化はできます）</DIV>
<DIV id="text1157_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:63px; margin-top:4560px; line-height:15px; white-space:nowrap">
<A href="vbslib_01.html#shortcut_sth">
・ショートカットから実行</A></DIV>
<DIV id="text1157_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:195px; margin-top:4560px; line-height:15px; white-space:nowrap">
するときのリンク先（コマンドライン）に cmd.exe /K を指定したとき</DIV>
<DIV id="text1157_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:63px; margin-top:4542px; line-height:15px; white-space:nowrap">
・バッチファイルから実行したとき</DIV>

<v:line from="0,3881" to="642,3881"/>
<v:line from="642,3881" to="642,4777"/>
<v:line from="642,4777" to="0,4777"/>
<v:line from="0,4777" to="0,3881"/>

</PAGE>
 
<!-- page 1158 --> 
<PAGE>
<A id="svgcats_vml_p1158" class="to_tree" style="margin-top:4782px;" onClick="selectTreeElem( '1158' );">←</A>
<A href="#svgcats_vml_p1159" class="to_next_page" style="margin-top:4782px;">▼</A>
<A href="#svgcats_vml_p1157" class="to_prev_page" style="margin-top:4782px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4793px; width:579px; height:180px;" fillcolor="white"/>
<DIV id="text1158_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4810px; line-height:15px; white-space:nowrap">
<A name="close_option">
/close オプション</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:4838px; width:130px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1158_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:4845px; line-height:13px; white-space:nowrap">
Sample.vbs /close:0</DIV>
<DIV id="text1158_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:4877px; line-height:15px; white-space:nowrap">
コマンドプロンプトを表示するかどうかの設定。 <BR/>
このオプションがあるときは、g_CommandPrompt の設定が無視されます。</DIV>
<DIV id="text1158_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:204px; margin-top:4810px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1158_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4925px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text1158_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:4925px; line-height:15px; white-space:nowrap">
<A href="#g_CommandPrompt">
→ g_CommandPrompt</A></DIV>

<v:line from="0,4793" to="579,4793"/>
<v:line from="579,4793" to="579,4973"/>
<v:line from="579,4973" to="0,4973"/>
<v:line from="0,4973" to="0,4793"/>

</PAGE>
 
<!-- page 1159 --> 
<PAGE>
<A id="svgcats_vml_p1159" class="to_tree" style="margin-top:4978px;" onClick="selectTreeElem( '1159' );">←</A>
<A href="#svgcats_vml_p1160" class="to_next_page" style="margin-top:4978px;">▼</A>
<A href="#svgcats_vml_p1158" class="to_prev_page" style="margin-top:4978px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4989px; width:576px; height:508px;" fillcolor="white"/>
<DIV id="text1159_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5006px; line-height:15px; white-space:nowrap">
<A name="ChangeScriptMode">
ChangeScriptMode</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:5036px; width:160px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1159_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:5043px; line-height:13px; white-space:nowrap">
Sub&nbsp; ChangeScriptMode();</DIV>
<DIV id="text1159_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5073px; line-height:15px; white-space:nowrap">
必要に応じて、子プロセスでスクリプトを実行します。</DIV>
<DIV id="text1159_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5394px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text1159_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:5413px; line-height:15px; white-space:nowrap">
→ vbslib_mini.vbs</DIV>
<DIV id="text1159_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:5394px; line-height:15px; white-space:nowrap">
→ vbs_inc_sub.vbs</DIV>
<DIV id="text1159_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5353px; line-height:15px; white-space:nowrap">
vbslib_mini.vbs ファイルを使うときは、明示的に呼び出してください。</DIV>
<DIV id="text1159_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:197px; margin-top:5413px; line-height:15px; white-space:nowrap">
→ sample without vbslib.vbs</DIV>
<DIV id="text1159_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5441px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text1159_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:5441px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#must_cscript">
→ VBScript - 常に cscript.exe で実行する （コマンドプロンプトを出す）</A></DIV>
<DIV id="text1159_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5103px; line-height:15px; white-space:nowrap">
子プロセスを起動する理由は、次のものがあります。</DIV>
<DIV id="text1159_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:5137px; line-height:15px; white-space:nowrap">
・コマンドプロンプトのウィンドウを開くために、wscript.exe から cscript.exe を起動する</DIV>
<DIV id="text1159_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:5191px; line-height:15px; white-space:nowrap">
・デバッガーに接続するために、//x オプションをつけて cscript.exe または cscript.exe <BR/>
　を起動する</DIV>
<DIV id="text1159_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:5156px; line-height:15px; white-space:nowrap">
<A href="#g_CommandPrompt">
→ g_CommandPrompt</A></DIV>
<DIV id="text1159_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:5238px; line-height:15px; white-space:nowrap">
・管理者として実行するために、runas コマンド経由で wscript.exe または cscript.exe<BR/>
　を起動する</DIV>
<DIV id="text1159_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:5283px; line-height:15px; white-space:nowrap">
・64ビットのコマンドプロンプトから起動したときに、32ビットの wscript.exe または <BR/>
　cscript.exe を起動する。 この場合は、新しいウィンドウが開きます。</DIV>
<DIV id="text1159_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5337px; line-height:15px; white-space:nowrap">
ChangeScriptMode 関数は、vbslib を使うときに、自動的に呼ばれます。</DIV>

<v:line from="0,4989" to="576,4989"/>
<v:line from="576,4989" to="576,5497"/>
<v:line from="576,5497" to="0,5497"/>
<v:line from="0,5497" to="0,4989"/>

</PAGE>
 
<!-- page 1160 --> 
<PAGE>
<A id="svgcats_vml_p1160" class="to_tree" style="margin-top:5502px;" onClick="selectTreeElem( '1160' );">←</A>
<A href="#svgcats_vml_p1161" class="to_next_page" style="margin-top:5502px;">▼</A>
<A href="#svgcats_vml_p1159" class="to_prev_page" style="margin-top:5502px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5513px; width:350px; height:139px;" fillcolor="white"/>
<DIV id="text1160_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5530px; line-height:15px; white-space:nowrap">
<A name="g_is_cscript_exe">
g_is_cscript_exe</A></DIV>
<v:rect style="position:absolute; margin-left:24px; margin-top:5565px; width:214px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1160_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:5572px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_is_cscript_exe&nbsp; as boolean</DIV>
<DIV id="text1160_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:5530px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1160_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:5604px; line-height:15px; white-space:nowrap">
コマンドライン(cscript.exe)で実行しているかどうか</DIV>

<v:line from="0,5513" to="350,5513"/>
<v:line from="350,5513" to="350,5652"/>
<v:line from="350,5652" to="0,5652"/>
<v:line from="0,5652" to="0,5513"/>

</PAGE>
 
<!-- page 1161 --> 
<PAGE>
<A id="svgcats_vml_p1161" class="to_tree" style="margin-top:5657px;" onClick="selectTreeElem( '1161' );">←</A>
<A href="#svgcats_vml_p1162" class="to_next_page" style="margin-top:5657px;">▼</A>
<A href="#svgcats_vml_p1160" class="to_prev_page" style="margin-top:5657px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5668px; width:643px; height:456px;" fillcolor="white"/>
<DIV id="text1161_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5685px; line-height:15px; white-space:nowrap">
<A name="g_admin">
g_admin</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:5713px; width:160px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1161_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:5720px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_admin&nbsp; as integer</DIV>
<DIV id="text1161_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5752px; line-height:15px; white-space:nowrap">
起動時に管理者へログインするのかしないのか</DIV>
<DIV id="text1161_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5867px; line-height:15px; white-space:nowrap">
g_admin の設定値は、メインの .vbs ファイルの中の</DIV>
<DIV id="text1161_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:52px; margin-top:5777px; line-height:15px; white-space:nowrap">
0 = 起動時に管理者へログインしない<BR/>
1 = 起動時に管理者へログインする</DIV>
<DIV id="text1161_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5886px; line-height:15px; white-space:nowrap">
Windows XP では、制限ユーザーから管理者へログインする設定にすると、起動時に管理者の<BR/>
パスワードを入力するようになります。 自分が管理者であるときは、入力を求められません。<BR/>
Windows Vista/7 では、vbs ファイルをダブルクリックした直後に、昇格の確認が求められます。</DIV>
<DIV id="text1161_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:417px; margin-top:5954px; line-height:15px; white-space:nowrap">
に設定してください</DIV>
<DIV id="text1161_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:259px; margin-top:5954px; line-height:15px; white-space:nowrap">
<A href="vbslib_10.html#Setting_getAdminUserName">
Setting_getAdminUserName</A></DIV>
<DIV id="text1161_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5954px; line-height:15px; white-space:nowrap">
Windows XP では、管理者のユーザ名を</DIV>
<DIV id="text1161_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:5998px; line-height:15px; white-space:nowrap">
<A href="..\vbslib_test2.files\vbslib_test2_01.html#T_Admin">
→ [T_Admin]</A></DIV>
<DIV id="text1161_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:5685px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1161_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:23px; margin-top:5998px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text1161_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:23px; margin-top:6024px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text1161_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:6024px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_15.html#IShellDispatch2_ShellExecute">
→ IShellDispatch2::ShellExecute</A></DIV>
<DIV id="text1161_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:255px; margin-top:6024px; line-height:15px; white-space:nowrap">
の runas</DIV>
<DIV id="text1161_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:6075px; line-height:15px; white-space:nowrap">
<A href="vbslib_49.html#sudo">
→ sudo</A></DIV>
<DIV id="text1161_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:23px; margin-top:6075px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text1161_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:6044px; line-height:15px; white-space:nowrap">
→ アカウント</DIV>
<DIV id="text1161_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:456px; margin-top:5866px; line-height:15px; white-space:nowrap">
に記述します。</DIV>
<DIV id="text1161_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:317px; margin-top:5867px; line-height:15px; white-space:nowrap">
<A href="#SetupVbslibParameters">
SetupVbslibParameters</A></DIV>
<DIV id="text1161_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5832px; line-height:15px; white-space:nowrap">
通常、</DIV>
<DIV id="text1161_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:5832px; line-height:15px; white-space:nowrap">
<A href="vbslib_49.html#sudo">
sudo</A></DIV>
<DIV id="text1161_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:105px; margin-top:5832px; line-height:15px; white-space:nowrap">
を使ってください。</DIV>

<v:line from="0,5668" to="643,5668"/>
<v:line from="643,5668" to="643,6124"/>
<v:line from="643,6124" to="0,6124"/>
<v:line from="0,6124" to="0,5668"/>

</PAGE>
 
<!-- page 1162 --> 
<PAGE>
<A id="svgcats_vml_p1162" class="to_tree" style="margin-top:6129px;" onClick="selectTreeElem( '1162' );">←</A>
<A href="#svgcats_vml_p1163" class="to_next_page" style="margin-top:6129px;">▼</A>
<A href="#svgcats_vml_p1161" class="to_prev_page" style="margin-top:6129px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6140px; width:430px; height:162px;" fillcolor="white"/>
<DIV id="text1162_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6157px; line-height:15px; white-space:nowrap">
<A name="g_is_admin">
g_is_admin</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:6185px; width:178px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1162_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:6192px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_is_admin&nbsp; as boolean</DIV>
<DIV id="text1162_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:6224px; line-height:15px; white-space:nowrap">
管理者のグループに入っているかどうか。</DIV>
<DIV id="text1162_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:6157px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1162_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:6254px; line-height:15px; white-space:nowrap">
Windows Vista 以降では、UAC を確認した後で true になります。</DIV>

<v:line from="0,6140" to="430,6140"/>
<v:line from="430,6140" to="430,6302"/>
<v:line from="430,6302" to="0,6302"/>
<v:line from="0,6302" to="0,6140"/>

</PAGE>
 
<!-- page 1163 --> 
<PAGE>
<A id="svgcats_vml_p1163" class="to_tree" style="margin-top:6307px;" onClick="selectTreeElem( '1163' );">←</A>
<A href="#svgcats_vml_p1164" class="to_next_page" style="margin-top:6307px;">▼</A>
<A href="#svgcats_vml_p1162" class="to_prev_page" style="margin-top:6307px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6318px; width:399px; height:195px;" fillcolor="white"/>
<DIV id="text1163_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6335px; line-height:15px; white-space:nowrap">
<A name="g_is64bitWindows">
g_is64bitWindows</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:6363px; width:214px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1163_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:6370px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_is64bitWindows&nbsp; as boolean</DIV>
<DIV id="text1163_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:6402px; line-height:15px; white-space:nowrap">
スクリプトが動いている OS が、64ビットWindows かどうか。</DIV>
<DIV id="text1163_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:6335px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1163_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6445px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text1163_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:6445px; line-height:15px; white-space:nowrap">
→ 64ビットWindows (WOW64)</DIV>
<DIV id="text1163_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:6465px; line-height:15px; white-space:nowrap">
<A href="#g_is64bitWSH">
→ g_is64bitWSH</A></DIV>

<v:line from="0,6318" to="399,6318"/>
<v:line from="399,6318" to="399,6513"/>
<v:line from="399,6513" to="0,6513"/>
<v:line from="0,6513" to="0,6318"/>

</PAGE>
 
<!-- page 1164 --> 
<PAGE>
<A id="svgcats_vml_p1164" class="to_tree" style="margin-top:6518px;" onClick="selectTreeElem( '1164' );">←</A>
<A href="#svgcats_vml_p1165" class="to_next_page" style="margin-top:6518px;">▼</A>
<A href="#svgcats_vml_p1163" class="to_prev_page" style="margin-top:6518px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6529px; width:595px; height:588px;" fillcolor="white"/>
<DIV id="text1164_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6546px; line-height:15px; white-space:nowrap">
<A name="g_is64bitWSH">
g_is64bitWSH</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:6574px; width:190px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1164_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:6581px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_is64bitWSH&nbsp; as boolean</DIV>
<DIV id="text1164_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:6613px; line-height:15px; white-space:nowrap">
スクリプトを動かすホスト、または、動いているホストが、64ビット WSH かどうか。</DIV>
<DIV id="text1164_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:6643px; line-height:15px; white-space:nowrap">
64ビット Windows では、vbslib を使うスクリプトは 64ビット版 WSH で起動され、起動直後に <BR/>
32ビット WSH に切り替わりますが、SetupVbslibParameters 関数の中で、<BR/>
g_is64bitWSH = True と設定すると、64ビット Windows では、64ビット WSH にのままなります。 <BR/>
ただし、メイン.vbs の最後にある vbslib include の中に Dim&nbsp; g_is64bitWSH が記述されている<BR/>
必要があります。 参考： vbslib Prompt.vbs の内容<BR/>
<BR/>
Main 関数を呼び出した後は、g_is64bitWSH の値は、実際に動いている WSH のバージョンに<BR/>
従った値になります。</DIV>
<DIV id="text1164_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:6546px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1164_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7048px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text1164_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:7069px; line-height:15px; white-space:nowrap">
<A href="#g_is64bitWindows">
→ g_is64bitWindows</A></DIV>
<DIV id="text1164_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:7048px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_03.html#wow64">
→ 32ビットWindows と 64ビットWindows の WSH</A></DIV>
<DIV id="text1164_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:174px; margin-top:6824px; line-height:13px; white-space:nowrap">
g_is64bitWindows = True</DIV>
<DIV id="text1164_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:6849px; line-height:13px; white-space:nowrap">
g_is64bitWSH = True</DIV>
<v:line style="position:absolute;" from="30,6841" to="558,6841" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1164_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:381px; margin-top:6824px; line-height:13px; white-space:nowrap">
g_is64bitWindows = False</DIV>
<DIV id="text1164_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:6870px; line-height:13px; white-space:nowrap">
g_is64bitWSH = False</DIV>
<DIV id="text1164_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:174px; margin-top:6849px; line-height:13px; white-space:nowrap">
%windir%\System32\cscript.exe</DIV>
<DIV id="text1164_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:174px; margin-top:6870px; line-height:13px; white-space:nowrap">
%windir%\SysWOW64\cscript.exe</DIV>
<DIV id="text1164_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:381px; margin-top:6870px; line-height:13px; white-space:nowrap">
%windir%\System32\cscript.exe</DIV>
<DIV id="text1164_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:381px; margin-top:6849px; line-height:13px; white-space:nowrap">
-</DIV>
<v:rect style="position:absolute; margin-left:44px; margin-top:6938px; width:364px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1164_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:52px; margin-top:6944px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; If g_is64bitWindows = g_is64bitWSH Then<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; cscript_exe = env("%windir%\System32\cscript.exe")<BR/>
&nbsp; &nbsp; Else<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; cscript_exe = env("%windir%\SysWOW64\cscript.exe")<BR/>
&nbsp; &nbsp; End If</DIV>
<DIV id="text1164_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6912px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text1164_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:6778px; line-height:15px; white-space:nowrap">
32ビット Windows では、g_is64bitWSH の値は無視されます。</DIV>

<v:line from="0,6529" to="595,6529"/>
<v:line from="595,6529" to="595,7117"/>
<v:line from="595,7117" to="0,7117"/>
<v:line from="0,7117" to="0,6529"/>

</PAGE>
 
<!-- page 1165 --> 
<PAGE>
<A id="svgcats_vml_p1165" class="to_tree" style="margin-top:7122px;" onClick="selectTreeElem( '1165' );">←</A>
<A href="#svgcats_vml_p1166" class="to_next_page" style="margin-top:7122px;">▼</A>
<A href="#svgcats_vml_p1164" class="to_prev_page" style="margin-top:7122px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7133px; width:233px; height:80px;" fillcolor="white"/>
<DIV id="text1165_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7150px; line-height:15px; white-space:nowrap">
ファイルまたはフォルダのパス</DIV>

<v:line from="0,7133" to="233,7133"/>
<v:line from="233,7133" to="233,7213"/>
<v:line from="233,7213" to="0,7213"/>
<v:line from="0,7213" to="0,7133"/>

</PAGE>
 
<!-- page 1166 --> 
<PAGE>
<A id="svgcats_vml_p1166" class="to_tree" style="margin-top:7218px;" onClick="selectTreeElem( '1166' );">←</A>
<A href="#svgcats_vml_p1167" class="to_next_page" style="margin-top:7218px;">▼</A>
<A href="#svgcats_vml_p1165" class="to_prev_page" style="margin-top:7218px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7229px; width:605px; height:1118px;" fillcolor="white"/>
<DIV id="text1166_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7246px; line-height:15px; white-space:nowrap">
<A name="g_start_in_path">
g_start_in_path</A></DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:7274px; width:202px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1166_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:7281px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_start_in_path&nbsp; as string</DIV>
<DIV id="text1166_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:7313px; line-height:15px; white-space:nowrap">
プロセス起動時のカレント・フォルダーのフル・パス。</DIV>
<DIV id="text1166_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:154px; margin-top:7246px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1166_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:7343px; line-height:15px; white-space:nowrap">
vbslib ver4 以降では、main 関数を呼ばれたときのカレント・フォルダーは、メイン.vbs ファイルが<BR/>
あるフォルダーになります。 そのため、プロセス起動時のカレント・フォルダーは、g_start_in_path<BR/>
から取得する必要があります。<BR/>
<BR/>
このように変更した理由は、書かれたスクリプトが、汎用コマンドとして使われることより、<BR/>
スクリプトがあるフォルダーに対して固有の処理を行うことが多いためです。<BR/>
<BR/>
g_start_in_path を変更すると、InputPath の基準フォルダーを変更することができます。</DIV>
<DIV id="text1166_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:7488px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:7510px; width:130px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1166_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:7517px; line-height:13px; white-space:nowrap">
cd&nbsp; g_start_in_path</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:7576px; width:226px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1166_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:7582px; line-height:15px; white-space:nowrap">
Sub&nbsp; main2( Opt, AppKey )<BR/>
&nbsp; Dim&nbsp; ds_:Set ds_= new CurDirStack<BR/>
&nbsp; pushd&nbsp; g_start_in_path<BR/>
&nbsp; &nbsp; :<BR/>
&nbsp; popd<BR/>
End Sub</DIV>
<DIV id="text1166_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:35px; margin-top:7555px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<DIV id="text1166_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8299px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text1166_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:65px; margin-top:8299px; line-height:15px; white-space:nowrap">
<A href="vbslib_11.html#InputPath">
→ InputPath</A></DIV>
<DIV id="text1166_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7735px; line-height:15px; white-space:nowrap">
コマンド・プロンプトから、プログラムを実行するときのパラメーターに、ファイルのパスを指定<BR/>
するときは、カレント・ディレクトリからの相対パスを指定します。 たとえば、cl a.c のように<BR/>
cl コマンドに指定した a.c は、カレント・ディレクトリにある a.c ファイルを指しています。<BR/>
<BR/>
このとき、cl.exe の実行ファイルは、環境変数 PATH で指定されたディレクトリのどこかにあり、<BR/>
a.c は、cl.exe があるディレクトリにある a.c ファイルではありません。<BR/>
<BR/>
しかし、この法則は、スクリプトを記述するときに問題になります。cl.exe のように使えるスク<BR/>
リプト script.vbs を開発したとしましょう。スクリプトから、cl a.c を実行するように記述するときは、<BR/>
素直にcl a.c とスクリプトに記述するでしょう。 このとき、a.c は、スクリプトがあるフォルダー<BR/>
からの相対パスを指定するはずです。 カレント・ディレクトリからの相対パスではありません。<BR/>
<BR/>
どういうことかというと、通常、カレント・ディレクトリは、スクリプトがあるディレクトリではなく、<BR/>
スクリプトを起動したときのディレクトリのままになるのですが、これでは、他のフォルダーから<BR/>
スクリプトを起動したとき、a.c というファイルは、起動したときのカレント・ディレクトリにある <BR/>
a.c というファイルになってしまうのです。 起動したときのカレント・ディレクトリにある a.c を<BR/>
意図してスクリプトを記述することなど、ほとんど無いので、カレント・ディレクトリが、起動した<BR/>
ときのカレント・ディレクトリであるという仕様は、扱いにくいのです。<BR/>
<BR/>
vbslib4 では、main 関数を実行するときのカレント・ディレクトリは、スクリプトがあるディレク<BR/>
トリになっています。これにより、多くのケースで、スクリプトに記述したファイル、たとえば a.c <BR/>
が、意図したとおりのファイルを指定することになります。<BR/>
<BR/>
一方で、起動したときのディレクトリは、g_start_in_path グローバル変数を参照するようになっ<BR/>
ています。 起動時のパラメーターに指定した相対パスは、g_start_in_path を基準とした絶対<BR/>
パスに変換する必要があります。 しかし、多くの場合、それに気をつける必要はありません。<BR/>
ショートハンド・プロンプトに対応したスクリプト（InputCommand 関数を使ったスクリプト）は、<BR/>
自動的にコマンド・プロンプトから起動することもできるようになるのですが、そのときに、<BR/>
パラメーターに指定した相対パスは、InputPath 関数で取得でき、それは、g_start_in_path から<BR/>
の相対パスであるとして、フル・パスを返すからです。<BR/>
<BR/>
カレント・ディレクトリは、スクリプトがあるディレクトリがいいか、起動時のカレント・ディレクトリ<BR/>
がいいか、という話ではなく、どちらの相対パスも自動的に適切に扱えるように工夫されて<BR/>
いるのです。</DIV>
<DIV id="text1166_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:7707px; line-height:15px; white-space:nowrap">
カレント・ディレクトリとスクリプトがあるディレクトリ</DIV>
<DIV id="text1166_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:65px; margin-top:8269px; line-height:15px; white-space:nowrap">
<A href="..\vbslib_test2.files\vbslib_test2_01.html#T_StartFromOther">
→ [T_StartFromOther] スクリプトが無いフォルダーから起動したとき</A></DIV>
<DIV id="text1166_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:8269px; line-height:15px; white-space:nowrap">
テスト</DIV>

<v:line from="0,7229" to="605,7229"/>
<v:line from="605,7229" to="605,8347"/>
<v:line from="605,8347" to="0,8347"/>
<v:line from="0,8347" to="0,7229"/>

</PAGE>
 
<!-- page 1167 --> 
<PAGE>
<A id="svgcats_vml_p1167" class="to_tree" style="margin-top:8352px;" onClick="selectTreeElem( '1167' );">←</A>
<A href="#svgcats_vml_p1168" class="to_next_page" style="margin-top:8352px;">▼</A>
<A href="#svgcats_vml_p1166" class="to_prev_page" style="margin-top:8352px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8363px; width:573px; height:269px;" fillcolor="white"/>
<DIV id="text1167_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8380px; line-height:15px; white-space:nowrap">
<A name="g_vbslib_path">
g_vbslib_path</A></DIV>
<DIV id="text1167_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:44px; margin-top:8586px; line-height:13px; white-space:nowrap">
vbs_inc.vbs のフル・パス</DIV>
<v:rect style="position:absolute; margin-left:24px; margin-top:8415px; width:190px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1167_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:8422px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_vbslib_path&nbsp; as string</DIV>
<DIV id="text1167_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:24px; margin-top:8466px; line-height:15px; white-space:nowrap">
vbs_inc.vbs をインクルードする前</DIV>
<DIV id="text1167_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; margin-left:24px; margin-top:8557px; line-height:15px; white-space:nowrap">
vbs_inc.vbs をインクルードした後</DIV>
<DIV id="text1167_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:44px; margin-top:8489px; line-height:15px; white-space:nowrap">
vbs_inc.vbs の相対パス。<BR/>
相対パスの基準は、すべてのスクリプトのベースフォルダなど。</DIV>
<DIV id="text1167_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:149px; margin-top:8380px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1167_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:8517px; line-height:15px; white-space:nowrap">
インクルードする前の g_vbslib_path は、</DIV>
<DIV id="text1167_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:398px; margin-top:8516px; line-height:15px; white-space:nowrap">
にユーザが記述します。</DIV>
<DIV id="text1167_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:262px; margin-top:8517px; line-height:15px; white-space:nowrap">
<A href="#SetupVbslibParameters">
SetupVbslibParameters</A></DIV>

<v:line from="0,8363" to="573,8363"/>
<v:line from="573,8363" to="573,8632"/>
<v:line from="573,8632" to="0,8632"/>
<v:line from="0,8632" to="0,8363"/>

</PAGE>
 
<!-- page 1168 --> 
<PAGE>
<A id="svgcats_vml_p1168" class="to_tree" style="margin-top:8637px;" onClick="selectTreeElem( '1168' );">←</A>
<A href="#svgcats_vml_p1169" class="to_next_page" style="margin-top:8637px;">▼</A>
<A href="#svgcats_vml_p1167" class="to_prev_page" style="margin-top:8637px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8648px; width:573px; height:345px;" fillcolor="white"/>
<DIV id="text1168_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8665px; line-height:15px; white-space:nowrap">
<A name="g_vbslib_folder">
g_vbslib_folder</A></DIV>
<v:rect style="position:absolute; margin-left:24px; margin-top:8700px; width:202px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1168_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:8707px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_vbslib_folder&nbsp; as string</DIV>
<DIV id="text1168_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:8665px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1168_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:8905px; line-height:15px; white-space:nowrap">
<A href="vbslib_01.html#vbslib_head">
→ scriptlib フォルダー</A></DIV>
<DIV id="text1168_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:68px; margin-top:8925px; line-height:15px; white-space:nowrap">
→ g_vbslib_parent_folder</DIV>
<DIV id="text1168_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:8761px; line-height:15px; white-space:nowrap">
g_Ver の設定に関わらず、最初の scriptlib フォルダの親になります。</DIV>
<DIV id="text1168_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:8739px; line-height:15px; white-space:nowrap">
scriptlib フォルダのフル・パス。末尾に \ が付きます。</DIV>
<DIV id="text1168_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:8885px; line-height:15px; white-space:nowrap">
<A href="#g_vbslib_ver_folder">
→ g_vbslib_ver_folder</A></DIV>
<DIV id="text1168_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8885px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text1168_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:8945px; line-height:15px; white-space:nowrap">
<A href="vbslib_32.html#WriteVBSLibHeader">
→ WriteVBSLibFooter</A></DIV>
<v:rect style="position:absolute; margin-left:51px; margin-top:8825px; width:490px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1168_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:59px; margin-top:8832px; line-height:13px; white-space:nowrap">
copy&nbsp; Left( g_vbslib_folder, Len( g_vbslib_folder ) - 1 ), "C:\NewScriptFolder"</DIV>
<DIV id="text1168_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8799px; line-height:15px; white-space:nowrap">
サンプル</DIV>

<v:line from="0,8648" to="573,8648"/>
<v:line from="573,8648" to="573,8993"/>
<v:line from="573,8993" to="0,8993"/>
<v:line from="0,8993" to="0,8648"/>

</PAGE>
 
<!-- page 1169 --> 
<PAGE>
<A id="svgcats_vml_p1169" class="to_tree" style="margin-top:8998px;" onClick="selectTreeElem( '1169' );">←</A>
<A href="#svgcats_vml_p1170" class="to_next_page" style="margin-top:8998px;">▼</A>
<A href="#svgcats_vml_p1168" class="to_prev_page" style="margin-top:8998px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9009px; width:462px; height:212px;" fillcolor="white"/>
<DIV id="text1169_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9026px; line-height:15px; white-space:nowrap">
<A name="g_vbslib_ver_folder">
g_vbslib_ver_folder</A></DIV>
<v:rect style="position:absolute; margin-left:24px; margin-top:9061px; width:226px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1169_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:9068px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_vbslib_ver_folder&nbsp; as string</DIV>
<DIV id="text1169_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:198px; margin-top:9026px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1169_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:69px; margin-top:9154px; line-height:15px; white-space:nowrap">
<A href="vbslib_01.html#vbslib_head">
→ scriptlib フォルダー</A></DIV>
<DIV id="text1169_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:9156px; line-height:13px; white-space:nowrap">
関連</DIV>
<DIV id="text1169_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:69px; margin-top:9173px; line-height:15px; white-space:nowrap">
<A href="#g_vbslib_folder">
→ g_vbslib_folder</A></DIV>
<DIV id="text1169_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:9122px; line-height:13px; white-space:nowrap">
g_Ver の設定によって、フォルダパスは変わります。</DIV>
<DIV id="text1169_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:9100px; line-height:13px; white-space:nowrap">
vbs_inc_XXX.vbs があるフォルダのフル・パス。末尾に \ が付きます。</DIV>

<v:line from="0,9009" to="462,9009"/>
<v:line from="462,9009" to="462,9221"/>
<v:line from="462,9221" to="0,9221"/>
<v:line from="0,9221" to="0,9009"/>

</PAGE>
 
<!-- page 1170 --> 
<PAGE>
<A id="svgcats_vml_p1170" class="to_tree" style="margin-top:9226px;" onClick="selectTreeElem( '1170' );">←</A>
<A href="#svgcats_vml_p1171" class="to_next_page" style="margin-top:9226px;">▼</A>
<A href="#svgcats_vml_p1169" class="to_prev_page" style="margin-top:9226px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9237px; width:565px; height:252px;" fillcolor="white"/>
<DIV id="text1170_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9254px; line-height:15px; white-space:nowrap">
<A name="g_SrcPath">
g_SrcPath</A></DIV>
<DIV id="text1170_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:9439px; line-height:15px; white-space:nowrap">
<A href="vbslib_64.html#src_path">
→ デバッガで開いているソースのパスを知る</A></DIV>
<v:rect style="position:absolute; margin-left:24px; margin-top:9288px; width:160px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1170_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:9295px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_SrcPath as string</DIV>
<DIV id="text1170_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:160px; margin-top:9357px; line-height:15px; white-space:nowrap">
g_IncludePathes</DIV>
<DIV id="text1170_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:73px; margin-top:9357px; line-height:15px; white-space:nowrap">
や</DIV>
<DIV id="text1170_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:27px; margin-top:9357px; line-height:15px; white-space:nowrap">
<A href="vbslib_50.html#include">
include</A></DIV>
<DIV id="text1170_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:94px; margin-top:9357px; line-height:15px; white-space:nowrap">
<A href="vbslib_51.html#call_vbs">
call_vbs</A></DIV>
<DIV id="text1170_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:141px; margin-top:9357px; line-height:15px; white-space:nowrap">
や</DIV>
<DIV id="text1170_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:254px; margin-top:9357px; line-height:15px; white-space:nowrap">
で、グローバル領域を実行しているとき、</DIV>
<DIV id="text1170_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:9323px; line-height:15px; white-space:nowrap">
インクルードしているスクリプトファイル(.vbs)のフル・パス。</DIV>
<DIV id="text1170_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:9254px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1170_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:9372px; line-height:15px; white-space:nowrap">
だけ定義されます。</DIV>
<DIV id="text1170_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:9417px; line-height:15px; white-space:nowrap">
<A href="vbslib_22.html#get_DefineInfoObject">
→ get_DefineInfoObject</A></DIV>
<DIV id="text1170_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:344px; margin-top:9439px; line-height:15px; white-space:nowrap">
g_SrcPath のサンプルがあります</DIV>
<DIV id="text1170_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:27px; margin-top:9417px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text1170_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:344px; margin-top:9417px; line-height:15px; white-space:nowrap">
g_SrcPath のサンプルがあります</DIV>

<v:line from="0,9237" to="565,9237"/>
<v:line from="565,9237" to="565,9489"/>
<v:line from="565,9489" to="0,9489"/>
<v:line from="0,9489" to="0,9237"/>

</PAGE>
 
<!-- page 1171 --> 
<PAGE>
<A id="svgcats_vml_p1171" class="to_tree" style="margin-top:9494px;" onClick="selectTreeElem( '1171' );">←</A>
<A href="#svgcats_vml_p1172" class="to_next_page" style="margin-top:9494px;">▼</A>
<A href="#svgcats_vml_p1170" class="to_prev_page" style="margin-top:9494px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9505px; width:343px; height:134px;" fillcolor="white"/>
<DIV id="text1171_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9522px; line-height:15px; white-space:nowrap">
<A name="g_MainPath">
g_MainPath</A></DIV>
<v:rect style="position:absolute; margin-left:24px; margin-top:9556px; width:166px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1171_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:32px; margin-top:9563px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_MainPath as string</DIV>
<DIV id="text1171_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:9591px; line-height:15px; white-space:nowrap">
メイン.vbs のスクリプトファイル(.vbs)のフル・パス。</DIV>
<DIV id="text1171_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:9522px; line-height:15px; white-space:nowrap">
(src)</DIV>

<v:line from="0,9505" to="343,9505"/>
<v:line from="343,9505" to="343,9639"/>
<v:line from="343,9639" to="0,9639"/>
<v:line from="0,9639" to="0,9505"/>

</PAGE>
 
<!-- page 1172 --> 
<PAGE>
<A id="svgcats_vml_p1172" class="to_tree" style="margin-top:9644px;" onClick="selectTreeElem( '1172' );">←</A>
<A href="vbslib_62.html#svgcats_vml_p1173" class="to_next_page" style="margin-top:9644px;">▼</A>
<A href="#svgcats_vml_p1171" class="to_prev_page" style="margin-top:9644px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9655px; width:600px; height:705px;" fillcolor="white"/>
<DIV id="text1172_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9672px; line-height:15px; white-space:nowrap">
<A name="g_InitializeModule">
グローバル変数の初期化、後始末、g_InitializeModule、g_FinalizeModule</A></DIV>
<v:rect style="position:absolute; margin-left:30px; margin-top:9944px; width:502px; height:220px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1172_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:38px; margin-top:9950px; line-height:15px; white-space:nowrap">
' Global Variable<BR/>
Dim&nbsp; g_Test<BR/>
<BR/>
Function&nbsp; InitializeModule( ThisPath )<BR/>
&nbsp; Set&nbsp; g_Test = new TestScript : ErrCheck : Set g_TestScriptGlobals.Test = g_Test<BR/>
End Function<BR/>
Dim&nbsp; g_InitializeModule<BR/>
Set&nbsp; g_InitializeModule = GetRef( "InitializeModule" )<BR/>
<BR/>
Function&nbsp; FinalizeModule( ThisPath, Reason )<BR/>
&nbsp; g_Test.Finish<BR/>
End Function<BR/>
Dim g_FinalizeModule: Set g_FinalizeModule = GetRef( "FinalizeModule" )<BR/>
Dim g_FinalizeLevel:&nbsp; &nbsp; &nbsp; g_FinalizeLevel&nbsp; = 100&nbsp; ' If smaller, called early</DIV>
<DIV id="text1172_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9709px; line-height:15px; white-space:nowrap">
vbs_inc.vbs でインクルードするモジュールの中にあるグローバル変数は、下記のように<BR/>
初期化関数を g_InitializeModule に設定してください。後始末が必要なら、g_FinalizeModule <BR/>
と g_FinalizeLevel を設定してください。 g_FinalizeLevel が小さいモジュールほど先に呼ばれます。<BR/>
これらによって、グローバル変数の初期化や後始末の順番を制御します。</DIV>
<DIV id="text1172_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9922px; line-height:15px; white-space:nowrap">
サンプル （TestScript.vbs）</DIV>
<DIV id="text1172_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:474px; margin-top:9672px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text1172_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:10204px; line-height:15px; white-space:nowrap">
配列のグローバル変数</DIV>
<v:rect style="position:absolute; margin-left:30px; margin-top:10288px; width:478px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text1172_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:38px; margin-top:10294px; line-height:15px; white-space:nowrap">
&nbsp; '--- start of parameters for vbslib include -------------------------------<BR/>
Dim&nbsp; g_LineOfThreadSwitch()</DIV>
<DIV id="text1172_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:10240px; line-height:15px; white-space:nowrap">
main より後のグローバル領域に、配列を宣言すると、main 関数終了後にエラーになることが<BR/>
あります。そのときは、下記のように SetupVbslibParameters の中で宣言してください。</DIV>
<DIV id="text1172_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9828px; line-height:15px; white-space:nowrap">
初期化関数で依存するモジュールがなくても、(モジュール).vbs をダブルクリックして、<BR/>
文法チェックができます。<BR/>
<BR/>
Setting_getIncludePathes にモジュールを登録して、vbs_inc.vbs をダブルクリックすると、<BR/>
初期化、後始末のテストができます。</DIV>
<DIV id="text1172_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:172px; margin-top:9794px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text1172_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9779px; line-height:15px; white-space:nowrap">
同じモジュールの中のオブジェクトの Class_Terminate が呼ばれる順番は、グローバル変数に<BR/>
格納した順番と同じです。</DIV>
<DIV id="text1172_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:211px; margin-top:9794px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_10.html#Class_Terminate_order">
→ Class_Terminate が呼ばれる順序</A></DIV>

<v:line from="0,9655" to="600,9655"/>
<v:line from="600,9655" to="600,10360"/>
<v:line from="600,10360" to="0,10360"/>
<v:line from="0,10360" to="0,9655"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10360px;">
<A id="svgcats_vml_p1172" class="to_tree" onClick="selectTreeElem( '1172' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10360px;">
<A id="page_group_bottom" href="vbslib_62.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
