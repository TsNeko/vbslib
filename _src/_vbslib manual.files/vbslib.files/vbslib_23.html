<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>vbslib</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbslib.files/vbslib_23.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbslib.files/vbslib_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbslib.files/vbslib_23.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 413 --> 
<PAGE>
<A id="svgcats_vml_p413" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '413' );">←</A>
<A href="#svgcats_vml_p414" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbslib_22.html#svgcats_vml_p412" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbslib_22.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:657px; height:294px;" fillcolor="white"/>
<DIV id="text413_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="new_ObjectsFromStream">
new_ObjectsFromStream</A></DIV>
<DIV id="text413_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:217px; margin-top:17px; line-height:15px; white-space:nowrap">
(src)</DIV>
<v:rect style="position:absolute; margin-left:27px; margin-top:49px; width:598px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text413_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:35px; margin-top:56px; line-height:13px; white-space:nowrap">
Sub&nbsp; new_ObjectsFromStream( out_Objs as array of object, ClassName as string, Stream as variant )</DIV>
<DIV id="text413_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:87px; line-height:15px; white-space:nowrap">
ストリームから、オブジェクトをいくつか生成して、配列に格納します。</DIV>
<DIV id="text413_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:113px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text413_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:113px; line-height:15px; white-space:nowrap">
out_Objs</DIV>
<DIV id="text413_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:132px; line-height:15px; white-space:nowrap">
ClassName</DIV>
<DIV id="text413_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:190px; margin-top:113px; line-height:15px; white-space:nowrap">
（出力） ストリームから生成したオブジェクトが入った配列</DIV>
<DIV id="text413_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:190px; margin-top:132px; line-height:15px; white-space:nowrap">
生成するオブジェクトのクラス名</DIV>
<DIV id="text413_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:151px; line-height:15px; white-space:nowrap">
Stream</DIV>
<DIV id="text413_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:190px; margin-top:151px; line-height:15px; white-space:nowrap">
XML ストリーム</DIV>
<DIV id="text413_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:188px; line-height:15px; white-space:nowrap">
１つもオブジェクトを生成しなかったときでも、out_Objs には配列が格納されます。</DIV>
<DIV id="text413_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:210px; line-height:15px; white-space:nowrap">
ClassName, Stream については、</DIV>
<DIV id="text413_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:219px; margin-top:210px; line-height:15px; white-space:nowrap">
<A href="vbslib_22.html#new_ObjectFromStream">
→ new_ObjectFromStream</A></DIV>
<DIV id="text413_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:33px; margin-top:246px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text413_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:83px; margin-top:246px; line-height:15px; white-space:nowrap">
→ T_ObjectFromStream フォルダ</DIV>

<v:line from="0,0" to="657,0"/>
<v:line from="657,0" to="657,294"/>
<v:line from="657,294" to="0,294"/>
<v:line from="0,294" to="0,0"/>

</PAGE>
 
<!-- page 414 --> 
<PAGE>
<A id="svgcats_vml_p414" class="to_tree" style="margin-top:299px;" onClick="selectTreeElem( '414' );">←</A>
<A href="#svgcats_vml_p415" class="to_next_page" style="margin-top:299px;">▼</A>
<A href="#svgcats_vml_p413" class="to_prev_page" style="margin-top:299px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:310px; width:531px; height:304px;" fillcolor="white"/>
<DIV id="text414_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:327px; line-height:15px; white-space:nowrap">
<A name="NameOnlyClass">
NameOnlyClass</A></DIV>
<v:rect style="position:absolute; margin-left:30px; margin-top:357px; width:136px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text414_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:38px; margin-top:363px; line-height:15px; white-space:nowrap">
Class&nbsp; NameOnlyClass<BR/>
&nbsp; &nbsp; Public&nbsp; Name<BR/>
&nbsp; &nbsp; Public&nbsp; Delegate<BR/>
End Class</DIV>
<DIV id="text414_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:445px; line-height:15px; white-space:nowrap">
Name 変数（任意の型の識別値）と、Delegate 変数（指しているオブジェクトなど）の<BR/>
対応関係を表すクラスです。<BR/>
Delegate 変数を使わずに、Name だけのオブジェクトとして使うこともできます。</DIV>
<DIV id="text414_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:186px; margin-top:327px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text414_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:545px; line-height:15px; white-space:nowrap">
<A href="vbslib_15.html#ArrayToNameOnlyClassArray">
→ ArrayToNameOnlyClassArray</A></DIV>
<DIV id="text414_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:29px; margin-top:545px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text414_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:567px; line-height:15px; white-space:nowrap">
<A href="#JoinedClass">
→ JoinedClass</A></DIV>
<DIV id="text414_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:502px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_14.html#xml_prop">
xml プロパティ</A></DIV>
<DIV id="text414_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:124px; margin-top:502px; line-height:15px; white-space:nowrap">
に対応しています。</DIV>

<v:line from="0,310" to="531,310"/>
<v:line from="531,310" to="531,614"/>
<v:line from="531,614" to="0,614"/>
<v:line from="0,614" to="0,310"/>

</PAGE>
 
<!-- page 415 --> 
<PAGE>
<A id="svgcats_vml_p415" class="to_tree" style="margin-top:619px;" onClick="selectTreeElem( '415' );">←</A>
<A href="#svgcats_vml_p416" class="to_next_page" style="margin-top:619px;">▼</A>
<A href="#svgcats_vml_p414" class="to_prev_page" style="margin-top:619px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:630px; width:607px; height:132px;" fillcolor="white"/>
<DIV id="text415_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:647px; line-height:15px; white-space:nowrap">
<A name="new_NameOnlyClass">
new_NameOnlyClass</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:677px; width:550px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text415_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:684px; line-height:13px; white-space:nowrap">
Function&nbsp; new_NameOnlyClass( in_Name as string, in_Delegate as variant ) as NameOnlyClass</DIV>
<DIV id="text415_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:714px; line-height:15px; white-space:nowrap">
NameOnlyClass のオブジェクトを生成します。</DIV>
<DIV id="text415_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:257px; margin-top:647px; line-height:15px; white-space:nowrap">
(src)</DIV>

<v:line from="0,630" to="607,630"/>
<v:line from="607,630" to="607,762"/>
<v:line from="607,762" to="0,762"/>
<v:line from="0,762" to="0,630"/>

</PAGE>
 
<!-- page 416 --> 
<PAGE>
<A id="svgcats_vml_p416" class="to_tree" style="margin-top:767px;" onClick="selectTreeElem( '416' );">←</A>
<A href="#svgcats_vml_p417" class="to_next_page" style="margin-top:767px;">▼</A>
<A href="#svgcats_vml_p415" class="to_prev_page" style="margin-top:767px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:778px; width:514px; height:294px;" fillcolor="white"/>
<DIV id="text416_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:795px; line-height:15px; white-space:nowrap">
<A name="JoinedClass">
JoinedClass</A></DIV>
<v:rect style="position:absolute; margin-left:30px; margin-top:825px; width:124px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text416_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:38px; margin-top:831px; line-height:15px; white-space:nowrap">
Class&nbsp; JoinedClass<BR/>
&nbsp; Public&nbsp; Left<BR/>
&nbsp; Public&nbsp; Right<BR/>
End Class</DIV>
<DIV id="text416_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:186px; margin-top:795px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text416_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:74px; margin-top:952px; line-height:15px; white-space:nowrap">
<A href="vbslib_12.html#ArrayClass">
→ ArrayClass</A></DIV>
<DIV id="text416_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:196px; margin-top:952px; line-height:15px; white-space:nowrap">
配列番号 0 と 1 で対応関係を表すことができます</DIV>
<DIV id="text416_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:1000px; line-height:15px; white-space:nowrap">
→ PointerPairClass (clib)</DIV>
<DIV id="text416_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:29px; margin-top:952px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text416_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:913px; line-height:15px; white-space:nowrap">
Left 変数の値と Right 変数の値の対応関係を表すクラスです。</DIV>
<DIV id="text416_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:74px; margin-top:976px; line-height:15px; white-space:nowrap">
<A href="#NameOnlyClass">
→ NameOnlyClass</A></DIV>
<DIV id="text416_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:74px; margin-top:1024px; line-height:15px; white-space:nowrap">
<A href="https://sites.google.com/site/cpprefjp/reference/utility/pair" target="_blank">
→ pair - cpprefjp - C++ Library Reference (Web)</A></DIV>

<v:line from="0,778" to="514,778"/>
<v:line from="514,778" to="514,1072"/>
<v:line from="514,1072" to="0,1072"/>
<v:line from="0,1072" to="0,778"/>

</PAGE>
 
<!-- page 417 --> 
<PAGE>
<A id="svgcats_vml_p417" class="to_tree" style="margin-top:1077px;" onClick="selectTreeElem( '417' );">←</A>
<A href="#svgcats_vml_p418" class="to_next_page" style="margin-top:1077px;">▼</A>
<A href="#svgcats_vml_p416" class="to_prev_page" style="margin-top:1077px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1088px; width:535px; height:229px;" fillcolor="white"/>
<DIV id="text417_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1105px; line-height:15px; white-space:nowrap">
<A name="new_JoinedClass">
new_JoinedClass</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:1135px; width:478px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text417_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:1142px; line-height:13px; white-space:nowrap">
Function&nbsp; new_JoinedClass( Left as variant, Right as variant ) as JoinedClass</DIV>
<DIV id="text417_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:1172px; line-height:15px; white-space:nowrap">
JoinedClass のオブジェクトを生成します。</DIV>
<DIV id="text417_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:1198px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text417_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:1198px; line-height:15px; white-space:nowrap">
Left</DIV>
<DIV id="text417_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:1217px; line-height:15px; white-space:nowrap">
Right</DIV>
<DIV id="text417_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:1198px; line-height:15px; white-space:nowrap">
生成するオブジェクトの Left プロパティに設定する値</DIV>
<DIV id="text417_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:1217px; line-height:15px; white-space:nowrap">
生成するオブジェクトの Right プロパティに設定する値</DIV>
<DIV id="text417_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:1236px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text417_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:1236px; line-height:15px; white-space:nowrap">
生成された JoinedClass のオブジェクト</DIV>
<DIV id="text417_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1269px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text417_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:85px; margin-top:1269px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text417_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:402px; margin-top:1236px; line-height:15px; white-space:nowrap">
<A href="#JoinedClass">
→ JoinedClass</A></DIV>

<v:line from="0,1088" to="535,1088"/>
<v:line from="535,1088" to="535,1317"/>
<v:line from="535,1317" to="0,1317"/>
<v:line from="0,1317" to="0,1088"/>

</PAGE>
 
<!-- page 418 --> 
<PAGE>
<A id="svgcats_vml_p418" class="to_tree" style="margin-top:1322px;" onClick="selectTreeElem( '418' );">←</A>
<A href="#svgcats_vml_p419" class="to_next_page" style="margin-top:1322px;">▼</A>
<A href="#svgcats_vml_p417" class="to_prev_page" style="margin-top:1322px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1333px; width:614px; height:927px;" fillcolor="white"/>
<DIV id="text418_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1350px; line-height:15px; white-space:nowrap">
<A name="g_ObjectIDs">
g_ObjectIDs</A></DIV>
<DIV id="text418_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1382px; line-height:15px; white-space:nowrap">
オブジェクトに数値の ID を割り当て、ID からオブジェクトが取得できるようにします。</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:1689px; width:310px; height:475px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text418_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:54px; margin-top:1695px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set root = new SampleRootClass<BR/>
&nbsp; &nbsp; Set element = new SampleElementClass<BR/>
<BR/>
&nbsp; &nbsp; '// Link<BR/>
&nbsp; &nbsp; element.RootObjectID = root.ObjectID<BR/>
&nbsp; &nbsp; Set root.Element = element<BR/>
<BR/>
&nbsp; &nbsp; '// Call a method<BR/>
&nbsp; &nbsp; element.Method<BR/>
<BR/>
<BR/>
Class&nbsp; SampleRootClass<BR/>
&nbsp; &nbsp; Public&nbsp; ObjectID<BR/>
&nbsp; &nbsp; Public&nbsp; Element<BR/>
<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Me.ObjectID = g_ObjectIDs.Add( Me )<BR/>
&nbsp; &nbsp; End Sub<BR/>
<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Terminate()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; g_ObjectIDs.Remove&nbsp; Me.ObjectID<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class<BR/>
<BR/>
Class&nbsp; SampleElementClass<BR/>
&nbsp; &nbsp; Public&nbsp; RootObjectID<BR/>
<BR/>
&nbsp; &nbsp; Public Sub&nbsp; Method()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set root = g_ObjectIDs( Me.RootObjectID )<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class</DIV>
<DIV id="text418_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1585px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text418_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:1399px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_10.html#Class_Terminate_Mutual">
相互参照しているときの Class_Terminate</A></DIV>
<DIV id="text418_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:260px; margin-top:1399px; line-height:15px; white-space:nowrap">
が期待通りに動作するようになります。</DIV>
<v:rect style="position:absolute; margin-left:46px; margin-top:1625px; width:112px; height:26px;" fillcolor="#F0F3FF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text418_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:1631px; line-height:15px; white-space:nowrap">
SampleRootClass</DIV>
<v:rect style="position:absolute; margin-left:222px; margin-top:1625px; width:131px; height:26px;" fillcolor="#F0F3FF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text418_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:230px; margin-top:1631px; line-height:15px; white-space:nowrap">
SampleElementClass</DIV>
<v:line style="position:absolute;" from="169,1632" to="207,1632" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="207,1632" to="196,1628" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="207,1632" to="196,1636" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="208,1644" to="170,1644" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="170,1644" to="181,1648" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="170,1644" to="181,1640" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text418_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:1607px; line-height:15px; white-space:nowrap">
Element メンバー</DIV>
<DIV id="text418_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:103px; margin-top:1656px; line-height:15px; white-space:nowrap">
RootObjectID メンバー （g_ObjectIDs 経由）</DIV>
<DIV id="text418_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:186px; margin-top:1936px; line-height:13px; white-space:nowrap">
g_ObjectIDs</DIV>
<DIV id="text418_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:102px; margin-top:1996px; line-height:13px; white-space:nowrap">
g_ObjectIDs</DIV>
<DIV id="text418_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:168px; margin-top:2116px; line-height:13px; white-space:nowrap">
g_ObjectIDs</DIV>
<DIV id="text418_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:2189px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text418_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2189px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text418_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:45px; margin-top:1433px; line-height:13px; white-space:nowrap">
.Add</DIV>
<DIV id="text418_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:45px; margin-top:1452px; line-height:13px; white-space:nowrap">
.Remove</DIV>
<DIV id="text418_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:45px; margin-top:1471px; line-height:13px; white-space:nowrap">
.Item</DIV>
<DIV id="text418_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:120px; margin-top:1431px; line-height:15px; white-space:nowrap">
新規 ID を取得します</DIV>
<DIV id="text418_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:120px; margin-top:1450px; line-height:15px; white-space:nowrap">
ID を返却します</DIV>
<DIV id="text418_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1508px; line-height:15px; white-space:nowrap">
Add できる最大数、同時に存在できる ID の数は 0x7FFE です。<BR/>
同時に存在できる ID の数を超えて、Remove と Add を繰り返すと、返却された ID を再利用します。<BR/>
同じオブジェクトに複数の ID が割り当てられる状況になっても、エラーにはなりません。</DIV>
<DIV id="text418_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:120px; margin-top:1469px; line-height:15px; white-space:nowrap">
渡された ID に対応するオブジェクトを返します</DIV>
<DIV id="text418_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:63px; margin-top:2212px; line-height:15px; white-space:nowrap">
<A href="vbslib_13.html#ObjectSetClass">
→ ObjectSetClass</A></DIV>
<DIV id="text418_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2212px; line-height:15px; white-space:nowrap">
関連</DIV>

<v:line from="0,1333" to="614,1333"/>
<v:line from="614,1333" to="614,2260"/>
<v:line from="614,2260" to="0,2260"/>
<v:line from="0,2260" to="0,1333"/>

</PAGE>
 
<!-- page 419 --> 
<PAGE>
<A id="svgcats_vml_p419" class="to_tree" style="margin-top:2265px;" onClick="selectTreeElem( '419' );">←</A>
<A href="#svgcats_vml_p420" class="to_next_page" style="margin-top:2265px;">▼</A>
<A href="#svgcats_vml_p418" class="to_prev_page" style="margin-top:2265px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2276px; width:629px; height:1147px;" fillcolor="white"/>
<DIV id="text419_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2293px; line-height:15px; white-space:nowrap">
<A name="LifeGroupClass">
LifeGroupClass</A></DIV>
<DIV id="text419_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2329px; line-height:15px; white-space:nowrap">
相互参照しているオブジェクトに対して、適切に</DIV>
<v:line style="position:absolute;" from="164,3070" to="164,3137" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="164,3137" to="168,3126" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="164,3137" to="160,3126" strokecolor="#000000" strokeweight="1pt"/>
<A href="#LifeGroupClass_createMember">
<v:rect style="position:absolute; margin-left:292px; margin-top:3141px; width:183px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text419_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:300px; margin-top:3147px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_createMember">
所属オブジェクト（ルート以外）</A></DIV>
<v:line style="position:absolute;" from="133,2952" to="133,2979" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="133,2979" to="137,2968" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="133,2979" to="129,2968" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="234,3149" to="281,3149" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="281,3149" to="270,3145" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="281,3149" to="270,3153" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="281,3159" to="234,3159" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="234,3159" to="245,3163" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="234,3159" to="245,3155" strokecolor="#000000" strokeweight="1pt"/>
<A href="#LifeGroupClass_createRoot">
<v:rect style="position:absolute; margin-left:71px; margin-top:3141px; width:155px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text419_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:79px; margin-top:3147px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_createRoot">
所属オブジェクト（ルート）</A></DIV>
<v:line style="position:absolute;" from="384,2952" to="384,2979" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="384,2979" to="388,2968" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="384,2979" to="380,2968" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="364,3070" to="364,3137" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="364,3137" to="368,3126" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="364,3137" to="360,3126" strokecolor="#000000" strokeweight="1pt"/>
<A href="#LifeGroupClass_Members">
<v:rect style="position:absolute; margin-left:206px; margin-top:3059px; width:71px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text419_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:214px; margin-top:3065px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_Members">
LifeGroup</A></DIV>
<v:line style="position:absolute;" from="249,3006" to="249,3054" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="249,3054" to="253,3043" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="249,3054" to="245,3043" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="234,3006" to="234,3054" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="234,3054" to="238,3043" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="234,3054" to="230,3043" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="249,3006" to="278,3006" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="234,3006" to="203,3006" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="164,3070" to="199,3070" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="364,3070" to="282,3070" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="242,3090" to="242,3140" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="242,3140" to="246,3129" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="242,3140" to="238,3129" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="133,3015" to="133,3137" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="133,3137" to="137,3126" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="133,3137" to="129,3126" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="384,3017" to="384,3137" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="384,3137" to="388,3126" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="384,3137" to="380,3126" strokecolor="#000000" strokeweight="1pt"/>
<A href="#LifeHandleClass">
<v:rect style="position:absolute; margin-left:289px; margin-top:2986px; width:262px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text419_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:297px; margin-top:2992px; line-height:15px; white-space:nowrap">
<A href="#LifeHandleClass">
ハンドル（ルート以外へ） as LifeHandleClass</A></DIV>
<DIV id="text419_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:117px; margin-top:3023px; line-height:15px; white-space:nowrap">
p</DIV>
<DIV id="text419_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:369px; margin-top:3025px; line-height:15px; white-space:nowrap">
p</DIV>
<v:line style="position:absolute;" from="356,3082" to="284,3082" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="284,3082" to="295,3086" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="284,3082" to="295,3078" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="356,3082" to="356,3137" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="175,3137" to="175,3082" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="175,3082" to="197,3082" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="197,3082" to="186,3078" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="197,3082" to="186,3086" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="234,3091" to="234,3125" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="250,3091" to="250,3126" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="234,3126" to="182,3126" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="182,3126" to="193,3130" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="182,3126" to="193,3122" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="250,3126" to="341,3126" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="341,3126" to="330,3122" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="341,3126" to="330,3130" strokecolor="#FF0000" strokeweight="1pt"/>
<A href="#LifeGroupClass_createRoot">
<v:rect style="position:absolute; margin-left:71px; margin-top:2985px; width:125px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
</A>
<DIV id="text419_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:79px; margin-top:2991px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_createRoot">
ハンドル（ルートへ）</A></DIV>
<DIV id="text419_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:81px; margin-top:3173px; line-height:12px; white-space:nowrap">
<A href="#LifeGroupClass_createRoot">
→ グループのルートの生成</A></DIV>
<DIV id="text419_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:319px; margin-top:3172px; line-height:12px; white-space:nowrap">
<A href="#LifeGroupClass_createMember">
→ グループのメンバーの生成</A></DIV>
<DIV id="text419_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:258px; margin-top:3109px; line-height:12px; white-space:nowrap">
<A href="#DestroyReferences">
DestroyReferences</A></DIV>
<v:rect style="position:absolute; margin-left:71px; margin-top:2920px; width:108px; height:26px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text419_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:2926px; line-height:15px; white-space:nowrap">
ユーザーの変数</DIV>
<v:rect style="position:absolute; margin-left:289px; margin-top:2920px; width:108px; height:26px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text419_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:297px; margin-top:2926px; line-height:15px; white-space:nowrap">
ユーザーの変数</DIV>
<DIV id="text419_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:24px; margin-top:3219px; line-height:15px; white-space:nowrap">
所属オブジェクトのメンバー変数やメソッドにアクセスするときは、ハンドルのメンバー変数 p を<BR/>
介する必要があります。 </DIV>
<DIV id="text419_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:229px; margin-top:3171px; line-height:15px; white-space:nowrap">
相互参照</DIV>
<DIV id="text419_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3356px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text419_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:2626px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_10.html#Class_Terminate_Mutual">
→ 相互参照しているときの Class_Terminate</A></DIV>
<DIV id="text419_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:2645px; line-height:15px; white-space:nowrap">
→ ガーベージコレクション (GC)</DIV>
<DIV id="text419_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2626px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text419_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2688px; line-height:15px; white-space:nowrap">
一般に、関数が終了したときにオブジェクトを参照している変数がなくなると、ガーベージコレクター</DIV>
<DIV id="text419_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:65px; margin-top:2902px; line-height:15px; white-space:nowrap">
(1)</DIV>
<DIV id="text419_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:65px; margin-top:2966px; line-height:15px; white-space:nowrap">
(2)</DIV>
<DIV id="text419_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:282px; margin-top:2904px; line-height:15px; white-space:nowrap">
(3)</DIV>
<DIV id="text419_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:282px; margin-top:2968px; line-height:15px; white-space:nowrap">
(4)</DIV>
<DIV id="text419_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:65px; margin-top:3121px; line-height:15px; white-space:nowrap">
(5)</DIV>
<DIV id="text419_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:452px; margin-top:3124px; line-height:15px; white-space:nowrap">
(7)</DIV>
<DIV id="text419_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:197px; margin-top:3043px; line-height:15px; white-space:nowrap">
(6)</DIV>
<DIV id="text419_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2770px; line-height:15px; white-space:nowrap">
内部で相互参照するグループに LifeGroupClass を使うと下記の図のような構成になります。<BR/>
グループに所属しているオブジェクトの Class_Terminate が呼び出されるタイミングは、<BR/>
グループに所属しているオブジェクト（ルート オブジェクトも含む）を参照するすべてのハンドルが、<BR/>
すべてのユーザーの変数から参照されなくなったときです。<BR/>
( ) の中の数字は、削除される順番です。 <BR/>
(1) と (3)、(2) と (4)、(5) と (7) の順番は入れ替わることがあります。 <BR/>
(1) だけが削除されたときは、(3)が削除されるまで、(4)以降のオブジェクトは残ります。</DIV>
<DIV id="text419_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2704px; line-height:15px; white-space:nowrap">
によって</DIV>
<DIV id="text419_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:2720px; line-height:15px; white-space:nowrap">
プログラム終了時に呼ばれます。 LifeGroupClass は、相互参照しているオブジェクトでも <BR/>
Class_Terminate が呼び出されるようにします。</DIV>
<DIV id="text419_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:176px; margin-top:2704px; line-height:15px; white-space:nowrap">
が呼ばれますが、相互参照していると Class_Terminate は呼ばれません。 </DIV>
<DIV id="text419_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:76px; margin-top:2704px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_10.html#Class_Terminate">
Class_Terminate</A></DIV>
<DIV id="text419_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3250px; line-height:15px; white-space:nowrap">
このように相互参照しているオブジェクトとハンドルのオブジェクトを分けることで、<BR/>
参照している変数がなくなったことをハンドルで検出できるようにしています。</DIV>
<DIV id="text419_58" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:212px; margin-top:3356px; line-height:15px; white-space:nowrap">
オブジェクト ID を経由することで Class_Terminate を呼び出す</DIV>
<v:rect style="position:absolute; margin-left:103px; margin-top:2363px; width:23px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text419_59" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:111px; margin-top:2369px; line-height:15px; white-space:nowrap">
A</DIV>
<v:rect style="position:absolute; margin-left:210px; margin-top:2363px; width:25px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text419_60" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:218px; margin-top:2369px; line-height:15px; white-space:nowrap">
B</DIV>
<v:line style="position:absolute;" from="140,2371" to="199,2371" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="199,2371" to="188,2367" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="199,2371" to="188,2375" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="198,2379" to="139,2379" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="139,2379" to="150,2383" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="139,2379" to="150,2375" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text419_63" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:142px; margin-top:2390px; line-height:15px; white-space:nowrap">
相互参照</DIV>
<DIV id="text419_64" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:3331px; line-height:15px; white-space:nowrap">
→ T_Dic.vbs</DIV>
<DIV id="text419_65" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:209px; margin-top:3331px; line-height:15px; white-space:nowrap">
T_LifeGroupClass</DIV>
<DIV id="text419_66" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:3306px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text419_67" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3331px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text419_68" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3306px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text419_69" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:24px; margin-top:2426px; line-height:15px; white-space:nowrap">
注意</DIV>
<DIV id="text419_70" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:2426px; line-height:15px; white-space:nowrap">
メンバー変数やメソッドにアクセスするときは、メンバー変数 p を介する必要があります。 </DIV>
<DIV id="text419_71" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:197px; margin-top:2454px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_createRoot">
→ グループのルートの使用サンプル</A></DIV>
<DIV id="text419_72" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:2490px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_08.html#dic">
辞書</A></DIV>
<DIV id="text419_73" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:97px; margin-top:2490px; line-height:15px; white-space:nowrap">
のキーや配列番号で参照することで、相互参照が原因で Class_Terminate が呼ばれなく</DIV>
<DIV id="text419_74" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:68px; margin-top:2507px; line-height:15px; white-space:nowrap">
なる状況を回避することができます。</DIV>
<v:rect style="position:absolute; margin-left:89px; margin-top:2449px; width:94px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text419_75" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:97px; margin-top:2456px; line-height:13px; white-space:nowrap">
root.p.Member</DIV>
<DIV id="text419_76" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:142px; margin-top:2575px; line-height:15px; white-space:nowrap">
辞書のキーや配列番号</DIV>
<v:line style="position:absolute;" from="280,2564" to="140,2564" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="140,2564" to="151,2568" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="140,2564" to="151,2560" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="140,2556" to="280,2556" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="280,2556" to="269,2552" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="280,2556" to="269,2560" strokecolor="#000000" strokeweight="1pt"/>
<v:rect style="position:absolute; margin-left:292px; margin-top:2548px; width:25px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text419_79" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:300px; margin-top:2554px; line-height:15px; white-space:nowrap">
B</DIV>
<v:rect style="position:absolute; margin-left:103px; margin-top:2548px; width:23px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text419_80" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:111px; margin-top:2554px; line-height:15px; white-space:nowrap">
A</DIV>
<DIV id="text419_81" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:159px; margin-top:2537px; line-height:15px; white-space:nowrap">
オブジェクトの Set</DIV>
<DIV id="text419_82" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:287px; margin-top:2329px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_10.html#Class_Terminate">
Class_Terminate</A></DIV>
<DIV id="text419_83" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:385px; margin-top:2329px; line-height:15px; white-space:nowrap">
が呼ばれるようにします。</DIV>
<DIV id="text419_84" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:286px; margin-top:2507px; line-height:15px; white-space:nowrap">
<A href="#g_ObjectIDs">
→ g_ObjectIDs</A></DIV>
<DIV id="text419_85" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:212px; margin-top:3375px; line-height:15px; white-space:nowrap">
p を介する必要がないが、多少手間がかかるライフサイクル管理</DIV>
<DIV id="text419_86" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:3375px; line-height:15px; white-space:nowrap">
<A href="#DestroyerClass">
→ DestroyerClass</A></DIV>
<DIV id="text419_87" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:3356px; line-height:15px; white-space:nowrap">
<A href="#g_ObjectIDs">
→ g_ObjectIDs</A></DIV>

<v:line from="0,2276" to="629,2276"/>
<v:line from="629,2276" to="629,3423"/>
<v:line from="629,3423" to="0,3423"/>
<v:line from="0,3423" to="0,2276"/>

</PAGE>
 
<!-- page 420 --> 
<PAGE>
<A id="svgcats_vml_p420" class="to_tree" style="margin-top:3428px;" onClick="selectTreeElem( '420' );">←</A>
<A href="#svgcats_vml_p421" class="to_next_page" style="margin-top:3428px;">▼</A>
<A href="#svgcats_vml_p419" class="to_prev_page" style="margin-top:3428px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3439px; width:583px; height:822px;" fillcolor="white"/>
<DIV id="text420_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3456px; line-height:15px; white-space:nowrap">
<A name="LifeGroupClass_createRoot">
グループのルートの生成 （LifeGroupClass）</A></DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:3783px; width:412px; height:205px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text420_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:3789px; line-height:15px; white-space:nowrap">
Class&nbsp; RootClass<BR/>
&nbsp; &nbsp; Public&nbsp; p&nbsp; '// as RootBodyClass : Target object of this handle<BR/>
<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Initialize()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set group = new LifeGroupClass<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; group.AddHandle&nbsp; Me, new RootBodyClass<BR/>
&nbsp; &nbsp; End Sub<BR/>
<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Terminate()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; If not IsEmpty( Me.p.LifeGroup.Group ) Then _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Me.p.LifeGroup.Group.AddTerminated&nbsp; Me.p<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class</DIV>
<DIV id="text420_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3593px; line-height:15px; white-space:nowrap">
使用サンプル</DIV>
<DIV id="text420_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:247px; margin-top:3865px; line-height:13px; white-space:nowrap">
RootBodyClass</DIV>
<DIV id="text420_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3489px; line-height:15px; white-space:nowrap">
相互参照しているオブジェクトのグループのうち、最初に生成するオブジェクトのハンドルの<BR/>
クラスは、下記のように定義します。 RootBodyClass を最初に生成するオブジェクトのクラス名<BR/>
に変更すること以外は、そのままにしてください。</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:4064px; width:442px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text420_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:4070px; line-height:15px; white-space:nowrap">
Class&nbsp; RootBodyClass<BR/>
&nbsp; &nbsp; &nbsp; :<BR/>
&nbsp; &nbsp; Public&nbsp; LifeGroup&nbsp; '// Don't write except for LifeGroupClass ■追加<BR/>
<BR/>
&nbsp; &nbsp; Public Sub&nbsp; DestroyReferences()&nbsp; '// ■追加<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Me.Reference = Empty<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class</DIV>
<DIV id="text420_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:40px; margin-top:4022px; line-height:15px; white-space:nowrap">
最初に生成するオブジェクトのクラスは、メンバー変数 LifeGroup と、</DIV>
<DIV id="text420_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:40px; margin-top:4037px; line-height:15px; white-space:nowrap">
<A href="#DestroyReferences">
DestroyReferences メソッド</A></DIV>
<DIV id="text420_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:194px; margin-top:4037px; line-height:15px; white-space:nowrap">
を定義してください。</DIV>
<DIV id="text420_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:258px; margin-top:3553px; line-height:15px; white-space:nowrap">
<A href="#LifeHandleClass">
LifeHandleClass</A></DIV>
<DIV id="text420_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3758px; line-height:15px; white-space:nowrap">
定義サンプル</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:3619px; width:160px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text420_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:3625px; line-height:15px; white-space:nowrap">
Set root = new RootClass<BR/>
root.p.Member</DIV>
<DIV id="text420_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:353px; margin-top:3553px; line-height:15px; white-space:nowrap">
と同じメンバーを持ちます。</DIV>
<DIV id="text420_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:411px; margin-top:3456px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass">
&lt;&lt; LifeGroupClass</A></DIV>
<DIV id="text420_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3553px; line-height:15px; white-space:nowrap">
グループのルート（下記の RootClass）は、</DIV>
<DIV id="text420_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:91px; margin-top:3790px; line-height:13px; white-space:nowrap">
RootClass</DIV>
<DIV id="text420_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:91px; margin-top:4071px; line-height:13px; white-space:nowrap">
RootBodyClass</DIV>
<DIV id="text420_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:115px; margin-top:4146px; line-height:13px; white-space:nowrap">
Reference</DIV>
<DIV id="text420_19" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:79px; margin-top:3641px; line-height:13px; white-space:nowrap">
p</DIV>
<DIV id="text420_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:3667px; line-height:15px; white-space:nowrap">
メンバー変数やメソッドにアクセスするときは、メンバー変数 p を介する必要があります。</DIV>
<DIV id="text420_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:219px; margin-top:3639px; line-height:15px; white-space:nowrap">
… p の追加が必要</DIV>
<DIV id="text420_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:3698px; line-height:15px; white-space:nowrap">
相互参照しているオブジェクトを使用するコードに、この変更を要求することがどうしても<BR/>
できないなら、p を介すだけのメソッドやプロパティを定義します。</DIV>
<v:line style="position:absolute;" from="141,4072" to="284,3883" strokecolor="#7CFF11" strokeweight="1pt"/>
<DIV id="text420_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:145px; margin-top:4131px; line-height:13px; white-space:nowrap">
<A href="#DestroyReferences">
DestroyReferences</A></DIV>
<DIV id="text420_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:193px; margin-top:3850px; line-height:13px; white-space:nowrap">
<A href="#LifeGroupClass_Members">
LifeGroupClass</A></DIV>
<DIV id="text420_26" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:133px; margin-top:3865px; line-height:13px; white-space:nowrap">
<A href="#AddHandle_LifeGroupClass">
AddHandle</A></DIV>

<v:line from="0,3439" to="583,3439"/>
<v:line from="583,3439" to="583,4261"/>
<v:line from="583,4261" to="0,4261"/>
<v:line from="0,4261" to="0,3439"/>

</PAGE>
 
<!-- page 421 --> 
<PAGE>
<A id="svgcats_vml_p421" class="to_tree" style="margin-top:4266px;" onClick="selectTreeElem( '421' );">←</A>
<A href="#svgcats_vml_p422" class="to_next_page" style="margin-top:4266px;">▼</A>
<A href="#svgcats_vml_p420" class="to_prev_page" style="margin-top:4266px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4277px; width:577px; height:774px;" fillcolor="white"/>
<DIV id="text421_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4294px; line-height:15px; white-space:nowrap">
<A name="LifeGroupClass_createMember">
グループに所属するオブジェクトの生成 （LifeGroupClass）</A></DIV>
<DIV id="text421_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4327px; line-height:15px; white-space:nowrap">
相互参照しているオブジェクトのグループに所属するオブジェクトのメソッドから、グループに<BR/>
所属させるオブジェクトを新しく生成するときは、下記の CreateMember メソッドのように、<BR/>
グループに追加します。&nbsp; そうしなければ、グループが削除されるタイミングで、生成した<BR/>
オブジェクトに対して DestroyReferences が呼ばれなくなります。</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:4560px; width:424px; height:145px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text421_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:4566px; line-height:15px; white-space:nowrap">
Class&nbsp; RootBodyClass<BR/>
&nbsp; &nbsp; &nbsp; :<BR/>
&nbsp; &nbsp; Public&nbsp; LifeGroup&nbsp; '// Don't write except for LifeGroupClass<BR/>
<BR/>
&nbsp; &nbsp; Function&nbsp; CreateMember()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set CreateMember = Me.LifeGroup.Group.Add( new MemberClass )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :<BR/>
&nbsp; &nbsp; End Function<BR/>
End Class</DIV>
<DIV id="text421_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4536px; line-height:15px; white-space:nowrap">
定義サンプル</DIV>
<DIV id="text421_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:379px; margin-top:4642px; line-height:13px; white-space:nowrap">
MemberClass</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:4889px; width:442px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text421_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:4895px; line-height:15px; white-space:nowrap">
Class&nbsp; MemberClass<BR/>
&nbsp; &nbsp; &nbsp; :<BR/>
&nbsp; &nbsp; Public&nbsp; LifeGroup&nbsp; '// Don't write except for LifeGroupClass ■追加<BR/>
<BR/>
&nbsp; &nbsp; Public Sub&nbsp; DestroyReferences()&nbsp; '// ■追加<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Me.Reference = Empty<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class</DIV>
<DIV id="text421_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:40px; margin-top:4850px; line-height:15px; white-space:nowrap">
グループに所属するオブジェクトのクラスは、メンバー変数 LifeGroup と、</DIV>
<DIV id="text421_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4827px; line-height:15px; white-space:nowrap">
定義サンプル</DIV>
<DIV id="text421_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:40px; margin-top:4865px; line-height:15px; white-space:nowrap">
<A href="#DestroyReferences">
DestroyReferences メソッド</A></DIV>
<DIV id="text421_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:194px; margin-top:4865px; line-height:15px; white-space:nowrap">
を定義してください。</DIV>
<DIV id="text421_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:225px; margin-top:4403px; line-height:15px; white-space:nowrap">
<A href="#LifeHandleClass">
LifeHandleClass</A></DIV>
<DIV id="text421_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:320px; margin-top:4403px; line-height:15px; white-space:nowrap">
です。</DIV>
<DIV id="text421_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4403px; line-height:15px; white-space:nowrap">
CreateMember メソッドの返り値は、</DIV>
<DIV id="text421_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4447px; line-height:15px; white-space:nowrap">
使用サンプル</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:4473px; width:220px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text421_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:4479px; line-height:15px; white-space:nowrap">
Set root = new RootClass<BR/>
Set member = root.p.CreateMember()</DIV>
<DIV id="text421_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:409px; margin-top:4294px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass">
&lt;&lt; LifeGroupClass</A></DIV>
<DIV id="text421_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:91px; margin-top:4896px; line-height:13px; white-space:nowrap">
MemberClass</DIV>
<DIV id="text421_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:325px; margin-top:4642px; line-height:13px; white-space:nowrap">
<A href="#Add_LifeGroupClass">
Add</A></DIV>
<DIV id="text421_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:4710px; line-height:15px; white-space:nowrap">
すぐに CreateMember の返り値を参照しなくなっても、DestroyReferences がすぐに呼ば<BR/>
れることはありません。 グループに所属するすべてのオブジェクトが参照されなくなった<BR/>
ときに呼び出されます。<BR/>
ルートのハンドルが参照されなくなったときに、グループに所属する一部のオブジェクトが<BR/>
削除されても構わないときは、ハンドルの代わりに生成したオブジェクトを返しても構いま<BR/>
せん。</DIV>

<v:line from="0,4277" to="577,4277"/>
<v:line from="577,4277" to="577,5051"/>
<v:line from="577,5051" to="0,5051"/>
<v:line from="0,5051" to="0,4277"/>

</PAGE>
 
<!-- page 422 --> 
<PAGE>
<A id="svgcats_vml_p422" class="to_tree" style="margin-top:5056px;" onClick="selectTreeElem( '422' );">←</A>
<A href="#svgcats_vml_p423" class="to_next_page" style="margin-top:5056px;">▼</A>
<A href="#svgcats_vml_p421" class="to_prev_page" style="margin-top:5056px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5067px; width:565px; height:493px;" fillcolor="white"/>
<DIV id="text422_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5084px; line-height:15px; white-space:nowrap">
<A name="LifeGroupClass_getMember">
グループに所属するオブジェクトの出力 （LifeGroupClass）</A></DIV>
<DIV id="text422_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:5117px; line-height:15px; white-space:nowrap">
相互参照しているオブジェクトを出力するときは、下記の SearchMember メソッドのように、 </DIV>
<DIV id="text422_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:223px; margin-top:5134px; line-height:15px; white-space:nowrap">
<A href="#LifeHandleClass">
LifeHandleClass</A></DIV>
<DIV id="text422_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:318px; margin-top:5134px; line-height:15px; white-space:nowrap">
を生成して返してください。</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:5399px; width:406px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text422_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:5405px; line-height:15px; white-space:nowrap">
Class&nbsp; RootBodyClass<BR/>
&nbsp; &nbsp; &nbsp; :<BR/>
&nbsp; &nbsp; Public&nbsp; LifeGroup&nbsp; '// Don't write except for LifeGroupClass<BR/>
<BR/>
&nbsp; &nbsp; Function&nbsp; GetReference()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Set GetReference = Me.LifeGroup.Group.Add( Me.Reference )<BR/>
&nbsp; &nbsp; End Function<BR/>
End Class</DIV>
<DIV id="text422_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5375px; line-height:15px; white-space:nowrap">
定義サンプル</DIV>
<DIV id="text422_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5286px; line-height:15px; white-space:nowrap">
使用サンプル</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:5312px; width:220px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text422_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:5318px; line-height:15px; white-space:nowrap">
Set root = new RootClass<BR/>
Set member = root.p.GetReference()</DIV>
<DIV id="text422_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:5134px; line-height:15px; white-space:nowrap">
<A href="#Add_LifeGroupClass">
Add (LifeGroupClass)</A></DIV>
<DIV id="text422_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:149px; margin-top:5134px; line-height:15px; white-space:nowrap">
を呼び出し、</DIV>
<DIV id="text422_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:133px; margin-top:5466px; line-height:13px; white-space:nowrap">
GetReference</DIV>
<DIV id="text422_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:5236px; line-height:15px; white-space:nowrap">
ただし、グループの中で参照するときは、LifeHandleClass を生成しないでください。</DIV>
<DIV id="text422_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:5150px; line-height:15px; white-space:nowrap">
そうしなければ、ルートのハンドルが削除されるタイミングで、グループに所属する一部の<BR/>
オブジェクトが削除されてしまいます。 ルートのハンドルが参照されなくなったら、グループ<BR/>
に所属する一部のオブジェクトが削除されても構わないときは、LifeHandleClass を生成<BR/>
しなくても構いません。</DIV>

<v:line from="0,5067" to="565,5067"/>
<v:line from="565,5067" to="565,5560"/>
<v:line from="565,5560" to="0,5560"/>
<v:line from="0,5560" to="0,5067"/>

</PAGE>
 
<!-- page 423 --> 
<PAGE>
<A id="svgcats_vml_p423" class="to_tree" style="margin-top:5565px;" onClick="selectTreeElem( '423' );">←</A>
<A href="#svgcats_vml_p424" class="to_next_page" style="margin-top:5565px;">▼</A>
<A href="#svgcats_vml_p422" class="to_prev_page" style="margin-top:5565px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5576px; width:493px; height:391px;" fillcolor="white"/>
<DIV id="text423_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5593px; line-height:15px; white-space:nowrap">
<A name="DestroyReferences">
DestroyReferences メソッド</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:5623px; width:436px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text423_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:5630px; line-height:13px; white-space:nowrap">
Sub&nbsp; （グループのに所属するオブジェクトのクラス）::DestroyReferences()</DIV>
<DIV id="text423_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5660px; line-height:15px; white-space:nowrap">
相互参照を切ります。</DIV>
<DIV id="text423_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5688px; line-height:15px; white-space:nowrap">
グループのユーザーは、本メソッドを直接呼び出さないでください。</DIV>
<DIV id="text423_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5736px; line-height:15px; white-space:nowrap">
Class_Terminate メソッド（デストラクター）が呼び出されて、オブジェクトが<BR/>
破棄されるように、相互参照を切ってください。 つまり、相互に参照している<BR/>
関係にあるメンバー変数に Empty や Nothing を代入してください。</DIV>
<DIV id="text423_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:340px; margin-top:5593px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass">
&lt;&lt; LifeGroupClass</A></DIV>
<DIV id="text423_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:33px; margin-top:5704px; line-height:15px; white-space:nowrap">
<A href="#AddTerminated_LifeGroupClass">
AddTerminated (LifeGroupClass)</A></DIV>
<DIV id="text423_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:219px; margin-top:5704px; line-height:15px; white-space:nowrap">
から呼ばれます。</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:5835px; width:214px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text423_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:5841px; line-height:15px; white-space:nowrap">
Class&nbsp; RootBodyClass<BR/>
&nbsp; &nbsp; &nbsp; :<BR/>
&nbsp; &nbsp; Function&nbsp; DestroyReferences()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Me.Member = Empty<BR/>
&nbsp; &nbsp; End Function<BR/>
End Class</DIV>
<DIV id="text423_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5811px; line-height:15px; white-space:nowrap">
定義サンプル</DIV>

<v:line from="0,5576" to="493,5576"/>
<v:line from="493,5576" to="493,5967"/>
<v:line from="493,5967" to="0,5967"/>
<v:line from="0,5967" to="0,5576"/>

</PAGE>
 
<!-- page 424 --> 
<PAGE>
<A id="svgcats_vml_p424" class="to_tree" style="margin-top:5972px;" onClick="selectTreeElem( '424' );">←</A>
<A href="#svgcats_vml_p425" class="to_next_page" style="margin-top:5972px;">▼</A>
<A href="#svgcats_vml_p423" class="to_prev_page" style="margin-top:5972px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5983px; width:612px; height:498px;" fillcolor="white"/>
<DIV id="text424_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6000px; line-height:15px; white-space:nowrap">
<A name="LifeHandleClass">
LifeHandleClass</A></DIV>
<DIV id="text424_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:6031px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass">
LifeGroupClass</A></DIV>
<DIV id="text424_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:115px; margin-top:6031px; line-height:15px; white-space:nowrap">
（グループ）に所属する、相互参照しているオブジェクトを参照できるハンドル。</DIV>
<DIV id="text424_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6106px; line-height:15px; white-space:nowrap">
LifeHandleClass が参照している、相互参照しているオブジェクトを、グループの外にある変数<BR/>
に直接格納しないでください。 もしそうしてしまうと、すべてのハンドルへの参照が無くなったときに、<BR/>
相互参照が切れたオブジェクトになり、正しく動作しなくなります。</DIV>
<DIV id="text424_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:48px; margin-top:6411px; line-height:15px; white-space:nowrap">
<A href="#p_LifeHandleClass">
→ p</A></DIV>
<DIV id="text424_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6384px; line-height:15px; white-space:nowrap">
メンバー</DIV>
<DIV id="text424_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:48px; margin-top:6433px; line-height:15px; white-space:nowrap">
<A href="#Class_Terminate_LifeHandleClass">
→ Class_Terminate</A></DIV>
<DIV id="text424_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6287px; line-height:15px; white-space:nowrap">
生成</DIV>
<DIV id="text424_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:48px; margin-top:6314px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_createRoot">
→ グループのルートの生成</A></DIV>
<DIV id="text424_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:48px; margin-top:6337px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_createMember">
→ グループのメンバーの生成</A></DIV>
<DIV id="text424_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:184px; margin-top:6411px; line-height:15px; white-space:nowrap">
相互参照しているオブジェクトを参照します。</DIV>
<DIV id="text424_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:184px; margin-top:6433px; line-height:15px; white-space:nowrap">
<A href="#AddTerminated_LifeGroupClass">
AddTerminated (LifeGroupClass)</A></DIV>
<DIV id="text424_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:369px; margin-top:6433px; line-height:15px; white-space:nowrap">
を呼び出します。</DIV>
<DIV id="text424_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:419px; margin-top:6000px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass">
&lt;&lt; LifeGroupClass</A></DIV>
<DIV id="text424_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6062px; line-height:15px; white-space:nowrap">
オブジェクトのメンバー変数やメソッドにアクセスするときは、メンバー変数 p を介する必要が<BR/>
あります。 </DIV>
<v:rect style="position:absolute; margin-left:49px; margin-top:6196px; width:406px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text424_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:57px; margin-top:6202px; line-height:15px; white-space:nowrap">
Set root = new RootClass<BR/>
Set member = root.p.CreateMember()&nbsp; '// member as LifeHandleClass<BR/>
member.p.Method</DIV>
<DIV id="text424_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6173px; line-height:15px; white-space:nowrap">
サンプル</DIV>

<v:line from="0,5983" to="612,5983"/>
<v:line from="612,5983" to="612,6481"/>
<v:line from="612,6481" to="0,6481"/>
<v:line from="0,6481" to="0,5983"/>

</PAGE>
 
<!-- page 425 --> 
<PAGE>
<A id="svgcats_vml_p425" class="to_tree" style="margin-top:6486px;" onClick="selectTreeElem( '425' );">←</A>
<A href="#svgcats_vml_p426" class="to_next_page" style="margin-top:6486px;">▼</A>
<A href="#svgcats_vml_p424" class="to_prev_page" style="margin-top:6486px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6497px; width:585px; height:224px;" fillcolor="white"/>
<DIV id="text425_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6514px; line-height:15px; white-space:nowrap">
<A name="p_LifeHandleClass">
p (LifeHandleClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:6544px; width:214px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text425_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:6551px; line-height:13px; white-space:nowrap">
Dim&nbsp; LifeHandleClass::p as Object</DIV>
<DIV id="text425_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6581px; line-height:15px; white-space:nowrap">
グループに所属している相互参照しているオブジェクトを参照します。</DIV>
<DIV id="text425_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:407px; margin-top:6514px; line-height:15px; white-space:nowrap">
<A href="#LifeHandleClass">
&lt;&lt; LifeHandleClass</A></DIV>
<DIV id="text425_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:70px; margin-top:6673px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass">
→ LifeGroupClass</A></DIV>
<DIV id="text425_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6673px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text425_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6609px; line-height:15px; white-space:nowrap">
オブジェクトのメンバー変数やメソッドにアクセスするときは、ハンドルのメンバー変数 p を<BR/>
介する必要があります。&nbsp; このように相互参照しているオブジェクトとハンドルのオブジェクトを<BR/>
分けることで、参照している変数がなくなったことをハンドルで検出できるようにしています。</DIV>

<v:line from="0,6497" to="585,6497"/>
<v:line from="585,6497" to="585,6721"/>
<v:line from="585,6721" to="0,6721"/>
<v:line from="0,6721" to="0,6497"/>

</PAGE>
 
<!-- page 426 --> 
<PAGE>
<A id="svgcats_vml_p426" class="to_tree" style="margin-top:6726px;" onClick="selectTreeElem( '426' );">←</A>
<A href="#svgcats_vml_p427" class="to_next_page" style="margin-top:6726px;">▼</A>
<A href="#svgcats_vml_p425" class="to_prev_page" style="margin-top:6726px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6737px; width:563px; height:132px;" fillcolor="white"/>
<DIV id="text426_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6754px; line-height:15px; white-space:nowrap">
<A name="Class_Terminate_LifeHandleClass">
Class_Terminate (LifeHandleClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:6784px; width:250px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text426_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:6791px; line-height:13px; white-space:nowrap">
Sub&nbsp; LifeHandleClass::Class_Terminate()</DIV>
<DIV id="text426_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6821px; line-height:15px; white-space:nowrap">
ハンドルが参照されなくなったときに、</DIV>
<DIV id="text426_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:330px; margin-top:6754px; line-height:15px; white-space:nowrap">
<A href="#LifeHandleClass">
&lt;&lt; LifeHandleClass</A></DIV>
<DIV id="text426_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:243px; margin-top:6821px; line-height:15px; white-space:nowrap">
<A href="#AddTerminated_LifeGroupClass">
AddTerminated (LifeGroupClass)</A></DIV>
<DIV id="text426_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:428px; margin-top:6821px; line-height:15px; white-space:nowrap">
を呼び出します。</DIV>

<v:line from="0,6737" to="563,6737"/>
<v:line from="563,6737" to="563,6869"/>
<v:line from="563,6869" to="0,6869"/>
<v:line from="0,6869" to="0,6737"/>

</PAGE>
 
<!-- page 427 --> 
<PAGE>
<A id="svgcats_vml_p427" class="to_tree" style="margin-top:6874px;" onClick="selectTreeElem( '427' );">←</A>
<A href="#svgcats_vml_p428" class="to_next_page" style="margin-top:6874px;">▼</A>
<A href="#svgcats_vml_p426" class="to_prev_page" style="margin-top:6874px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6885px; width:669px; height:170px;" fillcolor="white"/>
<DIV id="text427_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6902px; line-height:15px; white-space:nowrap">
<A name="LifeGroupClass_Members">
LifeGroupClass のメンバー</A></DIV>
<DIV id="text427_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:6937px; line-height:15px; white-space:nowrap">
<A href="#AddHandle_LifeGroupClass">
→ AddHandle</A></DIV>
<DIV id="text427_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:6960px; line-height:15px; white-space:nowrap">
<A href="#Add_LifeGroupClass">
→ Add</A></DIV>
<DIV id="text427_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:6984px; line-height:15px; white-space:nowrap">
<A href="#Remove_LifeGroupClass">
→ Remove</A></DIV>
<DIV id="text427_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:37px; margin-top:7007px; line-height:15px; white-space:nowrap">
<A href="#AddTerminated_LifeGroupClass">
→ AddTerminated</A></DIV>
<DIV id="text427_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:158px; margin-top:6937px; line-height:15px; white-space:nowrap">
オブジェクトをグループに追加し、ハンドルからオブジェクトを参照できるようにします</DIV>
<DIV id="text427_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:158px; margin-top:6960px; line-height:15px; white-space:nowrap">
オブジェクトをグループに追加して、そのオブジェクトを参照するハンドルを生成します</DIV>
<DIV id="text427_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:158px; margin-top:6983px; line-height:15px; white-space:nowrap">
オブジェクトをグループから除外します</DIV>
<DIV id="text427_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:158px; margin-top:7006px; line-height:15px; white-space:nowrap">
ハンドルから参照されるカウンターを減らし、必要なら相互参照を切ります</DIV>
<DIV id="text427_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:500px; margin-top:6902px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass">
&lt;&lt; LifeGroupClass</A></DIV>

<v:line from="0,6885" to="669,6885"/>
<v:line from="669,6885" to="669,7055"/>
<v:line from="669,7055" to="0,7055"/>
<v:line from="0,7055" to="0,6885"/>

</PAGE>
 
<!-- page 428 --> 
<PAGE>
<A id="svgcats_vml_p428" class="to_tree" style="margin-top:7060px;" onClick="selectTreeElem( '428' );">←</A>
<A href="#svgcats_vml_p429" class="to_next_page" style="margin-top:7060px;">▼</A>
<A href="#svgcats_vml_p427" class="to_prev_page" style="margin-top:7060px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7071px; width:545px; height:180px;" fillcolor="white"/>
<DIV id="text428_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7088px; line-height:15px; white-space:nowrap">
<A name="AddHandle_LifeGroupClass">
AddHandle (LifeGroupClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:7118px; width:424px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text428_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:7125px; line-height:13px; white-space:nowrap">
Sub&nbsp; LifeGroupClass::AddHandle( Handle as Object, Object as Object )</DIV>
<DIV id="text428_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7155px; line-height:15px; white-space:nowrap">
オブジェクトをグループに追加し、ハンドルからオブジェクトを参照できるようにします。</DIV>
<DIV id="text428_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7183px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text428_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7183px; line-height:15px; white-space:nowrap">
Handle</DIV>
<DIV id="text428_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:7183px; line-height:15px; white-space:nowrap">
（ルートの）ハンドル</DIV>
<DIV id="text428_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:7203px; line-height:15px; white-space:nowrap">
ハンドルが参照しようとしているオブジェクト</DIV>
<DIV id="text428_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7203px; line-height:15px; white-space:nowrap">
Object</DIV>
<DIV id="text428_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:325px; margin-top:7088px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_Members">
&lt;&lt; LifeGroupClass のメンバー</A></DIV>

<v:line from="0,7071" to="545,7071"/>
<v:line from="545,7071" to="545,7251"/>
<v:line from="545,7251" to="0,7251"/>
<v:line from="0,7251" to="0,7071"/>

</PAGE>
 
<!-- page 429 --> 
<PAGE>
<A id="svgcats_vml_p429" class="to_tree" style="margin-top:7256px;" onClick="selectTreeElem( '429' );">←</A>
<A href="#svgcats_vml_p430" class="to_next_page" style="margin-top:7256px;">▼</A>
<A href="#svgcats_vml_p428" class="to_prev_page" style="margin-top:7256px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7267px; width:588px; height:182px;" fillcolor="white"/>
<DIV id="text429_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7284px; line-height:15px; white-space:nowrap">
<A name="Add_LifeGroupClass">
Add (LifeGroupClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:7314px; width:424px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text429_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:7321px; line-height:13px; white-space:nowrap">
Function&nbsp; LifeGroupClass::Add( Object as Object ) as LifeHandleClass</DIV>
<DIV id="text429_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7351px; line-height:15px; white-space:nowrap">
オブジェクトをグループに追加して、そのオブジェクトを参照するハンドルを生成して返します。</DIV>
<DIV id="text429_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7379px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text429_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7379px; line-height:15px; white-space:nowrap">
Object</DIV>
<DIV id="text429_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:7379px; line-height:15px; white-space:nowrap">
ハンドルが参照しようとしているオブジェクト</DIV>
<DIV id="text429_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7401px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text429_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:7401px; line-height:15px; white-space:nowrap">
生成されたハンドル</DIV>
<DIV id="text429_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:323px; margin-top:7284px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_Members">
&lt;&lt; LifeGroupClass のメンバー</A></DIV>

<v:line from="0,7267" to="588,7267"/>
<v:line from="588,7267" to="588,7449"/>
<v:line from="588,7449" to="0,7449"/>
<v:line from="0,7449" to="0,7267"/>

</PAGE>
 
<!-- page 430 --> 
<PAGE>
<A id="svgcats_vml_p430" class="to_tree" style="margin-top:7454px;" onClick="selectTreeElem( '430' );">←</A>
<A href="#svgcats_vml_p431" class="to_next_page" style="margin-top:7454px;">▼</A>
<A href="#svgcats_vml_p429" class="to_prev_page" style="margin-top:7454px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7465px; width:459px; height:160px;" fillcolor="white"/>
<DIV id="text430_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7482px; line-height:15px; white-space:nowrap">
<A name="Remove_LifeGroupClass">
Remove (LifeGroupClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:7512px; width:298px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text430_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:7519px; line-height:13px; white-space:nowrap">
Sub&nbsp; LifeGroupClass::Remove( Object as Object )</DIV>
<DIV id="text430_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7549px; line-height:15px; white-space:nowrap">
オブジェクトをグループから除外します。</DIV>
<DIV id="text430_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7577px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text430_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7577px; line-height:15px; white-space:nowrap">
Object</DIV>
<DIV id="text430_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:7577px; line-height:15px; white-space:nowrap">
ハンドルが参照しているオブジェクト</DIV>
<DIV id="text430_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:253px; margin-top:7482px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_Members">
&lt;&lt; LifeGroupClass のメンバー</A></DIV>

<v:line from="0,7465" to="459,7465"/>
<v:line from="459,7465" to="459,7625"/>
<v:line from="459,7625" to="0,7625"/>
<v:line from="0,7625" to="0,7465"/>

</PAGE>
 
<!-- page 431 --> 
<PAGE>
<A id="svgcats_vml_p431" class="to_tree" style="margin-top:7630px;" onClick="selectTreeElem( '431' );">←</A>
<A href="#svgcats_vml_p432" class="to_next_page" style="margin-top:7630px;">▼</A>
<A href="#svgcats_vml_p430" class="to_prev_page" style="margin-top:7630px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7641px; width:532px; height:352px;" fillcolor="white"/>
<DIV id="text431_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7658px; line-height:15px; white-space:nowrap">
<A name="AddTerminated_LifeGroupClass">
AddTerminated (LifeGroupClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:7688px; width:340px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text431_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:7695px; line-height:13px; white-space:nowrap">
Sub&nbsp; LifeGroupClass::AddTerminated( Object as Object )</DIV>
<DIV id="text431_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7725px; line-height:15px; white-space:nowrap">
ハンドルから参照されるカウンターを減らし、必要なら相互参照を切ります。</DIV>
<DIV id="text431_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7753px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text431_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:7753px; line-height:15px; white-space:nowrap">
Object</DIV>
<DIV id="text431_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:165px; margin-top:7753px; line-height:15px; white-space:nowrap">
参照されなくなったハンドルが参照しているオブジェクト</DIV>
<DIV id="text431_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7840px; line-height:15px; white-space:nowrap">
相互参照を切ることで、グループに所属するすべてのオブジェクトが削除されます。</DIV>
<DIV id="text431_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7857px; line-height:15px; white-space:nowrap">
自分（Me）も削除されます。</DIV>
<DIV id="text431_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7890px; line-height:15px; white-space:nowrap">
グループに所属するオブジェクトを参照するハンドルが他にもあるときは、<BR/>
Object を参照しているハンドルだけが削除され、Object は残ります。</DIV>
<DIV id="text431_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:68px; margin-top:7945px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass">
→ LifeGroupClass</A></DIV>
<DIV id="text431_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7945px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text431_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:309px; margin-top:7658px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass_Members">
&lt;&lt; LifeGroupClass のメンバー</A></DIV>
<DIV id="text431_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7791px; line-height:15px; white-space:nowrap">
グループのユーザーは、本メソッドを直接呼び出さないでください。</DIV>
<DIV id="text431_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:250px; margin-top:7807px; line-height:15px; white-space:nowrap">
から呼ばれます。</DIV>
<DIV id="text431_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:33px; margin-top:7807px; line-height:15px; white-space:nowrap">
<A href="#LifeHandleClass">
LifeHandleClass</A></DIV>
<DIV id="text431_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:129px; margin-top:7807px; line-height:15px; white-space:nowrap">
の</DIV>
<DIV id="text431_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:150px; margin-top:7807px; line-height:15px; white-space:nowrap">
<A href="#Class_Terminate_LifeHandleClass">
Class_Terminate</A></DIV>

<v:line from="0,7641" to="532,7641"/>
<v:line from="532,7641" to="532,7993"/>
<v:line from="532,7993" to="0,7993"/>
<v:line from="0,7993" to="0,7641"/>

</PAGE>
 
<!-- page 432 --> 
<PAGE>
<A id="svgcats_vml_p432" class="to_tree" style="margin-top:7998px;" onClick="selectTreeElem( '432' );">←</A>
<A href="#svgcats_vml_p433" class="to_next_page" style="margin-top:7998px;">▼</A>
<A href="#svgcats_vml_p431" class="to_prev_page" style="margin-top:7998px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8009px; width:604px; height:1459px;" fillcolor="white"/>
<DIV id="text432_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8026px; line-height:15px; white-space:nowrap">
<A name="DestroyerClass">
DestroyerClass</A></DIV>
<DIV id="text432_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:9397px; line-height:15px; white-space:nowrap">
→ T_Dic.vbs</DIV>
<DIV id="text432_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:9397px; line-height:15px; white-space:nowrap">
T_DestroyerClass</DIV>
<DIV id="text432_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:9374px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text432_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9397px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text432_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9374px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text432_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8125px; line-height:15px; white-space:nowrap">
相互参照しているオブジェクトを削除するタイミングを制御するオブジェクト。<BR/>
DestroyerClass のオブジェクトが削除されるときに、相互参照を切るメソッド DestroyReferences <BR/>
を呼び出し、相互参照していたオブジェクトの Class_Terminate が呼び出されます。</DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:8548px; width:508px; height:610px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text432_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:8554px; line-height:15px; white-space:nowrap">
Case1<BR/>
WScript.echo&nbsp; "End of Main"<BR/>
Case2<BR/>
WScript.echo&nbsp; "End of Main"<BR/>
WScript.echo&nbsp; "もし、ここ以降でデストラクターが動くときは、"+_<BR/>
&nbsp; &nbsp; "プログラム終了時にすべてのオブジェクトを削除する"+_<BR/>
&nbsp; &nbsp; "ことによるデストラクター呼び出しです。"<BR/>
<BR/>
Sub&nbsp; Case1()<BR/>
&nbsp; &nbsp; WScript.echo&nbsp; vbCRLF +"Case1:"<BR/>
&nbsp; &nbsp; Set destroyer = new DestroyerClass<BR/>
&nbsp; &nbsp; Set a_object = new MutualClass : a_object.Name = "a" : destroyer.Add&nbsp; a_object<BR/>
&nbsp; &nbsp; Set b_object = new MutualClass : b_object.Name = "b" : destroyer.Add&nbsp; b_object<BR/>
&nbsp; &nbsp; Set a_object.Reference = b_object<BR/>
&nbsp; &nbsp; Set b_object.Reference = a_object<BR/>
End Sub<BR/>
<BR/>
Sub&nbsp; Case2()<BR/>
&nbsp; &nbsp; WScript.echo&nbsp; vbCRLF +"Case2:"<BR/>
&nbsp; &nbsp; Set destroyer = new DestroyerClass<BR/>
&nbsp; &nbsp; Set a_object = new MutualClass : a_object.Name = "a"<BR/>
&nbsp; &nbsp; Set b_object = new MutualClass : b_object.Name = "b"<BR/>
&nbsp; &nbsp; Set a_object.Reference = b_object<BR/>
&nbsp; &nbsp; Set b_object.Reference = a_object<BR/>
End Sub<BR/>
<BR/>
Class&nbsp; MutualClass<BR/>
&nbsp; &nbsp; Public&nbsp; Name<BR/>
&nbsp; &nbsp; Public&nbsp; Reference<BR/>
&nbsp; &nbsp; Public&nbsp; IsDestroyer&nbsp; &nbsp; '// ■追加<BR/>
<BR/>
&nbsp; &nbsp; Private Sub&nbsp; Class_Terminate()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; WScript.echo&nbsp; Me.Name +".Class_Terminate"<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; CheckUnderDestroyer&nbsp; Me&nbsp; '// ■追加<BR/>
&nbsp; &nbsp; End Sub<BR/>
<BR/>
&nbsp; &nbsp; Public Sub&nbsp; DestroyReferences()&nbsp; '// ■追加<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Me.Reference = Empty<BR/>
&nbsp; &nbsp; End Sub<BR/>
End Class</DIV>
<DIV id="text432_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8524px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:line style="position:absolute;" from="97,8187" to="97,8206" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="97,8206" to="101,8195" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="97,8206" to="93,8195" strokecolor="#000000" strokeweight="1pt"/>
<v:rect style="position:absolute; margin-left:62px; margin-top:8215px; width:70px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text432_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:70px; margin-top:8221px; line-height:15px; white-space:nowrap">
Destroyer</DIV>
<v:line style="position:absolute;" from="241,8267" to="241,8241" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="241,8241" to="237,8252" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="241,8241" to="245,8252" strokecolor="#FF0000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="241,8267" to="113,8267" strokecolor="#FF0000" strokeweight="1pt"/>
<v:rect style="position:absolute; margin-left:177px; margin-top:8215px; width:23px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text432_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:8221px; line-height:15px; white-space:nowrap">
A</DIV>
<v:rect style="position:absolute; margin-left:284px; margin-top:8215px; width:25px; height:26px;" fillcolor="#F8FFB0" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text432_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:292px; margin-top:8221px; line-height:15px; white-space:nowrap">
B</DIV>
<v:line style="position:absolute;" from="188,8187" to="188,8206" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="188,8206" to="192,8195" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="188,8206" to="184,8195" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="296,8187" to="296,8206" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="296,8206" to="300,8195" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="296,8206" to="292,8195" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="214,8223" to="268,8223" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="268,8223" to="257,8219" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="268,8223" to="257,8227" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="268,8234" to="214,8234" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="214,8234" to="225,8238" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="214,8234" to="225,8230" strokecolor="#000000" strokeweight="1pt"/>
<v:line style="position:absolute;" from="113,8249" to="113,8267" strokecolor="#FF0000" strokeweight="1pt"/>
<DIV id="text432_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#FF0000; margin-left:141px; margin-top:8274px; line-height:12px; white-space:nowrap">
相互参照を切る</DIV>
<DIV id="text432_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8315px; line-height:15px; white-space:nowrap">
関数が終了したときにオブジェクトを参照している変数がなくなると、ガーベージコレクターによって<BR/>
Class_Terminate が呼ばれますが、相互参照していると Class_Terminate は呼ばれません。 <BR/>
プログラム終了時に呼ばれます。 DestroyerClass は、相互参照しているオブジェクトでも<BR/>
Class_Terminate が呼ばれるようにします。</DIV>
<DIV id="text432_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8456px; line-height:15px; white-space:nowrap">
相互参照するクラスは、相互参照を切る DestroyReferences メソッドと、DestroyerClass に<BR/>
登録されると True になる IsDestroyer 属性（プロパティ）を実装してください。 下記サンプルの<BR/>
MutualClass を参照。</DIV>
<DIV id="text432_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:98px; margin-top:9050px; line-height:13px; white-space:nowrap">
<A href="#CheckUnderDestroyer">
CheckUnderDestroyer</A></DIV>
<DIV id="text432_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:464px; margin-top:8720px; line-height:13px; white-space:nowrap">
<A href="#Add_DestroyerClass">
Add</A></DIV>
<DIV id="text432_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8393px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text432_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:71px; margin-top:8412px; line-height:15px; white-space:nowrap">
→ ガーベージコレクション (GC)</DIV>
<DIV id="text432_28" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:194px; margin-top:8705px; line-height:13px; white-space:nowrap">
DestroyerClass</DIV>
<DIV id="text432_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:8393px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_10.html#Class_Terminate_Mutual">
→ 相互参照しているときの Class_Terminate</A></DIV>
<v:rect style="position:absolute; margin-left:42px; margin-top:9199px; width:436px; height:145px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text432_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:50px; margin-top:9205px; line-height:15px; white-space:nowrap">
Case1:<BR/>
Case1: a.Class_Terminate<BR/>
Case1: b.Class_Terminate<BR/>
Case2:<BR/>
End of Main<BR/>
もし、ここ以降でデストラクターが動くときは、プログラム終了時にすべての<BR/>
オブジェクトを削除することによるデストラクター呼び出しです。<BR/>
Case2: a.Class_Terminate<BR/>
Case2: b.Class_Terminate</DIV>
<DIV id="text432_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:9176px; line-height:15px; white-space:nowrap">
表示例：</DIV>
<DIV id="text432_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9420px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text432_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:9420px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass">
→ LifeGroupClass</A></DIV>
<DIV id="text432_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:226px; margin-top:8073px; line-height:15px; white-space:nowrap">
<A href="#LifeGroupClass">
LifeGroupClass</A></DIV>
<DIV id="text432_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:316px; margin-top:8073px; line-height:15px; white-space:nowrap">
の使用を推奨します。</DIV>
<DIV id="text432_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; font-weight: bold; margin-left:24px; margin-top:8073px; line-height:15px; white-space:nowrap">
注意</DIV>
<DIV id="text432_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:8073px; line-height:15px; white-space:nowrap">
DestroyerClass の代わりに</DIV>

<v:line from="0,8009" to="604,8009"/>
<v:line from="604,8009" to="604,9468"/>
<v:line from="604,9468" to="0,9468"/>
<v:line from="0,9468" to="0,8009"/>

</PAGE>
 
<!-- page 433 --> 
<PAGE>
<A id="svgcats_vml_p433" class="to_tree" style="margin-top:9473px;" onClick="selectTreeElem( '433' );">←</A>
<A href="#svgcats_vml_p434" class="to_next_page" style="margin-top:9473px;">▼</A>
<A href="#svgcats_vml_p432" class="to_prev_page" style="margin-top:9473px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9484px; width:535px; height:233px;" fillcolor="white"/>
<DIV id="text433_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9501px; line-height:15px; white-space:nowrap">
<A name="Add_DestroyerClass">
Add (DestroyerClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:9531px; width:286px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text433_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:9538px; line-height:13px; white-space:nowrap">
Sub&nbsp; DestroyerClass::Add( Object as variant )</DIV>
<DIV id="text433_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9568px; line-height:15px; white-space:nowrap">
相互参照するオブジェクトを登録します。</DIV>
<DIV id="text433_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9594px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text433_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9594px; line-height:15px; white-space:nowrap">
Object</DIV>
<DIV id="text433_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:9594px; line-height:15px; white-space:nowrap">
登録するオブジェクト</DIV>
<DIV id="text433_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:279px; margin-top:9501px; line-height:15px; white-space:nowrap">
<A href="#DestroyerClass">
&lt;&lt; DestroyerClass</A></DIV>
<DIV id="text433_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9639px; line-height:15px; white-space:nowrap">
本関数は、Object の IsDestroyer 属性（プロパティ）を True に設定します。<BR/>
DestroyerClass が削除されるタイミングで、Object の DestroyReferences メソッドが<BR/>
呼ばれます。</DIV>

<v:line from="0,9484" to="535,9484"/>
<v:line from="535,9484" to="535,9717"/>
<v:line from="535,9717" to="0,9717"/>
<v:line from="0,9717" to="0,9484"/>

</PAGE>
 
<!-- page 434 --> 
<PAGE>
<A id="svgcats_vml_p434" class="to_tree" style="margin-top:9722px;" onClick="selectTreeElem( '434' );">←</A>
<A href="#svgcats_vml_p435" class="to_next_page" style="margin-top:9722px;">▼</A>
<A href="#svgcats_vml_p433" class="to_prev_page" style="margin-top:9722px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9733px; width:541px; height:210px;" fillcolor="white"/>
<DIV id="text434_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9750px; line-height:15px; white-space:nowrap">
<A name="Remove_DestroyerClass">
Remove (DestroyerClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:9780px; width:304px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text434_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:9787px; line-height:13px; white-space:nowrap">
Sub&nbsp; DestroyerClass::Remove( Object as variant )</DIV>
<DIV id="text434_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9817px; line-height:15px; white-space:nowrap">
登録から除外します。</DIV>
<DIV id="text434_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9843px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text434_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9843px; line-height:15px; white-space:nowrap">
Object</DIV>
<DIV id="text434_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:9843px; line-height:15px; white-space:nowrap">
除外するオブジェクト</DIV>
<DIV id="text434_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:250px; margin-top:9750px; line-height:15px; white-space:nowrap">
<A href="#DestroyerClass">
&lt;&lt; DestroyerClass</A></DIV>
<DIV id="text434_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9880px; line-height:15px; white-space:nowrap">
DestroyerClass が削除されるときよりも早く削除するオブジェクトを指定してください。<BR/>
本関数は、Object の IsDestroyer 属性（プロパティ）を False に設定します。</DIV>

<v:line from="0,9733" to="541,9733"/>
<v:line from="541,9733" to="541,9943"/>
<v:line from="541,9943" to="0,9943"/>
<v:line from="0,9943" to="0,9733"/>

</PAGE>
 
<!-- page 435 --> 
<PAGE>
<A id="svgcats_vml_p435" class="to_tree" style="margin-top:9948px;" onClick="selectTreeElem( '435' );">←</A>
<A href="vbslib_24.html#svgcats_vml_p436" class="to_next_page" style="margin-top:9948px;">▼</A>
<A href="#svgcats_vml_p434" class="to_prev_page" style="margin-top:9948px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9959px; width:405px; height:132px;" fillcolor="white"/>
<DIV id="text435_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9976px; line-height:15px; white-space:nowrap">
<A name="CheckUnderDestroyer">
CheckUnderDestroyer</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:10006px; width:286px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text435_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:10013px; line-height:13px; white-space:nowrap">
Sub&nbsp; CheckUnderDestroyer( Object as variant )</DIV>
<DIV id="text435_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:10043px; line-height:15px; white-space:nowrap">
Destroyer によって管理されていなければ、エラーにします。</DIV>

<v:line from="0,9959" to="405,9959"/>
<v:line from="405,9959" to="405,10091"/>
<v:line from="405,10091" to="0,10091"/>
<v:line from="0,10091" to="0,9959"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10091px;">
<A id="svgcats_vml_p435" class="to_tree" onClick="selectTreeElem( '435' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10091px;">
<A id="page_group_bottom" href="vbslib_24.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
