<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>vbslib</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbslib.files/vbslib_18.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbslib.files/vbslib_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbslib.files/vbslib_18.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 347 --> 
<PAGE>
<A id="svgcats_vml_p347" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '347' );">←</A>
<A href="#svgcats_vml_p348" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbslib_17.html#svgcats_vml_p346" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbslib_17.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:552px; height:1294px;" fillcolor="white"/>
<DIV id="text347_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:19px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="AppKeyClass_NewWritable">
NewWritable (AppKeyClass)</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:47px; width:424px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text347_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:54px; line-height:13px; white-space:nowrap">
Function&nbsp; AppKeyClass::NewWritable( Pathes as variant ) as Writables</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:554px; width:388px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text347_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:560px; line-height:15px; white-space:nowrap">
Sub&nbsp; Main( Opt, AppKey )<BR/>
&nbsp; Set w_= AppKey.NewWritable( "." ).Enable()<BR/>
&nbsp; &nbsp; '// 書き込み可能な範囲<BR/>
&nbsp; w_ = Empty&nbsp; '// これを書かないときは、関数が終わるまでが範囲<BR/>
End Sub</DIV>
<DIV id="text347_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:532px; line-height:15px; white-space:nowrap">
サンプル１： カレントフォルダを書き込み可能にする</DIV>
<DIV id="text347_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:965px; line-height:15px; white-space:nowrap">
サンプル： 後で out フォルダを書き込み可能にする</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:984px; width:244px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text347_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:990px; line-height:15px; white-space:nowrap">
Sub&nbsp; Main( Opt, AppKey )<BR/>
&nbsp; Set wr = AppKey.NewWritable( "out" )<BR/>
<BR/>
&nbsp; sub2&nbsp; wr<BR/>
End Sub<BR/>
<BR/>
Sub&nbsp; sub2( wr )<BR/>
&nbsp; Set w_ = wr.Enable()<BR/>
&nbsp; &nbsp; '// "out" に書き込み可能な範囲<BR/>
End Sub</DIV>
<DIV id="text347_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:83px; line-height:15px; white-space:nowrap">
書き込み可能なフォルダの設定オブジェクトを生成します。</DIV>
<DIV id="text347_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:110px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text347_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:95px; margin-top:110px; line-height:15px; white-space:nowrap">
Pathes</DIV>
<DIV id="text347_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:152px; margin-top:110px; line-height:15px; white-space:nowrap">
書き込み可能なフォルダの</DIV>
<DIV id="text347_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:95px; margin-top:131px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text347_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:152px; margin-top:131px; line-height:15px; white-space:nowrap">
Writable 設定オブジェクト</DIV>
<DIV id="text347_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:205px; line-height:15px; white-space:nowrap">
通常は、サンプル１のように使い、NewWritable 関数の引数を調整します。<BR/>
もしくは、使っているオブジェクトの</DIV>
<DIV id="text347_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:302px; line-height:15px; white-space:nowrap">
渡すと、書き込み可能なフォルダの設定を不正に変えられる可能性があります。<BR/>
返り値である Writable 設定オブジェクトは、他の関数に渡すことができます。</DIV>
<DIV id="text347_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:31px; margin-top:286px; line-height:15px; white-space:nowrap">
AppKey は、なるべく他の関数に渡さないようにしてください。</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:874px; width:382px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text347_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:880px; line-height:15px; white-space:nowrap">
Sub&nbsp; Main( Opt, AppKey )<BR/>
&nbsp; Set w_= AppKey.NewWritable( Array("out1","out2") ).Enable()<BR/>
&nbsp; &nbsp; '// 書き込み可能な範囲<BR/>
End Sub</DIV>
<DIV id="text347_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:855px; line-height:15px; white-space:nowrap">
サンプル： 複数のフォルダを書き込み可能にする</DIV>
<DIV id="text347_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:257px; margin-top:576px; line-height:13px; white-space:nowrap">
<A href="#Writables_Enable">
Enable</A></DIV>
<DIV id="text347_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:252px; line-height:15px; white-space:nowrap">
AppKeyClass は、</DIV>
<DIV id="text347_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:312px; margin-top:131px; line-height:15px; white-space:nowrap">
<A href="#Writables_Enable">
→ Writables::Enable</A></DIV>
<DIV id="text347_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:143px; margin-top:576px; line-height:13px; white-space:nowrap">
NewWritable( "." )</DIV>
<DIV id="text347_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:246px; margin-top:17px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text347_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:333px; margin-top:110px; line-height:15px; white-space:nowrap">
。文字列、または文字列の配列</DIV>
<DIV id="text347_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:304px; margin-top:110px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#fname">
パス</A></DIV>
<DIV id="text347_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:62px; margin-top:1214px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#fname">
→ ファイル名、パス</A></DIV>
<DIV id="text347_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1172px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text347_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:62px; margin-top:1172px; line-height:15px; white-space:nowrap">
<A href="vbslib_17.html#owerr">
→ Out of Writable 警告</A></DIV>
<DIV id="text347_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:62px; margin-top:1193px; line-height:15px; white-space:nowrap">
<A href="#SetWritableMode">
→ SetWritableMode</A></DIV>
<DIV id="text347_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:665px; line-height:15px; white-space:nowrap">
サンプル： デスクトップに新規フォルダの作成を可能にし、新規フォルダの中は書き込み<BR/>
可能にする。 新規フォルダを作成することができるフォルダのパスの後に \* を指定して<BR/>
ください。</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:720px; width:388px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text347_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:726px; line-height:15px; white-space:nowrap">
Sub&nbsp; Main( Opt, AppKey )<BR/>
&nbsp; desktop = g_sh.SpecialFolders( "Desktop" )<BR/>
&nbsp; Set w_= AppKey.NewWritable( desktop+"\*" ).Enable()<BR/>
&nbsp; mkdir&nbsp; desktop+"\New Folder"<BR/>
&nbsp; &nbsp; '// 書き込み可能な範囲<BR/>
&nbsp; w_ = Empty&nbsp; '// これを書かないときは、関数が終わるまでが範囲<BR/>
End Sub</DIV>
<DIV id="text347_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:349px; line-height:15px; white-space:nowrap">
Pathes に指定するパスの最後に "\*" があると、新規フォルダの作成を可能にし、<BR/>
新規フォルダの中は書き込み可能にします。 "C:\folder1\*" とすると、C:\folder1<BR/>
にファイルを作成できませんが、フォルダは作成できます。<BR/>
すでに C:\folder1 にあるフォルダの中は、上書きされないように、書き込み不可<BR/>
になります。</DIV>
<DIV id="text347_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:161px; margin-top:171px; line-height:15px; white-space:nowrap">
<A href="vbslib_17.html#owerr">
Out of Writable 警告</A></DIV>
<DIV id="text347_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:281px; margin-top:171px; line-height:15px; white-space:nowrap">
が出ないようになります。</DIV>
<DIV id="text347_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:171px; line-height:15px; white-space:nowrap">
本関数を正しく使えば、</DIV>
<DIV id="text347_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:282px; margin-top:20px; line-height:12px; white-space:nowrap">
<A href="vbslib_17.html#owerr">
[ 親: Out of Writable 警告 ]</A></DIV>
<DIV id="text347_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1246px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text347_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:441px; line-height:15px; white-space:nowrap">
Program Files などの OS のシステムフォルダを NewWritable に指定すると、<BR/>
System folder access の警告になります。 この警告を自動的に無視するときは、<BR/>
NewWritable を呼び出す前に</DIV>
<DIV id="text347_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:199px; margin-top:471px; line-height:15px; white-space:nowrap">
SetWritableMode</DIV>
<DIV id="text347_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:301px; margin-top:471px; line-height:15px; white-space:nowrap">
に F_IgnoreIfWarn を指定して、</DIV>
<DIV id="text347_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:486px; line-height:15px; white-space:nowrap">
呼び出してください。</DIV>
<DIV id="text347_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:77px; margin-top:1246px; line-height:15px; white-space:nowrap">
→ T_Writable フォルダ</DIV>
<DIV id="text347_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:221px; margin-top:1246px; line-height:15px; white-space:nowrap">
→ [T_Writable] の説明</DIV>
<DIV id="text347_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:222px; margin-top:220px; line-height:15px; white-space:nowrap">
<A href="#GetWritable">
GetWritable メソッド</A></DIV>
<DIV id="text347_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:333px; margin-top:220px; line-height:15px; white-space:nowrap">
を使います。</DIV>
<DIV id="text347_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:194px; margin-top:252px; line-height:15px; white-space:nowrap">
の第2引数である AppKey のクラスです。</DIV>
<DIV id="text347_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:128px; margin-top:252px; line-height:15px; white-space:nowrap">
<A href="vbslib_37.html#main">
Main 関数</A></DIV>

<v:line from="0,0" to="552,0"/>
<v:line from="552,0" to="552,1294"/>
<v:line from="552,1294" to="0,1294"/>
<v:line from="0,1294" to="0,0"/>

</PAGE>
 
<!-- page 348 --> 
<PAGE>
<A id="svgcats_vml_p348" class="to_tree" style="margin-top:1299px;" onClick="selectTreeElem( '348' );">←</A>
<A href="#svgcats_vml_p349" class="to_next_page" style="margin-top:1299px;">▼</A>
<A href="#svgcats_vml_p347" class="to_prev_page" style="margin-top:1299px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1310px; width:484px; height:495px;" fillcolor="white"/>
<DIV id="text348_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1327px; line-height:15px; white-space:nowrap">
<A name="GetWritable">
GetWritable メソッド</A></DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:1482px; width:364px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text348_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:1488px; line-height:15px; white-space:nowrap">
Sub&nbsp; main2( Opt, AppKey )<BR/>
&nbsp; Dim&nbsp; writable : writable = m.GetWritable<BR/>
&nbsp; If not AppKey.InPath( writable, "..\out" ) Then&nbsp; Error<BR/>
<BR/>
&nbsp; Dim w_ : Set w_= AppKey.NewWritable( writable ).Enable()<BR/>
&nbsp; &nbsp; '// 書き込み可能な範囲<BR/>
&nbsp; w_ = Empty<BR/>
End Sub</DIV>
<DIV id="text348_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1463px; line-height:15px; white-space:nowrap">
使用サンプル：</DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:1357px; width:316px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text348_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:1364px; line-height:13px; white-space:nowrap">
Function&nbsp; ClassA::GetWritable() as array of string</DIV>
<DIV id="text348_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:1392px; line-height:15px; white-space:nowrap">
書き込み許可の設定が必要なフォルダの一覧を取得します。</DIV>
<DIV id="text348_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:1424px; line-height:15px; white-space:nowrap">
GetWritable メソッドは、それぞれのクラスで定義してください。</DIV>
<DIV id="text348_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:137px; margin-top:1519px; line-height:13px; white-space:nowrap">
<A href="#InPath_AppKeyClass">
InPath</A></DIV>
<DIV id="text348_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:83px; margin-top:1504px; line-height:13px; white-space:nowrap">
writable</DIV>
<DIV id="text348_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:185px; margin-top:1519px; line-height:13px; white-space:nowrap">
writable</DIV>
<DIV id="text348_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:275px; margin-top:1549px; line-height:13px; white-space:nowrap">
writable</DIV>
<DIV id="text348_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:197px; margin-top:1549px; line-height:13px; white-space:nowrap">
<A href="#AppKeyClass_NewWritable">
NewWritable</A></DIV>
<DIV id="text348_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:1632px; line-height:15px; white-space:nowrap">
定義サンプル：</DIV>
<v:rect style="position:absolute; margin-left:33px; margin-top:1652px; width:214px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text348_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:41px; margin-top:1658px; line-height:15px; white-space:nowrap">
Class&nbsp; ClassA<BR/>
&nbsp; Public Function&nbsp; GetWritable()<BR/>
&nbsp; &nbsp; GetWritable = Array( "Work" )<BR/>
&nbsp; End Function<BR/>
End Class</DIV>

<v:line from="0,1310" to="484,1310"/>
<v:line from="484,1310" to="484,1805"/>
<v:line from="484,1805" to="0,1805"/>
<v:line from="0,1805" to="0,1310"/>

</PAGE>
 
<!-- page 349 --> 
<PAGE>
<A id="svgcats_vml_p349" class="to_tree" style="margin-top:1810px;" onClick="selectTreeElem( '349' );">←</A>
<A href="#svgcats_vml_p350" class="to_next_page" style="margin-top:1810px;">▼</A>
<A href="#svgcats_vml_p348" class="to_prev_page" style="margin-top:1810px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:1821px; width:611px; height:265px;" fillcolor="white"/>
<DIV id="text349_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:1838px; line-height:15px; white-space:nowrap">
<A name="InPath_AppKeyClass">
InPath (AppKeyClass)</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:1868px; width:556px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text349_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:1875px; line-height:13px; white-space:nowrap">
Function&nbsp; AppKeyClass::InPath( Paths as Array of string, EnablePath as string ) as boolean</DIV>
<DIV id="text349_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2038px; line-height:15px; white-space:nowrap">
サンプル：</DIV>
<DIV id="text349_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:1905px; line-height:15px; white-space:nowrap">
Paths に指定したパスの集合が、EnablePath の中に含まれるかどうかを返します。</DIV>
<DIV id="text349_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:1931px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text349_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:1931px; line-height:15px; white-space:nowrap">
Paths</DIV>
<DIV id="text349_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:1950px; line-height:15px; white-space:nowrap">
EnablePath</DIV>
<DIV id="text349_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:1931px; line-height:15px; white-space:nowrap">
パスの配列</DIV>
<DIV id="text349_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:1950px; line-height:15px; white-space:nowrap">
許可しているパス</DIV>
<DIV id="text349_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:1969px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text349_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:1969px; line-height:15px; white-space:nowrap">
Paths の要素がすべて許可しているパスに含まれているかどうか</DIV>
<DIV id="text349_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2004px; line-height:15px; white-space:nowrap">
ファイル：</DIV>
<v:rect style="position:absolute; margin-left:94px; margin-top:2002px; width:75px; height:19px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text349_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:102px; margin-top:2006px; line-height:13px; white-space:nowrap">
vbslib.vbs</DIV>
<DIV id="text349_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:214px; margin-top:1838px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text349_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:102px; margin-top:2038px; line-height:15px; white-space:nowrap">
<A href="#GetWritable">
→ GetWritable メソッド</A></DIV>

<v:line from="0,1821" to="611,1821"/>
<v:line from="611,1821" to="611,2086"/>
<v:line from="611,2086" to="0,2086"/>
<v:line from="0,2086" to="0,1821"/>

</PAGE>
 
<!-- page 350 --> 
<PAGE>
<A id="svgcats_vml_p350" class="to_tree" style="margin-top:2091px;" onClick="selectTreeElem( '350' );">←</A>
<A href="#svgcats_vml_p351" class="to_next_page" style="margin-top:2091px;">▼</A>
<A href="#svgcats_vml_p349" class="to_prev_page" style="margin-top:2091px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2102px; width:528px; height:387px;" fillcolor="white"/>
<DIV id="text350_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2119px; line-height:15px; white-space:nowrap">
<A name="CheckWritable_AppKeyClass">
CheckWritable (AppKeyClass)</A></DIV>
<DIV id="text350_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:242px; margin-top:2119px; line-height:15px; white-space:nowrap">
(src)</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:2149px; width:406px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text350_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:2156px; line-height:13px; white-space:nowrap">
Sub&nbsp; AppKeyClass::CheckWritable( Path as string, Opt as variant )</DIV>
<DIV id="text350_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2186px; line-height:15px; white-space:nowrap">
指定したパスが、</DIV>
<DIV id="text350_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2212px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text350_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2212px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text350_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:2231px; line-height:15px; white-space:nowrap">
Opt</DIV>
<DIV id="text350_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:154px; margin-top:2212px; line-height:15px; white-space:nowrap">
チェックするパス</DIV>
<DIV id="text350_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:154px; margin-top:2231px; line-height:15px; white-space:nowrap">
Empty または c.ForMkDir (*1)</DIV>
<DIV id="text350_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:132px; margin-top:2186px; line-height:15px; white-space:nowrap">
<A href="#Writables_Enable">
Enable (Writables)</A></DIV>
<DIV id="text350_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:240px; margin-top:2186px; line-height:15px; white-space:nowrap">
されているかどうかチェックします。</DIV>
<DIV id="text350_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2263px; line-height:15px; white-space:nowrap">
(*1)</DIV>
<DIV id="text350_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:309px; margin-top:2329px; line-height:15px; white-space:nowrap">
<A href="vbslib_17.html#owerr">
Out of Writable 警告</A></DIV>
<DIV id="text350_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2329px; line-height:15px; white-space:nowrap">
Path が、Enable (Writables) されていなかったら、</DIV>
<DIV id="text350_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:428px; margin-top:2329px; line-height:15px; white-space:nowrap">
が出ます。</DIV>
<DIV id="text350_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:2263px; line-height:15px; white-space:nowrap">
Opt 引数に、g_VBS_Lib.ForMkDir を指定すると、Path に指定したパスの<BR/>
フォルダーを作るために、Path の子フォルダー（Path より長いパス）だけが、<BR/>
Enable (Writables) されていたときでも、チェックに引っかからなくなります。</DIV>
<v:rect style="position:absolute; margin-left:47px; margin-top:2392px; width:226px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text350_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:55px; margin-top:2399px; line-height:13px; white-space:nowrap">
g_AppKey.CheckWritable&nbsp; path, Empty</DIV>
<DIV id="text350_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2368px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text350_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2442px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text350_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:2442px; line-height:15px; white-space:nowrap">
<A href="vbslib_15.html#mkdir_for">
→ mkdir_for</A></DIV>

<v:line from="0,2102" to="528,2102"/>
<v:line from="528,2102" to="528,2489"/>
<v:line from="528,2489" to="0,2489"/>
<v:line from="0,2489" to="0,2102"/>

</PAGE>
 
<!-- page 351 --> 
<PAGE>
<A id="svgcats_vml_p351" class="to_tree" style="margin-top:2494px;" onClick="selectTreeElem( '351' );">←</A>
<A href="#svgcats_vml_p352" class="to_next_page" style="margin-top:2494px;">▼</A>
<A href="#svgcats_vml_p350" class="to_prev_page" style="margin-top:2494px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2505px; width:276px; height:131px;" fillcolor="white"/>
<DIV id="text351_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2522px; line-height:15px; white-space:nowrap">
<A name="AppKeyClass_Watch">
Watch (AppKeyClass)</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:2552px; width:166px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text351_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:2559px; line-height:13px; white-space:nowrap">
Sub&nbsp; AppKeyClass::Watch()</DIV>
<DIV id="text351_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:2588px; line-height:15px; white-space:nowrap">
Writable の状態を echo 出力します。</DIV>

<v:line from="0,2505" to="276,2505"/>
<v:line from="276,2505" to="276,2636"/>
<v:line from="276,2636" to="0,2636"/>
<v:line from="0,2636" to="0,2505"/>

</PAGE>
 
<!-- page 352 --> 
<PAGE>
<A id="svgcats_vml_p352" class="to_tree" style="margin-top:2641px;" onClick="selectTreeElem( '352' );">←</A>
<A href="#svgcats_vml_p353" class="to_next_page" style="margin-top:2641px;">▼</A>
<A href="#svgcats_vml_p351" class="to_prev_page" style="margin-top:2641px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2652px; width:543px; height:632px;" fillcolor="white"/>
<DIV id="text352_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2669px; line-height:15px; white-space:nowrap">
<A name="Writables_Enable">
Enable (Writables)</A></DIV>
<v:rect style="position:absolute; margin-left:23px; margin-top:2699px; width:298px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text352_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:31px; margin-top:2706px; line-height:13px; white-space:nowrap">
Function&nbsp; Writables::Enable() as WritablesStack</DIV>
<DIV id="text352_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:2735px; line-height:15px; white-space:nowrap">
書き込み可能なフォルダを設定します。</DIV>
<DIV id="text352_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:2762px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text352_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:2762px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text352_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:150px; margin-top:2762px; line-height:15px; white-space:nowrap">
WritableStack オブジェクト</DIV>
<DIV id="text352_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:2796px; line-height:15px; white-space:nowrap">
Writables は、</DIV>
<DIV id="text352_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:259px; margin-top:2796px; line-height:15px; white-space:nowrap">
から取得できます。</DIV>
<DIV id="text352_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:107px; margin-top:2796px; line-height:15px; white-space:nowrap">
<A href="#AppKeyClass_NewWritable">
AppKeyClass::NewWritable</A></DIV>
<DIV id="text352_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:2878px; line-height:15px; white-space:nowrap">
返り値の WritableStack オブジェクトが、どこからも参照されなくなったら、書き込み<BR/>
可能では無くなります。<BR/>
１つ目の WritableStack が存在するときに、２つ目の Writable::Enable をすると、ネスト<BR/>
して、２つ目の WritableStack のみ有効になります。 ２つ目の WritableStack が参照<BR/>
されなくなったら、１つ目の WritableStack が有効になります。</DIV>
<v:rect style="position:absolute; margin-left:54px; margin-top:2968px; width:244px; height:250px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text352_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:62px; margin-top:2974px; line-height:15px; white-space:nowrap">
Set&nbsp; w1 = AppKey.NewWritable( "out1" )<BR/>
Set&nbsp; w2 = AppKey.NewWritable( "out2" )<BR/>
<BR/>
Set&nbsp; w1_ = w1.Enable()<BR/>
<BR/>
&nbsp; '// "out1" が書き込み可能<BR/>
<BR/>
Set&nbsp; w2_ = w2.Enable()<BR/>
<BR/>
&nbsp; '// "out2" が書き込み可能<BR/>
<BR/>
w2_ = Empty<BR/>
<BR/>
&nbsp; '// "out1" が書き込み可能<BR/>
<BR/>
w1_ = Empty</DIV>
<DIV id="text352_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:2669px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text352_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:61px; margin-top:3235px; line-height:15px; white-space:nowrap">
<A href="vbslib_17.html#owerr">
→ Out of Writable 警告</A></DIV>
<DIV id="text352_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:3235px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text352_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:213px; margin-top:2672px; line-height:12px; white-space:nowrap">
<A href="vbslib_17.html#owerr">
[ 親: Out of Writable 警告 ]</A></DIV>
<v:rect style="position:absolute; margin-left:52px; margin-top:2824px; width:322px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text352_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:60px; margin-top:2831px; line-height:13px; white-space:nowrap">
&nbsp; Dim w_:Set w_= AppKey.NewWritable( "." ).Enable()</DIV>

<v:line from="0,2652" to="543,2652"/>
<v:line from="543,2652" to="543,3284"/>
<v:line from="543,3284" to="0,3284"/>
<v:line from="0,3284" to="0,2652"/>

</PAGE>
 
<!-- page 353 --> 
<PAGE>
<A id="svgcats_vml_p353" class="to_tree" style="margin-top:3289px;" onClick="selectTreeElem( '353' );">←</A>
<A href="#svgcats_vml_p354" class="to_next_page" style="margin-top:3289px;">▼</A>
<A href="#svgcats_vml_p352" class="to_prev_page" style="margin-top:3289px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3300px; width:566px; height:452px;" fillcolor="white"/>
<DIV id="text353_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3317px; line-height:15px; white-space:nowrap">
<A name="SetWritableMode">
SetWritableMode</A></DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:3349px; width:250px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text353_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:3356px; line-height:13px; white-space:nowrap">
Sub&nbsp; SetWritableMode( Mode as integer )</DIV>
<DIV id="text353_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:105px; margin-top:3420px; line-height:15px; white-space:nowrap">
で指定していないフォルダにライトしようとしたときの動きを設定します。</DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:3559px; width:184px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text353_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:3566px; line-height:13px; white-space:nowrap">
SetWritableMode&nbsp; F_ErrIfWarn</DIV>
<DIV id="text353_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:3538px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text353_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:38px; margin-top:3456px; line-height:13px; white-space:nowrap">
<A name="F_AskIfWarn">
F_AskIfWarn</A></DIV>
<DIV id="text353_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:146px; margin-top:3454px; line-height:15px; white-space:nowrap">
ユーザにライトしていいかどうかを確認します（デフォルト）</DIV>
<DIV id="text353_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:38px; margin-top:3477px; line-height:13px; white-space:nowrap">
<A name="F_ErrIfWarn">
F_ErrIfWarn</A></DIV>
<DIV id="text353_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:146px; margin-top:3475px; line-height:15px; white-space:nowrap">
E_OutOfWritable エラーにします</DIV>
<DIV id="text353_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:38px; margin-top:3498px; line-height:13px; white-space:nowrap">
<A name="F_IgnoreIfWarn">
F_IgnoreIfWarn</A></DIV>
<DIV id="text353_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:146px; margin-top:3496px; line-height:15px; white-space:nowrap">
警告を無視します（AppKeyClass::SetWritableMode でのみ指定可能）</DIV>
<DIV id="text353_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:3317px; line-height:15px; white-space:nowrap">
(src)</DIV>
<v:rect style="position:absolute; margin-left:39px; margin-top:3628px; width:460px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text353_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:47px; margin-top:3634px; line-height:15px; white-space:nowrap">
&nbsp; AppKey.SetWritableMode&nbsp; F_IgnoreIfWarn<BR/>
&nbsp; Set w_=AppKey.NewWritable( env("%ProgramFiles%")+"\SampleApp" ).Enable()<BR/>
&nbsp; SetWritableMode&nbsp; F_AskIfWarn</DIV>
<v:rect style="position:absolute; margin-left:26px; margin-top:3381px; width:328px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text353_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:34px; margin-top:3388px; line-height:13px; white-space:nowrap">
Sub&nbsp; AppKeyClass::SetWritableMode( Mode as integer )</DIV>
<DIV id="text353_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:29px; margin-top:3420px; line-height:15px; white-space:nowrap">
<A href="#AppKeyClass_NewWritable">
NewWritable</A></DIV>
<DIV id="text353_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:3704px; line-height:15px; white-space:nowrap">
<A href="vbslib_17.html#owerr">
→ Out of Writable 警告</A></DIV>
<DIV id="text353_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:30px; margin-top:3704px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text353_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:213px; margin-top:3320px; line-height:12px; white-space:nowrap">
<A href="vbslib_17.html#owerr">
[ 親: Out of Writable 警告 ]</A></DIV>
<DIV id="text353_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:29px; margin-top:3607px; line-height:15px; white-space:nowrap">
サンプル： F_IgnoreIfWarn には、AppKey が必要</DIV>

<v:line from="0,3300" to="566,3300"/>
<v:line from="566,3300" to="566,3752"/>
<v:line from="566,3752" to="0,3752"/>
<v:line from="0,3752" to="0,3300"/>

</PAGE>
 
<!-- page 354 --> 
<PAGE>
<A id="svgcats_vml_p354" class="to_tree" style="margin-top:3757px;" onClick="selectTreeElem( '354' );">←</A>
<A href="#svgcats_vml_p355" class="to_next_page" style="margin-top:3757px;">▼</A>
<A href="#svgcats_vml_p353" class="to_prev_page" style="margin-top:3757px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3768px; width:536px; height:897px;" fillcolor="white"/>
<DIV id="text354_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3785px; line-height:15px; white-space:nowrap">
<A name="OpenForRead">
OpenForRead</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:3812px; width:334px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text354_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:3819px; line-height:13px; white-space:nowrap">
Function&nbsp; OpenForRead( Path as string ) as TextStream</DIV>
<DIV id="text354_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:3850px; line-height:15px; white-space:nowrap">
テキストファイルを開きます。（リード用＝ファイルから入力します）</DIV>
<DIV id="text354_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:3873px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text354_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:3873px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text354_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:3892px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text354_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:3873px; line-height:15px; white-space:nowrap">
開くファイルのパス</DIV>
<DIV id="text354_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:3892px; line-height:15px; white-space:nowrap">
ファイルのストリーム</DIV>
<DIV id="text354_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:221px; margin-top:3924px; line-height:15px; white-space:nowrap">
と異なり、エラーがあったら、</DIV>
<DIV id="text354_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:3924px; line-height:15px; white-space:nowrap">
FileSystemObject::OpenTextFile</DIV>
<DIV id="text354_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:3940px; line-height:15px; white-space:nowrap">
エラーメッセージに Path が付きます。</DIV>
<DIV id="text354_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:3784px; line-height:15px; white-space:nowrap">
(src)</DIV>
<v:rect style="position:absolute; margin-left:38px; margin-top:4035px; width:406px; height:235px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text354_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:46px; margin-top:4041px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set c = g_VBS_Lib<BR/>
&nbsp; &nbsp; Set args = WScript.Arguments.Unnamed<BR/>
<BR/>
&nbsp; &nbsp; If args.Count = 0 Then<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; path = InputPath( "ファイルのパス &gt;", c.CheckFileExists )<BR/>
&nbsp; &nbsp; Else<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; path = args(0)<BR/>
&nbsp; &nbsp; End If<BR/>
<BR/>
&nbsp; &nbsp; Set file = OpenForRead( path )<BR/>
&nbsp; &nbsp; Do Until&nbsp; file.AtEndOfStream<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; line = file.ReadLine()<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; '// If InStr( line, "DEBUG" ) &gt; 0 Then&nbsp; echo&nbsp; line<BR/>
&nbsp; &nbsp; Loop<BR/>
&nbsp; &nbsp; file = Empty</DIV>
<DIV id="text354_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:34px; margin-top:3956px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_16.html#E_FileNotExist">
E_FileNotExist エラー</A></DIV>
<DIV id="text354_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:197px; margin-top:3957px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_16.html#E_PathNotFound">
E_PathNotFound エラー</A></DIV>
<DIV id="text354_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:156px; margin-top:3957px; line-height:15px; white-space:nowrap">
または</DIV>
<DIV id="text354_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:331px; margin-top:3957px; line-height:15px; white-space:nowrap">
になります。</DIV>
<DIV id="text354_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:4519px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#FileSystemObject_OpenTextFile">
→ FileSystemObject::OpenTextFile</A></DIV>
<DIV id="text354_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:4576px; line-height:15px; white-space:nowrap">
<A href="vbslib_20.html#ReplaceTextFile">
→ ReplaceTextFile</A></DIV>
<DIV id="text354_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:4595px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_06.html#txt_read">
→ VBScript - テキストファイルの内容を読む (Read)</A></DIV>
<DIV id="text354_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:295px; margin-top:3873px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#fname">
→ ファイル名、パス</A></DIV>
<DIV id="text354_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:64px; margin-top:4483px; line-height:15px; white-space:nowrap">
→ T_File.vbs # [T_OpenFile]</DIV>
<DIV id="text354_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:4519px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text354_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:4483px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text354_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:268px; margin-top:4538px; line-height:15px; white-space:nowrap">
既定の文字コードを指定します</DIV>
<DIV id="text354_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:4538px; line-height:15px; white-space:nowrap">
<A href="#new_TextFileCharSetStack">
→ new_TextFileCharSetStack</A></DIV>
<DIV id="text354_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:4557px; line-height:15px; white-space:nowrap">
<A href="vbslib_17.html#ReadFile">
→ ReadFile</A></DIV>
<DIV id="text354_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:4286px; line-height:15px; white-space:nowrap">
文字コードを指定するときは、</DIV>
<DIV id="text354_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:199px; margin-top:4286px; line-height:15px; white-space:nowrap">
new_TextFileCharSetStack</DIV>
<DIV id="text354_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:353px; margin-top:4286px; line-height:15px; white-space:nowrap">
を使ってください。 </DIV>
<DIV id="text354_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:4303px; line-height:15px; white-space:nowrap">
ただし、Shift-JIS, Unicode, UTF-8(BOMあり) は、使わなくても自動的に文字コード<BR/>
を判定して、正しく読み込みます。</DIV>
<v:rect style="position:absolute; margin-left:55px; margin-top:4343px; width:298px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text354_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:63px; margin-top:4349px; line-height:15px; white-space:nowrap">
&nbsp; Set cs = new_TextFileCharSetStack( "EUC-JP" )<BR/>
&nbsp; Set file = OpenForRead( args(0) )<BR/>
&nbsp; cs = Empty<BR/>
&nbsp; Do Until&nbsp; file.AtEndOfStream<BR/>
&nbsp; &nbsp; line = file.ReadLine()<BR/>
&nbsp; Loop</DIV>
<DIV id="text354_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:64px; margin-top:4614px; line-height:15px; white-space:nowrap">
<A href="vbslib_12.html#StringStream">
→ StringStream クラス</A></DIV>
<DIV id="text354_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:3972px; line-height:15px; white-space:nowrap">
返り値を使って呼び出せるメソッドは、FileSystemObject::OpenTextFile と同じです。</DIV>
<DIV id="text354_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4014px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text354_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:295px; margin-top:3892px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_05.html#TextStream">
→ TextStream （VBScript）</A></DIV>

<v:line from="0,3768" to="536,3768"/>
<v:line from="536,3768" to="536,4665"/>
<v:line from="536,4665" to="0,4665"/>
<v:line from="0,4665" to="0,3768"/>

</PAGE>
 
<!-- page 355 --> 
<PAGE>
<A id="svgcats_vml_p355" class="to_tree" style="margin-top:4670px;" onClick="selectTreeElem( '355' );">←</A>
<A href="#svgcats_vml_p356" class="to_next_page" style="margin-top:4670px;">▼</A>
<A href="#svgcats_vml_p354" class="to_prev_page" style="margin-top:4670px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4681px; width:629px; height:620px;" fillcolor="white"/>
<DIV id="text355_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4698px; line-height:15px; white-space:nowrap">
<A name="ReadUnicodeFileBOM">
ReadUnicodeFileBOM</A></DIV>
<DIV id="text355_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4767px; line-height:15px; white-space:nowrap">
ファイルの文字コードを判定するために、ファイルの先頭にある BOM を読みます。</DIV>
<DIV id="text355_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4793px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text355_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4793px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text355_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:4793px; line-height:15px; white-space:nowrap">
文字コードを判定するファイルのパス</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:4728px; width:358px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text355_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:4735px; line-height:13px; white-space:nowrap">
Function&nbsp; ReadUnicodeFileBOM( Path as string ) as integer</DIV>
<DIV id="text355_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:4812px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text355_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:4812px; line-height:15px; white-space:nowrap">
BOM の文字コード</DIV>
<DIV id="text355_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5236px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text355_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:5236px; line-height:15px; white-space:nowrap">
<A href="#new_TextFileCharSetStack">
→ new_TextFileCharSetStack</A></DIV>
<DIV id="text355_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4851px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:4874px; width:460px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text355_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:4880px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set cs = new_TextFileCharSetStack( ReadUnicodeFileBOM( "File1.txt" ) )<BR/>
&nbsp; &nbsp; CreateFile&nbsp; "File1.txt", "abc"<BR/>
&nbsp; &nbsp; cs = Empty</DIV>
<DIV id="text355_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:114px; margin-top:4851px; line-height:15px; white-space:nowrap">
同じ文字コードを使ってファイルを作成する</DIV>
<DIV id="text355_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:405px; margin-top:4881px; line-height:13px; white-space:nowrap">
File1.txt</DIV>
<DIV id="text355_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5204px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text355_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:5204px; line-height:15px; white-space:nowrap">
→ T_File.vbs</DIV>
<DIV id="text355_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:292px; margin-top:5014px; line-height:15px; white-space:nowrap">
XML宣言 (?xml)</DIV>
<DIV id="text355_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:5253px; line-height:15px; white-space:nowrap">
→ 文字エンコーディングの指定方法</DIV>
<DIV id="text355_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:25px; margin-top:5124px; line-height:15px; white-space:nowrap">
MIME</DIV>
<DIV id="text355_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:59px; margin-top:5124px; line-height:15px; white-space:nowrap">
や</DIV>
<DIV id="text355_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:25px; margin-top:5139px; line-height:15px; white-space:nowrap">
new_TextFileCharSetStack</DIV>
<DIV id="text355_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:5139px; line-height:15px; white-space:nowrap">
を使って開きなおしてください。</DIV>
<DIV id="text355_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:148px; margin-top:5204px; line-height:15px; white-space:nowrap">
T_ReadUnicodeFileBOM</DIV>
<DIV id="text355_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5175px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text355_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:79px; margin-top:5175px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text355_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:391px; margin-top:5014px; line-height:15px; white-space:nowrap">
の encoding="UTF-8" があるとき</DIV>
<DIV id="text355_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:5124px; line-height:15px; white-space:nowrap">
HTML</DIV>
<DIV id="text355_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:111px; margin-top:5124px; line-height:15px; white-space:nowrap">
の charset によって、文字コードが指定される場合は、文字コードを調べて</DIV>
<DIV id="text355_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:25px; margin-top:4966px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text355_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:5077px; line-height:15px; white-space:nowrap">
ファイルが無いとき</DIV>
<DIV id="text355_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:63px; margin-top:5079px; line-height:13px; white-space:nowrap">
Empty</DIV>
<DIV id="text355_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:63px; margin-top:5058px; line-height:13px; white-space:nowrap">
c.UTF_8</DIV>
<DIV id="text355_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:63px; margin-top:5037px; line-height:13px; white-space:nowrap">
c.Unicode</DIV>
<DIV id="text355_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:63px; margin-top:4995px; line-height:13px; white-space:nowrap">
c.No_BOM</DIV>
<DIV id="text355_35" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:63px; margin-top:5016px; line-height:13px; white-space:nowrap">
c.UTF_8_No_BOM</DIV>
<DIV id="text355_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:5056px; line-height:15px; white-space:nowrap">
先頭に UTF-8 の BOM (EF BB BF) があるとき</DIV>
<DIV id="text355_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:5035px; line-height:15px; white-space:nowrap">
先頭に UTF-16 の BOM (FF FE) があるとき</DIV>
<DIV id="text355_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:4993px; line-height:15px; white-space:nowrap">
先頭に BOM がなく、c.UTF_8_No_BOM のケースではないとき</DIV>
<DIV id="text355_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:174px; margin-top:5014px; line-height:15px; white-space:nowrap">
先頭に BOM がなく、</DIV>

<v:line from="0,4681" to="629,4681"/>
<v:line from="629,4681" to="629,5301"/>
<v:line from="629,5301" to="0,5301"/>
<v:line from="0,5301" to="0,4681"/>

</PAGE>
 
<!-- page 356 --> 
<PAGE>
<A id="svgcats_vml_p356" class="to_tree" style="margin-top:5306px;" onClick="selectTreeElem( '356' );">←</A>
<A href="#svgcats_vml_p357" class="to_next_page" style="margin-top:5306px;">▼</A>
<A href="#svgcats_vml_p355" class="to_prev_page" style="margin-top:5306px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5317px; width:501px; height:357px;" fillcolor="white"/>
<DIV id="text356_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5334px; line-height:15px; white-space:nowrap">
<A name="ReadLineSeparator">
ReadLineSeparator</A></DIV>
<DIV id="text356_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5403px; line-height:15px; white-space:nowrap">
ファイルの先頭行を読んで、改行文字の種類を返します。</DIV>
<DIV id="text356_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5429px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text356_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:5429px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text356_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:5429px; line-height:15px; white-space:nowrap">
改行文字の種類を判定するファイルのパス</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:5364px; width:352px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text356_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:5371px; line-height:13px; white-space:nowrap">
Function&nbsp; ReadLineSeparator( Path as string ) as integer</DIV>
<DIV id="text356_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:5448px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text356_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:168px; margin-top:5448px; line-height:15px; white-space:nowrap">
vbCRLF または vbLF</DIV>
<DIV id="text356_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5626px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text356_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5522px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:5545px; width:328px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text356_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:5552px; line-height:13px; white-space:nowrap">
&nbsp; f.LineSeparator = ReadLineSeparator( "File1.txt" )</DIV>
<DIV id="text356_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:228px; margin-top:5333px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text356_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:67px; margin-top:5626px; line-height:15px; white-space:nowrap">
<A href="#new_TextFileLineSeparatorStack">
→ new_TextFileLineSeparatorStack</A></DIV>
<DIV id="text356_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5595px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text356_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:67px; margin-top:5595px; line-height:15px; white-space:nowrap">
→ T_File.vbs # [T_ReadLineSeparator]</DIV>
<DIV id="text356_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5481px; line-height:15px; white-space:nowrap">
ファイルによっては、改行文字の種類がバラバラになっていることもあります。</DIV>

<v:line from="0,5317" to="501,5317"/>
<v:line from="501,5317" to="501,5674"/>
<v:line from="501,5674" to="0,5674"/>
<v:line from="0,5674" to="0,5317"/>

</PAGE>
 
<!-- page 357 --> 
<PAGE>
<A id="svgcats_vml_p357" class="to_tree" style="margin-top:5679px;" onClick="selectTreeElem( '357' );">←</A>
<A href="#svgcats_vml_p358" class="to_next_page" style="margin-top:5679px;">▼</A>
<A href="#svgcats_vml_p356" class="to_prev_page" style="margin-top:5679px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5690px; width:517px; height:641px;" fillcolor="white"/>
<DIV id="text357_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5707px; line-height:15px; white-space:nowrap">
<A name="GetLineCount">
GetLineCount</A></DIV>
<v:rect style="position:absolute; margin-left:43px; margin-top:5898px; width:328px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text357_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:51px; margin-top:5904px; line-height:15px; white-space:nowrap">
Set c = g_VBS_Lib<BR/>
<BR/>
Assert&nbsp; GetLineCount( "a", Empty ) = 1<BR/>
Assert&nbsp; GetLineCount( "a" +vbCRLF, Empty ) = 1<BR/>
Assert&nbsp; GetLineCount( "a" +vbCRLF+ "b", Empty ) = 2<BR/>
Assert&nbsp; GetLineCount( "a" +vbLF+&nbsp; &nbsp;"b", Empty ) = 2<BR/>
Assert&nbsp; GetLineCount( "", Empty ) = 0<BR/>
<BR/>
Assert&nbsp; GetLineCount( "a", c.NoRound ) = 1<BR/>
Assert&nbsp; GetLineCount( "a" +vbCRLF, c.NoRound ) = 1.5</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:5737px; width:382px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text357_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:5744px; line-height:13px; white-space:nowrap">
Function&nbsp; GetLineCount( Text as string, RoundWay as integer )</DIV>
<DIV id="text357_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5774px; line-height:15px; white-space:nowrap">
文字列の行数をカウントします。</DIV>
<DIV id="text357_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5800px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text357_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:5800px; line-height:15px; white-space:nowrap">
Text</DIV>
<DIV id="text357_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:5819px; line-height:15px; white-space:nowrap">
RoundWay</DIV>
<DIV id="text357_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:5800px; line-height:15px; white-space:nowrap">
行数をカウントする文字列</DIV>
<DIV id="text357_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:5819px; line-height:15px; white-space:nowrap">
通常 Empty、g_VBS_Lib.NoRound も可能</DIV>
<DIV id="text357_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6283px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text357_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5875px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text357_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6257px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text357_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:180px; margin-top:6283px; line-height:15px; white-space:nowrap">
T_GetLineCount</DIV>
<DIV id="text357_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:78px; margin-top:6283px; line-height:15px; white-space:nowrap">
→ T_StrEx.vbs</DIV>
<DIV id="text357_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:6257px; line-height:15px; white-space:nowrap">
→ ToolsLib.vbs</DIV>
<DIV id="text357_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:5838px; line-height:15px; white-space:nowrap">
文字列の行数</DIV>
<DIV id="text357_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:5838px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text357_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6176px; line-height:15px; white-space:nowrap">
<A name="GetLineCount_RoundWay">
RoundWay 引数</A></DIV>
<DIV id="text357_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:6202px; line-height:15px; white-space:nowrap">
RoundWay 引数には、通常 Empty を指定します。<BR/>
g_VBS_Lib.NoRound を指定すると、最終行の行末が改行文字なら +0.5 します。</DIV>
<DIV id="text357_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:411px; margin-top:5819px; line-height:15px; white-space:nowrap">
<A href="#GetLineCount_RoundWay">
（下記）</A></DIV>
<DIV id="text357_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6086px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:43px; margin-top:6110px; width:364px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text357_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:51px; margin-top:6117px; line-height:13px; white-space:nowrap">
line_num = GetLineCount( Left( string, position ), Empty )</DIV>
<DIV id="text357_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:108px; margin-top:6086px; line-height:15px; white-space:nowrap">
position の位置の行番号を取得する</DIV>

<v:line from="0,5690" to="517,5690"/>
<v:line from="517,5690" to="517,6331"/>
<v:line from="517,6331" to="0,6331"/>
<v:line from="0,6331" to="0,5690"/>

</PAGE>
 
<!-- page 358 --> 
<PAGE>
<A id="svgcats_vml_p358" class="to_tree" style="margin-top:6336px;" onClick="selectTreeElem( '358' );">←</A>
<A href="#svgcats_vml_p359" class="to_next_page" style="margin-top:6336px;">▼</A>
<A href="#svgcats_vml_p357" class="to_prev_page" style="margin-top:6336px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6347px; width:645px; height:845px;" fillcolor="white"/>
<DIV id="text358_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6364px; line-height:15px; white-space:nowrap">
<A name="ReadVBS_Comment">
ReadVBS_Comment</A></DIV>
<DIV id="text358_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7096px; line-height:15px; white-space:nowrap">
テスト</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:6394px; width:586px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text358_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:6401px; line-height:13px; white-space:nowrap">
Function&nbsp; ReadVBS_Comment( Path as string, StartTag as string, EndTag as string, Opt as Empty )</DIV>
<DIV id="text358_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6431px; line-height:15px; white-space:nowrap">
VBScript のファイルの中のコメントを、複数行の文字列として読み込みます。</DIV>
<DIV id="text358_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6457px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text358_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:6457px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text358_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:6476px; line-height:15px; white-space:nowrap">
StartTag</DIV>
<DIV id="text358_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:6457px; line-height:15px; white-space:nowrap">
VBScript ファイルのパス、# 可能、Empty = </DIV>
<DIV id="text358_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:6476px; line-height:15px; white-space:nowrap">
VBScript ファイルの中の、読み込みを開始する1つ上の行にあるキーワード</DIV>
<DIV id="text358_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:6495px; line-height:15px; white-space:nowrap">
EndTag</DIV>
<DIV id="text358_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:6514px; line-height:15px; white-space:nowrap">
Opt</DIV>
<DIV id="text358_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:6533px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text358_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:6495px; line-height:15px; white-space:nowrap">
読み込む最後の行の1つ下の行にあるキーワード</DIV>
<DIV id="text358_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:6514px; line-height:15px; white-space:nowrap">
Empty を指定してください</DIV>
<DIV id="text358_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:6533px; line-height:15px; white-space:nowrap">
読み込んだ文字列。 先頭に ' は付きません</DIV>
<DIV id="text358_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6632px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:6684px; width:490px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text358_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:6690px; line-height:15px; white-space:nowrap">
text = ReadVBS_Comment( Empty, "["+"FileA.txt]", "[/"+"FileA.txt]", Empty )<BR/>
<BR/>
'-------------------------------------------------------------------[FileA.txt]<BR/>
'((( これはテキストファイルの代わりです )))<BR/>
'<BR/>
'END<BR/>
'------------------------------------------------------------------[/FileA.txt]</DIV>
<DIV id="text358_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:6660px; line-height:15px; white-space:nowrap">
スクリプト</DIV>
<DIV id="text358_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:6821px; line-height:15px; white-space:nowrap">
text に入った値</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:6843px; width:268px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text358_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:6849px; line-height:15px; white-space:nowrap">
((( これはテキストファイルの代わりです )))<BR/>
<BR/>
END</DIV>
<DIV id="text358_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:347px; margin-top:6882px; line-height:15px; white-space:nowrap">
最後の行の末尾には改行があります</DIV>
<DIV id="text358_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:7096px; line-height:15px; white-space:nowrap">
→ T_FileInScript.vbs</DIV>
<DIV id="text358_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:208px; margin-top:7096px; line-height:15px; white-space:nowrap">
T_ReadVBS_Comment</DIV>
<DIV id="text358_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6575px; line-height:15px; white-space:nowrap">
StartTag と EndTag に指定したキーワードがヒットしないよう、下記のサンプルにあるように + でつなぐ<BR/>
などの対策をしてください。</DIV>
<DIV id="text358_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:26px; margin-top:7067px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text358_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:87px; margin-top:7067px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text358_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:427px; margin-top:6457px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_01.html#ScriptFullName">
WScript.ScriptFullName</A></DIV>
<DIV id="text358_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:7144px; line-height:15px; white-space:nowrap">
<A href="vbslib_22.html#new_FilePathForFileInScript">
→ new_FilePathForFileInScript</A></DIV>
<DIV id="text358_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7125px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text358_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6927px; line-height:15px; white-space:nowrap">
Path に、URL のように # を付けると、StartTag と EndTag の一部になります。<BR/>
下記の２つは同じ動きをします。&nbsp; StartTag と EndTag に指定した引数は無視されます。</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:6964px; width:370px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text358_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:6971px; line-height:13px; white-space:nowrap">
text = ReadVBS_Comment( "#FileA.txt", Empty, Empty, Empty )</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:6997px; width:466px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text358_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:7004px; line-height:13px; white-space:nowrap">
text = ReadVBS_Comment( Empty, "["+"FileA.txt]", "[/"+"FileA.txt]", Empty )</DIV>
<DIV id="text358_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:7125px; line-height:15px; white-space:nowrap">
→ WriteVBS_Comment</DIV>

<v:line from="0,6347" to="645,6347"/>
<v:line from="645,6347" to="645,7192"/>
<v:line from="645,7192" to="0,7192"/>
<v:line from="0,7192" to="0,6347"/>

</PAGE>
 
<!-- page 359 --> 
<PAGE>
<A id="svgcats_vml_p359" class="to_tree" style="margin-top:7197px;" onClick="selectTreeElem( '359' );">←</A>
<A href="#svgcats_vml_p360" class="to_next_page" style="margin-top:7197px;">▼</A>
<A href="#svgcats_vml_p358" class="to_prev_page" style="margin-top:7197px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7208px; width:629px; height:1034px;" fillcolor="white"/>
<DIV id="text359_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7225px; line-height:15px; white-space:nowrap">
<A name="OpenForWrite">
OpenForWrite</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:7252px; width:448px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text359_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:7259px; line-height:13px; white-space:nowrap">
Function&nbsp; OpenForWrite( Path as string, Flags as integer ) as TextStream</DIV>
<DIV id="text359_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7290px; line-height:15px; white-space:nowrap">
テキストファイルを開きます。（ライト用＝ファイルへ出力します）</DIV>
<DIV id="text359_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7313px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text359_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:7313px; line-height:15px; white-space:nowrap">
Path</DIV>
<DIV id="text359_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:7349px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text359_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:7313px; line-height:15px; white-space:nowrap">
開くファイルのパス</DIV>
<DIV id="text359_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:7349px; line-height:15px; white-space:nowrap">
ファイルのストリーム</DIV>
<DIV id="text359_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:221px; margin-top:7400px; line-height:15px; white-space:nowrap">
と異なり、エラーがあったら、エラーメッセージに Path が付きます。</DIV>
<DIV id="text359_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7400px; line-height:15px; white-space:nowrap">
FileSystemObject::OpenTextFile</DIV>
<v:rect style="position:absolute; margin-left:38px; margin-top:7518px; width:322px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text359_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:46px; margin-top:7524px; line-height:15px; white-space:nowrap">
&nbsp; Dim&nbsp; file<BR/>
<BR/>
&nbsp; Dim w_:Set w_= AppKey.NewWritable( "." ).Enable()<BR/>
&nbsp; Set file = OpenForWrite( "a.txt", Empty )<BR/>
&nbsp; file.WriteLine&nbsp; "abc"<BR/>
&nbsp; file = Empty</DIV>
<DIV id="text359_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7498px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text359_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:8104px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#FileSystemObject_CreateTextFile">
→ FileSystemObject::CreateTextFile</A></DIV>
<DIV id="text359_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7739px; line-height:13px; white-space:nowrap">
c.Unicode</DIV>
<DIV id="text359_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7651px; line-height:15px; white-space:nowrap">
Flags 引数</DIV>
<DIV id="text359_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:132px; margin-top:7651px; line-height:15px; white-space:nowrap">
Empty または 次の値</DIV>
<DIV id="text359_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7738px; line-height:15px; white-space:nowrap">
Unicode 形式ファイルにします。 指定しないときは、<BR/>
new_TextFileCharSetStack で指定した既定の文字コードになります。</DIV>
<DIV id="text359_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:162px; margin-top:7224px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text359_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:98px; margin-top:7331px; line-height:15px; white-space:nowrap">
Flags</DIV>
<DIV id="text359_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:157px; margin-top:7331px; line-height:15px; white-space:nowrap">
Empty、またはオプション（下記）</DIV>
<DIV id="text359_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7956px; line-height:13px; white-space:nowrap">
c.Append</DIV>
<DIV id="text359_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7954px; line-height:15px; white-space:nowrap">
追記します。<BR/>
Shift-JIS, Unicode, UTF-8(BOMあり) のときは、文字コードを指定しなくても、<BR/>
元のファイルと同じ文字コードになります。</DIV>
<DIV id="text359_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:8122px; line-height:15px; white-space:nowrap">
<A href="vbslib_20.html#ReplaceTextFile">
→ ReplaceTextFile</A></DIV>
<DIV id="text359_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8104px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text359_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:8140px; line-height:15px; white-space:nowrap">
<A href="vbslib_12.html#StringStream">
→ StringStream クラス</A></DIV>
<DIV id="text359_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:295px; margin-top:7313px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_04.html#fname">
→ ファイル名、パス</A></DIV>
<DIV id="text359_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:8158px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_01.html#txt2bintxt">
→ バイナリ混在テキスト生成 (txt2bintxt.exe)</A></DIV>
<DIV id="text359_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:8060px; line-height:15px; white-space:nowrap">
→ T_File.vbs [T_OpenForWrite]</DIV>
<DIV id="text359_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8060px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text359_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:214px; margin-top:7570px; line-height:13px; white-space:nowrap">
a.txt</DIV>
<DIV id="text359_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:24px; margin-top:7706px; line-height:15px; white-space:nowrap">
<A href="#new_TextFileCharSetStack">
new_TextFileCharSetStack</A></DIV>
<DIV id="text359_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:178px; margin-top:7706px; line-height:15px; white-space:nowrap">
を使うと、その他のフォーマットも指定できます。</DIV>
<DIV id="text359_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:190px; margin-top:7555px; line-height:13px; white-space:nowrap">
<A href="#AppKeyClass_NewWritable">
NewWritable</A></DIV>
<DIV id="text359_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7929px; line-height:15px; white-space:nowrap">
次の値と論理和をとることもできます。</DIV>
<DIV id="text359_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7689px; line-height:15px; white-space:nowrap">
文字コードの指定は、次のどれかが指定できます。</DIV>
<DIV id="text359_36" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7821px; line-height:13px; white-space:nowrap">
c.Shift_JIS</DIV>
<DIV id="text359_37" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7779px; line-height:13px; white-space:nowrap">
c.UTF_8</DIV>
<DIV id="text359_38" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7842px; line-height:13px; white-space:nowrap">
c.EUC_JP</DIV>
<DIV id="text359_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7777px; line-height:15px; white-space:nowrap">
BOM 付き UTF-8</DIV>
<DIV id="text359_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7819px; line-height:15px; white-space:nowrap">
Shift-JIS</DIV>
<DIV id="text359_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7840px; line-height:15px; white-space:nowrap">
EUC(JP)</DIV>
<DIV id="text359_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:144px; margin-top:7798px; line-height:15px; white-space:nowrap">
BOM なし UTF-8</DIV>
<DIV id="text359_43" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:46px; margin-top:7800px; line-height:13px; white-space:nowrap">
c.UTF_8_No_BOM</DIV>
<DIV id="text359_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:8194px; line-height:15px; white-space:nowrap">
<A href="vbslib_17.html#CreateFile">
→ CreateFile</A></DIV>
<DIV id="text359_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8012px; line-height:15px; white-space:nowrap">
c は g_VBS_Lib から取得できます。</DIV>
<DIV id="text359_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:245px; margin-top:8012px; line-height:15px; white-space:nowrap">
<A href="vbslib_07.html#g_VBS_Lib">
→ g_VBS_Lib</A></DIV>
<DIV id="text359_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:34px; margin-top:7384px; line-height:15px; white-space:nowrap">
<A href="#AppKeyClass_NewWritable">
NewWritable</A></DIV>
<DIV id="text359_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:110px; margin-top:7384px; line-height:15px; white-space:nowrap">
メソッドを使って、Out of Writable 警告が出ないようにしておいてください。</DIV>
<DIV id="text359_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:7886px; line-height:15px; white-space:nowrap">
改行コードの指定は、</DIV>
<DIV id="text359_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:339px; margin-top:7886px; line-height:15px; white-space:nowrap">
を使ってください。</DIV>
<DIV id="text359_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:149px; margin-top:7886px; line-height:15px; white-space:nowrap">
<A href="#new_TextFileLineSeparatorStack">
new_TextFileLineSeparatorStack</A></DIV>
<DIV id="text359_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7416px; line-height:15px; white-space:nowrap">
返り値を使って呼び出せるメソッドは、FileSystemObject::OpenTextFile と同じです。</DIV>
<DIV id="text359_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:8079px; line-height:15px; white-space:nowrap">
→ T_File.vbs [T_OpenForWrite_Overwrite]</DIV>
<DIV id="text359_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:89px; margin-top:7461px; line-height:15px; white-space:nowrap">
<A href="vbslib_19.html#StartReplace">
StartReplace</A></DIV>
<DIV id="text359_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7445px; line-height:15px; white-space:nowrap">
テキストファイルの内容を書き換えるときは、文字コード（Unicode ファイルのBOM）や改行文字を</DIV>
<DIV id="text359_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:166px; margin-top:7461px; line-height:15px; white-space:nowrap">
を使ってください。</DIV>
<DIV id="text359_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:34px; margin-top:7461px; line-height:15px; white-space:nowrap">
継承する</DIV>
<DIV id="text359_58" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:283px; margin-top:7349px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_05.html#TextStream">
→ TextStream （VBScript）</A></DIV>
<DIV id="text359_59" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:8176px; line-height:15px; white-space:nowrap">
<A href="vbslib_37.html#LockByFileMutex">
→ LockByFileMutex</A></DIV>

<v:line from="0,7208" to="629,7208"/>
<v:line from="629,7208" to="629,8242"/>
<v:line from="629,8242" to="0,8242"/>
<v:line from="0,8242" to="0,7208"/>

</PAGE>
 
<!-- page 360 --> 
<PAGE>
<A id="svgcats_vml_p360" class="to_tree" style="margin-top:8247px;" onClick="selectTreeElem( '360' );">←</A>
<A href="#svgcats_vml_p361" class="to_next_page" style="margin-top:8247px;">▼</A>
<A href="#svgcats_vml_p359" class="to_prev_page" style="margin-top:8247px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8258px; width:552px; height:896px;" fillcolor="white"/>
<DIV id="text360_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8275px; line-height:15px; white-space:nowrap">
<A name="new_TextFileCharSetStack">
new_TextFileCharSetStack</A></DIV>
<v:rect style="position:absolute; margin-left:36px; margin-top:8740px; width:292px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text360_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:44px; margin-top:8746px; line-height:15px; white-space:nowrap">
&nbsp; Set cs = new_TextFileCharSetStack( "UTF-8" )<BR/>
&nbsp; CreateFile&nbsp; "File1.txt", "abc"</DIV>
<DIV id="text360_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8719px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text360_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:266px; margin-top:8747px; line-height:13px; white-space:nowrap">
"UTF-8"</DIV>
<DIV id="text360_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8344px; line-height:15px; white-space:nowrap">
ファイルの文字コードを指定します。</DIV>
<DIV id="text360_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8370px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text360_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:8370px; line-height:15px; white-space:nowrap">
CharSet</DIV>
<DIV id="text360_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:178px; margin-top:8370px; line-height:15px; white-space:nowrap">
ファイルの文字コード, Empty=デフォルト</DIV>
<DIV id="text360_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8523px; line-height:15px; white-space:nowrap">
新規作成時のデフォルトは、"Shift_JIS" です。<BR/>
CharSet 引数に指定する文字列の大文字小文字は区別しません。<BR/>
c.Unicode などの数値定数を指定することもできます。</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:8305px; width:490px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text360_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:8312px; line-height:13px; white-space:nowrap">
Function&nbsp; new_TextFileCharSetStack( CharSet as string ) as TextFileCharSetStack</DIV>
<DIV id="text360_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:9006px; line-height:15px; white-space:nowrap">
<A href="#OpenForWrite">
→ OpenForWrite</A></DIV>
<DIV id="text360_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9006px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text360_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8979px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text360_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:70px; margin-top:8979px; line-height:15px; white-space:nowrap">
→ T_File.vbs [T_OpenForWrite]</DIV>
<DIV id="text360_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:228px; margin-top:8274px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text360_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8405px; line-height:15px; white-space:nowrap">
新規作成するときの出力ファイルや、ファイルから読み込むときの文字コードを指定<BR/>
します。 返り値のオブジェクトが削除されたら、指定は無効になります。</DIV>
<DIV id="text360_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8587px; line-height:15px; white-space:nowrap">
"UTF-8" は、ファイルの先頭に</DIV>
<DIV id="text360_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:210px; margin-top:8587px; line-height:15px; white-space:nowrap">
BOM</DIV>
<DIV id="text360_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:241px; margin-top:8587px; line-height:15px; white-space:nowrap">
が付きます。 "UTF-8-No-BOM" は付きません。</DIV>
<DIV id="text360_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:9026px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_13.html#Charset_ADODB_Stream">
→ Charset (ADODB.Stream)</A></DIV>
<DIV id="text360_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8667px; line-height:15px; white-space:nowrap">
指定できる値は、レジストリの HKEY_CLASSES_ROOT\MIME\Database\Charset の<BR/>
サブキーを参照してください。 ただし、"UTF-8-No-BOM" はサブキーにありません。</DIV>
<DIV id="text360_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8447px; line-height:15px; white-space:nowrap">
CharSetの例：</DIV>
<DIV id="text360_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:146px; margin-top:8448px; line-height:15px; white-space:nowrap">
"Shift_JIS", "EUC-JP", "Unicode", "UTF-8", "UTF-8-No-BOM",<BR/>
"ISO-8859-1", "ISO-2022-JP"<BR/>
c.Unicode, c.UTF_8, c.UTF_8_No_BOM, c.EUC_JP, c.Shift_JIS, <BR/>
c.ISO_2022_JP</DIV>
<DIV id="text360_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:184px; margin-top:9006px; line-height:15px; white-space:nowrap">
<A href="vbslib_17.html#CreateFile">
→ CreateFile</A></DIV>
<DIV id="text360_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8602px; line-height:15px; white-space:nowrap">
BOM を付けないときは XML の encoding や HTML の charset などを用いて文字<BR/>
コードを記述しなければ、多くのプログラムは文字化けを起こします。 一方で、<BR/>
BOM があるとエラーを起こすプログラムも多くあります。</DIV>
<DIV id="text360_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:9046px; line-height:15px; white-space:nowrap">
→ XmlWriteEncoding</DIV>
<DIV id="text360_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:9066px; line-height:15px; white-space:nowrap">
<A href="#ReadUnicodeFileBOM">
→ ReadUnicodeFileBOM</A></DIV>
<DIV id="text360_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8803px; line-height:15px; white-space:nowrap">
<A name="charcode_in_file">
ファイル内の文字コードの指定</A></DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:8850px; width:244px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text360_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:8857px; line-height:13px; white-space:nowrap">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;</DIV>
<DIV id="text360_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:8831px; line-height:15px; white-space:nowrap">
XML の場合</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:8909px; width:424px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text360_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:8916px; line-height:13px; white-space:nowrap">
&lt;META http-equiv="content-type" content="text/html; charset=UTF-8"/&gt;</DIV>
<DIV id="text360_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:37px; margin-top:8891px; line-height:15px; white-space:nowrap">
HTML の場合</DIV>
<DIV id="text360_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:236px; margin-top:8857px; line-height:13px; white-space:nowrap">
UTF-8</DIV>
<DIV id="text360_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:416px; margin-top:8916px; line-height:13px; white-space:nowrap">
UTF-8</DIV>
<DIV id="text360_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:249px; margin-top:9066px; line-height:15px; white-space:nowrap">
ファイルの先頭にある BOM を読みます。</DIV>
<DIV id="text360_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:249px; margin-top:9046px; line-height:15px; white-space:nowrap">
XML ファイルの文字コードを指定します。</DIV>
<DIV id="text360_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:9086px; line-height:15px; white-space:nowrap">
<A href="%vbslib_n_new%\_src\vbslib_n.svg#ConvertCharCodeInHref">
→ ConvertCharCodeInHref</A></DIV>
<DIV id="text360_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:9106px; line-height:15px; white-space:nowrap">
→ Text (BinaryArray)</DIV>
<DIV id="text360_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:249px; margin-top:9106px; line-height:15px; white-space:nowrap">
文字コードセットを変換します。</DIV>

<v:line from="0,8258" to="552,8258"/>
<v:line from="552,8258" to="552,9154"/>
<v:line from="552,9154" to="0,9154"/>
<v:line from="0,9154" to="0,8258"/>

</PAGE>
 
<!-- page 361 --> 
<PAGE>
<A id="svgcats_vml_p361" class="to_tree" style="margin-top:9159px;" onClick="selectTreeElem( '361' );">←</A>
<A href="#svgcats_vml_p362" class="to_next_page" style="margin-top:9159px;">▼</A>
<A href="#svgcats_vml_p360" class="to_prev_page" style="margin-top:9159px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9170px; width:603px; height:405px;" fillcolor="white"/>
<DIV id="text361_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9187px; line-height:15px; white-space:nowrap">
<A name="Decode_MIME_HeaderLine">
Decode_MIME_HeaderLine</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:9217px; width:376px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text361_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:9224px; line-height:13px; white-space:nowrap">
Function&nbsp; Decode_MIME_HeaderLine( Line as string ) as string</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:9395px; width:526px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text361_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:9401px; line-height:15px; white-space:nowrap">
str = Decode_MIME_HeaderLine( "Subject: =?ISO-2022-JP?B?YWJjGyRCJUYlOSVIGyhCZGVm?=" )<BR/>
Assert&nbsp; str = "Subject: abcテストdef"</DIV>
<DIV id="text361_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9254px; line-height:15px; white-space:nowrap">
MIME ヘッダーの１行を "=? … ?=" 形式から、通常の文字列に戻します。</DIV>
<DIV id="text361_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9280px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text361_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9280px; line-height:15px; white-space:nowrap">
Line</DIV>
<DIV id="text361_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:9280px; line-height:15px; white-space:nowrap">
MIME ヘッダーの１行</DIV>
<DIV id="text361_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:9299px; line-height:15px; white-space:nowrap">
Line からでコードした通常の文字列</DIV>
<DIV id="text361_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9299px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text361_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9456px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text361_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9372px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text361_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9336px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text361_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:185px; margin-top:9456px; line-height:15px; white-space:nowrap">
T_MIME</DIV>
<DIV id="text361_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9482px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text361_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:71px; margin-top:9482px; line-height:15px; white-space:nowrap">
→ MIME</DIV>
<DIV id="text361_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:138px; margin-top:9482px; line-height:15px; white-space:nowrap">
→ ISO-2022-JP</DIV>
<DIV id="text361_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:254px; margin-top:9482px; line-height:15px; white-space:nowrap">
→ Base64</DIV>
<DIV id="text361_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9508px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text361_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:9508px; line-height:15px; white-space:nowrap">
<A href="vbslib_24.html#Base64_BinaryArray">
→ Base64 (BinaryArray)</A></DIV>
<DIV id="text361_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:71px; margin-top:9456px; line-height:15px; white-space:nowrap">
→ T_Binary.vbs</DIV>
<DIV id="text361_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:71px; margin-top:9527px; line-height:15px; white-space:nowrap">
<A href="vbslib_24.html#Text_BinaryArray">
→ Text (BinaryArray)</A></DIV>
<DIV id="text361_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:89px; margin-top:9336px; line-height:15px; white-space:nowrap">
→ System.vbs</DIV>
<DIV id="text361_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:9527px; line-height:15px; white-space:nowrap">
文字コードの変換</DIV>

<v:line from="0,9170" to="603,9170"/>
<v:line from="603,9170" to="603,9575"/>
<v:line from="603,9575" to="0,9575"/>
<v:line from="0,9575" to="0,9170"/>

</PAGE>
 
<!-- page 362 --> 
<PAGE>
<A id="svgcats_vml_p362" class="to_tree" style="margin-top:9580px;" onClick="selectTreeElem( '362' );">←</A>
<A href="vbslib_19.html#svgcats_vml_p363" class="to_next_page" style="margin-top:9580px;">▼</A>
<A href="#svgcats_vml_p361" class="to_prev_page" style="margin-top:9580px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9591px; width:589px; height:1279px;" fillcolor="white"/>
<DIV id="text362_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9608px; line-height:15px; white-space:nowrap">
<A name="new_TextFileLineSeparatorStack">
new_TextFileLineSeparatorStack</A></DIV>
<DIV id="text362_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:274px; margin-top:9607px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text362_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9677px; line-height:15px; white-space:nowrap">
ファイルの改行文字コードを指定します。</DIV>
<DIV id="text362_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9703px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text362_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:9703px; line-height:15px; white-space:nowrap">
LS</DIV>
<DIV id="text362_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:150px; margin-top:9703px; line-height:15px; white-space:nowrap">
ファイルの改行文字コード、または Empty</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:9638px; width:532px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text362_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:9645px; line-height:13px; white-space:nowrap">
Function&nbsp; new_TextFileLineSeparatorStack( LS as string ) as TextFileLineSeparatorStack</DIV>
<DIV id="text362_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:9738px; line-height:15px; white-space:nowrap">
&nbsp;返り値のオブジェクトが削除されたら、指定は無効になります。</DIV>
<DIV id="text362_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9903px; line-height:15px; white-space:nowrap">
LS 引数</DIV>
<DIV id="text362_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:9953px; line-height:13px; white-space:nowrap">
vbCRLF, g_VBS_Lib.CRLF</DIV>
<DIV id="text362_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:9973px; line-height:13px; white-space:nowrap">
vbLF, g_VBS_Lib.LF</DIV>
<DIV id="text362_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:9993px; line-height:13px; white-space:nowrap">
g_VBS_Lib.KeepLineSeparators</DIV>
<DIV id="text362_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:44px; margin-top:9933px; line-height:13px; white-space:nowrap">
Empty</DIV>
<DIV id="text362_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10071px; line-height:15px; white-space:nowrap">
リードするときは改行文字を自動判定、ライトするときは CR+LF、修正するとき（*下記）は<BR/>
改行文字の種類を継承します。</DIV>
<DIV id="text362_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:259px; margin-top:9951px; line-height:15px; white-space:nowrap">
CR+LF</DIV>
<DIV id="text362_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:259px; margin-top:9971px; line-height:15px; white-space:nowrap">
LF</DIV>
<DIV id="text362_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:259px; margin-top:9991px; line-height:15px; white-space:nowrap">
改行文字の種類を継承する（下記）</DIV>
<v:rect style="position:absolute; margin-left:40px; margin-top:9800px; width:460px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text362_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:48px; margin-top:9806px; line-height:15px; white-space:nowrap">
Dim ls : Set ls = new_TextFileLineSeparatorStack( get_ADODBConsts().Keep )<BR/>
Set f&nbsp; = OpenForRead( Path )<BR/>
ls = Empty<BR/>
text = f.ReadLine()</DIV>
<DIV id="text362_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9776px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text362_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10792px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text362_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:10792px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_13.html#LineSeparator_ADODB_Stream">
→ LineSeparator (ADODB.Stream)</A></DIV>
<DIV id="text362_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:44px; margin-top:10229px; line-height:15px; white-space:nowrap">
<A href="vbslib_19.html#OpenForReplace">
OpenForReplace</A></DIV>
<DIV id="text362_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:147px; margin-top:10229px; line-height:15px; white-space:nowrap">
など、修正前のテキストと修正後のテキストの両方を指定する vbslib</DIV>
<DIV id="text362_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10167px; line-height:15px; white-space:nowrap">
「改行文字の種類を継承する」 とは、入力ファイルに書かれた改行文字の種類が、１行<BR/>
単位で、そのまま出力ファイルに書かれることです。 １つのファイルに複数の改行文字の<BR/>
種類が混ざっていても、そのまま継承されることです。</DIV>
<DIV id="text362_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10139px; line-height:15px; white-space:nowrap">
<A name="new_TextFileLineSeparatorStack_Inherit">
改行文字の種類を継承するときの動き (KeepLineSeparators)</A></DIV>
<DIV id="text362_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10547px; line-height:15px; white-space:nowrap">
TextStream::WriteLine に渡すテキストの末尾に vbCRLF または vbLF を付けることが<BR/>
できます。 付けたときは、その種類の改行文字が出力され、TextStream::WriteLine に<BR/>
よって自動的に改行文字を付けることはなくなります。 また、デフォルトの改行文字も<BR/>
指定した種類に変更されます。&nbsp; 改行文字を付けなかったときは、デフォルトの改行<BR/>
文字が自動的に付きます。 つまり、TextStream::ReadLine で入力した１行をそのまま<BR/>
TextStream::WriteLine に出力すると、改行文字の種類は継承され、末尾に改行文字<BR/>
を付けない新たな１行を TextStream::WriteLine に出力すると、前の行の改行文字の<BR/>
種類を継承します。</DIV>
<DIV id="text362_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:259px; margin-top:9931px; line-height:15px; white-space:nowrap">
自動判定 （下記）</DIV>
<DIV id="text362_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10045px; line-height:15px; white-space:nowrap">
<A name="new_TextFileLineSeparatorStack_Empty">
LS 引数 = Empty のときの動き</A></DIV>
<DIV id="text362_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10245px; line-height:15px; white-space:nowrap">
の関数を使ったときは、その関数の中で改行文字の種類の継承処理が行われます。</DIV>
<DIV id="text362_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:106px; margin-top:10354px; line-height:15px; white-space:nowrap">
<A href="#ReadLineSeparator">
ReadLineSeparator</A></DIV>
<DIV id="text362_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:225px; margin-top:10354px; line-height:15px; white-space:nowrap">
を使って、入力ファイルの先頭行の改行文字の種類を</DIV>
<DIV id="text362_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10370px; line-height:15px; white-space:nowrap">
判定して、出力ファイルのデフォルト改行文字の種類を設定します。</DIV>
<DIV id="text362_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10398px; line-height:15px; white-space:nowrap">
入力ファイル、出力ファイル、ともに、g_VBS_Lib.KeepLineSeparators （上記） のモード<BR/>
を使うように、new_TextFileLineSeparatorStack を呼び出します。</DIV>
<DIV id="text362_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10484px; line-height:15px; white-space:nowrap">
TextStream::ReadLine の返り値である１行のテキストの末尾に改行文字が加わります。<BR/>
改行文字は、ファイルの内容によって、LF または CR+LF のどちらかになります。<BR/>
ただし、最終行の末尾に改行文字が無いときだけ、改行文字は加わりません。</DIV>
<DIV id="text362_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10354px; line-height:15px; white-space:nowrap">
はじめに、</DIV>
<DIV id="text362_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:66px; margin-top:10820px; line-height:15px; white-space:nowrap">
<A href="vbslib_20.html#CutCRLF">
→ CutCRLF</A></DIV>
<DIV id="text362_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10820px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text362_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10276px; line-height:15px; white-space:nowrap">
そうではなく、OpenForRead などを使ってテキストをリードして、OpenForWrite などを<BR/>
使ってテキストをライトする処理をプログラミングするときは、以下で説明する詳細な<BR/>
手順を参考に、改行文字の継承を行ってください。</DIV>
<DIV id="text362_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#FF0000; margin-left:44px; margin-top:10441px; line-height:15px; white-space:nowrap">
KeepLineSeparators モードでは、TextStream::ReadLine や TextStream::WriteLine に<BR/>
よってアクセスする１行のテキストの内容が、次のように変わります。</DIV>
<DIV id="text362_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:22px; margin-top:10744px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text362_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:10744px; line-height:15px; white-space:nowrap">
→ T_Replace.vbs # T_StartReplace_KeepRet_1</DIV>
<DIV id="text362_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:66px; margin-top:10765px; line-height:15px; white-space:nowrap">
→ T_File.vbs # T_OpenFile_LineSepFromFS</DIV>
<DIV id="text362_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:10685px; line-height:15px; white-space:nowrap">
TextStream::WriteLineDefault を使うと、渡したテキストの改行文字を、デフォルトの<BR/>
改行文字に置き換え、渡したテキストの最後に改行文字を追加して、出力します。</DIV>

<v:line from="0,9591" to="589,9591"/>
<v:line from="589,9591" to="589,10870"/>
<v:line from="589,10870" to="0,10870"/>
<v:line from="0,10870" to="0,9591"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10870px;">
<A id="svgcats_vml_p362" class="to_tree" onClick="selectTreeElem( '362' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10870px;">
<A id="page_group_bottom" href="vbslib_19.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
