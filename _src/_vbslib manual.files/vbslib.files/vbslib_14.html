<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>vbslib</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbslib.files/vbslib_14.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbslib.files/vbslib_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbslib.files/vbslib_14.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 226 --> 
<PAGE>
<A id="svgcats_vml_p226" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '226' );">←</A>
<A href="#svgcats_vml_p227" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbslib_13.html#svgcats_vml_p225" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbslib_13.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:390px; height:132px;" fillcolor="white"/>
<DIV id="text226_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="Items_ObjectSetClass">
Items (ObjectSetClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:47px; width:238px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text226_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:54px; line-height:13px; white-space:nowrap">
Property Get&nbsp; ObjectSetClass::Items()</DIV>
<DIV id="text226_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:84px; line-height:15px; white-space:nowrap">
For 文に指定できるオブジェクトの集合を返します。</DIV>
<DIV id="text226_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:247px; margin-top:17px; line-height:15px; white-space:nowrap">
<A href="vbslib_13.html#ObjectSetClass">
&lt;&lt; ObjectSetClass</A></DIV>

<v:line from="0,0" to="390,0"/>
<v:line from="390,0" to="390,132"/>
<v:line from="390,132" to="0,132"/>
<v:line from="0,132" to="0,0"/>

</PAGE>
 
<!-- page 227 --> 
<PAGE>
<A id="svgcats_vml_p227" class="to_tree" style="margin-top:137px;" onClick="selectTreeElem( '227' );">←</A>
<A href="#svgcats_vml_p228" class="to_next_page" style="margin-top:137px;">▼</A>
<A href="#svgcats_vml_p226" class="to_prev_page" style="margin-top:137px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:148px; width:457px; height:132px;" fillcolor="white"/>
<DIV id="text227_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:165px; line-height:15px; white-space:nowrap">
<A name="Exists_ObjectSetClass">
Exists (ObjectSetClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:195px; width:400px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text227_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:202px; line-height:13px; white-space:nowrap">
Function&nbsp; ObjectSetClass::Exists( Object as variant ) as boolean</DIV>
<DIV id="text227_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:232px; line-height:15px; white-space:nowrap">
コレクションに追加されているかどうかを返します。</DIV>
<DIV id="text227_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:277px; margin-top:165px; line-height:15px; white-space:nowrap">
<A href="vbslib_13.html#ObjectSetClass">
&lt;&lt; ObjectSetClass</A></DIV>

<v:line from="0,148" to="457,148"/>
<v:line from="457,148" to="457,280"/>
<v:line from="457,280" to="0,280"/>
<v:line from="0,280" to="0,148"/>

</PAGE>
 
<!-- page 228 --> 
<PAGE>
<A id="svgcats_vml_p228" class="to_tree" style="margin-top:285px;" onClick="selectTreeElem( '228' );">←</A>
<A href="#svgcats_vml_p229" class="to_next_page" style="margin-top:285px;">▼</A>
<A href="#svgcats_vml_p227" class="to_prev_page" style="margin-top:285px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:296px; width:419px; height:158px;" fillcolor="white"/>
<DIV id="text228_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:313px; line-height:15px; white-space:nowrap">
<A name="Remove_ObjectSetClass">
Remove (ObjectSetClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:343px; width:304px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text228_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:350px; line-height:13px; white-space:nowrap">
Sub&nbsp; ObjectSetClass::Remove( Object as variant )</DIV>
<DIV id="text228_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:380px; line-height:15px; white-space:nowrap">
コレクションに追加されていれば、コレクションから除外します。</DIV>
<DIV id="text228_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:406px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text228_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:406px; line-height:15px; white-space:nowrap">
Object</DIV>
<DIV id="text228_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:406px; line-height:15px; white-space:nowrap">
除外するオブジェクト</DIV>
<DIV id="text228_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:253px; margin-top:313px; line-height:15px; white-space:nowrap">
<A href="vbslib_13.html#ObjectSetClass">
&lt;&lt; ObjectSetClass</A></DIV>

<v:line from="0,296" to="419,296"/>
<v:line from="419,296" to="419,454"/>
<v:line from="419,454" to="0,454"/>
<v:line from="0,454" to="0,296"/>

</PAGE>
 
<!-- page 229 --> 
<PAGE>
<A id="svgcats_vml_p229" class="to_tree" style="margin-top:459px;" onClick="selectTreeElem( '229' );">←</A>
<A href="#svgcats_vml_p230" class="to_next_page" style="margin-top:459px;">▼</A>
<A href="#svgcats_vml_p228" class="to_prev_page" style="margin-top:459px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:470px; width:380px; height:132px;" fillcolor="white"/>
<DIV id="text229_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:487px; line-height:15px; white-space:nowrap">
<A name="RemoveAll_ObjectSetClass">
RemoveAll (ObjectSetClass)</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:517px; width:208px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text229_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:524px; line-height:13px; white-space:nowrap">
Sub&nbsp; ObjectSetClass::RemoveAll()</DIV>
<DIV id="text229_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:554px; line-height:15px; white-space:nowrap">
コレクションからすべてのオブジェクトを除外します。</DIV>
<DIV id="text229_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:237px; margin-top:487px; line-height:15px; white-space:nowrap">
<A href="vbslib_13.html#ObjectSetClass">
&lt;&lt; ObjectSetClass</A></DIV>

<v:line from="0,470" to="380,470"/>
<v:line from="380,470" to="380,602"/>
<v:line from="380,602" to="0,602"/>
<v:line from="0,602" to="0,470"/>

</PAGE>
 
<!-- page 230 --> 
<PAGE>
<A id="svgcats_vml_p230" class="to_tree" style="margin-top:607px;" onClick="selectTreeElem( '230' );">←</A>
<A href="#svgcats_vml_p231" class="to_next_page" style="margin-top:607px;">▼</A>
<A href="#svgcats_vml_p229" class="to_prev_page" style="margin-top:607px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:618px; width:642px; height:7273px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:76px; margin-top:2465px; width:268px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:2471px; line-height:15px; white-space:nowrap">
g("${RootPath}") = "${${Target}/RootPath}"<BR/>
g("${TargetA/RootPath}") = "C:\FolderA"<BR/>
g("${TargetB/RootPath}") = "C:\FolderB"<BR/>
<BR/>
g("${Target}") = "TargetA"<BR/>
Assert&nbsp; g("${RootPath}") = "C:\FolderA"<BR/>
g("${Target}") = "TargetB"<BR/>
Assert&nbsp; g("${RootPath}") = "C:\FolderB"</DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:2259px; width:250px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:2265px; line-height:15px; white-space:nowrap">
g("${RootPath}") = "C:\FolderA"<BR/>
Assert&nbsp; g("${RootPath}") = "C:\FolderA"</DIV>
<DIV id="text230_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2198px; line-height:15px; white-space:nowrap">
<A name="DictionaryEx_IndirectRef">
既存の変数の値を、別の変数によって間接参照させる</A></DIV>
<DIV id="text230_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:635px; line-height:15px; white-space:nowrap">
<A name="LazyDictionaryClass">
${ } 変数, LazyDictionaryClass</A></DIV>
<DIV id="text230_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:2231px; line-height:15px; white-space:nowrap">
元々、下記のように使われていた変数 ${RootPath} があるとします。</DIV>
<DIV id="text230_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:2324px; line-height:15px; white-space:nowrap">
変数の値を、別の変数の値によって動的に変えたい場合は、下記のどちらの記述もできます。</DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:2349px; width:250px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:2355px; line-height:15px; white-space:nowrap">
g("${RootPath}") = "C:\Folder${Target}"<BR/>
<BR/>
g("${Target}") = "A"<BR/>
Assert&nbsp; g("${RootPath}") = "C:\FolderA"<BR/>
g("${Target}") = "B"<BR/>
Assert&nbsp; g("${RootPath}") = "C:\FolderB"</DIV>
<DIV id="text230_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6971px; line-height:15px; white-space:nowrap">
<A name="DictionaryEx_Escape">
参照記号 ${ } のエスケープ</A></DIV>
<v:rect style="position:absolute; margin-left:79px; margin-top:7047px; width:322px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:87px; margin-top:7053px; line-height:15px; white-space:nowrap">
g("$\{") = "${"&nbsp; &nbsp;'// $\ は $ に置き換わります<BR/>
g("$\\") = "$\"<BR/>
g("$\}") = "$}"<BR/>
g("$A")&nbsp; = "$A"&nbsp; &nbsp;'// $ の後に { がないと、そのまま</DIV>
<DIV id="text230_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:7128px; line-height:15px; white-space:nowrap">
（メモ） このエスケープにより、単純に "${" を検索すれば、それが展開すべき変数かどうかが<BR/>
分かります。</DIV>
<DIV id="text230_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:668px; line-height:15px; white-space:nowrap">
辞書の値に、辞書のキーへの参照を入れて、遅延評価する辞書です。<BR/>
LazyDictionaryClass のオブジェクトは名前空間に相当し、キーは変数名に相当します。</DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:708px; width:250px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:714px; line-height:15px; white-space:nowrap">
Set g = new LazyDictionaryClass<BR/>
g("${RootPath}") = "C:\Folder${Target}"<BR/>
g("${Target}") = "A"<BR/>
<BR/>
Assert&nbsp; g("${RootPath}") = "C:\FolderA"</DIV>
<DIV id="text230_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:889px; line-height:15px; white-space:nowrap">
キーは、${ 〜 } 形式（例： ${A}）にしてください。 $〜 形式（例： $A）は、エラーになります。<BR/>
キーの ${ 〜 } の中に "$", "{", "}" は使えませんが、他の記号、Unicode文字（日本語など）<BR/>
は使えます。</DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:2677px; width:346px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:2683px; line-height:15px; white-space:nowrap">
g("${RootPath( TargetA )}") = "C:\FolderA"<BR/>
g("${RootPath( TargetB )}") = "C:\FolderB"<BR/>
<BR/>
target = "TargetA"<BR/>
Assert&nbsp; g("${RootPath( "+ target +" )}") = "C:\FolderA"</DIV>
<DIV id="text230_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:2620px; line-height:15px; white-space:nowrap">
単純な変換関数であれば、関数をデータに置き換えることもできます。<BR/>
下記の RootPath が、関数の代わりです。<BR/>
キーが存在しなければ、エラーになります。</DIV>
<DIV id="text230_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1408px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text230_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1386px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text230_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:75px; margin-top:1386px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text230_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3225px; line-height:15px; white-space:nowrap">
<A name="DictionaryEx_Array">
配列を値にする</A></DIV>
<v:rect style="position:absolute; margin-left:79px; margin-top:3302px; width:454px; height:220px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_20" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:87px; margin-top:3308px; line-height:15px; white-space:nowrap">
Set g = new LazyDictionaryClass<BR/>
<BR/>
g("${Array1}") = Array( "${Var}/1", "${Var}/2" )<BR/>
g("${Array2}") = Array( "${Array1}", "${Var}/3", "${Var}/4", "${Var}/5" )<BR/>
g("${Var}") = "x"<BR/>
array1 = g("${Array1}")<BR/>
array2 = g("${Array2}")<BR/>
<BR/>
Assert&nbsp; IsSameArray( array1, Array( "x/1", "x/2" ) )<BR/>
Assert&nbsp; IsSameArray( array2, Array( "x/1", "x/2", "x/3", "x/4", "x/5" ) )<BR/>
<BR/>
For Each&nbsp; value&nbsp; In g("${Array2}")<BR/>
&nbsp; &nbsp; echo&nbsp; value<BR/>
Next</DIV>
<DIV id="text230_21" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1430px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text230_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:1447px; line-height:15px; white-space:nowrap">
<A href="vbslib_15.html#DictionaryClass">
→ DictionaryClass</A></DIV>
<DIV id="text230_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:2807px; line-height:15px; white-space:nowrap">
<A name="DictionaryEx_NotString">
文字列以外の値の参照</A></DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:2863px; width:454px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:2869px; line-height:15px; white-space:nowrap">
g("${Var}") = True<BR/>
Assert&nbsp; g("${Var}") = True&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '// 式ではないので boolean 型のまま<BR/>
Assert&nbsp; g("Var=${Var}") = "Var=True"&nbsp; '// 式なので文字列に変換</DIV>
<DIV id="text230_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:2838px; line-height:15px; white-space:nowrap">
式を参照すると、文字列になります。 式とは、${ } で囲まれた変数以外の文字がある文字列です。</DIV>
<DIV id="text230_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:950px; line-height:15px; white-space:nowrap">
キーの展開は参照時（ g("${Var}") を Get するとき）に行われる（遅延評価である）ため、<BR/>
キーを含むアイテム（値）を設定するときに、そのキーが定義されていなくても構いません。 <BR/>
例：上記 ${Target}。 つまり、連続して設定するときは、設定する順番を問いません。 <BR/>
参照時にキーが存在しないときは、エラーになります。 簡単な文字列変換関数なら、<BR/>
辞書のデータに置き換えることができます。</DIV>
<DIV id="text230_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:75px; margin-top:1464px; line-height:15px; white-space:nowrap">
→ 関数型プログラミング</DIV>
<DIV id="text230_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1090px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_IndirectRef">
→ 既存の変数の値を、別の変数によって間接参照させる</A></DIV>
<DIV id="text230_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1110px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_NotString">
→ 文字列以外の値の参照</A></DIV>
<DIV id="text230_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1130px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_Array">
→ 配列を値にする</A></DIV>
<DIV id="text230_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1250px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_Escape">
→ 参照記号 ${ } のエスケープ</A></DIV>
<v:rect style="position:absolute; margin-left:79px; margin-top:3573px; width:514px; height:205px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:87px; margin-top:3579px; line-height:15px; white-space:nowrap">
Set g = new LazyDictionaryClass<BR/>
<BR/>
g("${Workspace/Lib}")&nbsp; &nbsp; = "FolderA"<BR/>
g("${Workspace/Sample}") = "FolderB" <BR/>
<BR/>
values1 = g.Each_( "${Workspace/${i}}", "${i}", Array( "Lib", "Sample" ) )<BR/>
Assert&nbsp; IsSameArray( values1, Array( "FolderA", "FolderB" ) )<BR/>
<BR/>
formulas = g.EachFormula( "${Workspace/${i}}", "${i}", Array( "Lib", "Sample" ) )<BR/>
Assert&nbsp; IsSameArray( formulas, Array( "${Workspace/Lib}", "${Workspace/Sample}" ) )<BR/>
<BR/>
values2 = g( formulas )<BR/>
Assert&nbsp; IsSameArray( values2, values1 )</DIV>
<DIV id="text230_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:3537px; line-height:15px; white-space:nowrap">
Each_ や EachFormula を使えば、配列の要素をループ変数のように扱って変換できます。<BR/>
また、辞書を参照するときに、配列を指定することもできます。</DIV>
<DIV id="text230_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:49px; margin-top:3261px; line-height:15px; white-space:nowrap">
値（ = の右）に配列を指定することができます。<BR/>
また、配列の要素に、配列を値を持つ変数への参照を指定すると、ネストしないで展開されます。</DIV>
<DIV id="text230_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:7006px; line-height:15px; white-space:nowrap">
$\{ と書くと、${ という文字列データができます。 この処理は、変数の展開をしないために、<BR/>
最後に行われます。 展開した結果に $\ があるときは、$ に置き換わります。 </DIV>
<DIV id="text230_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:75px; margin-top:1408px; line-height:15px; white-space:nowrap">
→ T_LazyDictionary.vbs</DIV>
<DIV id="text230_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:2943px; line-height:15px; white-space:nowrap">
オブジェクトの設定と参照ができます。</DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:2967px; width:226px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_38" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:2973px; line-height:15px; white-space:nowrap">
Set g("${Var}") = new NameOnlyClass<BR/>
echo&nbsp; g("${Var}").Name</DIV>
<DIV id="text230_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7363px; line-height:15px; white-space:nowrap">
<A name="str_spell_miss_lz">
文字列のスペルミス対策、${&gt;&nbsp; }</A></DIV>
<DIV id="text230_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:7391px; line-height:15px; white-space:nowrap">
キーが存在しないときに自動的にキーを追加しないため、文字列のスペルミスを防ぐことができます。<BR/>
ただし、キーとアイテムが異なることが一般的である辞書型では、アイテムを調べなければ<BR/>
文字列を知ることができないため、開発効率が落ちます。<BR/>
そこで、キーの先頭が "&gt;" から、アイテムと同じであるようなルールにするとよいでしょう。<BR/>
なお、&gt; を選んだ理由は、メールの引用（コピー）記号や、NaturalDocs の空白を維持する記号に<BR/>
近い意味を持っているからです。</DIV>
<v:rect style="position:absolute; margin-left:83px; margin-top:7491px; width:202px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_41" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:91px; margin-top:7497px; line-height:15px; white-space:nowrap">
Set g = new LazyDictionaryClass<BR/>
g("${&gt;Spell}") = "Spell"</DIV>
<DIV id="text230_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1270px; line-height:15px; white-space:nowrap">
<A href="#str_spell_miss_lz">
→ 文字列のスペルミス対策、${&gt;&nbsp; }</A></DIV>
<DIV id="text230_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1580px; line-height:15px; white-space:nowrap">
<A name="LazyDictionaryShow">
アイテムを一覧表示する</A></DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:1649px; width:202px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_44" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:1655px; line-height:15px; white-space:nowrap">
Set g = new LazyDictionaryClass<BR/>
g("${Var1}") = "Value1"<BR/>
g("${Var2}") = "${Var1}-2"<BR/>
<BR/>
g.EchoToEditor</DIV>
<DIV id="text230_45" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:96px; margin-top:1716px; line-height:13px; white-space:nowrap">
EchoToEditor</DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:1771px; width:220px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_46" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:1777px; line-height:15px; white-space:nowrap">
${Var1} = "Value1"<BR/>
${Var2} = "${Var1}-2" = "Value1-2"</DIV>
<DIV id="text230_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:1609px; line-height:15px; white-space:nowrap">
EchoToEditor メソッドを呼び出すと、アイテムのキーと展開前の値と展開後の値が書かれた<BR/>
テキスト エディターが開きます。 内容は、GetSetListString の返り値と同じです。</DIV>
<DIV id="text230_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:1751px; line-height:15px; white-space:nowrap">
テキスト エディターで開く内容：</DIV>
<DIV id="text230_49" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1050px; line-height:15px; white-space:nowrap">
<A href="#LazyDictionaryShow">
→ アイテムを一覧表示する</A></DIV>
<DIV id="text230_50" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7692px; line-height:15px; white-space:nowrap">
<A name="lazy_explanatory_variable">
説明変数の活用</A></DIV>
<v:rect style="position:absolute; margin-left:83px; margin-top:7763px; width:406px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_51" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:91px; margin-top:7770px; line-height:13px; white-space:nowrap">
patch_path = g("${Repository_workspace}\Sample_Test_patch\patch")</DIV>
<DIV id="text230_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:7723px; line-height:15px; white-space:nowrap">
辞書を参照するコードが長くなるときは、役割を説明する説明変数をローカルで（関数内のスコープ<BR/>
をもつ変数を）活用するとよいでしょう</DIV>
<DIV id="text230_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:85px; margin-top:7804px; line-height:15px; white-space:nowrap">
→ 説明変数</DIV>
<DIV id="text230_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:47px; margin-top:7804px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text230_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1290px; line-height:15px; white-space:nowrap">
<A href="#lazy_explanatory_variable">
→ 説明変数の活用</A></DIV>
<DIV id="text230_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:1481px; line-height:15px; white-space:nowrap">
<A href="vbslib_16.html#DicItemOfItem">
→ DicItemOfItem</A></DIV>
<DIV id="text230_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1868px; line-height:15px; white-space:nowrap">
<A name="LazyDictionaryDebug">
デバッグ・モード</A></DIV>
<v:rect style="position:absolute; margin-left:75px; margin-top:1959px; width:226px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_58" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:83px; margin-top:1965px; line-height:15px; white-space:nowrap">
g.DebugMode = True&nbsp; '// [TODO] 追加<BR/>
g("${Target}") = "B"<BR/>
echo&nbsp; g("${RootPath}")</DIV>
<DIV id="text230_59" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:1899px; line-height:15px; white-space:nowrap">
下記のように、デバッグ・モードをオンにすると、設定した内容を echo 表示したり、参照時にキーを<BR/>
１つずつ展開する様子を echo 表示します。</DIV>
<v:rect style="position:absolute; margin-left:75px; margin-top:2050px; width:388px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_60" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:83px; margin-top:2056px; line-height:15px; white-space:nowrap">
&lt;DictionaryEx operation="Set" key="${Target}"&gt;B&lt;/DictionaryEx&gt;<BR/>
&lt;DictionaryEx operation="Get" key="${RootPath}"&gt;<BR/>
&lt;Expand count="1"&gt;C:\Folder${Target}&lt;/Expand&gt;<BR/>
&lt;Expand count="2"&gt;C:\FolderB&lt;/Expand&gt;<BR/>
&lt;/DictionaryEx&gt;</DIV>
<DIV id="text230_61" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:2030px; line-height:15px; white-space:nowrap">
echo 表示の内容：</DIV>
<DIV id="text230_62" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1070px; line-height:15px; white-space:nowrap">
<A href="#LazyDictionaryDebug">
→ デバッグ・モード</A></DIV>
<v:rect style="position:absolute; margin-left:48px; margin-top:830px; width:388px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_63" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:56px; margin-top:836px; line-height:15px; white-space:nowrap">
Set g = new LazyDictionaryClass<BR/>
Assert&nbsp; g("${USERPROFILE}\Desktop") = "C:\Users\user1\Desktop"</DIV>
<DIV id="text230_64" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:24px; margin-top:810px; line-height:15px; white-space:nowrap">
OSの環境変数を参照することもできます。</DIV>
<DIV id="text230_65" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:1430px; line-height:15px; white-space:nowrap">
<A href="vbslib_37.html#new_PathDictionaryClass_fromXML_Tag">
→ FF-path 属性対応の XML、path 属性と、Except タグ</A></DIV>
<DIV id="text230_66" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5258px; line-height:15px; white-space:nowrap">
<A name="DictionaryEx_Formula">
遅延評価する前の値や式の参照</A></DIV>
<DIV id="text230_67" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1210px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_Formula">
→ 遅延評価する前の値や式の参照</A></DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:5316px; width:346px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_68" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:5322px; line-height:15px; white-space:nowrap">
g("${RootPath}") = "C:\Folder${Target}"<BR/>
g("${Target}") = "A"<BR/>
<BR/>
Assert&nbsp; g.Formula("${RootPath}") = "C:\Folder${Target}"<BR/>
Assert&nbsp; g("${RootPath}") = "C:\FolderA"</DIV>
<DIV id="text230_69" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:5292px; line-height:15px; white-space:nowrap">
遅延評価する前の値を参照するには、Formula プロパティを使います。</DIV>
<DIV id="text230_70" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:5090px; line-height:15px; white-space:nowrap">
<A name="DictionaryEx_AddDictionary">
２つの辞書を加算する (AddDictionary)</A></DIV>
<DIV id="text230_71" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:48px; margin-top:5187px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text230_72" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1190px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_AddDictionary">
→ ２つの辞書を加算する</A></DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:5117px; width:202px; height:55px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_73" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:5123px; line-height:15px; white-space:nowrap">
Set a = new LazyDictionaryClass<BR/>
Set b = new LazyDictionaryClass<BR/>
a.AddDictionary&nbsp; b</DIV>
<DIV id="text230_74" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:91px; margin-top:5187px; line-height:15px; white-space:nowrap">
<A href="vbslib_16.html#Dic_add">
→ Dic_add</A></DIV>
<DIV id="text230_75" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:6455px; line-height:15px; white-space:nowrap">
<A name="DictionaryEx_Reverse">
値から変数に戻す (EvaluateReverse, GetStepPath)</A></DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:6481px; width:400px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_76" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:6487px; line-height:15px; white-space:nowrap">
Set g = new LazyDictionaryClass<BR/>
g("${A}") = "AAA"<BR/>
g("${B}") = "BB"<BR/>
Assert&nbsp; g.EvaluateReverse( "1AAA2BB3AAA4" ) = "1${A}2${B}3${A}4"</DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:6575px; width:286px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_77" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:6581px; line-height:15px; white-space:nowrap">
Set g = new LazyDictionaryClass<BR/>
g("${A3}") = "AAA"<BR/>
g("${A4}") = "AAAA"<BR/>
g("${A2}") = "AA"<BR/>
Assert&nbsp; g.EvaluateReverse( "AAAA" ) = "${A4}"</DIV>
<DIV id="text230_78" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:77px; margin-top:6668px; line-height:15px; white-space:nowrap">
値の文字列の長さが長い変数に優先的に変換されます。</DIV>
<DIV id="text230_79" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:48px; margin-top:7176px; line-height:15px; white-space:nowrap">
逆に、変数でない ${ を含む文字列を、${ 〜 } 変数を変換しようとする文字列に入れる場合は、<BR/>
次の変換をします。</DIV>
<v:rect style="position:absolute; margin-left:79px; margin-top:7217px; width:370px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_80" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:87px; margin-top:7223px; line-height:15px; white-space:nowrap">
'// "$\" =&gt; "$\\", "${" =&gt; "$\{"<BR/>
text = Replace( Replace( text, "$\", "$\\" ), "${", "$\{" )<BR/>
Set g = new LazyDictionaryClass<BR/>
echo&nbsp; g(text)</DIV>
<DIV id="text230_81" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:48px; margin-top:7303px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text230_82" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:93px; margin-top:7303px; line-height:15px; white-space:nowrap">
<A href="vbslib_29.html#GrepKeyword">
→ GrepKeyword</A></DIV>
<DIV id="text230_83" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1230px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_Reverse">
→ 値から変数に戻す</A></DIV>
<DIV id="text230_84" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:137px; margin-top:6533px; line-height:13px; white-space:nowrap">
EvaluateReverse</DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:6704px; width:502px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_85" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:6710px; line-height:15px; white-space:nowrap">
Set g = new LazyDictionaryClass<BR/>
g("${XA}") = "X:\FolderA"<BR/>
g("${Extension}") = ".txt"<BR/>
Assert&nbsp; g.GetStepPath( "X:\FolderA\File.xml", "X:\" ) = "${XA}\File.xml"<BR/>
Assert&nbsp; g.GetStepPath( "C:\FolderA\File.xml", "C:\FolderA" ) = "File.xml"<BR/>
Assert&nbsp; g.GetStepPath( "C:\FolderA\File.txt", "C:\FolderA" ) = "File${Extension}"</DIV>
<DIV id="text230_86" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:137px; margin-top:6756px; line-height:13px; white-space:nowrap">
GetStepPath</DIV>
<DIV id="text230_87" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:77px; margin-top:6809px; line-height:15px; white-space:nowrap">
GetStepPath メソッドでは、フル パスが格納された変数に戻らなかったときだけ、<BR/>
指定した基準パスからの相対パスに変換されます。</DIV>
<DIV id="text230_88" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:7551px; line-height:15px; white-space:nowrap">
${&gt; } 形式の記述は、次の関数でも使われています。</DIV>
<DIV id="text230_89" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:81px; margin-top:7576px; line-height:15px; white-space:nowrap">
<A href="vbslib_60.html#GetPercentURL">
→ GetPercentURL</A></DIV>
<DIV id="text230_90" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:81px; margin-top:7594px; line-height:15px; white-space:nowrap">
<A href="vbslib_36.html#GetTagJumpParams">
→ GetTagJumpParams</A></DIV>
<DIV id="text230_91" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:236px; margin-top:7576px; line-height:15px; white-space:nowrap">
特殊な URL 予約文字をエスケープしない</DIV>
<DIV id="text230_92" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:236px; margin-top:7594px; line-height:15px; white-space:nowrap">
${&gt;#} で、# をファイル名の一部にする</DIV>
<DIV id="text230_93" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:44px; margin-top:7631px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text230_94" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:91px; margin-top:7631px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_Escape">
→ 参照記号 ${ } のエスケープ</A></DIV>
<DIV id="text230_95" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:1498px; line-height:15px; white-space:nowrap">
<A href="http://www.koikikukan.com/archives/2011/09/27-015555.php" target="_blank">
→ PHPやPerlで変数の記号に「$」が使われる理由 - 小粋空間 (Web)</A></DIV>
<DIV id="text230_96" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:1515px; line-height:15px; white-space:nowrap">
<A href="https://en.wikipedia.org/wiki/Dollar_sign#Programming_languages" target="_blank">
→ Dollar sign &gt;&gt; Programming languages - Wikipedia (Web)</A></DIV>
<DIV id="text230_97" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:77px; margin-top:6859px; line-height:15px; white-space:nowrap">
ちなみに、戻した変数を一覧するときは、指定する</DIV>
<DIV id="text230_98" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:363px; margin-top:6859px; line-height:15px; white-space:nowrap">
正規表現</DIV>
<DIV id="text230_99" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:425px; margin-top:6859px; line-height:15px; white-space:nowrap">
を、</DIV>
<v:rect style="position:absolute; margin-left:446px; margin-top:6858px; width:64px; height:17px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_100" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:454px; margin-top:6861px; line-height:13px; white-space:nowrap">
\$\{.*\}</DIV>
<DIV id="text230_101" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:518px; margin-top:6859px; line-height:15px; white-space:nowrap">
ではなく、</DIV>
<v:rect style="position:absolute; margin-left:78px; margin-top:6878px; width:88px; height:17px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_102" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:86px; margin-top:6881px; line-height:13px; white-space:nowrap">
\$\{[^\}]*\}</DIV>
<DIV id="text230_103" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:173px; margin-top:6879px; line-height:15px; white-space:nowrap">
にします。 複数の変数があるときでも正しく処理するようになります。</DIV>
<DIV id="text230_104" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1310px; line-height:15px; white-space:nowrap">
<A href="vbslib_15.html#new_LazyDictionaryClass">
→ new_LazyDictionaryClass</A></DIV>
<DIV id="text230_105" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1330px; line-height:15px; white-space:nowrap">
<A href="vbslib_15.html#GetPathLazyDictionary">
→ GetPathLazyDictionary</A></DIV>
<DIV id="text230_106" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1350px; line-height:15px; white-space:nowrap">
<A href="vbslib_15.html#ParseDollarVariableString">
→ ParseDollarVariableString</A></DIV>
<DIV id="text230_107" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:224px; margin-top:1310px; line-height:15px; white-space:nowrap">
XML の Variable タグを変数にした辞書を返します</DIV>
<DIV id="text230_108" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:224px; margin-top:1330px; line-height:15px; white-space:nowrap">
パスに関する変数か定義された辞書を返します</DIV>
<DIV id="text230_109" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:224px; margin-top:1350px; line-height:15px; white-space:nowrap">
${ } を使った式を解析します</DIV>
<DIV id="text230_110" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:77px; margin-top:6900px; line-height:15px; white-space:nowrap">
<A href="vbslib_15.html#ParseDollarVariableString">
ParseDollarVariableString</A></DIV>
<DIV id="text230_111" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:221px; margin-top:6900px; line-height:15px; white-space:nowrap">
でも変数を一覧することができます。</DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:5446px; width:358px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_112" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:5452px; line-height:15px; white-space:nowrap">
g("${RootPath}") = "C:\Folder\A"<BR/>
g("${Target}") = "A"<BR/>
<BR/>
Assert&nbsp; g.Formula("${RootPath}") =&nbsp; "C:\Folder\A"<BR/>
Assert&nbsp; g.Formula("${RootPath}") &lt;&gt; "C:\Folder\${Target}"</DIV>
<DIV id="text230_113" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:151px; margin-top:5425px; line-height:15px; white-space:nowrap">
と異なり、変数の値に一致しても、変数に戻ることはありません。</DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:5618px; width:460px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_114" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:5625px; line-height:13px; white-space:nowrap">
&lt;Variable&nbsp; name="${FullPath1}"&nbsp; value="..\File.txt"&nbsp; type="FullPathType"/&gt;</DIV>
<DIV id="text230_115" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:5558px; line-height:15px; white-space:nowrap">
XML の Variable タグの type 属性は、Type_ プロパティで参照できます。</DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:5932px; width:526px; height:475px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_116" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:5938px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; path = t("C:\Folder")+"\Sub\Setting.xml"<BR/>
&nbsp; &nbsp; base_path = GetParentFullPath( path )<BR/>
&nbsp; &nbsp; Set root = LoadXML( path, Empty )<BR/>
<BR/>
&nbsp; &nbsp; Set g = LoadVariableInXML( root, path )<BR/>
<BR/>
&nbsp; &nbsp; Assert&nbsp; g.Formula("${FullPath1}") = t("C:\Folder")+"\ABC"<BR/>
&nbsp; &nbsp; Assert&nbsp; g.Formula("${StepPath}")&nbsp; = "..\ABC"<BR/>
&nbsp; &nbsp; Assert&nbsp; g.Formula("${ABC}")&nbsp; &nbsp; &nbsp; &nbsp;= "ABC"<BR/>
&nbsp; &nbsp; Assert&nbsp; g.Formula("${FullPath2}") = "${FullPath1}\File.txt"<BR/>
&nbsp; &nbsp; Assert&nbsp; g.Formula("${FullPath3}") = t("C:\Folder")+"\Sub\${StepPath}\File.txt"<BR/>
<BR/>
&nbsp; &nbsp; Set file = OpenForWrite( "_out.xml",&nbsp; g_VBS_Lib.UTF_8 )<BR/>
&nbsp; &nbsp; file.WriteLine&nbsp; "&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;"<BR/>
&nbsp; &nbsp; file.WriteLine&nbsp; "&lt;Root&gt;"<BR/>
&nbsp; &nbsp; file.WriteLine&nbsp; ""<BR/>
<BR/>
&nbsp; &nbsp; For Each&nbsp; variable_name&nbsp; In&nbsp; Array( _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "${FullPath1}", "${StepPath}", "${ABC}", "${FullPath2}", "${FullPath3}" )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; If not IsFullPath( g.Formula( variable_name ) ) Then<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.WriteLine&nbsp; "&lt;Variable&nbsp; name="""+ variable_name +"""&nbsp; value="""+ _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g.Formula( variable_name ) +"""/&gt;"<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Else<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file.WriteLine&nbsp; "&lt;Variable&nbsp; name="""+ variable_name +"""&nbsp; value="""+ _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GetStepPath( g.Formula( variable_name ),&nbsp; base_path ) + _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; """&nbsp; type=""FullPathType""/&gt;"<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; End If<BR/>
&nbsp; &nbsp; Next<BR/>
&nbsp; &nbsp; file.WriteLine&nbsp; ""<BR/>
&nbsp; &nbsp; file.WriteLine&nbsp; "&lt;/Root&gt;"<BR/>
&nbsp; &nbsp; file = Empty</DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:5651px; width:502px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_117" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:5657px; line-height:15px; white-space:nowrap">
file.WriteLine&nbsp; "&lt;Variable&nbsp; name=""${FullPath1}""&nbsp; value="""+ _<BR/>
&nbsp; &nbsp; g.Formula( "${FullPath1}" ) +"""&nbsp; type="""+ g.Type_( "${FullPath1}" ) +"""/&gt;"</DIV>
<DIV id="text230_118" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:45px; margin-top:5732px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text230_119" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:245px; margin-top:6314px; line-height:13px; white-space:nowrap">
FullPathType</DIV>
<v:rect style="position:absolute; margin-left:69px; margin-top:5753px; width:514px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_120" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:77px; margin-top:5759px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;<BR/>
&lt;Root&gt;<BR/>
<BR/>
&lt;Variable&nbsp; name="${FullPath1}"&nbsp; value="..\ABC"&nbsp; type="FullPathType"/&gt;<BR/>
&lt;Variable&nbsp; name="${StepPath}"&nbsp; value="..\ABC"/&gt;<BR/>
&lt;Variable&nbsp; name="${ABC}"&nbsp; value="ABC"/&gt;<BR/>
&lt;Variable&nbsp; name="${FullPath2}"&nbsp; value="${FullPath1}\File.txt"/&gt;<BR/>
&lt;Variable&nbsp; name="${FullPath3}"&nbsp; value="${StepPath}\File.txt"&nbsp; type="FullPathType"/&gt;<BR/>
<BR/>
&lt;/Root&gt;</DIV>
<DIV id="text230_121" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:45px; margin-top:5590px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text230_122" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:149px; margin-top:5999px; line-height:13px; white-space:nowrap">
<A href="#LoadVariableInXML">
LoadVariableInXML</A></DIV>
<DIV id="text230_123" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:50px; margin-top:3025px; line-height:15px; white-space:nowrap">
<A name="LazyDictionaryClass_GetFullPath">
GetFullPath メソッド</A></DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:3047px; width:460px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_124" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:3053px; line-height:15px; white-space:nowrap">
g("${F1}") = "C:\Folder1"<BR/>
g("${F2}") = "C:\Folder2"<BR/>
Assert&nbsp; g.GetFullPath( "File.txt", "C:\Folder1" ) = "C:\Folder1\File.txt"<BR/>
Assert&nbsp; g.GetFullPath( "File.txt", "${F1}" ) = "C:\Folder1\File.txt"<BR/>
Assert&nbsp; g.GetFullPath( "${F2}\File.txt", "${F1}" ) = "C:\Folder2\File.txt"<BR/>
Assert&nbsp; g.GetFullPath( "File.txt", "${No}" )&nbsp; '// Error</DIV>
<DIV id="text230_125" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1150px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_Range">
→ 数列、CSV 形式、ToCSV</A></DIV>
<DIV id="text230_126" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:3824px; line-height:15px; white-space:nowrap">
<A name="DictionaryEx_Range">
数列、CSV 形式、ToCSV</A></DIV>
<DIV id="text230_127" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:48px; margin-top:4052px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text230_128" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:86px; margin-top:4052px; line-height:15px; white-space:nowrap">
→ Python - 数列 （range クラス）</DIV>
<v:rect style="position:absolute; margin-left:63px; margin-top:3851px; width:436px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_129" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:71px; margin-top:3857px; line-height:15px; white-space:nowrap">
Assert&nbsp; g("${ToCSV( %d, 1, 3 )}") = "1, 2, 3"<BR/>
Assert&nbsp; g("${ToCSV( %d, 2, 5 )}") = "2, 3, 4, 5"<BR/>
Assert&nbsp; g("${ToCSV( %d, 2, 5 )}") = "5, 4, 3, 2"<BR/>
Assert&nbsp; g("${ToCSV( %02d, 1, 3 )}") = "01, 02, 03"<BR/>
<BR/>
g("${N}") = "Num"<BR/>
Assert&nbsp; g("${ToCSV( ${N} = %d, 1, 3 )}") = "Num = 1, Num = 2, Num = 3"<BR/>
Assert&nbsp; g("${N} = ${ToCSV( %d, 1, 3 )}") = "Num = 1, 2, 3"</DIV>
<DIV id="text230_130" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:93px; margin-top:4071px; line-height:15px; white-space:nowrap">
→ T_LazyDictionary.vbs</DIV>
<DIV id="text230_131" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:252px; margin-top:4071px; line-height:15px; white-space:nowrap">
T_LazyDictionaryCSV</DIV>
<DIV id="text230_132" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:48px; margin-top:4071px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text230_133" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:3992px; line-height:15px; white-space:nowrap">
( ) の中のパラメーターは、</DIV>
<DIV id="text230_134" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:322px; margin-top:3992px; line-height:15px; white-space:nowrap">
、開始の値、最後の値です。</DIV>
<DIV id="text230_135" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:205px; margin-top:3992px; line-height:15px; white-space:nowrap">
<A href="vbslib_20.html#sprintf">
C言語の printf 書式</A></DIV>
<DIV id="text230_136" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:4022px; line-height:15px; white-space:nowrap">
C言語の printf 書式の中に、${ } 変数を記述できます。</DIV>
<DIV id="text230_137" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:55px; margin-top:4007px; line-height:15px; white-space:nowrap">
( ) の中のパラメーターは、CSV としてパースされるので、" "で囲むこともできます。</DIV>
<DIV id="text230_138" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:30px; margin-top:1170px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_Call">
→ 関数を呼び出す</A></DIV>
<DIV id="text230_139" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:4135px; line-height:15px; white-space:nowrap">
<A name="DictionaryEx_Call">
関数を呼び出す</A></DIV>
<v:rect style="position:absolute; margin-left:63px; margin-top:4676px; width:454px; height:370px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_140" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:71px; margin-top:4682px; line-height:15px; white-space:nowrap">
Sub&nbsp; Main()<BR/>
&nbsp; &nbsp; Set g = new LazyDictionaryClass<BR/>
<BR/>
&nbsp; &nbsp; Set g("${GetObject()}") = GetRef( "My_GetObject" )<BR/>
&nbsp; &nbsp; Set object = g("${GetObject( a,b )}")<BR/>
&nbsp; &nbsp; Assert&nbsp; object.Name = " a,b "<BR/>
<BR/>
&nbsp; &nbsp; Set g("${UpperCase()}") = GetRef( "My_UpperCase" )<BR/>
&nbsp; &nbsp; g.Delegate = "UserDefined"<BR/>
&nbsp; &nbsp; Assert&nbsp; g("before&nbsp; ${Upper( a,b )}&nbsp; after") = _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; "before&nbsp; ( A,B )&nbsp; after"<BR/>
End Sub<BR/>
<BR/>
Function&nbsp; My_GetObject( ref_Dictionary,&nbsp; in_FunctionName,&nbsp; in_Parameter )<BR/>
&nbsp; &nbsp; Set&nbsp; object = new NameOnlyClass<BR/>
&nbsp; &nbsp; object.Name = in_Parameter<BR/>
&nbsp; &nbsp; Set My_GetObject = object<BR/>
End Function<BR/>
<BR/>
Function&nbsp; My_UpperCase( ref_Dictionary,&nbsp; in_FunctionName,&nbsp; in_Parameter )<BR/>
&nbsp; &nbsp; Assert&nbsp; in_FunctionName = "${My_UpperCase()}"<BR/>
&nbsp; &nbsp; Assert&nbsp; ref_Dictionary.Delegate = "UserDefined"<BR/>
&nbsp; &nbsp; My_GetObject = "("+ UCase( in_Parameter ) +")"<BR/>
End Function</DIV>
<v:rect style="position:absolute; margin-left:63px; margin-top:4384px; width:448px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_141" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:71px; margin-top:4390px; line-height:15px; white-space:nowrap">
Function&nbsp; LazyDictionaryFunction( ref_Dictionary as LazyDictionaryClass,<BR/>
&nbsp; &nbsp; in_FunctionName as string,&nbsp; in_Parameter as string ) as Variant</DIV>
<DIV id="text230_142" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:4360px; line-height:15px; white-space:nowrap">
関数は下記の型である必要があります。</DIV>
<DIV id="text230_143" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:4436px; line-height:15px; white-space:nowrap">
LazyDictionaryClass で ${Function( parameters )} 形式を指定したときに呼び出す関数の型。</DIV>
<DIV id="text230_144" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:4462px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text230_145" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:138px; margin-top:4462px; line-height:15px; white-space:nowrap">
ref_Dictionary</DIV>
<DIV id="text230_146" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:138px; margin-top:4500px; line-height:15px; white-space:nowrap">
in_Parameter</DIV>
<DIV id="text230_147" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:248px; margin-top:4462px; line-height:15px; white-space:nowrap">
LazyDictionaryClass のオブジェクト</DIV>
<DIV id="text230_148" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:248px; margin-top:4500px; line-height:15px; white-space:nowrap">
括弧の中のすべてのパラメーター</DIV>
<v:rect style="position:absolute; margin-left:63px; margin-top:4314px; width:298px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_149" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:71px; margin-top:4321px; line-height:13px; white-space:nowrap">
Set g("${UpperCase()}") = GetRef( "UpperCase" )</DIV>
<DIV id="text230_150" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:4291px; line-height:15px; white-space:nowrap">
コールバックする関数を設定するには、次のように記述します。</DIV>
<DIV id="text230_151" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:56px; margin-top:4654px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text230_152" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:4163px; line-height:15px; white-space:nowrap">
${Function( parameters )} 形式を指定すると、アプリケーションが定義した関数を呼び出す、<BR/>
または、VBScript で定義した関数をコールバックさせることができます。 </DIV>
<v:rect style="position:absolute; margin-left:63px; margin-top:4244px; width:316px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text230_153" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:71px; margin-top:4251px; line-height:13px; white-space:nowrap">
Assert&nbsp; g("${UpperCase( abc, def )}") = "ABC, DEF"</DIV>
<DIV id="text230_154" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:56px; margin-top:4206px; line-height:15px; white-space:nowrap">
UpperCase 関数をパラメーター abc, def で呼び出し、ABC, DEF が返されたことをチェックする<BR/>
には、次のように記述します。</DIV>
<DIV id="text230_155" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:4551px; line-height:15px; white-space:nowrap">
in_Parameter の中にあるそれぞれのパラメーターを取得するときは、</DIV>
<DIV id="text230_156" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:454px; margin-top:4551px; line-height:15px; white-space:nowrap">
<A href="vbslib_45.html#ArrayFromCSV">
ArrayFromCSV</A></DIV>
<DIV id="text230_157" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:4568px; line-height:15px; white-space:nowrap">
などを使ってください。</DIV>
<DIV id="text230_158" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:131px; margin-top:4391px; line-height:13px; white-space:nowrap">
<A name="LazyDictionaryFunction">
LazyDictionaryFunction</A></DIV>
<DIV id="text230_159" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:248px; margin-top:4519px; line-height:15px; white-space:nowrap">
${Function( parameters )} を置き換えた後の値</DIV>
<DIV id="text230_160" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:138px; margin-top:4519px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text230_161" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:138px; margin-top:4481px; line-height:15px; white-space:nowrap">
in_FunctionName</DIV>
<DIV id="text230_162" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:248px; margin-top:4481px; line-height:15px; white-space:nowrap">
関数名。 例："${FunctionName()}"</DIV>
<DIV id="text230_163" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:4595px; line-height:15px; white-space:nowrap">
ref_Dictionary の Delegate メンバー変数は、LazyDictionaryClass オブジェクトを生成<BR/>
したユーザーが設定して、コールバック関数で参照することができます。 </DIV>
<DIV id="text230_164" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:137px; margin-top:5368px; line-height:13px; white-space:nowrap">
<A name="LazyDictionaryClass_Formula">
Formula</A></DIV>
<DIV id="text230_165" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:51px; margin-top:5425px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_Reverse">
EvaluateReverse</A></DIV>
<DIV id="text230_166" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:377px; margin-top:5673px; line-height:13px; white-space:nowrap">
Type_</DIV>
<DIV id="text230_167" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:395px; margin-top:5625px; line-height:13px; white-space:nowrap">
type</DIV>
<DIV id="text230_168" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:55px; margin-top:3160px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text230_169" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:88px; margin-top:3160px; line-height:15px; white-space:nowrap">
<A href="vbslib_34.html#GetFullPath">
→ GetFullPath</A></DIV>
<DIV id="text230_170" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:163px; margin-top:3025px; line-height:15px; white-space:nowrap">
は、変数の値を参照し、フル パスを返します。</DIV>
<DIV id="text230_171" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:47px; margin-top:1939px; line-height:15px; white-space:nowrap">
ただし、スクリプトの中の LazyDictionaryClass のオブジェクト（下記の g）の特定が必要です。</DIV>

<v:line from="0,618" to="642,618"/>
<v:line from="642,618" to="642,7891"/>
<v:line from="642,7891" to="0,7891"/>
<v:line from="0,7891" to="0,618"/>

</PAGE>
 
<!-- page 231 --> 
<PAGE>
<A id="svgcats_vml_p231" class="to_tree" style="margin-top:7896px;" onClick="selectTreeElem( '231' );">←</A>
<A href="vbslib_15.html#svgcats_vml_p232" class="to_next_page" style="margin-top:7896px;">▼</A>
<A href="#svgcats_vml_p230" class="to_prev_page" style="margin-top:7896px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:7907px; width:655px; height:2594px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:224px; margin-top:8609px; width:256px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:232px; margin-top:8615px; line-height:15px; white-space:nowrap">
&lt;Variable&nbsp; name="${Var1}"&nbsp; value="ABC"/&gt;<BR/>
&lt;Project&nbsp; path="C:\${Var1}.txt"/&gt;</DIV>
<DIV id="text231_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:7924px; line-height:15px; white-space:nowrap">
<A name="LoadVariableInXML">
LoadVariableInXML</A></DIV>
<v:rect style="position:absolute; margin-left:62px; margin-top:8834px; width:382px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:70px; margin-top:8840px; line-height:15px; white-space:nowrap">
Set root = LoadXML( "Sample.xml", Empty )<BR/>
Set variables = LoadVariableInXML( root, "Sample.xml" )<BR/>
data = root.selectSingleNode( "Data" ).getAttribute( "data" )<BR/>
&nbsp; &nbsp; Assert&nbsp; data ="${Var1}DEF"<BR/>
data = variables( data )<BR/>
&nbsp; &nbsp; Assert&nbsp; data = "ABCDEF"</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:7954px; width:598px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:7960px; line-height:15px; white-space:nowrap">
Function&nbsp; LoadVariableInXML( in_RootXML_Element as IXMLDOMElement,&nbsp; in_FilePathOfXML&nbsp; as string )<BR/>
&nbsp; &nbsp; as LazyDictionaryClass</DIV>
<DIV id="text231_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8006px; line-height:15px; white-space:nowrap">
XML の</DIV>
<DIV id="text231_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8032px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text231_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:86px; margin-top:8032px; line-height:15px; white-space:nowrap">
in_RootXML_Element</DIV>
<DIV id="text231_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:86px; margin-top:8051px; line-height:15px; white-space:nowrap">
in_FilePathOfXML</DIV>
<DIV id="text231_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:8051px; line-height:15px; white-space:nowrap">
in_RootXML_Element が書かれている XML ファイルのパス</DIV>
<DIV id="text231_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8784px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text231_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:8953px; line-height:15px; white-space:nowrap">
Sample.xml</DIV>
<DIV id="text231_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:8812px; line-height:15px; white-space:nowrap">
スクリプト：</DIV>
<v:rect style="position:absolute; margin-left:62px; margin-top:8973px; width:256px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:70px; margin-top:8979px; line-height:15px; white-space:nowrap">
&lt;Sample&gt;<BR/>
&lt;Variable&nbsp; name="${Var1}"&nbsp; value="ABC"/&gt;<BR/>
&lt;Variable&nbsp; name="${Var2}"&nbsp; value="XYZ"/&gt;<BR/>
&lt;Data&nbsp; data="${Var1}DEF"/&gt;<BR/>
&lt;/Sample&gt;</DIV>
<DIV id="text231_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:94px; margin-top:8856px; line-height:13px; white-space:nowrap">
variables</DIV>
<v:rect style="position:absolute; margin-left:188px; margin-top:8368px; width:256px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:196px; margin-top:8375px; line-height:13px; white-space:nowrap">
&lt;Variable&nbsp; name="${Var1}"&nbsp; value="ABC"/&gt;</DIV>
<DIV id="text231_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10411px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text231_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:75px; margin-top:10372px; line-height:15px; white-space:nowrap">
→ vbslib.vbs</DIV>
<DIV id="text231_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10372px; line-height:15px; white-space:nowrap">
ソース</DIV>
<DIV id="text231_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:75px; margin-top:10411px; line-height:15px; white-space:nowrap">
→ T_LazyDictionary.vbs</DIV>
<DIV id="text231_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:348px; margin-top:8070px; line-height:15px; white-space:nowrap">
<A href="#LazyDictionaryClass">
→ LazyDictionaryClass</A></DIV>
<DIV id="text231_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:112px; margin-top:8901px; line-height:13px; white-space:nowrap">
variables</DIV>
<DIV id="text231_22" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:78px; margin-top:8373px; line-height:15px; white-space:nowrap">
変数の定義の例：</DIV>
<DIV id="text231_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:226px; margin-top:10411px; line-height:15px; white-space:nowrap">
T_LazyDictionaryXML</DIV>
<DIV id="text231_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:8245px; line-height:15px; white-space:nowrap">
<A name="VariableTag">
Variable タグ</A></DIV>
<DIV id="text231_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:196px; margin-top:8400px; line-height:15px; white-space:nowrap">
変数名は ${Var1} で、その値は ABC です。</DIV>
<DIV id="text231_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:8137px; line-height:15px; white-space:nowrap">
変数を参照するときは、DOM API で値を取得した後で、評価（変数の展開を）する処理を書く<BR/>
必要があります。（下記サンプル コードを参照）</DIV>
<DIV id="text231_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:9136px; line-height:15px; white-space:nowrap">
type 属性を "FullPathType" にすると、value 属性を相対パスとして、変数を参照したときは<BR/>
フル・パスが返ります。 通常、基準フォルダーは XML ファイルがあるフォルダーです。</DIV>
<DIV id="text231_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:27px; margin-top:9105px; line-height:15px; white-space:nowrap">
<A name="Variable_FullPathType">
type 属性 "FullPathType" （Variable タグ）</A></DIV>
<v:rect style="position:absolute; margin-left:92px; margin-top:9528px; width:484px; height:100px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_29" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:100px; margin-top:9534px; line-height:15px; white-space:nowrap">
&lt;Sample&gt;<BR/>
&lt;Variable&nbsp; name="${FullPath1}"&nbsp; value="..\File.txt"&nbsp; type="FullPathType"/&gt;<BR/>
&lt;Variable&nbsp; name="${FullPath2}"&nbsp; value="${FullPath1}"/&gt;<BR/>
&lt;Variable&nbsp; name="${ErrorPath}"&nbsp; value="${FullPath1}"&nbsp; type="FullPathType"/&gt;<BR/>
&lt;Variable&nbsp; name="${SearchParent}"&nbsp; value="...\File.txt"&nbsp; type="FullPathType"/&gt;<BR/>
&lt;/Sample&gt;</DIV>
<DIV id="text231_30" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:9648px; line-height:15px; white-space:nowrap">
スクリプト：</DIV>
<DIV id="text231_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:72px; margin-top:9508px; line-height:15px; white-space:nowrap">
Sample.xml</DIV>
<v:rect style="position:absolute; margin-left:92px; margin-top:9670px; width:502px; height:205px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:100px; margin-top:9676px; line-height:15px; white-space:nowrap">
&nbsp; &nbsp; Set xml = new FilePathClass<BR/>
&nbsp; &nbsp; xml.FilePath = "Sample.xml"<BR/>
&nbsp; &nbsp; Set xml.Text = LoadXML( xml.FilePath, Empty )<BR/>
&nbsp; &nbsp; Set variables = new_LazyDictionaryClass( xml )<BR/>
<BR/>
&nbsp; &nbsp; base_path = GetParentFullPath( xml.FilePath )<BR/>
&nbsp; &nbsp; Assert&nbsp; variables( "${FullPath1}" ) = GetFullPath( "..\File.txt", base_path )<BR/>
&nbsp; &nbsp; Assert&nbsp; variables( "${FullPath2}" ) = GetFullPath( "..\File.txt", base_path )<BR/>
<BR/>
&nbsp; &nbsp; Assert&nbsp; variables( "${ErrorPath}" ) = _<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; base_path +"\"+ GetFullPath( "..\File.txt", base_path )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; '// Example: "C:\Folder\Sub\C:\Folder\File.txt"<BR/>
&nbsp; &nbsp; Assert&nbsp; variables.Formula( "${ErrorPath}" ) = "C:\Folder\Sub\${ErrorPath}"</DIV>
<DIV id="text231_33" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:54px; margin-top:9482px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text231_34" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:244px; margin-top:9767px; line-height:13px; white-space:nowrap">
${FullPath1}</DIV>
<DIV id="text231_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#800000; margin-left:54px; margin-top:9182px; line-height:15px; white-space:nowrap">
XML に記述する value 属性は、相対パスを指定してください。 value 属性がフル パスの値を<BR/>
持つ変数から始まるときは、type 属性に "FullPathType" を指定しないでください。</DIV>
<DIV id="text231_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:9350px; line-height:15px; white-space:nowrap">
フル・パスに変換するタイミングは、new_LazyDictionaryClass 関数を呼び出したときで、<BR/>
遅延評価ではありません。 </DIV>
<DIV id="text231_37" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:298px; margin-top:8375px; line-height:13px; white-space:nowrap">
${Var1}</DIV>
<DIV id="text231_38" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:342px; margin-top:8181px; line-height:15px; white-space:nowrap">
<A href="vbslib_16.html#Dic_add">
Dic_add</A></DIV>
<DIV id="text231_39" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:8181px; line-height:15px; white-space:nowrap">
２つの辞書を合成するときは、</DIV>
<DIV id="text231_40" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:392px; margin-top:8181px; line-height:15px; white-space:nowrap">
を呼び出してください。</DIV>
<DIV id="text231_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:8032px; line-height:15px; white-space:nowrap">
XML のルート要素オブジェクト、または、FilePathClass のオブジェクト</DIV>
<DIV id="text231_42" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:9274px; line-height:15px; white-space:nowrap">
new_LazyDictionaryClass 関数の引数に FilePathClass のオブジェクトを指定すると、<BR/>
FilePathClass::FilePath の親フォルダーを基準にします。 引数に文字列を指定した場合は、<BR/>
相対パスの基準はカレント・フォルダーになります。 XML のルート要素オブジェクトは、<BR/>
FilePathClass::Text に指定してください。</DIV>
<DIV id="text231_43" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:44px; margin-top:8475px; line-height:15px; white-space:nowrap">
<A href="#Variable_FullPathType">
type 属性を FullPathType</A></DIV>
<DIV id="text231_44" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:195px; margin-top:8475px; line-height:15px; white-space:nowrap">
に設定すると、値をフル パスにすることができます。</DIV>
<DIV id="text231_45" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:9228px; line-height:15px; white-space:nowrap">
value 属性を、ピリオド 3つから始めると、内部で</DIV>
<DIV id="text231_46" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:326px; margin-top:9228px; line-height:15px; white-space:nowrap">
<A href="vbslib_35.html#SearchParent">
SearchParent</A></DIV>
<DIV id="text231_47" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:408px; margin-top:9228px; line-height:15px; white-space:nowrap">
を呼び出して、親フォルダー</DIV>
<DIV id="text231_48" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:9243px; line-height:15px; white-space:nowrap">
を探しにいきます。</DIV>
<v:rect style="position:absolute; margin-left:92px; margin-top:9429px; width:460px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_49" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:100px; margin-top:9436px; line-height:13px; white-space:nowrap">
&lt;Variable&nbsp; name="${FullPath1}"&nbsp; value="..\File.txt"&nbsp; type="FullPathType"/&gt;</DIV>
<DIV id="text231_50" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:418px; margin-top:9436px; line-height:13px; white-space:nowrap">
type="FullPathType"</DIV>
<DIV id="text231_51" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:54px; margin-top:9406px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text231_52" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:86px; margin-top:8070px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text231_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:8070px; line-height:15px; white-space:nowrap">
遅延評価する辞書</DIV>
<DIV id="text231_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:8492px; line-height:15px; white-space:nowrap">
値に</DIV>
<DIV id="text231_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:70px; margin-top:8492px; line-height:15px; white-space:nowrap">
<A href="#Variable_Env">
OS の環境変数を指定する</A></DIV>
<DIV id="text231_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:222px; margin-top:8492px; line-height:15px; white-space:nowrap">
ことができます。</DIV>
<DIV id="text231_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9918px; line-height:15px; white-space:nowrap">
<A name="Variable_Env">
OS の環境変数を指定する</A></DIV>
<v:rect style="position:absolute; margin-left:75px; margin-top:10034px; width:370px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_58" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:83px; margin-top:10041px; line-height:13px; white-space:nowrap">
&lt;Variable&nbsp; name="${A}"&nbsp; value="${USERPROFILE}\Document\A"/&gt;</DIV>
<DIV id="text231_59" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:54px; margin-top:10009px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text231_60" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:77px; margin-top:10100px; line-height:15px; white-space:nowrap">
USERPROFILE は、OS の環境変数の名前です。</DIV>
<v:rect style="position:absolute; margin-left:75px; margin-top:10067px; width:388px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_61" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:83px; margin-top:10074px; line-height:13px; white-space:nowrap">
&lt;Variable&nbsp; name="${Desktop}"&nbsp; value="${USERPROFILE}\Desktop"/&gt;</DIV>
<DIV id="text231_62" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:10433px; line-height:15px; white-space:nowrap">
<A href="vbslib_15.html#LoadLocalVariableInXML">
→ LoadLocalVariableInXML</A></DIV>
<DIV id="text231_63" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10433px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text231_64" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:8274px; line-height:15px; white-space:nowrap">
Variable タグに対応した XML ファイルには、${ } 形式の変数の定義と、変数の参照を記述する<BR/>
ことができます。 </DIV>
<DIV id="text231_65" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:171px; margin-top:8121px; line-height:15px; white-space:nowrap">
<A href="#LoadVariableInXML">
LoadVariableInXML 関数</A></DIV>
<DIV id="text231_66" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:311px; margin-top:8121px; line-height:15px; white-space:nowrap">
で、Variable タグによる変数定義をロードします。</DIV>
<DIV id="text231_67" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:8543px; line-height:15px; white-space:nowrap">
変数の参照を記述できる場所は、XML ファイルの種類やアプリケーションによって異なります。 <BR/>
それぞれの仕様を確認してください。 たとえば、Project タグの path 属性に変数を指定できる<BR/>
仕様の場合、以下のように記述できます。</DIV>
<DIV id="text231_68" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:346px; margin-top:8631px; line-height:13px; white-space:nowrap">
${Var1}</DIV>
<DIV id="text231_69" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:78px; margin-top:8614px; line-height:15px; white-space:nowrap">
変数の定義と参照の例：</DIV>
<DIV id="text231_70" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:400px; margin-top:8695px; line-height:15px; white-space:nowrap">
こともできます。</DIV>
<DIV id="text231_71" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:246px; margin-top:8695px; line-height:15px; white-space:nowrap">
<A href="#Variable_Env">
OS の環境変数を指定する</A></DIV>
<DIV id="text231_72" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:237px; margin-top:8712px; line-height:15px; white-space:nowrap">
によって管理されるため、遅延評価されます。</DIV>
<DIV id="text231_73" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:8712px; line-height:15px; white-space:nowrap">
${ } 変数は、</DIV>
<DIV id="text231_74" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:115px; margin-top:8712px; line-height:15px; white-space:nowrap">
<A href="#LazyDictionaryClass">
LazyDictionaryClass</A></DIV>
<DIV id="text231_75" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:8695px; line-height:15px; white-space:nowrap">
変数の参照を記述できる場所には、</DIV>
<DIV id="text231_76" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:8121px; line-height:15px; white-space:nowrap">
スクリプトの内部では、</DIV>
<DIV id="text231_77" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:43px; margin-top:8320px; line-height:15px; white-space:nowrap">
変数の定義は、以下のように Variable タグを記述します。 ただし、name は、${ から始まり、} で<BR/>
終えてください。 Variable タグは、XML の中のどこでも記述することができます。</DIV>
<DIV id="text231_78" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:232px; margin-top:8656px; line-height:15px; white-space:nowrap">
path 属性は C:\ABC.txt になります。</DIV>
<DIV id="text231_79" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:211px; margin-top:8181px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_AddDictionary">
AddDictionary</A></DIV>
<DIV id="text231_80" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:299px; margin-top:8181px; line-height:15px; white-space:nowrap">
または</DIV>
<DIV id="text231_81" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:269px; margin-top:10041px; line-height:13px; white-space:nowrap">
${USERPROFILE}</DIV>
<DIV id="text231_82" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:305px; margin-top:10074px; line-height:13px; white-space:nowrap">
${USERPROFILE}</DIV>
<DIV id="text231_83" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:9948px; line-height:15px; white-space:nowrap">
${ } の中に OS の環境変数名を記述すると、その値を参照することができます。<BR/>
変数を定義する Variable タグの value 属性や、${ } 変数を参照できる場所に、OS の環境変数の<BR/>
参照を記述できます。</DIV>
<DIV id="text231_84" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:367px; margin-top:8509px; line-height:15px; white-space:nowrap">
<A href="vbslib_15.html#LocalVariableTag">
LocalVariable タグ</A></DIV>
<DIV id="text231_85" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:8509px; line-height:15px; white-space:nowrap">
変数の参照を記述する場所によって値を変更するときは、</DIV>
<DIV id="text231_86" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:472px; margin-top:8509px; line-height:15px; white-space:nowrap">
で定義してください。</DIV>
<DIV id="text231_87" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:166px; margin-top:8856px; line-height:13px; white-space:nowrap">
<A href="#LoadVariableInXML">
LoadVariableInXML</A></DIV>
<DIV id="text231_88" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:172px; margin-top:8995px; line-height:13px; white-space:nowrap">
${Var1}</DIV>
<DIV id="text231_89" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:148px; margin-top:9025px; line-height:13px; white-space:nowrap">
${Var1}</DIV>
<DIV id="text231_90" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:8448px; line-height:15px; white-space:nowrap">
手動で変数の展開をするときは、</DIV>
<DIV id="text231_91" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:236px; margin-top:8448px; line-height:15px; white-space:nowrap">
<A href="vbslib_03.html#EvaluateByVariableXML">
EvaluateByVariableXML コマンド</A></DIV>
<DIV id="text231_92" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:419px; margin-top:8448px; line-height:15px; white-space:nowrap">
が使えます。</DIV>
<DIV id="text231_93" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:75px; margin-top:10452px; line-height:15px; white-space:nowrap">
<A href="vbslib_03.html#EvaluateByVariableXML">
→ EvaluateByVariableXML</A></DIV>
<DIV id="text231_94" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10158px; line-height:15px; white-space:nowrap">
<A name="Variable_Call">
アプリケーション定義の関数を呼び出す</A></DIV>
<DIV id="text231_95" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:101px; margin-top:10317px; line-height:15px; white-space:nowrap">
<A href="#DictionaryEx_Call">
→ LazyDictionaryClass - 関数を呼び出す</A></DIV>
<v:rect style="position:absolute; margin-left:75px; margin-top:10243px; width:364px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_96" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:83px; margin-top:10250px; line-height:13px; white-space:nowrap">
&lt;Variable&nbsp; name="${A}"&nbsp; value="${UpperCase( abc, def )}"/&gt;</DIV>
<DIV id="text231_97" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:54px; margin-top:10218px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text231_98" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:54px; margin-top:10317px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text231_99" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:54px; margin-top:10191px; line-height:15px; white-space:nowrap">
アプリケーションによっては、${ } の中に ( ) が付いた関数呼び出しを記述することができます。</DIV>
<DIV id="text231_100" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:43px; margin-top:8729px; line-height:15px; white-space:nowrap">
<A href="#Variable_Call">
アプリケーション定義の関数を呼び出す</A></DIV>
<DIV id="text231_101" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:77px; margin-top:8006px; line-height:15px; white-space:nowrap">
<A href="#VariableTag">
Variable タグ</A></DIV>
<DIV id="text231_102" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:152px; margin-top:8006px; line-height:15px; white-space:nowrap">
で定義された変数を持つ、遅延評価する辞書を生成します。</DIV>
<DIV id="text231_103" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:266px; margin-top:8729px; line-height:15px; white-space:nowrap">
ことができます。</DIV>
<v:rect style="position:absolute; margin-left:75px; margin-top:10277px; width:286px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text231_104" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:83px; margin-top:10284px; line-height:13px; white-space:nowrap">
&lt;Project&nbsp; path="${UpperCase( C:\File.txt )"/&gt;</DIV>
<DIV id="text231_105" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:75px; margin-top:10389px; line-height:15px; white-space:nowrap">
→ vbslib_mini.vbs</DIV>
<DIV id="text231_106" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:44px; margin-top:8432px; line-height:15px; white-space:nowrap">
思ったように展開されないときは、</DIV>
<DIV id="text231_107" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:232px; margin-top:8432px; line-height:15px; white-space:nowrap">
<A href="#LazyDictionaryDebug">
デバッグ・モード</A></DIV>
<DIV id="text231_108" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:328px; margin-top:8432px; line-height:15px; white-space:nowrap">
を試してみてください</DIV>

<v:line from="0,7907" to="655,7907"/>
<v:line from="655,7907" to="655,10501"/>
<v:line from="655,10501" to="0,10501"/>
<v:line from="0,10501" to="0,7907"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10501px;">
<A id="svgcats_vml_p231" class="to_tree" onClick="selectTreeElem( '231' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10501px;">
<A id="page_group_bottom" href="vbslib_15.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
