<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet --> <!-- for too much local security warning -->
<HTML lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"> 
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=shift_jis"/>
<TITLE>vbslib</TITLE>

<STYLE type="text/css">
v\:line, v\:rect, v\:fill, v\:image, v\:stroke, v\:roundrect, v\:oval, v\:shape, v\:path, v\:textpath
  { behavior: url(#default#VML); }
A { text-decoration:none; }
A.to_tree { color:#CCDDCC; position:absolute; margin-left:0px; font-size:8pt; }
A.to_next_page { position:absolute; margin-left:40px; font-size:8pt; }
A.to_prev_page { position:absolute; margin-left:58px; font-size:8pt; }
A:visited { color:blue }
<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
DIV.tooltip { color:blue; }
DIV.tooltip textarea { display:none; margin-top:-5px; overflow:hidden; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->
</STYLE>

<SCRIPT type="text/javascript">
//<![CDATA[

function  onLoad()
{
  var  divs, i

  if ( !document.getElementsByTagName )  return;

  divs = document.getElementsByTagName( "A" );
  for ( i = 0; i < divs.length; i++ ) {
    if ( divs[i].className == "to_tree" ) {
      divs[i].style.color = "blue";
      divs[i].style.cursor = "hand";
    }
  }
}

function  selectTreeElem( num )
{
  var tree_url, i1, i2, fname, fname2

  if ( parent.frames.length == 0 ) {
    location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
     "&f2=vbslib.files/vbslib_34.html&sub2=svgcats_vml_p" + num;
  }
  else {
    tree_url = parent.tree.location.href;
    i1 = tree_url.lastIndexOf( "/" );
    i2 = tree_url.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname = tree_url.substring( i1 + 1 );
    i1 = fname.lastIndexOf( "#" );
    if ( i1 >= 0 )  fname = fname.substring( 0, i1 );
    fname2 = "vbslib.files/vbslib_tree.html";
    i1 = fname2.lastIndexOf( "/" );
    i2 = fname2.lastIndexOf( "\\" );
    if ( i2 > i1 )  i1 = i2;
    fname2 = fname2.substring( i1 + 1 );
    if ( fname == fname2 )
      parent.tree.selectTreeElem( "svgcats_index_p" + num );
    else
      location.href = "../vbslib.html?f1=vbslib.files/vbslib_tree.html&sub1=svgcats_index_p" + num +
       "&f2=vbslib.files/vbslib_34.html&sub2=svgcats_vml_p" + num;
  }
}

<!-- start of insert [PATCH_OF:urlrep_tooltip] -->
function  over( text, value, cols ){ text.style.display = "inline";
  text.cols=cols; text.rows=1; text.value=value; text.focus(); text.select(); }
function  out( text ){ text.style.display = "none"; }
<!-- end of [PATCH_OF:urlrep_tooltip] -->

//]]>
</SCRIPT>

</HEAD>
<BODY bgcolor="#CCDDCC" onLoad="onLoad();">

<DIV style="position:absolute; margin-left:0px; margin-top:8px; color:red; font-size:8pt;">
(for Internet Explorer)</DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:8px; width:130px; height:16px;" fillcolor="white" strokecolor="white"/>

<PAGESET>
 
<!-- page 675 --> 
<PAGE>
<A id="svgcats_vml_p675" class="to_tree" style="margin-top:-11px;" onClick="selectTreeElem( '675' );">←</A>
<A href="#svgcats_vml_p676" class="to_next_page" style="margin-top:-11px;">▼</A>
<A href="vbslib_33.html#svgcats_vml_p674" class="to_prev_page" style="margin-top:-11px;">▲</A>
<DIV style="position:absolute; margin-left:20px; margin-top:-16px;">
<A id="page_group_top" href="vbslib_33.html#page_group_bottom" style="text-decoration:none;">↑</A></DIV>
<v:rect style="position:absolute; margin-left:0px; margin-top:0px; width:587px; height:454px;" fillcolor="white"/>
<DIV id="text675_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:17px; line-height:15px; white-space:nowrap">
<A name="CheckTestErrLevel">
CheckTestErrLevel</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:45px; width:298px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text675_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:52px; line-height:13px; white-space:nowrap">
Sub&nbsp; CheckTestErrLevel( errorlevel as integer )</DIV>
<DIV id="text675_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:80px; line-height:15px; white-space:nowrap">
VBS プログラムの終了コード（エラーレベル）に問題があったらエラーを発生させる。</DIV>
<DIV id="text675_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:105px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text675_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:100px; margin-top:105px; line-height:15px; white-space:nowrap">
errorlevel</DIV>
<DIV id="text675_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:406px; line-height:15px; white-space:nowrap">
<A href="vbslib_27.html#RunProg">
→ RunProg</A></DIV>
<DIV id="text675_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:177px; margin-top:105px; line-height:15px; white-space:nowrap">
エラーレベル（WScript.Quit の引数）</DIV>
<DIV id="text675_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:141px; line-height:13px; white-space:nowrap">
内部で、Pass, Fail, Skip のいずれかを呼び出します。<BR/>
VBS プログラムは、wscript ではなく cscript で呼び出さないと、正しいエラーレベル<BR/>
を取得できません。</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:296px; width:286px; height:38px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text675_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:303px; line-height:13px; white-space:nowrap">
&nbsp; r = g_sh.Run( "cscript sample.vbs",, True )<BR/>
&nbsp; CheckTestErrLevel&nbsp; r</DIV>
<DIV id="text675_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:200px; margin-top:17px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text675_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:384px; line-height:15px; white-space:nowrap">
<A href="vbslib_39.html#fin">
→ 正常終了時の動作</A></DIV>
<DIV id="text675_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:406px; line-height:15px; white-space:nowrap">
関連</DIV>
<DIV id="text675_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:269px; line-height:15px; white-space:nowrap">
サンプル</DIV>
<DIV id="text675_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:201px; line-height:15px; white-space:nowrap">
RunProg</DIV>
<DIV id="text675_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:91px; margin-top:201px; line-height:15px; white-space:nowrap">
から VBScript のスクリプトを呼び出して、子プロセスでエラーが発生すると、</DIV>
<DIV id="text675_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:36px; margin-top:216px; line-height:15px; white-space:nowrap">
親プロセスの RunProg の中からエラーが発生してしまうため、終了コードを取得できません。</DIV>
<DIV id="text675_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:36px; margin-top:231px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_02.html#WScript_Shell_Run">
Run (Shell)</A></DIV>
<DIV id="text675_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:105px; margin-top:231px; line-height:15px; white-space:nowrap">
を使ってください。</DIV>
<DIV id="text675_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:72px; margin-top:362px; line-height:15px; white-space:nowrap">
<A href="vbslib_39.html#err_ov">
→ エラー発生時の動作</A></DIV>
<DIV id="text675_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:362px; line-height:15px; white-space:nowrap">
参考</DIV>

<v:line from="0,0" to="587,0"/>
<v:line from="587,0" to="587,454"/>
<v:line from="587,454" to="0,454"/>
<v:line from="0,454" to="0,0"/>

</PAGE>
 
<!-- page 676 --> 
<PAGE>
<A id="svgcats_vml_p676" class="to_tree" style="margin-top:459px;" onClick="selectTreeElem( '676' );">←</A>
<A href="#svgcats_vml_p677" class="to_next_page" style="margin-top:459px;">▼</A>
<A href="#svgcats_vml_p675" class="to_prev_page" style="margin-top:459px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:470px; width:427px; height:168px;" fillcolor="white"/>
<DIV id="text676_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:487px; line-height:15px; white-space:nowrap">
<A name="g_IsAutoTest">
g_IsAutoTest</A></DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:515px; width:184px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text676_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:522px; line-height:13px; white-space:nowrap">
Dim&nbsp; g_IsAutoTest as boolean</DIV>
<DIV id="text676_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:550px; line-height:15px; white-space:nowrap">
自動テストを実行中かどうか。</DIV>
<DIV id="text676_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:587px; line-height:15px; white-space:nowrap">
g_IsAutoTest = True にすると、</DIV>
<DIV id="text676_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:208px; margin-top:587px; line-height:15px; white-space:nowrap">
<A href="vbslib_06.html#pause">
Pause</A></DIV>
<DIV id="text676_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:250px; margin-top:587px; line-height:15px; white-space:nowrap">
しなくなることがあります。</DIV>

<v:line from="0,470" to="427,470"/>
<v:line from="427,470" to="427,638"/>
<v:line from="427,638" to="0,638"/>
<v:line from="0,638" to="0,470"/>

</PAGE>
 
<!-- page 677 --> 
<PAGE>
<A id="svgcats_vml_p677" class="to_tree" style="margin-top:643px;" onClick="selectTreeElem( '677' );">←</A>
<A href="#svgcats_vml_p678" class="to_next_page" style="margin-top:643px;">▼</A>
<A href="#svgcats_vml_p676" class="to_prev_page" style="margin-top:643px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:654px; width:278px; height:104px;" fillcolor="white"/>
<DIV id="text677_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:671px; line-height:15px; white-space:nowrap">
<A name="test_target">
テスト支援機能 （関数）</A></DIV>
<DIV id="text677_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:32px; margin-top:710px; line-height:15px; white-space:nowrap">
テスト対象となるスクリプトが使うもの</DIV>

<v:line from="0,654" to="278,654"/>
<v:line from="278,654" to="278,758"/>
<v:line from="278,758" to="0,758"/>
<v:line from="0,758" to="0,654"/>

</PAGE>
 
<!-- page 678 --> 
<PAGE>
<A id="svgcats_vml_p678" class="to_tree" style="margin-top:763px;" onClick="selectTreeElem( '678' );">←</A>
<A href="#svgcats_vml_p679" class="to_next_page" style="margin-top:763px;">▼</A>
<A href="#svgcats_vml_p677" class="to_prev_page" style="margin-top:763px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:774px; width:645px; height:1757px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:36px; margin-top:1069px; width:556px; height:295px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text678_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:44px; margin-top:1075px; line-height:15px; white-space:nowrap">
Sub&nbsp; T_Test1( Opt, AppKey )<BR/>
&nbsp; Dim&nbsp; x<BR/>
<BR/>
&nbsp; Dim cases : Set cases = ReadTestCase( "T_Test1_Data.xml", "TestCase_for_T_Test1" )<BR/>
&nbsp; For Each x&nbsp; In cases.Items<BR/>
&nbsp; &nbsp; T_Test1_main&nbsp; Opt, AppKey, x&nbsp; '// Test.vbs の中では、パラメーターは ( tests, x )<BR/>
&nbsp; Next<BR/>
&nbsp; Pass<BR/>
End Sub<BR/>
<BR/>
'// ループが増えてもインデントを深くさせなくて済むように、テストの実施は *_main 関数にする<BR/>
Sub&nbsp; T_Test1_main( Opt, AppKey, x )<BR/>
&nbsp; Dim w_:Set w_=AppKey.NewWritable( "out" ).Enable()<BR/>
&nbsp; EchoTestStart&nbsp; "T_Test1"<BR/>
&nbsp; echo&nbsp; x&nbsp; '// 全てのデータを表示する<BR/>
<BR/>
&nbsp; FuncA&nbsp; CInt( x("InputData") )<BR/>
&nbsp; FuncB&nbsp; Replace( x("Answer"), "%Num%", CStr( 12 ) )<BR/>
End Sub</DIV>
<DIV id="text678_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:791px; line-height:15px; white-space:nowrap">
<A name="ReadTestCase">
ReadTestCase</A></DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:1757px; width:454px; height:415px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text678_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:1763px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;<BR/>
&lt;TestCases name="common" ExeName="Sample"&gt;<BR/>
&lt;!-- base_data="...\TestCommon_Data.xml#root" --&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1" base_data="#common"&gt;<BR/>
&lt;SubCase&nbsp; name="Number"<BR/>
&nbsp; InputData = "123"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans%Num%.txt"&nbsp; _comment2= "FilePath with variable"<BR/>
/&gt;<BR/>
&lt;SubCase&nbsp; name="Alphabet"<BR/>
&nbsp; InputData = "ABC"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans2.txt"<BR/>
/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1_sub"&gt; &lt;!-- This is cross parameter --&gt;<BR/>
&lt;SubCase&nbsp; name="CurrentFolder"<BR/>
&nbsp; CurrentFolder = "."<BR/>
&nbsp; StepPath&nbsp; &nbsp; &nbsp; = "Data\"<BR/>
/&gt;<BR/>
&lt;SubCase&nbsp; name="SubFolder"<BR/>
&nbsp; CurrentFolder = "Data"<BR/>
&nbsp; StepPath&nbsp; &nbsp; &nbsp; = ""<BR/>
/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text678_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:1737px; line-height:15px; white-space:nowrap">
サンプル XML ファイル： T_Test1_Data.xml</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:819px; width:442px; height:40px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text678_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:825px; line-height:15px; white-space:nowrap">
Function&nbsp; ReadTestCase( XmlPath as string, TestCaseID as string )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; as ArrayClass of Dictionary</DIV>
<DIV id="text678_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:911px; line-height:15px; white-space:nowrap">
テストケースが書かれた XML ファイルのデータにアクセスするオブジェクトを返します。</DIV>
<DIV id="text678_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:937px; line-height:15px; white-space:nowrap">
【引数】</DIV>
<DIV id="text678_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:937px; line-height:15px; white-space:nowrap">
XmlPath</DIV>
<DIV id="text678_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:956px; line-height:15px; white-space:nowrap">
TestCaseID</DIV>
<DIV id="text678_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:937px; line-height:15px; white-space:nowrap">
テストケースが書かれた XML ファイルのパス</DIV>
<DIV id="text678_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:956px; line-height:15px; white-space:nowrap">
XML ファイルの中の &lt;TestCase&gt; タグの id 属性の値、または Empty</DIV>
<v:rect style="position:absolute; margin-left:91px; margin-top:1008px; width:100px; height:19px;" fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text678_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:99px; margin-top:1012px; line-height:13px; white-space:nowrap">
TestScript.vbs</DIV>
<DIV id="text678_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:97px; margin-top:975px; line-height:15px; white-space:nowrap">
返り値</DIV>
<DIV id="text678_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:975px; line-height:15px; white-space:nowrap">
テストケースのデータ（の配列）</DIV>
<DIV id="text678_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:1010px; line-height:15px; white-space:nowrap">
ファイル：</DIV>
<DIV id="text678_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:26px; margin-top:2283px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text678_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:172px; margin-top:791px; line-height:15px; white-space:nowrap">
(src)</DIV>
<DIV id="text678_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:2283px; line-height:15px; white-space:nowrap">
→ T_TestCaseData.vbs # T_TestCaseData</DIV>
<DIV id="text678_19" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:1627px; line-height:15px; white-space:nowrap">
テストケースのデータの多くは構造体の配列であるため、XML ファイルの書式は、それを想定<BR/>
して、ある程度決めています。&nbsp; この標準化により、XML ファイルを見たときにテストケースが<BR/>
把握しやすくなりますし、テスト・スクリプトのコードも DOM より簡単になります。 書式の詳細は、<BR/>
下記の DTD を参照してください。<BR/>
もし、複雑なデータを記述したいときは、一般的な XML ファイルをアクセスする DOM を使って<BR/>
ください。 参考</DIV>
<DIV id="text678_20" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:1044px; line-height:15px; white-space:nowrap">
サンプル・コード：</DIV>
<DIV id="text678_21" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:290px; margin-top:1121px; line-height:13px; white-space:nowrap">
T_Test1_Data.xml</DIV>
<DIV id="text678_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:410px; margin-top:1121px; line-height:13px; white-space:nowrap">
TestCase_for_T_Test1</DIV>
<DIV id="text678_23" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:170px; margin-top:1331px; line-height:13px; white-space:nowrap">
Answer</DIV>
<DIV id="text678_24" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:152px; margin-top:1316px; line-height:13px; white-space:nowrap">
InputData</DIV>
<DIV id="text678_25" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:45px; margin-top:2182px; line-height:15px; white-space:nowrap">
TestCases、TestCase、SubCase のタグ名を変えることはできません。<BR/>
<BR/>
XML タグの中（例：SubCase タグの中） に &lt;!-- --&gt; 形式のコメントは入れたいときは、<BR/>
XMLの仕様上できないので、ダミーとなる&nbsp; _comment1 などの属性を使って、コメントを<BR/>
記述します。</DIV>
<DIV id="text678_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:39px; margin-top:1422px; line-height:15px; white-space:nowrap">
返り値は、辞書型を要素に持つ配列（ArrayClass）です。 辞書のキーは、XML 属性の名前です。<BR/>
データの具体的な値は、下記のサンプル XML ファイルを参照してください。<BR/>
・得られるデータはすべて文字列型です。<BR/>
・数値を使うときは、CInt 関数などを使います。<BR/>
・辞書のキーに指定した名前に対応する XML 属性が存在しないときは、Empty を返します。<BR/>
・複数のデータをコンマで区切って記述したときは、<BR/>
・動的に変化するデータを XML ファイルに記述するときは、%Num% のように変数を記述します。<BR/>
　ただし、テスト・スクリプトで Replace 関数や<BR/>
・#name （HTML の href 属性）のリンク先を得るには、</DIV>
<DIV id="text678_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:321px; margin-top:1497px; line-height:15px; white-space:nowrap">
<A href="vbslib_25.html#ArrayFromCSV">
ArrayFromCSV</A></DIV>
<DIV id="text678_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:410px; margin-top:1497px; line-height:15px; white-space:nowrap">
などを使います。</DIV>
<DIV id="text678_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:1597px; line-height:15px; white-space:nowrap">
テストケースが書かれた XML ファイルの書式</DIV>
<DIV id="text678_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:57px; margin-top:1854px; line-height:13px; white-space:nowrap">
InputData</DIV>
<DIV id="text678_31" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:57px; margin-top:1869px; line-height:13px; white-space:nowrap">
Answer</DIV>
<DIV id="text678_32" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:129px; margin-top:1824px; line-height:13px; white-space:nowrap">
TestCase_for_T_Test1</DIV>
<DIV id="text678_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:129px; margin-top:1989px; line-height:13px; white-space:nowrap">
TestCase_for_T_Test1_sub</DIV>
<DIV id="text678_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:2443px; line-height:15px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_12.html#GetMainSetting">
→ GetMainSetting 関数 (vbsool)</A></DIV>
<DIV id="text678_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:26px; margin-top:2323px; line-height:15px; white-space:nowrap">
関連</DIV>
<v:rect style="position:absolute; margin-left:25px; margin-top:870px; width:400px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text678_36" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:33px; margin-top:877px; line-height:13px; white-space:nowrap">
Function&nbsp; ReadTestCase( XmlPath as string, Empty ) as Dictionary</DIV>
<DIV id="text678_37" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:129px; margin-top:1702px; line-height:15px; white-space:nowrap">
<A href="vbslib_25.html#LoadXML">
→ LoadXML</A></DIV>
<DIV id="text678_38" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:315px; margin-top:841px; line-height:13px; white-space:nowrap">
<A href="vbslib_07.html#ArrayClass">
ArrayClass</A></DIV>
<DIV id="text678_39" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:357px; margin-top:877px; line-height:13px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_07.html#dic">
Dictionary</A></DIV>
<DIV id="text678_40" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:399px; margin-top:841px; line-height:13px; white-space:nowrap">
<A href="..\vbs_memo.files\vbs_memo_07.html#dic">
Dictionary</A></DIV>
<DIV id="text678_41" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:2483px; line-height:15px; white-space:nowrap">
→ TestNums (clib)</DIV>
<v:line style="position:absolute;" from="206,1816" to="453,1139" strokecolor="#7CFF11" strokeweight="1pt"/>
<DIV id="text678_43" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:51px; margin-top:1779px; line-height:13px; white-space:nowrap">
TestCases</DIV>
<DIV id="text678_44" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:51px; margin-top:1824px; line-height:13px; white-space:nowrap">
TestCase</DIV>
<DIV id="text678_45" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:51px; margin-top:1839px; line-height:13px; white-space:nowrap">
SubCase</DIV>
<DIV id="text678_46" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:51px; margin-top:1899px; line-height:13px; white-space:nowrap">
SubCase</DIV>
<DIV id="text678_47" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:51px; margin-top:2004px; line-height:13px; white-space:nowrap">
SubCase</DIV>
<DIV id="text678_48" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:57px; margin-top:1959px; line-height:13px; white-space:nowrap">
TestCase</DIV>
<DIV id="text678_49" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:51px; margin-top:1989px; line-height:13px; white-space:nowrap">
TestCase</DIV>
<DIV id="text678_50" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:51px; margin-top:2064px; line-height:13px; white-space:nowrap">
SubCase</DIV>
<DIV id="text678_51" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:57px; margin-top:2124px; line-height:13px; white-space:nowrap">
TestCase</DIV>
<DIV id="text678_52" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:57px; margin-top:2154px; line-height:13px; white-space:nowrap">
TestCases</DIV>
<DIV id="text678_53" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:436px; margin-top:875px; line-height:15px; white-space:nowrap">
<A href="#ReadTestCase_Common">
→ 複数ケースで共通のデータ</A></DIV>
<DIV id="text678_54" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:2423px; line-height:15px; white-space:nowrap">
<A href="vbslib_35.html#SetReadTestCase">
→ SetReadTestCase</A></DIV>
<DIV id="text678_55" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:296px; margin-top:2423px; line-height:15px; white-space:nowrap">
デバッグ用に、テストケースを指定します</DIV>
<DIV id="text678_56" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:296px; margin-top:2443px; line-height:15px; white-space:nowrap">
スクリプト・ファイル内のデータ</DIV>
<DIV id="text678_57" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:296px; margin-top:2483px; line-height:15px; white-space:nowrap">
C言語のテスト番号</DIV>
<DIV id="text678_58" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:74px; margin-top:1076px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text678_59" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:68px; margin-top:1151px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text678_60" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:74px; margin-top:1241px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text678_61" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:2323px; line-height:15px; white-space:nowrap">
<A href="#ReadTestCase_Common">
→ 複数のケースで共通のデータ</A></DIV>
<DIV id="text678_62" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:2363px; line-height:15px; white-space:nowrap">
<A href="#cress_case">
→ クロス・ケース</A></DIV>
<DIV id="text678_63" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:2383px; line-height:15px; white-space:nowrap">
<A href="#ReadTestCase_LookUpDic">
→ テスト・ケースの選択</A></DIV>
<DIV id="text678_64" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:2403px; line-height:15px; white-space:nowrap">
<A href="#case_embed">
→ スクリプトからテストケースを指定する</A></DIV>
<DIV id="text678_65" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:80px; margin-top:2343px; line-height:15px; white-space:nowrap">
<A href="#ReadTestCase_SpXml">
→ 特殊な XML 属性 (ReadTestCase)</A></DIV>
<DIV id="text678_66" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:327px; margin-top:1824px; line-height:13px; white-space:nowrap">
<A href="#ReadTestCase_Common">
#common</A></DIV>
<v:line style="position:absolute;" from="186,1346" to="100,1850" strokecolor="#11FFFF" strokeweight="1pt"/>
<DIV id="text678_68" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:379px; margin-top:1528px; line-height:15px; white-space:nowrap">
などを使って値を設定してください。</DIV>
<DIV id="text678_69" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:291px; margin-top:1528px; line-height:15px; white-space:nowrap">
<A href="vbslib_09.html#DicItemOfItem">
DicItemOfItem</A></DIV>
<DIV id="text678_70" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:337px; margin-top:1542px; line-height:15px; white-space:nowrap">
GetHRefBase</DIV>
<DIV id="text678_71" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:420px; margin-top:1542px; line-height:15px; white-space:nowrap">
を使ってください。</DIV>
<DIV id="text678_72" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:29px; margin-top:1393px; line-height:15px; white-space:nowrap">
属性値の扱い方</DIV>
<DIV id="text678_73" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:2463px; line-height:15px; white-space:nowrap">
→ DicTable</DIV>
<DIV id="text678_74" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:296px; margin-top:2463px; line-height:15px; white-space:nowrap">
辞書を使ったテストデータ</DIV>

<v:line from="0,774" to="645,774"/>
<v:line from="645,774" to="645,2531"/>
<v:line from="645,2531" to="0,2531"/>
<v:line from="0,2531" to="0,774"/>

</PAGE>
 
<!-- page 679 --> 
<PAGE>
<A id="svgcats_vml_p679" class="to_tree" style="margin-top:2536px;" onClick="selectTreeElem( '679' );">←</A>
<A href="#svgcats_vml_p680" class="to_next_page" style="margin-top:2536px;">▼</A>
<A href="#svgcats_vml_p678" class="to_prev_page" style="margin-top:2536px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:2547px; width:535px; height:816px;" fillcolor="white"/>
<DIV id="text679_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:2564px; line-height:15px; white-space:nowrap">
<A name="ReadTestCase_Common">
複数のケースで共通のデータ</A></DIV>
<DIV id="text679_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:267px; margin-top:2567px; line-height:12px; white-space:nowrap">
<A href="#ReadTestCase">
[ 親: ReadTestCase ]</A></DIV>
<DIV id="text679_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:26px; margin-top:2594px; line-height:15px; white-space:nowrap">
複数のテストケースで共通のデータは、</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:2665px; width:448px; height:250px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text679_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:2671px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;<BR/>
&lt;TestCases ExeName="Sample" name="common"&gt;<BR/>
&lt;!-- base_data="...\TestCommon_Data.xml#root" --&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1" CommonData1="1" base_data="#common"&gt;<BR/>
&lt;SubCase&nbsp; name="Number"<BR/>
&nbsp; InputData = "123"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans%Num%.txt"&nbsp; _comment2= "FilePath with variable"<BR/>
/&gt;<BR/>
&lt;SubCase&nbsp; name="Alphabet"<BR/>
&nbsp; InputData = "ABC"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans2.txt"<BR/>
/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text679_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:2646px; line-height:15px; white-space:nowrap">
サンプル XML ファイル： T_Test1_Data.xml</DIV>
<DIV id="text679_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:423px; margin-top:2732px; line-height:13px; white-space:nowrap">
#common</DIV>
<DIV id="text679_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:249px; margin-top:2687px; line-height:13px; white-space:nowrap">
common</DIV>
<DIV id="text679_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:349px; margin-top:2594px; line-height:15px; white-space:nowrap">
を指定するか、</DIV>
<DIV id="text679_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:26px; margin-top:2611px; line-height:15px; white-space:nowrap">
TestCase タグの属性に記述できます。</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:2963px; width:406px; height:250px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text679_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:2969px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1"&gt;<BR/>
&lt;SubCase&nbsp; name="Number"<BR/>
&nbsp; InputData = "123"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans%Num%.txt"&nbsp; _comment2= "FilePath with variable"<BR/>
&nbsp; CommonData1 = "1"&nbsp; ExeName = "Sample.exe"<BR/>
/&gt;<BR/>
&lt;SubCase&nbsp; name="Alphabet"<BR/>
&nbsp; InputData = "ABC"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans2.txt"<BR/>
&nbsp; CommonData1 = "1"&nbsp; ExeName = "Sample.exe"<BR/>
/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text679_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:2943px; line-height:15px; white-space:nowrap">
上のファイルと下のファイルは、同じテスト・データになります。</DIV>
<DIV id="text679_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:261px; margin-top:2732px; line-height:13px; white-space:nowrap">
CommonData1</DIV>
<DIV id="text679_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:245px; margin-top:2594px; line-height:15px; white-space:nowrap">
<A href="#ReadTestCase_SpXml">
特殊な XML 属性</A></DIV>
<DIV id="text679_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:57px; margin-top:3060px; line-height:13px; white-space:nowrap">
CommonData1</DIV>
<DIV id="text679_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:57px; margin-top:3135px; line-height:13px; white-space:nowrap">
CommonData1</DIV>
<DIV id="text679_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:171px; margin-top:3135px; line-height:13px; white-space:nowrap">
ExeName</DIV>
<DIV id="text679_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:171px; margin-top:3060px; line-height:13px; white-space:nowrap">
ExeName</DIV>
<DIV id="text679_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:111px; margin-top:2687px; line-height:13px; white-space:nowrap">
ExeName</DIV>
<v:line style="position:absolute;" from="140,2704" to="220,3055" strokecolor="#7CFF11" strokeweight="1pt"/>
<v:line style="position:absolute;" from="303,2693" to="416,2731" strokecolor="#FF9F11" strokeweight="1pt"/>
<v:line style="position:absolute;" from="284,2748" to="104,3060" strokecolor="#11FFFF" strokeweight="1pt"/>
<v:rect style="position:absolute; margin-left:37px; margin-top:3261px; width:472px; height:70px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text679_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:3267px; line-height:15px; white-space:nowrap">
&nbsp; Dim test_common_data : Set test_common_data = ReadTestCase( SearchParent(_<BR/>
&nbsp; &nbsp; "TestCommon_Data.xml" ), Empty ) '// test_common_data as &lt;TestCases&gt;<BR/>
<BR/>
&nbsp; start&nbsp; test_common_data( "ExeName" )</DIV>
<DIV id="text679_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:26px; margin-top:3240px; line-height:15px; white-space:nowrap">
&lt;TestCases&gt; タグの内容をリードするときは、下記のようにします。</DIV>

<v:line from="0,2547" to="535,2547"/>
<v:line from="535,2547" to="535,3363"/>
<v:line from="535,3363" to="0,3363"/>
<v:line from="0,3363" to="0,2547"/>

</PAGE>
 
<!-- page 680 --> 
<PAGE>
<A id="svgcats_vml_p680" class="to_tree" style="margin-top:3368px;" onClick="selectTreeElem( '680' );">←</A>
<A href="#svgcats_vml_p681" class="to_next_page" style="margin-top:3368px;">▼</A>
<A href="#svgcats_vml_p679" class="to_prev_page" style="margin-top:3368px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:3379px; width:626px; height:816px;" fillcolor="white"/>
<DIV id="text680_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:3396px; line-height:15px; white-space:nowrap">
<A name="ReadTestCase_Common_old">
（旧版） 複数のケースで共通のデータ</A></DIV>
<v:rect style="position:absolute; margin-left:36px; margin-top:3468px; width:520px; height:295px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text680_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:44px; margin-top:3474px; line-height:15px; white-space:nowrap">
Sub&nbsp; T_Test1( Opt, AppKey )<BR/>
&nbsp; Dim&nbsp; x<BR/>
<BR/>
&nbsp; Dim xx : Set xx = ReadTestCase( "T_Test1_Data.xml", Empty ) '// xx as &lt;TestCases&gt;<BR/>
<BR/>
&nbsp; Dim cases : Set cases = ReadTestCase( "T_Test1_Data.xml", "TestCase_for_T_Test1" )<BR/>
&nbsp; For Each x&nbsp; In cases.Items<BR/>
&nbsp; &nbsp; Dic_add&nbsp; x, xx<BR/>
&nbsp; &nbsp; T_Test1_main&nbsp; Opt, AppKey, x<BR/>
&nbsp; Next<BR/>
&nbsp; Pass<BR/>
End Sub<BR/>
<BR/>
'// ループが増えてもインデントを深くさせないため、テストの実施は *_main 関数にする<BR/>
Sub&nbsp; T_Test1_main( Opt, AppKey, x )<BR/>
&nbsp; echo&nbsp; x<BR/>
&nbsp; FuncA&nbsp; CInt( x("InputData") )<BR/>
&nbsp; FuncB&nbsp; x("CommonData1")<BR/>
End Sub</DIV>
<DIV id="text680_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:254px; margin-top:3520px; line-height:13px; white-space:nowrap">
T_Test1_Data.xml</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:3801px; width:406px; height:265px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text680_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:3807px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;<BR/>
&lt;TestCases<BR/>
&nbsp; CommonData1 = "Sample.exe"<BR/>
&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1"&gt;<BR/>
&lt;SubCase&nbsp; name="Number"<BR/>
&nbsp; InputData = "123"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans%Num%.txt"&nbsp; _comment2= "FilePath with variable"<BR/>
/&gt;<BR/>
&lt;SubCase&nbsp; name="Alphabet"<BR/>
&nbsp; InputData = "ABC"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans2.txt"<BR/>
/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text680_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:57px; margin-top:3838px; line-height:13px; white-space:nowrap">
CommonData1</DIV>
<DIV id="text680_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#408080; margin-left:51px; margin-top:3823px; line-height:13px; white-space:nowrap">
TestCases</DIV>
<DIV id="text680_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:116px; margin-top:3730px; line-height:13px; white-space:nowrap">
CommonData1</DIV>
<DIV id="text680_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:26px; margin-top:3426px; line-height:15px; white-space:nowrap">
複数のテストケースで共通のデータを、XML ファイルの TestCases タグの属性からリードするときは、<BR/>
ReadTestCase の第2引数を Empty に指定してください。</DIV>
<DIV id="text680_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:3782px; line-height:15px; white-space:nowrap">
サンプル XML ファイル： T_Test1_Data.xml</DIV>
<DIV id="text680_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:288px; margin-top:3399px; line-height:12px; white-space:nowrap">
<A href="#ReadTestCase">
[ 親: ReadTestCase ]</A></DIV>
<DIV id="text680_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:368px; margin-top:3520px; line-height:13px; white-space:nowrap">
Empty</DIV>
<DIV id="text680_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:74px; margin-top:3475px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text680_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:74px; margin-top:3685px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text680_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:68px; margin-top:3595px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<v:line style="position:absolute;" from="144,3743" to="111,3833" strokecolor="#7CFF11" strokeweight="1pt"/>
<DIV id="text680_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:26px; margin-top:4100px; line-height:15px; white-space:nowrap">
複数のテスト・プログラムで共通のデータは、親フォルダーにある共通の XML ファイルからリードして<BR/>
ください。</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:4138px; width:550px; height:25px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text680_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:4145px; line-height:13px; white-space:nowrap">
Set xx = ReadTestCase( SearchParent("TestCommon_Data.xml"), Empty ) '// xx as &lt;TestCases&gt;</DIV>
<DIV id="text680_18" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:183px; margin-top:4145px; line-height:13px; white-space:nowrap">
<A href="vbslib_21.html#SearchParent">
SearchParent</A></DIV>

<v:line from="0,3379" to="626,3379"/>
<v:line from="626,3379" to="626,4195"/>
<v:line from="626,4195" to="0,4195"/>
<v:line from="0,4195" to="0,3379"/>

</PAGE>
 
<!-- page 681 --> 
<PAGE>
<A id="svgcats_vml_p681" class="to_tree" style="margin-top:4200px;" onClick="selectTreeElem( '681' );">←</A>
<A href="#svgcats_vml_p682" class="to_next_page" style="margin-top:4200px;">▼</A>
<A href="#svgcats_vml_p680" class="to_prev_page" style="margin-top:4200px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4211px; width:653px; height:571px;" fillcolor="white"/>
<DIV id="text681_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4228px; line-height:15px; white-space:nowrap">
<A name="ReadTestCase_SpXml">
特殊な XML 属性 (ReadTestCase)</A></DIV>
<DIV id="text681_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4262px; line-height:15px; white-space:nowrap">
ReadTestCase がリードする XML ファイルは、データの記述が冗長にならないように、データの継承や集約<BR/>
ができる特殊な XML が使えます。</DIV>
<DIV id="text681_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:39px; margin-top:4307px; line-height:15px; white-space:nowrap">
<A href="#ReadTestCase_base_data">
→ base_data 属性</A></DIV>
<DIV id="text681_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:39px; margin-top:4325px; line-height:15px; white-space:nowrap">
<A href="#ReadTestCase_plus_attr">
→ plus_attr 属性</A></DIV>
<DIV id="text681_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:39px; margin-top:4343px; line-height:15px; white-space:nowrap">
<A href="#ReadTestCase_aggregate">
→ aggregate 属性</A></DIV>
<DIV id="text681_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:181px; margin-top:4307px; line-height:15px; white-space:nowrap">
XML 属性を継承します</DIV>
<DIV id="text681_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:181px; margin-top:4325px; line-height:15px; white-space:nowrap">
継承した XML 属性は CSV 形式で追加します</DIV>
<DIV id="text681_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:181px; margin-top:4343px; line-height:15px; white-space:nowrap">
子の XML 要素を集約します</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:4410px; width:214px; height:340px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text681_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:4416px; line-height:15px; white-space:nowrap">
&lt;!ELEMENT TestCases (TestCase*)&gt;<BR/>
&lt;!ELEMENT TestCase (SubCase*)&gt;<BR/>
<BR/>
&lt;!ATTLIST TestCases<BR/>
&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CDATA&nbsp; &nbsp; #IMPLIED<BR/>
&nbsp; &nbsp; name&nbsp; &nbsp; &nbsp; &nbsp;ID&nbsp; &nbsp; &nbsp; &nbsp;#IMPLIED<BR/>
&nbsp; &nbsp; base_data&nbsp; IDREFS&nbsp; &nbsp;#IMPLIED<BR/>
&nbsp; &nbsp; plus_attr&nbsp; NMTOKENS #IMPLIED<BR/>
&gt;<BR/>
&lt;!ATTLIST TestCase<BR/>
&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CDATA&nbsp; &nbsp; #IMPLIED<BR/>
&nbsp; &nbsp; id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ID&nbsp; &nbsp; &nbsp; &nbsp;#REQUIRED<BR/>
&nbsp; &nbsp; base_data&nbsp; IDREFS&nbsp; &nbsp;#IMPLIED<BR/>
&nbsp; &nbsp; plus_attr&nbsp; NMTOKENS #IMPLIED<BR/>
&nbsp; &nbsp; aggregate&nbsp; IDREFS&nbsp; &nbsp;#IMPLIED<BR/>
&gt;<BR/>
&lt;!ATTLIST SubCase<BR/>
&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CDATA&nbsp; &nbsp; #IMPLIED<BR/>
&nbsp; &nbsp; name&nbsp; &nbsp; &nbsp; &nbsp;ID&nbsp; &nbsp; &nbsp; &nbsp;#IMPLIED<BR/>
&nbsp; &nbsp; base_data&nbsp; IDREFS&nbsp; &nbsp;#IMPLIED<BR/>
&nbsp; &nbsp; plus_attr&nbsp; NMTOKENS #IMPLIED<BR/>
&gt;</DIV>
<DIV id="text681_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4391px; line-height:15px; white-space:nowrap">
テストデータを記述する XML ファイルの DTD</DIV>
<DIV id="text681_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:267px; margin-top:4231px; line-height:12px; white-space:nowrap">
<A href="#ReadTestCase">
[ 親: ReadTestCase ]</A></DIV>

<v:line from="0,4211" to="653,4211"/>
<v:line from="653,4211" to="653,4782"/>
<v:line from="653,4782" to="0,4782"/>
<v:line from="0,4782" to="0,4211"/>

</PAGE>
 
<!-- page 682 --> 
<PAGE>
<A id="svgcats_vml_p682" class="to_tree" style="margin-top:4787px;" onClick="selectTreeElem( '682' );">←</A>
<A href="#svgcats_vml_p683" class="to_next_page" style="margin-top:4787px;">▼</A>
<A href="#svgcats_vml_p681" class="to_prev_page" style="margin-top:4787px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:4798px; width:631px; height:688px;" fillcolor="white"/>
<v:rect style="position:absolute; margin-left:37px; margin-top:4986px; width:460px; height:220px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text682_1" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:4992px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;<BR/>
&lt;TestCases&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1"&gt;<BR/>
&lt;SubCase&nbsp; name="Number"&nbsp; &nbsp;InputData = "123"&nbsp; base_data="#T_Test1_Common"/&gt;<BR/>
&lt;SubCase&nbsp; name="Alphabet" InputData = "ABC"&nbsp; base_data="#T_Test1_Common"/&gt;<BR/>
&lt;SubCase&nbsp; name="AlphaNum" InputData = "1AB"&nbsp; Answer="ans2.txt"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1_Common"&gt;<BR/>
&lt;SubCase&nbsp; name="T_Test1_Common"&nbsp; Answer="ans1.txt"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text682_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:4967px; line-height:15px; white-space:nowrap">
サンプル XML ファイル： T_Test1_Data.xml</DIV>
<DIV id="text682_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4850px; line-height:15px; white-space:nowrap">
データの多くは共通で、一部のデータだけ変えるときは、base_data 属性を使って属性を継承することが<BR/>
できます。 base_data 属性は、A タグの href 属性と同じ記述形式です。 別のファイルから継承する<BR/>
こともできます。</DIV>
<DIV id="text682_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:4816px; line-height:15px; white-space:nowrap">
<A name="ReadTestCase_base_data">
base_data 属性</A></DIV>
<DIV id="text682_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:387px; margin-top:5053px; line-height:13px; white-space:nowrap">
T_Test1_Common</DIV>
<DIV id="text682_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:387px; margin-top:5068px; line-height:13px; white-space:nowrap">
T_Test1_Common</DIV>
<DIV id="text682_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:141px; margin-top:5143px; line-height:13px; white-space:nowrap">
T_Test1_Common</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:5237px; width:400px; height:160px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text682_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:5243px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;<BR/>
&lt;TestCases&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1"&gt;<BR/>
&lt;SubCase&nbsp; name="Number"&nbsp; &nbsp;InputData = "123"&nbsp; Answer="ans1.txt"/&gt;<BR/>
&lt;SubCase&nbsp; name="Alphabet" InputData = "ABC"&nbsp; Answer="ans1.txt"/&gt;<BR/>
&lt;SubCase&nbsp; name="AlphaNum" InputData = "1AB"&nbsp; Answer="ans2.txt"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text682_9" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5216px; line-height:15px; white-space:nowrap">
上のファイルと下のファイルは、同じデータになります。</DIV>
<DIV id="text682_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:315px; margin-top:5304px; line-height:13px; white-space:nowrap">
Answer="ans1.txt"</DIV>
<DIV id="text682_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:315px; margin-top:5319px; line-height:13px; white-space:nowrap">
Answer="ans1.txt"</DIV>
<DIV id="text682_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:4906px; line-height:15px; white-space:nowrap">
ファイルパスに、ピリオドを３つ並べると、親フォルダー、親の親フォルダー … と探していきます。<BR/>
参考</DIV>
<DIV id="text682_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#0000FF; margin-left:57px; margin-top:4921px; line-height:15px; white-space:nowrap">
<A href="vbslib_21.html#period3">
→ パスにピリオドを３つ並べた場合</A></DIV>
<DIV id="text682_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:260px; margin-top:4819px; line-height:12px; white-space:nowrap">
<A href="#ReadTestCase">
[ 親: ReadTestCase ]</A></DIV>
<DIV id="text682_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:23px; margin-top:5421px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text682_16" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:5421px; line-height:15px; white-space:nowrap">
→ T_TestCaseData.vbs # [T_BaseTestCaseData]</DIV>
<DIV id="text682_17" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:117px; margin-top:5438px; line-height:15px; white-space:nowrap">
→ T_TestCaseData.xml # T_BaseTestCaseData_1 など</DIV>
<v:line style="position:absolute;" from="236,5144" to="375,5077" strokecolor="#7CFF11" strokeweight="1pt"/>
<v:line style="position:absolute;" from="322,5162" to="382,5299" strokecolor="#FF9F11" strokeweight="1pt"/>

<v:line from="0,4798" to="631,4798"/>
<v:line from="631,4798" to="631,5486"/>
<v:line from="631,5486" to="0,5486"/>
<v:line from="0,5486" to="0,4798"/>

</PAGE>
 
<!-- page 683 --> 
<PAGE>
<A id="svgcats_vml_p683" class="to_tree" style="margin-top:5491px;" onClick="selectTreeElem( '683' );">←</A>
<A href="#svgcats_vml_p684" class="to_next_page" style="margin-top:5491px;">▼</A>
<A href="#svgcats_vml_p682" class="to_prev_page" style="margin-top:5491px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:5502px; width:505px; height:578px;" fillcolor="white"/>
<DIV id="text683_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:5519px; line-height:15px; white-space:nowrap">
<A name="ReadTestCase_plus_attr">
plus_attr 属性</A></DIV>
<DIV id="text683_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:5554px; line-height:15px; white-space:nowrap">
CSV 形式のデータを、別のタグから追加するときは、plus_attr 属性を使います。<BR/>
plus_attr 属性の値は、属性の値を CSV 形式で並べます。</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:5621px; width:418px; height:205px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text683_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:5627px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;<BR/>
&lt;TestCases&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1"&gt;<BR/>
&lt;SubCase&nbsp; name="a" InputDataA="123" InputDataB="123"<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; base_data="#T_Test1_Common" plus_attr="InputDataA"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1_Common"&gt;<BR/>
&lt;SubCase&nbsp; name="T_Test1_Common" InputDataB="ABC" InputDataB="ABC"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text683_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:5602px; line-height:15px; white-space:nowrap">
サンプル XML ファイル： T_Test1_Data.xml</DIV>
<DIV id="text683_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:339px; margin-top:5703px; line-height:13px; white-space:nowrap">
InputDataA</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:5862px; width:370px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text683_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:5868px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;<BR/>
&lt;TestCases&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1"&gt;<BR/>
&lt;SubCase&nbsp; name="a" InputDataA="123, ABC" InputDataB="123"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text683_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:5837px; line-height:15px; white-space:nowrap">
上のファイルと下のファイルは、同じデータになります。</DIV>
<DIV id="text683_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:260px; margin-top:5523px; line-height:12px; white-space:nowrap">
<A href="#ReadTestCase">
[ 親: ReadTestCase ]</A></DIV>
<DIV id="text683_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:159px; margin-top:5929px; line-height:13px; white-space:nowrap">
InputDataA</DIV>
<DIV id="text683_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:23px; margin-top:6015px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text683_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:6015px; line-height:15px; white-space:nowrap">
→ T_TestCaseData.vbs # [T_BaseTestCaseData]</DIV>
<DIV id="text683_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:107px; margin-top:6034px; line-height:15px; white-space:nowrap">
→ T_TestCaseData2.xml # T_BaseTestCaseData_22 など</DIV>
<DIV id="text683_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:159px; margin-top:5688px; line-height:13px; white-space:nowrap">
InputDataA</DIV>

<v:line from="0,5502" to="505,5502"/>
<v:line from="505,5502" to="505,6080"/>
<v:line from="505,6080" to="0,6080"/>
<v:line from="0,6080" to="0,5502"/>

</PAGE>
 
<!-- page 684 --> 
<PAGE>
<A id="svgcats_vml_p684" class="to_tree" style="margin-top:6085px;" onClick="selectTreeElem( '684' );">←</A>
<A href="#svgcats_vml_p685" class="to_next_page" style="margin-top:6085px;">▼</A>
<A href="#svgcats_vml_p683" class="to_prev_page" style="margin-top:6085px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6096px; width:529px; height:711px;" fillcolor="white"/>
<DIV id="text684_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:23px; margin-top:6113px; line-height:15px; white-space:nowrap">
<A name="ReadTestCase_aggregate">
aggregate 属性</A></DIV>
<DIV id="text684_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:6148px; line-height:15px; white-space:nowrap">
TestCase タグの子の SubCase タグに、別の TestCase タグの子を追加するときは、<BR/>
aggregate 属性を使います。</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:6215px; width:406px; height:250px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text684_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:6221px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;<BR/>
&lt;TestCases&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1" aggregate="#TestCase_Common"&gt;<BR/>
&lt;SubCase&nbsp; name="a" InputDataA="123" InputDataB="123"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test2" aggregate="#TestCase_Common"&gt;<BR/>
&lt;SubCase&nbsp; name="b" InputDataA="123" InputDataB="ABC"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_Common"&gt;<BR/>
&lt;SubCase&nbsp; name="c" InputDataA="ABC" InputDataB="ABC"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text684_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:6196px; line-height:15px; white-space:nowrap">
サンプル XML ファイル： T_Test1_Data.xml</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:6503px; width:340px; height:220px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text684_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:6509px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;<BR/>
&lt;TestCases&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1"&gt;<BR/>
&lt;SubCase&nbsp; name="a" InputDataA="123" InputDataB="123"/&gt;<BR/>
&lt;SubCase&nbsp; name="c" InputDataA="ABC" InputDataB="ABC"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test2"&gt;<BR/>
&lt;SubCase&nbsp; name="b" InputDataA="123" InputDataB="ABC"/&gt;<BR/>
&lt;SubCase&nbsp; name="c" InputDataA="ABC" InputDataB="ABC"/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text684_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:31px; margin-top:6478px; line-height:15px; white-space:nowrap">
上のファイルと下のファイルは、同じデータになります。</DIV>
<DIV id="text684_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:333px; margin-top:6267px; line-height:13px; white-space:nowrap">
TestCase_Common</DIV>
<DIV id="text684_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:333px; margin-top:6327px; line-height:13px; white-space:nowrap">
TestCase_Common</DIV>
<DIV id="text684_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:129px; margin-top:6387px; line-height:13px; white-space:nowrap">
TestCase_Common</DIV>
<DIV id="text684_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:260px; margin-top:6117px; line-height:12px; white-space:nowrap">
<A href="#ReadTestCase">
[ 親: ReadTestCase ]</A></DIV>
<DIV id="text684_11" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:23px; margin-top:6742px; line-height:15px; white-space:nowrap">
テスト</DIV>
<DIV id="text684_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:74px; margin-top:6742px; line-height:15px; white-space:nowrap">
→ T_TestCaseData.vbs # [T_BaseTestCaseData]</DIV>
<DIV id="text684_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:117px; margin-top:6759px; line-height:15px; white-space:nowrap">
→ T_TestCaseData.xml # T_AggregateTestCaseData_1 など</DIV>
<DIV id="text684_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:51px; margin-top:6402px; line-height:13px; white-space:nowrap">
SubCase</DIV>
<DIV id="text684_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:51px; margin-top:6585px; line-height:13px; white-space:nowrap">
SubCase</DIV>
<DIV id="text684_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:51px; margin-top:6660px; line-height:13px; white-space:nowrap">
SubCase</DIV>

<v:line from="0,6096" to="529,6096"/>
<v:line from="529,6096" to="529,6807"/>
<v:line from="529,6807" to="0,6807"/>
<v:line from="0,6807" to="0,6096"/>

</PAGE>
 
<!-- page 685 --> 
<PAGE>
<A id="svgcats_vml_p685" class="to_tree" style="margin-top:6812px;" onClick="selectTreeElem( '685' );">←</A>
<A href="#svgcats_vml_p686" class="to_next_page" style="margin-top:6812px;">▼</A>
<A href="#svgcats_vml_p684" class="to_prev_page" style="margin-top:6812px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:6823px; width:638px; height:1258px;" fillcolor="white"/>
<DIV id="text685_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:6840px; line-height:15px; white-space:nowrap">
<A name="cress_case">
クロス・ケース</A></DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:6914px; width:556px; height:310px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text685_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:6920px; line-height:15px; white-space:nowrap">
Sub&nbsp; T_Test1( Opt, AppKey )<BR/>
&nbsp; Dim&nbsp; x, y, mix<BR/>
<BR/>
&nbsp; Dim cases_x : Set cases_x = ReadTestCase( "T_Test1_Data.xml", "TestCase_for_T_Test1_x" )<BR/>
&nbsp; Dim cases_y : Set cases_y = ReadTestCase( "T_Test1_Data.xml", "TestCase_for_T_Test1_y" )<BR/>
&nbsp; Set mix = CreateObject( "Scripting.Dictionary" )<BR/>
&nbsp; For Each y&nbsp; In cases_y.Items<BR/>
&nbsp; &nbsp; For Each x&nbsp; In cases_x.Items<BR/>
&nbsp; &nbsp; &nbsp; mix.RemoveAll : Dic_add&nbsp; mix, x : Dic_add&nbsp; mix, y<BR/>
&nbsp; &nbsp; &nbsp; T_Test1_main&nbsp; Opt, AppKey, mix<BR/>
&nbsp; &nbsp; Next<BR/>
&nbsp; Next<BR/>
&nbsp; Pass<BR/>
End Sub<BR/>
<BR/>
'// ループが増えてもインデントを深くさせないため、テストの実施は *_main 関数にする<BR/>
Sub&nbsp; T_Test1_main( Opt, AppKey, x )<BR/>
&nbsp; echo&nbsp; x<BR/>
&nbsp; FuncA&nbsp; x("InputData"), ReadFile( x("CurrentFolder") +"\file.txt" )<BR/>
End Sub</DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:7272px; width:412px; height:400px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text685_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:7278px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;<BR/>
&lt;TestCases&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1_x"&gt;<BR/>
&lt;SubCase&nbsp; name="Number"<BR/>
&nbsp; InputData = "123"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans%Num%.txt"&nbsp; _comment2= "FilePath with variable"<BR/>
/&gt;<BR/>
&lt;SubCase&nbsp; name="Alphabet"<BR/>
&nbsp; InputData = "ABC"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans2.txt"<BR/>
/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1_y"&gt; &lt;!-- This is cross case --&gt;<BR/>
&lt;SubCase&nbsp; name="CurrentFolder"<BR/>
&nbsp; CurrentFolder = "."<BR/>
&nbsp; StepPath&nbsp; &nbsp; &nbsp; = "Data\"<BR/>
/&gt;<BR/>
&lt;SubCase&nbsp; name="SubFolder"<BR/>
&nbsp; CurrentFolder = "Data"<BR/>
&nbsp; StepPath&nbsp; &nbsp; &nbsp; = ""<BR/>
/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text685_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:121px; margin-top:7191px; line-height:13px; white-space:nowrap">
InputData</DIV>
<DIV id="text685_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:277px; margin-top:7191px; line-height:13px; white-space:nowrap">
CurrentFolder</DIV>
<DIV id="text685_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:7249px; line-height:15px; white-space:nowrap">
サンプル XML ファイル： T_Test1_Data.xml</DIV>
<DIV id="text685_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:6869px; line-height:15px; white-space:nowrap">
テストケースの値が、表の縦軸と横軸にあり、表の全てをテストする場合は、下記のように二重ループに<BR/>
して、Dic_add を使ってテストデータを結合します。</DIV>
<v:line style="position:absolute;" from="141,7205" to="100,7353" strokecolor="#7CFF11" strokeweight="1pt"/>
<v:line style="position:absolute;" from="99,7516" to="306,7206" strokecolor="#FF9F11" strokeweight="1pt"/>
<DIV id="text685_10" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:267px; margin-top:6843px; line-height:12px; white-space:nowrap">
<A href="#ReadTestCase">
[ 親: ReadTestCase ]</A></DIV>
<DIV id="text685_11" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:79px; margin-top:6921px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text685_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:85px; margin-top:7056px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text685_13" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:79px; margin-top:7161px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text685_14" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:7714px; line-height:15px; white-space:nowrap">
<A name="cress_case_dic">
XML ファイルを使わない、クロス・ケースのサンプル</A></DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:7739px; width:508px; height:310px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text685_15" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:7745px; line-height:15px; white-space:nowrap">
Sub&nbsp; T_Test1( Opt, AppKey )<BR/>
&nbsp; &nbsp; Set t = CreateObject( "Scripting.Dictionary" )<BR/>
<BR/>
&nbsp; &nbsp; For Each&nbsp; endian&nbsp; In Array( "LittleEndian", "BigEndian" )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; For Each&nbsp; language&nbsp; In Array( "VBScript", "C" )<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t("Endian") = endian<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t("Language") = language<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; T_Test1_Main&nbsp; t<BR/>
&nbsp; &nbsp; &nbsp; &nbsp; Next<BR/>
&nbsp; &nbsp; Next<BR/>
<BR/>
&nbsp; &nbsp; Pass<BR/>
End Sub<BR/>
<BR/>
<BR/>
'// ループが増えてもインデントを深くさせないため、テストの実施は *_Main 関数にする<BR/>
Sub&nbsp; T_Test1_Main( Opt, AppKey, x )<BR/>
&nbsp; echo&nbsp; x<BR/>
&nbsp; FuncA&nbsp; x("Endian"), x("Language")<BR/>
End Sub</DIV>

<v:line from="0,6823" to="638,6823"/>
<v:line from="638,6823" to="638,8081"/>
<v:line from="638,8081" to="0,8081"/>
<v:line from="0,8081" to="0,6823"/>

</PAGE>
 
<!-- page 686 --> 
<PAGE>
<A id="svgcats_vml_p686" class="to_tree" style="margin-top:8086px;" onClick="selectTreeElem( '686' );">←</A>
<A href="#svgcats_vml_p687" class="to_next_page" style="margin-top:8086px;">▼</A>
<A href="#svgcats_vml_p685" class="to_prev_page" style="margin-top:8086px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8097px; width:627px; height:520px;" fillcolor="white"/>
<DIV id="text686_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8114px; line-height:15px; white-space:nowrap">
<A name="ReadTestCase_LookUpDic">
テスト・ケースの選択</A></DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:8181px; width:520px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text686_2" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:8187px; line-height:15px; white-space:nowrap">
Sub&nbsp; T_Test1( Opt, AppKey )<BR/>
&nbsp; Dim&nbsp; x<BR/>
<BR/>
&nbsp; Dim cases : Set cases = ReadTestCase( "T_Test1_Data.xml", "TestCase_for_T_Test1" )<BR/>
&nbsp; Set x = cases.LookUpDic( "name", "Alphabet" )<BR/>
&nbsp; T_Test1_main&nbsp; Opt, AppKey, x<BR/>
&nbsp; Pass<BR/>
End Sub</DIV>
<DIV id="text686_3" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:8152px; line-height:15px; white-space:nowrap">
SubCase タグの中から、特定のタグだけ選択するときは、ArrayClass の LookUpDic を使ってください。</DIV>
<v:rect style="position:absolute; margin-left:37px; margin-top:8350px; width:268px; height:235px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text686_4" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:45px; margin-top:8356px; line-height:15px; white-space:nowrap">
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;<BR/>
&lt;TestCases&gt;<BR/>
<BR/>
&lt;TestCase id="TestCase_for_T_Test1"&gt;<BR/>
&lt;SubCase&nbsp; name="Number"<BR/>
&nbsp; InputData = "123"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans%Num%.txt"<BR/>
/&gt;<BR/>
&lt;SubCase&nbsp; name="Alphabet"<BR/>
&nbsp; InputData = "ABC"<BR/>
&nbsp; Answer&nbsp; &nbsp; = "ans2.txt"<BR/>
/&gt;<BR/>
&lt;/TestCase&gt;<BR/>
<BR/>
&lt;/TestCases&gt;</DIV>
<DIV id="text686_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:33px; margin-top:8330px; line-height:15px; white-space:nowrap">
サンプル XML ファイル： T_Test1_Data.xml</DIV>
<DIV id="text686_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:207px; margin-top:8248px; line-height:13px; white-space:nowrap">
"name", "Alphabet"</DIV>
<v:line style="position:absolute;" from="456,8255" to="193,8398" strokecolor="#7CFF11" strokeweight="1pt"/>
<DIV id="text686_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:267px; margin-top:8117px; line-height:12px; white-space:nowrap">
<A href="#ReadTestCase">
[ 親: ReadTestCase ]</A></DIV>
<v:line style="position:absolute;" from="292,8267" to="170,8474" strokecolor="#FF9F11" strokeweight="1pt"/>

<v:line from="0,8097" to="627,8097"/>
<v:line from="627,8097" to="627,8617"/>
<v:line from="627,8617" to="0,8617"/>
<v:line from="0,8617" to="0,8097"/>

</PAGE>
 
<!-- page 687 --> 
<PAGE>
<A id="svgcats_vml_p687" class="to_tree" style="margin-top:8622px;" onClick="selectTreeElem( '687' );">←</A>
<A href="#svgcats_vml_p688" class="to_next_page" style="margin-top:8622px;">▼</A>
<A href="#svgcats_vml_p686" class="to_prev_page" style="margin-top:8622px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:8633px; width:618px; height:399px;" fillcolor="white"/>
<DIV id="text687_1" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:8650px; line-height:15px; white-space:nowrap">
<A name="case_embed">
スクリプトからテストケースを指定する</A></DIV>
<DIV id="text687_2" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:8pt; color:#0000FF; margin-left:318px; margin-top:8653px; line-height:12px; white-space:nowrap">
<A href="#ReadTestCase">
[ 親: ReadTestCase ]</A></DIV>
<v:rect style="position:absolute; margin-left:41px; margin-top:8705px; width:532px; height:295px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text687_3" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:49px; margin-top:8711px; line-height:15px; white-space:nowrap">
Sub&nbsp; T_Test1( Opt, AppKey )<BR/>
&nbsp; Dim&nbsp; x, y<BR/>
<BR/>
&nbsp; Dim cases : Set cases_x = ReadTestCase( "T_Test1_Data.xml", "TestCase_for_T_Test1" )<BR/>
&nbsp; For Each x&nbsp; In cases_x.Items<BR/>
&nbsp; &nbsp; For Each y&nbsp; In Array( 2, 3 )<BR/>
&nbsp; &nbsp; &nbsp; x("y") = y<BR/>
&nbsp; &nbsp; &nbsp; T_Test1_main&nbsp; Opt, AppKey, x<BR/>
&nbsp; &nbsp; &nbsp; x.Remove&nbsp; "y"<BR/>
&nbsp; &nbsp; Next<BR/>
&nbsp; Next<BR/>
&nbsp; Pass<BR/>
End Sub<BR/>
<BR/>
'// ループが増えてもインデントを深くさせないため、テストの実施は *_main 関数にする<BR/>
Sub&nbsp; T_Test1_main( Opt, AppKey, x )<BR/>
&nbsp; echo&nbsp; x<BR/>
&nbsp; FuncA&nbsp; x("InputData"), ReadFile( x("y") +"\file.txt" )<BR/>
End Sub</DIV>
<DIV id="text687_4" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:27px; margin-top:8679px; line-height:15px; white-space:nowrap">
テストケースの値を XML ファイルではなく、スクリプトに埋め込む場合は、下記のように代入します。</DIV>
<DIV id="text687_5" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:85px; margin-top:8802px; line-height:13px; white-space:nowrap">
x("y") = y</DIV>
<DIV id="text687_6" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:193px; margin-top:8787px; line-height:13px; white-space:nowrap">
( 2, 3 )</DIV>
<DIV id="text687_7" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:79px; margin-top:8937px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text687_8" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:85px; margin-top:8817px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text687_9" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:79px; margin-top:8712px; line-height:13px; white-space:nowrap">
T_Test1</DIV>
<DIV id="text687_10" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:259px; margin-top:8967px; line-height:13px; white-space:nowrap">
x("y")</DIV>
<v:line style="position:absolute;" from="118,8813" to="263,8968" strokecolor="#7CFF11" strokeweight="1pt"/>
<DIV id="text687_12" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#FF0000; margin-left:85px; margin-top:8832px; line-height:13px; white-space:nowrap">
x.Remove&nbsp; "y"</DIV>

<v:line from="0,8633" to="618,8633"/>
<v:line from="618,8633" to="618,9032"/>
<v:line from="618,9032" to="0,9032"/>
<v:line from="0,9032" to="0,8633"/>

</PAGE>
 
<!-- page 688 --> 
<PAGE>
<A id="svgcats_vml_p688" class="to_tree" style="margin-top:9037px;" onClick="selectTreeElem( '688' );">←</A>
<A href="vbslib_35.html#svgcats_vml_p689" class="to_next_page" style="margin-top:9037px;">▼</A>
<A href="#svgcats_vml_p687" class="to_prev_page" style="margin-top:9037px;">▲</A>
<v:rect style="position:absolute; margin-left:0px; margin-top:9048px; width:632px; height:1922px;" fillcolor="white"/>
<v:image src="688/image01.png"
   style="position:absolute; margin-left:193px; margin-top:9172px; width:31px; height:35px;"/>
<v:image src="688/image02.jpg"
   style="position:absolute; margin-left:447px; margin-top:9174px; width:35px; height:32px;"/>
<v:image src="688/image03.jpg"
   style="position:absolute; margin-left:78px; margin-top:9173px; width:25px; height:33px;"/>
<v:image src="688/image04.jpg"
   style="position:absolute; margin-left:314px; margin-top:9173px; width:25px; height:33px;"/>
<DIV id="text688_5" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#008000; font-weight: bold; margin-left:24px; margin-top:9065px; line-height:15px; white-space:nowrap">
<A name="TempParams">
TempParams.txt - C言語のプログラムにデータを渡す</A></DIV>
<DIV id="text688_6" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:24px; margin-top:9095px; line-height:15px; white-space:nowrap">
C言語の標準ライブラリだけを使うときは、fgets を使った１行ずつ読み込むような単純なファイル・リード<BR/>
しかできませんが、VBScript で XML などのデータを整理することで、C言語のプログラムに複雑な<BR/>
動きをさせることができるようになります。</DIV>
<DIV id="text688_7" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:187px; margin-top:9212px; line-height:15px; white-space:nowrap">
Test.vbs</DIV>
<DIV id="text688_8" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:412px; margin-top:9212px; line-height:15px; white-space:nowrap">
C言語のプログラム</DIV>
<v:line style="position:absolute;" from="116,9189" to="178,9189" strokecolor="#000000" strokeweight="1pt">
    <v:stroke dashstyle="dash"/>
</v:line>
<v:shape style="position:absolute; margin-left:168px; margin-top:9184px; width:10px; height:10px"
 fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"
 path="m 1000,500 l 0,0, 0,1000 x e"/>
<v:line style="position:absolute;" from="237,9191" to="299,9191" strokecolor="#000000" strokeweight="1pt">
    <v:stroke dashstyle="dash"/>
</v:line>
<v:shape style="position:absolute; margin-left:289px; margin-top:9186px; width:10px; height:10px"
 fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"
 path="m 1000,500 l 0,0, 0,1000 x e"/>
<v:line style="position:absolute;" from="353,9192" to="434,9192" strokecolor="#000000" strokeweight="1pt">
    <v:stroke dashstyle="dash"/>
</v:line>
<v:shape style="position:absolute; margin-left:424px; margin-top:9187px; width:10px; height:10px"
 fillcolor="#FFFFFF" strokecolor="#000000" strokeweight="1pt"
 path="m 1000,500 l 0,0, 0,1000 x e"/>
<DIV id="text688_12" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:61px; margin-top:9212px; line-height:15px; white-space:nowrap">
T_Test1.xml</DIV>
<DIV id="text688_13" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:283px; margin-top:9212px; line-height:15px; white-space:nowrap">
TempParams.txt</DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:9288px; width:388px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text688_14" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:9294px; line-height:15px; white-space:nowrap">
Sub&nbsp; T_Test1_main( tests, x )&nbsp; // x is from ReadTestCase<BR/>
&nbsp; Dim&nbsp; f : Set f = OpenForWrite( "TempParams.txt", Empty )<BR/>
&nbsp; f.WriteLine&nbsp; x("Param1") &amp; " // Param1"<BR/>
&nbsp; f = Empty<BR/>
<BR/>
&nbsp; r= RunProg( "CLangProg.exe /TempParams:TempParams.txt", "" )<BR/>
<BR/>
&nbsp; del&nbsp; "TempParams.txt"</DIV>
<DIV id="text688_15" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9258px; line-height:15px; white-space:nowrap">
vbs スクリプトのサンプル (Test.vbs)</DIV>
<DIV id="text688_16" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#0000FF; margin-left:317px; margin-top:9295px; line-height:13px; white-space:nowrap">
<A href="#ReadTestCase">
ReadTestCase</A></DIV>
<v:rect style="position:absolute; margin-left:45px; margin-top:9472px; width:502px; height:640px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text688_17" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:53px; margin-top:9478px; line-height:15px; white-space:nowrap">
int&nbsp; Params_read( Params* m, FILE* f );<BR/>
<BR/>
int&nbsp; T_Sample()<BR/>
{<BR/>
&nbsp; int&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e;<BR/>
&nbsp; errno_t&nbsp; &nbsp; &nbsp;et;<BR/>
&nbsp; FILE*&nbsp; &nbsp; &nbsp; &nbsp;f = NULL;<BR/>
&nbsp; TCHAR&nbsp; &nbsp; &nbsp; &nbsp;s[256];<BR/>
&nbsp; TCHAR&nbsp; &nbsp; &nbsp; &nbsp;path[256];<BR/>
<BR/>
&nbsp; //=== ReadTestCase<BR/>
&nbsp; e= GetCommandLineNamed( _T("TempParams"), false, s, sizeof(s) ); IF(e)goto fin;<BR/>
&nbsp; e= StrT_getFullPath( path, sizeof(path), s, NULL );<BR/>
&nbsp; et= _tfopen_s( &amp;f, path, _T("rt") ); IF(et)goto err_no;<BR/>
&nbsp; e= Params_read( &amp;params, f ); IF(e)goto fin;<BR/>
<BR/>
&nbsp; //=== Test Main<BR/>
&nbsp; // Write here ...<BR/>
<BR/>
&nbsp; e=0;<BR/>
fin:<BR/>
&nbsp; if(f!=NULL){ee= fclose( f ); IF(ee&amp;&amp;!e)e=E_Errno;}<BR/>
}<BR/>
<BR/>
<BR/>
int&nbsp; Params_read( Params* m, FILE* f )<BR/>
{<BR/>
&nbsp; int&nbsp; &nbsp; e;<BR/>
&nbsp; int&nbsp; &nbsp; i;<BR/>
&nbsp; TCHAR&nbsp; line[256];<BR/>
<BR/>
&nbsp; line[0] = '\0';<BR/>
&nbsp; _fgetts( line, _countof(line), f );<BR/>
<BR/>
&nbsp; e= StrT_cutLineComment( line, sizeof(line), line, _T("//") ); IF(e)goto fin;<BR/>
&nbsp; m-&gt;BufferSize = _ttoi( line );<BR/>
<BR/>
&nbsp; _fgetts( line, _countof(line), f );&nbsp; // skip space line<BR/>
&nbsp; e=0;<BR/>
fin:<BR/>
&nbsp; return&nbsp; e;<BR/>
}</DIV>
<DIV id="text688_18" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:9446px; line-height:15px; white-space:nowrap">
C言語のテスト・プログラムのサンプル (CLangProg.exe)</DIV>
<v:line style="position:absolute;" from="303,9671" to="342,9385" strokecolor="#7CFF11" strokeweight="1pt"/>
<v:line style="position:absolute;" from="217,9671" to="303,9671" strokecolor="#7CFF11" strokeweight="1pt"/>
<v:line style="position:absolute;" from="207,9683" to="217,9671" strokecolor="#7CFF11" strokeweight="1pt"/>
<DIV id="text688_22" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:83px; margin-top:9989px; line-height:13px; white-space:nowrap">
StrT_cutLineComment</DIV>
<DIV id="text688_23" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10708px; line-height:15px; white-space:nowrap">
TempParams.txt ファイルの データ型の名前</DIV>
<DIV id="text688_24" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:10739px; line-height:15px; white-space:nowrap">
テスト・データが複数のデータ構造を持つときは、データ構造を識別するシンボルを<BR/>
TempParams.txt ファイルに記述する必要があります。</DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:10808px; width:256px; height:130px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text688_25" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:10814px; line-height:15px; white-space:nowrap">
DataTypeA&nbsp; // データ型の名前<BR/>
100&nbsp; &nbsp; &nbsp; &nbsp; // DataTypeA の１つ目のデータ<BR/>
200&nbsp; &nbsp; &nbsp; &nbsp; // DataTypeA の２つ目のデータ<BR/>
<BR/>
DataTypeB&nbsp; // データ型の名前<BR/>
100&nbsp; &nbsp; &nbsp; &nbsp; // DataTypeB の１つ目のデータ<BR/>
200&nbsp; &nbsp; &nbsp; &nbsp; // DataTypeB の２つ目のデータ<BR/>
300&nbsp; &nbsp; &nbsp; &nbsp; // DataTypeB の３つ目のデータ</DIV>
<DIV id="text688_26" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10406px; line-height:15px; white-space:nowrap">
TempParams.txt ファイルの フラグド構造体パラメーター</DIV>
<DIV id="text688_27" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:80px; margin-top:10655px; line-height:15px; white-space:nowrap">
→ フラグド構造体パラメーター</DIV>
<DIV id="text688_28" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:42px; margin-top:10655px; line-height:15px; white-space:nowrap">
参考</DIV>
<DIV id="text688_29" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#408080; font-weight: bold; margin-left:24px; margin-top:10148px; line-height:15px; white-space:nowrap">
TempParams.txt ファイルの基本形</DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:10276px; width:304px; height:85px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text688_30" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:10282px; line-height:15px; white-space:nowrap">
100&nbsp; &nbsp; // １つ目のテスト・ケースの１つ目のデータ<BR/>
200&nbsp; &nbsp; // １つ目のテスト・ケースの２つ目のデータ<BR/>
<BR/>
110&nbsp; &nbsp; // ２つ目のテスト・ケースの１つ目のデータ<BR/>
210&nbsp; &nbsp; // ２つ目のテスト・ケースの２つ目のデータ</DIV>
<DIV id="text688_31" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:10178px; line-height:15px; white-space:nowrap">
多くの場合、テスト・データを単純に並べていくだけで、テストを実施することはできるでしょう。<BR/>
テスト・ケースが複数あるときは、空行で区切るとよいでしょう。<BR/>
clib の StrT_cutLineComment 関数を使えば、コメントを入れることができます。<BR/>
下記は、struct { int a; int b; } TestData[2]; という構造になります。</DIV>
<DIV id="text688_32" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:42px; margin-top:10437px; line-height:15px; white-space:nowrap">
１つのテスト・ケースにおいて、それぞれのデータを使うかどうかを表すには、１つ目のデータを<BR/>
ビットフィールドの数値として使い、ビットが1であれば対応するデータが記述されているように<BR/>
します。</DIV>
<v:rect style="position:absolute; margin-left:76px; margin-top:10522px; width:310px; height:115px;" fillcolor="#E7E7E7" strokecolor="#000000" strokeweight="1pt"/>
<DIV id="text688_33" style="position:absolute; font-family: 'ＭＳ ゴシック'; font-size:9pt; color:#000000; margin-left:84px; margin-top:10528px; line-height:15px; white-space:nowrap">
0x07&nbsp; &nbsp;// ビットフィールド。 ビット０、１、２が１<BR/>
100&nbsp; &nbsp; // １つ目のデータ<BR/>
200&nbsp; &nbsp; // ２つ目のデータ<BR/>
300&nbsp; &nbsp; // ３つ目のデータ<BR/>
<BR/>
0x02&nbsp; &nbsp;// ビットフィールド。 ビット１のみが１<BR/>
200&nbsp; &nbsp; // ２つ目のデータ</DIV>
<DIV id="text688_34" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:10255px; line-height:15px; white-space:nowrap">
TempParams.txt</DIV>
<DIV id="text688_35" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:10499px; line-height:15px; white-space:nowrap">
TempParams.txt</DIV>
<DIV id="text688_36" style="position:absolute; font-family: 'ＭＳ Ｐゴシック'; font-size:10pt; color:#000000; margin-left:62px; margin-top:10786px; line-height:15px; white-space:nowrap">
TempParams.txt</DIV>

<v:line from="0,9048" to="632,9048"/>
<v:line from="632,9048" to="632,10970"/>
<v:line from="632,10970" to="0,10970"/>
<v:line from="0,10970" to="0,9048"/>

<DIV style="position:absolute; margin-left:0px; margin-top:10970px;">
<A id="svgcats_vml_p688" class="to_tree" onClick="selectTreeElem( '688' );">←</A></DIV>
<DIV style="position:absolute; margin-left:20px; margin-top:10970px;">
<A id="page_group_bottom" href="vbslib_35.html#page_group_top" style="text-decoration:none;">↓</A></DIV>
</PAGE>
 
</PAGESET>

<TABLE height="100%" style="position:absolute; margin-top:-9999px"><TR><TD></TD></TR></TABLE>

</BODY>
</HTML> 
 
